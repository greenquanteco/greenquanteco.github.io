<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 4 Exploratory data analysis | Applied Biological Data Analysis</title>
  <meta name="description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 4 Exploratory data analysis | Applied Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://greenquanteco.github.io/index.html" />
  <meta property="og:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />
  <meta property="og:description" content="Helping biologists to become more informed users of R and statistical methods." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 4 Exploratory data analysis | Applied Biological Data Analysis" />
  
  <meta name="twitter:description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="twitter:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />

<meta name="author" content="Nick Green, Kennesaw State University" />


<meta name="date" content="2022-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mod-03.html"/>
<link rel="next" href="mod-05.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-permissions"><i class="fa fa-check"></i>License and permissions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i>Course objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-requirements"><i class="fa fa-check"></i>Course requirements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-reading"><i class="fa fa-check"></i>Recommended reading</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-organization"><i class="fa fa-check"></i>Course organization</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="mod-01.html"><a href="mod-01.html"><i class="fa fa-check"></i><b>1</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="mod-01.html"><a href="mod-01.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="mod-01.html"><a href="mod-01.html#statistics-in-modern-biology"><i class="fa fa-check"></i><b>1.2</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="mod-01.html"><a href="mod-01.html#the-scientific-method"><i class="fa fa-check"></i><b>1.2.1</b> The scientific method</a></li>
<li class="chapter" data-level="1.2.2" data-path="mod-01.html"><a href="mod-01.html#example-data-analysis"><i class="fa fa-check"></i><b>1.2.2</b> Example data analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="mod-01.html"><a href="mod-01.html#misuses-of-statistics"><i class="fa fa-check"></i><b>1.3</b> Misuses of statistics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="mod-01.html"><a href="mod-01.html#proving-the-trivial-and-meaningless-hypotheses"><i class="fa fa-check"></i><b>1.3.1</b> “Proving” the trivial and meaningless hypotheses</a></li>
<li class="chapter" data-level="1.3.2" data-path="mod-01.html"><a href="mod-01.html#inappropriate-methods"><i class="fa fa-check"></i><b>1.3.2</b> Inappropriate methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="mod-01.html"><a href="mod-01.html#p-hacking-and-data-dredging"><i class="fa fa-check"></i><b>1.3.3</b> <em>P</em>-hacking and data dredging</a></li>
<li class="chapter" data-level="1.3.4" data-path="mod-01.html"><a href="mod-01.html#inadequate-sample-sizes-and-pseudoreplication"><i class="fa fa-check"></i><b>1.3.4</b> Inadequate sample sizes and pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="mod-01.html"><a href="mod-01.html#p-values-and-null-hypothesis-significance-testing-nhst"><i class="fa fa-check"></i><b>1.4</b> <em>P</em>-values and null hypothesis significance testing (NHST)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="mod-01.html"><a href="mod-01.html#definition"><i class="fa fa-check"></i><b>1.4.1</b> Definition</a></li>
<li class="chapter" data-level="1.4.2" data-path="mod-01.html"><a href="mod-01.html#history-and-status-of-p-values"><i class="fa fa-check"></i><b>1.4.2</b> History and status of <em>P</em>-values</a></li>
<li class="chapter" data-level="1.4.3" data-path="mod-01.html"><a href="mod-01.html#where-p-values-come-from"><i class="fa fa-check"></i><b>1.4.3</b> Where <em>P</em>-values come from</a></li>
<li class="chapter" data-level="1.4.4" data-path="mod-01.html"><a href="mod-01.html#what-p-values-mean-and-do-not-mean"><i class="fa fa-check"></i><b>1.4.4</b> What <em>P</em>-values mean and do not mean</a></li>
<li class="chapter" data-level="1.4.5" data-path="mod-01.html"><a href="mod-01.html#do-you-need-a-p-value"><i class="fa fa-check"></i><b>1.4.5</b> Do you need a <em>P</em>-value?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="mod-01.html"><a href="mod-01.html#alternatives-to-nhst"><i class="fa fa-check"></i><b>1.5</b> Alternatives to NHST</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="mod-01.html"><a href="mod-01.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.1</b> Bayesian inference</a></li>
<li class="chapter" data-level="1.5.2" data-path="mod-01.html"><a href="mod-01.html#information-theoretic-methods"><i class="fa fa-check"></i><b>1.5.2</b> Information-theoretic methods</a></li>
<li class="chapter" data-level="1.5.3" data-path="mod-01.html"><a href="mod-01.html#machine-learning"><i class="fa fa-check"></i><b>1.5.3</b> Machine learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mod-02.html"><a href="mod-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-02.html"><a href="mod-02.html#getting-started-with-r"><i class="fa fa-check"></i><b>2.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="mod-02.html"><a href="mod-02.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="mod-02.html"><a href="mod-02.html#advantages-of-r"><i class="fa fa-check"></i><b>2.1.2</b> Advantages of R</a></li>
<li class="chapter" data-level="2.1.3" data-path="mod-02.html"><a href="mod-02.html#disadvantages-of-r"><i class="fa fa-check"></i><b>2.1.3</b> Disadvantages of R</a></li>
<li class="chapter" data-level="2.1.4" data-path="mod-02.html"><a href="mod-02.html#base-r-and-vs.-tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Base R and (vs.?) <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="mod-02.html"><a href="mod-02.html#download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> Download and install R (and RStudio)</a></li>
<li class="chapter" data-level="2.3" data-path="mod-02.html"><a href="mod-02.html#using-r"><i class="fa fa-check"></i><b>2.3</b> Using R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="mod-02.html"><a href="mod-02.html#using-the-base-r-gui"><i class="fa fa-check"></i><b>2.3.1</b> Using the base R GUI</a></li>
<li class="chapter" data-level="2.3.2" data-path="mod-02.html"><a href="mod-02.html#using-r-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Using R in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="mod-02.html"><a href="mod-02.html#using-r-with-other-programs"><i class="fa fa-check"></i><b>2.3.3</b> Using R with other programs</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="mod-02.html"><a href="mod-02.html#mod-02-first"><i class="fa fa-check"></i><b>2.4</b> A first R session</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="mod-02.html"><a href="mod-02.html#import-data"><i class="fa fa-check"></i><b>2.4.1</b> Import data</a></li>
<li class="chapter" data-level="2.4.2" data-path="mod-02.html"><a href="mod-02.html#explore-and-visualize-data"><i class="fa fa-check"></i><b>2.4.2</b> Explore and visualize data</a></li>
<li class="chapter" data-level="2.4.3" data-path="mod-02.html"><a href="mod-02.html#transform-data"><i class="fa fa-check"></i><b>2.4.3</b> Transform data</a></li>
<li class="chapter" data-level="2.4.4" data-path="mod-02.html"><a href="mod-02.html#analyze-data"><i class="fa fa-check"></i><b>2.4.4</b> Analyze data</a></li>
<li class="chapter" data-level="2.4.5" data-path="mod-02.html"><a href="mod-02.html#write-out-results"><i class="fa fa-check"></i><b>2.4.5</b> Write out results</a></li>
<li class="chapter" data-level="2.4.6" data-path="mod-02.html"><a href="mod-02.html#save-your-work"><i class="fa fa-check"></i><b>2.4.6</b> Save your work?</a></li>
<li class="chapter" data-level="2.4.7" data-path="mod-02.html"><a href="mod-02.html#whats-next"><i class="fa fa-check"></i><b>2.4.7</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="mod-02.html"><a href="mod-02.html#write-and-execute-commands-in-the-r-console"><i class="fa fa-check"></i><b>2.5</b> Write and execute commands in the R console</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="mod-02.html"><a href="mod-02.html#r-commandsbasics"><i class="fa fa-check"></i><b>2.5.1</b> R commands–basics</a></li>
<li class="chapter" data-level="2.5.2" data-path="mod-02.html"><a href="mod-02.html#elements-of-r-code"><i class="fa fa-check"></i><b>2.5.2</b> Elements of R code</a></li>
<li class="chapter" data-level="2.5.3" data-path="mod-02.html"><a href="mod-02.html#the-r-workspace"><i class="fa fa-check"></i><b>2.5.3</b> The R workspace</a></li>
<li class="chapter" data-level="2.5.4" data-path="mod-02.html"><a href="mod-02.html#r-code-basics-assignment-and-operators"><i class="fa fa-check"></i><b>2.5.4</b> R code basics: assignment and operators</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="mod-02.html"><a href="mod-02.html#mod-02-struct"><i class="fa fa-check"></i><b>2.6</b> Basic R data structures</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-02.html"><a href="mod-02.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-02.html"><a href="mod-02.html#data-frames"><i class="fa fa-check"></i><b>2.6.2</b> Data frames</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-02.html"><a href="mod-02.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.6.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-02.html"><a href="mod-02.html#lists"><i class="fa fa-check"></i><b>2.6.4</b> Lists</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-02.html"><a href="mod-02.html#s4-objects"><i class="fa fa-check"></i><b>2.6.5</b> S4 objects</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-02.html"><a href="mod-02.html#r-data-types"><i class="fa fa-check"></i><b>2.7</b> R data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="mod-02.html"><a href="mod-02.html#character-type"><i class="fa fa-check"></i><b>2.7.1</b> Character type</a></li>
<li class="chapter" data-level="2.7.2" data-path="mod-02.html"><a href="mod-02.html#numeric-type"><i class="fa fa-check"></i><b>2.7.2</b> Numeric type</a></li>
<li class="chapter" data-level="2.7.3" data-path="mod-02.html"><a href="mod-02.html#integer-type"><i class="fa fa-check"></i><b>2.7.3</b> Integer type</a></li>
<li class="chapter" data-level="2.7.4" data-path="mod-02.html"><a href="mod-02.html#logical-type"><i class="fa fa-check"></i><b>2.7.4</b> Logical type</a></li>
<li class="chapter" data-level="2.7.5" data-path="mod-02.html"><a href="mod-02.html#special-values"><i class="fa fa-check"></i><b>2.7.5</b> Special values</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="mod-02.html"><a href="mod-02.html#manage-r-code-as-scripts-.r-files"><i class="fa fa-check"></i><b>2.8</b> Manage R code as scripts (.r files)</a></li>
<li class="chapter" data-level="2.9" data-path="mod-02.html"><a href="mod-02.html#manage-and-use-r-packages"><i class="fa fa-check"></i><b>2.9</b> Manage and use R packages</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-02.html"><a href="mod-02.html#your-r-library"><i class="fa fa-check"></i><b>2.9.1</b> Your R library</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-02.html"><a href="mod-02.html#installing-packages-using-the-r-gui"><i class="fa fa-check"></i><b>2.9.2</b> Installing packages using the R GUI</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-02.html"><a href="mod-02.html#installing-packages-in-rstudio"><i class="fa fa-check"></i><b>2.9.3</b> Installing packages in RStudio</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-02.html"><a href="mod-02.html#installing-packages-using-the-r-console"><i class="fa fa-check"></i><b>2.9.4</b> Installing packages using the R console</a></li>
<li class="chapter" data-level="2.9.5" data-path="mod-02.html"><a href="mod-02.html#working-with-packages-in-r"><i class="fa fa-check"></i><b>2.9.5</b> Working with packages in R</a></li>
<li class="chapter" data-level="2.9.6" data-path="mod-02.html"><a href="mod-02.html#package-dependencies"><i class="fa fa-check"></i><b>2.9.6</b> Package dependencies</a></li>
<li class="chapter" data-level="2.9.7" data-path="mod-02.html"><a href="mod-02.html#citing-packages"><i class="fa fa-check"></i><b>2.9.7</b> Citing packages</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="mod-02.html"><a href="mod-02.html#r-documentation"><i class="fa fa-check"></i><b>2.10</b> R documentation</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="mod-02.html"><a href="mod-02.html#documentation-help-files"><i class="fa fa-check"></i><b>2.10.1</b> Documentation (help) files</a></li>
<li class="chapter" data-level="2.10.2" data-path="mod-02.html"><a href="mod-02.html#r-vignettes"><i class="fa fa-check"></i><b>2.10.2</b> R vignettes</a></li>
<li class="chapter" data-level="2.10.3" data-path="mod-02.html"><a href="mod-02.html#official-r-project-resources"><i class="fa fa-check"></i><b>2.10.3</b> Official R Project resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="mod-02.html"><a href="mod-02.html#unofficial-online-resources"><i class="fa fa-check"></i><b>2.10.4</b> Unofficial online resources</a></li>
<li class="chapter" data-level="2.10.5" data-path="mod-02.html"><a href="mod-02.html#r-books"><i class="fa fa-check"></i><b>2.10.5</b> R books</a></li>
<li class="chapter" data-level="2.10.6" data-path="mod-02.html"><a href="mod-02.html#two-reminders"><i class="fa fa-check"></i><b>2.10.6</b> Two reminders</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-03.html"><a href="mod-03.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-03.html"><a href="mod-03.html#mod-03-inout"><i class="fa fa-check"></i><b>3.1</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="mod-03.html"><a href="mod-03.html#importing-data-preliminaries"><i class="fa fa-check"></i><b>3.1.1</b> Importing data: preliminaries</a></li>
<li class="chapter" data-level="3.1.2" data-path="mod-03.html"><a href="mod-03.html#importing-data-from-text-files-with-read.csv-and-read.table"><i class="fa fa-check"></i><b>3.1.2</b> Importing data from text files with <code>read.csv()</code> and <code>read.table()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="mod-03.html"><a href="mod-03.html#importing-data-from-saved-workspaces"><i class="fa fa-check"></i><b>3.1.3</b> Importing data from saved workspaces</a></li>
<li class="chapter" data-level="3.1.4" data-path="mod-03.html"><a href="mod-03.html#importing-data-special-cases"><i class="fa fa-check"></i><b>3.1.4</b> Importing data: special cases:</a></li>
<li class="chapter" data-level="3.1.5" data-path="mod-03.html"><a href="mod-03.html#export-data-from-r"><i class="fa fa-check"></i><b>3.1.5</b> Export data from R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="mod-03.html"><a href="mod-03.html#making-values-in-r"><i class="fa fa-check"></i><b>3.2</b> Making values in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="mod-03.html"><a href="mod-03.html#producing-arbitrary-values-with-c"><i class="fa fa-check"></i><b>3.2.1</b> Producing arbitrary values with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="mod-03.html"><a href="mod-03.html#generating-regular-values"><i class="fa fa-check"></i><b>3.2.2</b> Generating regular values</a></li>
<li class="chapter" data-level="3.2.3" data-path="mod-03.html"><a href="mod-03.html#generating-random-values"><i class="fa fa-check"></i><b>3.2.3</b> Generating random values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="mod-03.html"><a href="mod-03.html#selecting-data-with"><i class="fa fa-check"></i><b>3.3</b> Selecting data with <code>[]</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="mod-03.html"><a href="mod-03.html#mod-03-brackets"><i class="fa fa-check"></i><b>3.3.1</b> Basics of brackets</a></li>
<li class="chapter" data-level="3.3.2" data-path="mod-03.html"><a href="mod-03.html#extracting-and-selecting-data-with-logical-tests"><i class="fa fa-check"></i><b>3.3.2</b> Extracting and selecting data with logical tests</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="mod-03.html"><a href="mod-03.html#managing-dates-and-characters"><i class="fa fa-check"></i><b>3.4</b> Managing dates and characters</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="mod-03.html"><a href="mod-03.html#temporal-data-and-dates"><i class="fa fa-check"></i><b>3.4.1</b> Temporal data and dates</a></li>
<li class="chapter" data-level="3.4.2" data-path="mod-03.html"><a href="mod-03.html#character-data-text"><i class="fa fa-check"></i><b>3.4.2</b> Character data (text)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="mod-03.html"><a href="mod-03.html#mod-03-dataframe"><i class="fa fa-check"></i><b>3.5</b> Data frame management</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="mod-03.html"><a href="mod-03.html#data-frame-structure"><i class="fa fa-check"></i><b>3.5.1</b> Data frame structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="mod-03.html"><a href="mod-03.html#common-data-frame-operations"><i class="fa fa-check"></i><b>3.5.2</b> Common data frame operations</a></li>
<li class="chapter" data-level="3.5.3" data-path="mod-03.html"><a href="mod-03.html#other-data-frame-operations"><i class="fa fa-check"></i><b>3.5.3</b> Other data frame operations</a></li>
<li class="chapter" data-level="3.5.4" data-path="mod-03.html"><a href="mod-03.html#mod-03-reshape"><i class="fa fa-check"></i><b>3.5.4</b> Reshaping data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-04.html"><a href="mod-04.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-04.html"><a href="mod-04.html#descriptive-and-summary-statistics"><i class="fa fa-check"></i><b>4.1</b> Descriptive and summary statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="mod-04.html"><a href="mod-04.html#basic-summary-statistics"><i class="fa fa-check"></i><b>4.1.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="4.1.2" data-path="mod-04.html"><a href="mod-04.html#summarizing-data-with-the-apply-family"><i class="fa fa-check"></i><b>4.1.2</b> Summarizing data with the <code>apply()</code> family</a></li>
<li class="chapter" data-level="4.1.3" data-path="mod-04.html"><a href="mod-04.html#mod-04-tabagg"><i class="fa fa-check"></i><b>4.1.3</b> Tabulation and aggregation</a></li>
<li class="chapter" data-level="4.1.4" data-path="mod-04.html"><a href="mod-04.html#aggregation-aka-pivot-tables"><i class="fa fa-check"></i><b>4.1.4</b> Aggregation (aka: pivot tables)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mod-04.html"><a href="mod-04.html#mod-04-vis"><i class="fa fa-check"></i><b>4.2</b> Visualizing data distributions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="mod-04.html"><a href="mod-04.html#boxplots-aka-box-and-whisker-plots"><i class="fa fa-check"></i><b>4.2.1</b> Boxplots (aka: box-and-whisker plots)</a></li>
<li class="chapter" data-level="4.2.2" data-path="mod-04.html"><a href="mod-04.html#histograms"><i class="fa fa-check"></i><b>4.2.2</b> Histograms</a></li>
<li class="chapter" data-level="4.2.3" data-path="mod-04.html"><a href="mod-04.html#kernel-density-plots"><i class="fa fa-check"></i><b>4.2.3</b> Kernel density plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="mod-04.html"><a href="mod-04.html#empirical-cumulative-distribution-plots-ecdf"><i class="fa fa-check"></i><b>4.2.4</b> Empirical cumulative distribution plots (ECDF)</a></li>
<li class="chapter" data-level="4.2.5" data-path="mod-04.html"><a href="mod-04.html#quantile-quantile-qq-plots"><i class="fa fa-check"></i><b>4.2.5</b> Quantile-quantile (QQ) plots</a></li>
<li class="chapter" data-level="4.2.6" data-path="mod-04.html"><a href="mod-04.html#how-should-i-plot-my-data"><i class="fa fa-check"></i><b>4.2.6</b> How should I plot my data?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mod-04.html"><a href="mod-04.html#mod-04-dists1"><i class="fa fa-check"></i><b>4.3</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="mod-04.html"><a href="mod-04.html#probability-distributions"><i class="fa fa-check"></i><b>4.3.1</b> Probability distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="mod-04.html"><a href="mod-04.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>4.3.2</b> Probability distributions in R</a></li>
<li class="chapter" data-level="4.3.3" data-path="mod-04.html"><a href="mod-04.html#discrete-distributions"><i class="fa fa-check"></i><b>4.3.3</b> Discrete distributions</a></li>
<li class="chapter" data-level="4.3.4" data-path="mod-04.html"><a href="mod-04.html#continuous-distributions"><i class="fa fa-check"></i><b>4.3.4</b> Continuous distributions</a></li>
<li class="chapter" data-level="4.3.5" data-path="mod-04.html"><a href="mod-04.html#distributions-summary"><i class="fa fa-check"></i><b>4.3.5</b> Distributions summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="mod-04.html"><a href="mod-04.html#mod-04-dists2"><i class="fa fa-check"></i><b>4.4</b> Fitting and testing distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="mod-04.html"><a href="mod-04.html#estimating-distributional-parameters"><i class="fa fa-check"></i><b>4.4.1</b> Estimating distributional parameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="mod-04.html"><a href="mod-04.html#graphical-methods-for-examining-distributions"><i class="fa fa-check"></i><b>4.4.2</b> Graphical methods for examining distributions</a></li>
<li class="chapter" data-level="4.4.3" data-path="mod-04.html"><a href="mod-04.html#formal-tests-for-distributions"><i class="fa fa-check"></i><b>4.4.3</b> Formal tests for distributions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="mod-04.html"><a href="mod-04.html#mod-04-trans"><i class="fa fa-check"></i><b>4.5</b> Data transformations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-04.html"><a href="mod-04.html#why-transform"><i class="fa fa-check"></i><b>4.5.1</b> Why transform?</a></li>
<li class="chapter" data-level="4.5.2" data-path="mod-04.html"><a href="mod-04.html#transforms-vs.-link-functions"><i class="fa fa-check"></i><b>4.5.2</b> Transforms vs. link functions</a></li>
<li class="chapter" data-level="4.5.3" data-path="mod-04.html"><a href="mod-04.html#log-transformation"><i class="fa fa-check"></i><b>4.5.3</b> Log transformation</a></li>
<li class="chapter" data-level="4.5.4" data-path="mod-04.html"><a href="mod-04.html#rank-transformation"><i class="fa fa-check"></i><b>4.5.4</b> Rank transformation</a></li>
<li class="chapter" data-level="4.5.5" data-path="mod-04.html"><a href="mod-04.html#other-transforms-less-common"><i class="fa fa-check"></i><b>4.5.5</b> Other transforms (less common)</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-04.html"><a href="mod-04.html#multivariate-data-exploration"><i class="fa fa-check"></i><b>4.6</b> Multivariate data exploration</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="mod-04.html"><a href="mod-04.html#scatterplots-for-two-variables"><i class="fa fa-check"></i><b>4.6.1</b> Scatterplots for two variables</a></li>
<li class="chapter" data-level="4.6.2" data-path="mod-04.html"><a href="mod-04.html#mod-04-smat"><i class="fa fa-check"></i><b>4.6.2</b> Scatterplot matrices for many variables</a></li>
<li class="chapter" data-level="4.6.3" data-path="mod-04.html"><a href="mod-04.html#lattice-plots-for-hierarchical-data"><i class="fa fa-check"></i><b>4.6.3</b> Lattice plots for hierarchical data</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="mod-04.html"><a href="mod-04.html#ordination-brief-introduction"><i class="fa fa-check"></i><b>4.7</b> Ordination (brief introduction)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="mod-04.html"><a href="mod-04.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>4.7.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="4.7.2" data-path="mod-04.html"><a href="mod-04.html#nonmetric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>4.7.2</b> Nonmetric multidimensional scaling (NMDS)</a></li>
<li class="chapter" data-level="4.7.3" data-path="mod-04.html"><a href="mod-04.html#plotting-ordinations"><i class="fa fa-check"></i><b>4.7.3</b> Plotting ordinations</a></li>
<li class="chapter" data-level="4.7.4" data-path="mod-04.html"><a href="mod-04.html#ordination-wrap-up-for-now"><i class="fa fa-check"></i><b>4.7.4</b> Ordination wrap-up (for now)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="mod-04.html"><a href="mod-04.html#mod-04-prob"><i class="fa fa-check"></i><b>4.8</b> Common statistical problems</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="mod-04.html"><a href="mod-04.html#outliers-and-erroneous-values"><i class="fa fa-check"></i><b>4.8.1</b> Outliers and erroneous values</a></li>
<li class="chapter" data-level="4.8.2" data-path="mod-04.html"><a href="mod-04.html#autocorrelation"><i class="fa fa-check"></i><b>4.8.2</b> Autocorrelation</a></li>
<li class="chapter" data-level="4.8.3" data-path="mod-04.html"><a href="mod-04.html#mod-04-multicol"><i class="fa fa-check"></i><b>4.8.3</b> Collinearity</a></li>
<li class="chapter" data-level="4.8.4" data-path="mod-04.html"><a href="mod-04.html#missing-data"><i class="fa fa-check"></i><b>4.8.4</b> Missing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-05.html"><a href="mod-05.html"><i class="fa fa-check"></i><b>5</b> Generalized linear models (GLM)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-05.html"><a href="mod-05.html#mod-05-lm"><i class="fa fa-check"></i><b>5.1</b> Prelude with linear models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mod-05.html"><a href="mod-05.html#assumptions-of-linear-models"><i class="fa fa-check"></i><b>5.1.1</b> Assumptions of linear models</a></li>
<li class="chapter" data-level="5.1.2" data-path="mod-05.html"><a href="mod-05.html#linear-regression-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Linear regression in R</a></li>
<li class="chapter" data-level="5.1.3" data-path="mod-05.html"><a href="mod-05.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="5.1.4" data-path="mod-05.html"><a href="mod-05.html#mod-05-anova"><i class="fa fa-check"></i><b>5.1.4</b> ANOVA and ANCOVA with <code>lm()</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="mod-05.html"><a href="mod-05.html#variations-on-linear-models"><i class="fa fa-check"></i><b>5.1.5</b> Variations on linear models</a></li>
<li class="chapter" data-level="5.1.6" data-path="mod-05.html"><a href="mod-05.html#example-linear-regression-workflow"><i class="fa fa-check"></i><b>5.1.6</b> Example linear regression workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mod-05.html"><a href="mod-05.html#mod-05-basic"><i class="fa fa-check"></i><b>5.2</b> GLM basics</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mod-05.html"><a href="mod-05.html#example-glms"><i class="fa fa-check"></i><b>5.2.1</b> Example GLMS</a></li>
<li class="chapter" data-level="5.2.2" data-path="mod-05.html"><a href="mod-05.html#glm-families"><i class="fa fa-check"></i><b>5.2.2</b> GLM families</a></li>
<li class="chapter" data-level="5.2.3" data-path="mod-05.html"><a href="mod-05.html#glm-link-functions"><i class="fa fa-check"></i><b>5.2.3</b> GLM link functions</a></li>
<li class="chapter" data-level="5.2.4" data-path="mod-05.html"><a href="mod-05.html#deviance-and-other-glm-diagnostics"><i class="fa fa-check"></i><b>5.2.4</b> Deviance and other GLM diagnostics</a></li>
<li class="chapter" data-level="5.2.5" data-path="mod-05.html"><a href="mod-05.html#to-pseudo-r2-or-not-to-pseudo-r2"><i class="fa fa-check"></i><b>5.2.5</b> To pseudo-<em>R</em><sup>2</sup> or not to pseudo-<em>R</em><sup>2</sup>?</a></li>
<li class="chapter" data-level="5.2.6" data-path="mod-05.html"><a href="mod-05.html#common-glms"><i class="fa fa-check"></i><b>5.2.6</b> Common GLMs</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mod-05.html"><a href="mod-05.html#mod-05-loglin"><i class="fa fa-check"></i><b>5.3</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="mod-05.html"><a href="mod-05.html#mod-05-loglin-examp"><i class="fa fa-check"></i><b>5.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.3.2" data-path="mod-05.html"><a href="mod-05.html#example-with-real-data"><i class="fa fa-check"></i><b>5.3.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="mod-05.html"><a href="mod-05.html#mod-05-poisson"><i class="fa fa-check"></i><b>5.4</b> Poisson GLM for counts</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="mod-05.html"><a href="mod-05.html#example-with-simulated-data"><i class="fa fa-check"></i><b>5.4.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.4.2" data-path="mod-05.html"><a href="mod-05.html#example-with-real-data-1"><i class="fa fa-check"></i><b>5.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="mod-05.html"><a href="mod-05.html#mod-05-quasi"><i class="fa fa-check"></i><b>5.5</b> Quasi-Poisson and negative binomial GLM</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-05.html"><a href="mod-05.html#example-with-simulated-data-1"><i class="fa fa-check"></i><b>5.5.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-05.html"><a href="mod-05.html#example-with-real-data-2"><i class="fa fa-check"></i><b>5.5.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-05.html"><a href="mod-05.html#mod-05-logistic"><i class="fa fa-check"></i><b>5.6</b> Logistic regression for binary outcomes</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-05.html"><a href="mod-05.html#example-with-simulated-data-2"><i class="fa fa-check"></i><b>5.6.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-05.html"><a href="mod-05.html#example-with-real-data-3"><i class="fa fa-check"></i><b>5.6.2</b> Example with real data</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-05.html"><a href="mod-05.html#mod-05-auc"><i class="fa fa-check"></i><b>5.6.3</b> Logistic GLM diagnostics: AUC and ROC</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-05.html"><a href="mod-05.html#mod-05-binom"><i class="fa fa-check"></i><b>5.7</b> Binomial GLM for proportional data</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mod-05.html"><a href="mod-05.html#binomial-glm"><i class="fa fa-check"></i><b>5.7.1</b> Binomial GLM</a></li>
<li class="chapter" data-level="5.7.2" data-path="mod-05.html"><a href="mod-05.html#example-with-simulated-data-3"><i class="fa fa-check"></i><b>5.7.2</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="mod-05.html"><a href="mod-05.html#mod-05-gamma"><i class="fa fa-check"></i><b>5.8</b> Gamma models for overdispersed data</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="mod-05.html"><a href="mod-05.html#example-with-simulated-data-4"><i class="fa fa-check"></i><b>5.8.1</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="mod-05.html"><a href="mod-05.html#mod-05-beyond"><i class="fa fa-check"></i><b>5.9</b> Beyond GLM: Overview of GAM and GEE</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="mod-05.html"><a href="mod-05.html#mod-05-gam"><i class="fa fa-check"></i><b>5.9.1</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="5.9.2" data-path="mod-05.html"><a href="mod-05.html#mod-05-gee"><i class="fa fa-check"></i><b>5.9.2</b> Generalized estimating equations (GEE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-06.html"><a href="mod-06.html"><i class="fa fa-check"></i><b>6</b> Nonlinear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-06.html"><a href="mod-06.html#background"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="mod-06.html"><a href="mod-06.html#mod-06-intro"><i class="fa fa-check"></i><b>6.2</b> Nonlinear least squares (NLS)</a></li>
<li class="chapter" data-level="6.3" data-path="mod-06.html"><a href="mod-06.html#mod-06-micmen"><i class="fa fa-check"></i><b>6.3</b> Michaelis-Menten curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="mod-06.html"><a href="mod-06.html#mod-06-micmen-sim"><i class="fa fa-check"></i><b>6.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="6.3.2" data-path="mod-06.html"><a href="mod-06.html#example-with-real-data-4"><i class="fa fa-check"></i><b>6.3.2</b> Example with real data</a></li>
<li class="chapter" data-level="6.3.3" data-path="mod-06.html"><a href="mod-06.html#alternative-strategies-for-the-analysis"><i class="fa fa-check"></i><b>6.3.3</b> Alternative strategies for the analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="mod-06.html"><a href="mod-06.html#mod-06-grow"><i class="fa fa-check"></i><b>6.4</b> Biological growth curves</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="mod-06.html"><a href="mod-06.html#gompertz-and-von-bertalanffy-curves"><i class="fa fa-check"></i><b>6.4.1</b> Gompertz and von Bertalanffy curves</a></li>
<li class="chapter" data-level="6.4.2" data-path="mod-06.html"><a href="mod-06.html#example-with-real-data-5"><i class="fa fa-check"></i><b>6.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mod-06.html"><a href="mod-06.html#dose-response-curves"><i class="fa fa-check"></i><b>6.5</b> Dose response curves</a></li>
<li class="chapter" data-level="6.6" data-path="mod-06.html"><a href="mod-06.html#alternatives-to-nls"><i class="fa fa-check"></i><b>6.6</b> Alternatives to NLS</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="mod-06.html"><a href="mod-06.html#generalized-nonlinear-models"><i class="fa fa-check"></i><b>6.6.1</b> Generalized nonlinear models</a></li>
<li class="chapter" data-level="6.6.2" data-path="mod-06.html"><a href="mod-06.html#quantile-regression"><i class="fa fa-check"></i><b>6.6.2</b> Quantile regression</a></li>
<li class="chapter" data-level="6.6.3" data-path="mod-06.html"><a href="mod-06.html#mod-06-gam"><i class="fa fa-check"></i><b>6.6.3</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="6.6.4" data-path="mod-06.html"><a href="mod-06.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>6.6.4</b> Classification and regression trees (CART)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mod-07.html"><a href="mod-07.html"><i class="fa fa-check"></i><b>7</b> Mixed models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-07.html"><a href="mod-07.html#prelude-glm"><i class="fa fa-check"></i><b>7.1</b> Prelude (GLM)</a></li>
<li class="chapter" data-level="7.2" data-path="mod-07.html"><a href="mod-07.html#mod-07-lmm"><i class="fa fa-check"></i><b>7.2</b> Linear mixed models (LMM)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-07.html"><a href="mod-07.html#formal-definition-and-example"><i class="fa fa-check"></i><b>7.2.1</b> Formal definition and example</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-07.html"><a href="mod-07.html#example-with-simulated-data-5"><i class="fa fa-check"></i><b>7.2.2</b> Example with simulated data</a></li>
<li class="chapter" data-level="7.2.3" data-path="mod-07.html"><a href="mod-07.html#p-values-in-lmm"><i class="fa fa-check"></i><b>7.2.3</b> <em>P</em>-values in LMM</a></li>
<li class="chapter" data-level="7.2.4" data-path="mod-07.html"><a href="mod-07.html#specifying-random-effects"><i class="fa fa-check"></i><b>7.2.4</b> Specifying random effects</a></li>
<li class="chapter" data-level="7.2.5" data-path="mod-07.html"><a href="mod-07.html#lmm-example-with-real-data"><i class="fa fa-check"></i><b>7.2.5</b> LMM example with real data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-07.html"><a href="mod-07.html#mod-07-glmm"><i class="fa fa-check"></i><b>7.3</b> Generalized linear mixed models (GLMM)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="mod-07.html"><a href="mod-07.html#definition-1"><i class="fa fa-check"></i><b>7.3.1</b> Definition</a></li>
<li class="chapter" data-level="7.3.2" data-path="mod-07.html"><a href="mod-07.html#glmm-on-simulated-data"><i class="fa fa-check"></i><b>7.3.2</b> GLMM on simulated data</a></li>
<li class="chapter" data-level="7.3.3" data-path="mod-07.html"><a href="mod-07.html#glmm-on-real-data"><i class="fa fa-check"></i><b>7.3.3</b> GLMM on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="mod-07.html"><a href="mod-07.html#mod-07-nlme"><i class="fa fa-check"></i><b>7.4</b> Nonlinear mixed models (NLME)</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mod-07.html"><a href="mod-07.html#definition-and-background"><i class="fa fa-check"></i><b>7.4.1</b> Definition and background</a></li>
<li class="chapter" data-level="7.4.2" data-path="mod-07.html"><a href="mod-07.html#nlme-on-simulated-data"><i class="fa fa-check"></i><b>7.4.2</b> NLME on simulated data</a></li>
<li class="chapter" data-level="7.4.3" data-path="mod-07.html"><a href="mod-07.html#nlme-on-real-data"><i class="fa fa-check"></i><b>7.4.3</b> NLME on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mod-07.html"><a href="mod-07.html#mod-07-gamm"><i class="fa fa-check"></i><b>7.5</b> (Generalized) additive mixed models (AMM/GAMM)</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="mod-07.html"><a href="mod-07.html#example-gamm-with-real-data"><i class="fa fa-check"></i><b>7.5.1</b> Example GAMM with real data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-08.html"><a href="mod-08.html"><i class="fa fa-check"></i><b>8</b> Multivariate data analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-08.html"><a href="mod-08.html#multivariate-data"><i class="fa fa-check"></i><b>8.1</b> Multivariate data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mod-08.html"><a href="mod-08.html#univariate-vs.-multivariate-data"><i class="fa fa-check"></i><b>8.1.1</b> Univariate vs. multivariate data</a></li>
<li class="chapter" data-level="8.1.2" data-path="mod-08.html"><a href="mod-08.html#components-of-multivariate-data"><i class="fa fa-check"></i><b>8.1.2</b> Components of multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mod-08.html"><a href="mod-08.html#mod-08-dist"><i class="fa fa-check"></i><b>8.2</b> Distance metrics: biological (dis)similarity</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mod-08.html"><a href="mod-08.html#euclidean-distance"><i class="fa fa-check"></i><b>8.2.1</b> Euclidean distance</a></li>
<li class="chapter" data-level="8.2.2" data-path="mod-08.html"><a href="mod-08.html#bray-curtis-and-other-distance-metrics"><i class="fa fa-check"></i><b>8.2.2</b> Bray-Curtis and other distance metrics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mod-08.html"><a href="mod-08.html#clustering"><i class="fa fa-check"></i><b>8.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mod-08.html"><a href="mod-08.html#k-means-clustering"><i class="fa fa-check"></i><b>8.3.1</b> <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="8.3.2" data-path="mod-08.html"><a href="mod-08.html#hierarchical-agglomerative-clustering"><i class="fa fa-check"></i><b>8.3.2</b> Hierarchical agglomerative clustering</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mod-08.html"><a href="mod-08.html#mod-08-sims"><i class="fa fa-check"></i><b>8.4</b> Analyzing dissimilarity</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="mod-08.html"><a href="mod-08.html#mantel-tests-distance-vs.-distance"><i class="fa fa-check"></i><b>8.4.1</b> Mantel tests: distance vs. distance</a></li>
<li class="chapter" data-level="8.4.2" data-path="mod-08.html"><a href="mod-08.html#comparing-dissimilarity-between-groups"><i class="fa fa-check"></i><b>8.4.2</b> Comparing dissimilarity between groups</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mod-08.html"><a href="mod-08.html#mod-08-ord"><i class="fa fa-check"></i><b>8.5</b> Ordination</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="mod-08.html"><a href="mod-08.html#principal-components-analysis-pca-1"><i class="fa fa-check"></i><b>8.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="8.5.2" data-path="mod-08.html"><a href="mod-08.html#nmds-and-other-ordination-methods"><i class="fa fa-check"></i><b>8.5.2</b> NMDS and other ordination methods</a></li>
<li class="chapter" data-level="8.5.3" data-path="mod-08.html"><a href="mod-08.html#other-ordination-techniques"><i class="fa fa-check"></i><b>8.5.3</b> Other ordination techniques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-09.html"><a href="mod-09.html"><i class="fa fa-check"></i><b>9</b> Planning your analysis (what test?)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-09.html"><a href="mod-09.html#how-to-use-this-guide"><i class="fa fa-check"></i><b>9.1</b> How to use this guide</a></li>
<li class="chapter" data-level="9.2" data-path="mod-09.html"><a href="mod-09.html#what-question-are-you-trying-to-answer"><i class="fa fa-check"></i><b>9.2</b> What question are you trying to answer?</a></li>
<li class="chapter" data-level="9.3" data-path="mod-09.html"><a href="mod-09.html#testing-for-a-difference-in-mean-or-location"><i class="fa fa-check"></i><b>9.3</b> Testing for a difference in mean or location</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mod-09.html"><a href="mod-09.html#additional-considerations"><i class="fa fa-check"></i><b>9.3.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mod-09.html"><a href="mod-09.html#testing-for-a-continuous-relationship-between-two-or-more-variables"><i class="fa fa-check"></i><b>9.4</b> Testing for a continuous relationship between two or more variables</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mod-09.html"><a href="mod-09.html#additional-considerations-1"><i class="fa fa-check"></i><b>9.4.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mod-09.html"><a href="mod-09.html#classifying-observations"><i class="fa fa-check"></i><b>9.5</b> Classifying observations</a></li>
<li class="chapter" data-level="9.6" data-path="mod-09.html"><a href="mod-09.html#conclusions"><i class="fa fa-check"></i><b>9.6</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literature-cited.html"><a href="literature-cited.html"><i class="fa fa-check"></i>Literature Cited</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-04" class="section level1" number="4">
<h1><span class="header-section-number">Module 4</span> Exploratory data analysis</h1>
<p>Sometimes you have to “pre-analyze” your data before you can really analyze it. This process of <strong>exploratory data analysis</strong> can be very informative and can reveal unexpected patterns (or problems) in your dataset. This module will demonstrate some common exploratory processes in R. Along the way we will explore how to summarize data, common data distributions and how to fit them to your data, and how to manage your data to avoid common statistical pitfalls.</p>
<p>One of the main questions that biologists have after collecting data is, “<em>What statistical test do I use?</em>” Ignoring the fact that they should have thought about that before collecting data, the answer to that question depends on the answers to two other questions:</p>
<ol style="list-style-type: decimal">
<li>What question are you trying to answer?</li>
<li>What kind of data do you have?</li>
</ol>
<p>Exploratory data analysis is the process of answering the second question. Common objectives in exploratory data analysis include:</p>
<ul>
<li>Describing the central tendency and variability of variables</li>
<li>Identifying potential outliers</li>
<li>Identifying how variables are distributed</li>
<li>Testing whether data meet the assumptions of statistical tests</li>
<li>Checking for common issues such as autocorrelation, collinearity, and missingness.</li>
<li>Searching for patterns in your data that may or may not be related to your main analysis.</li>
</ul>
<p>How much exploratory data analysis is needed varies from to project to project. At a minimum, you should be checking to see that your data meet the assumptions of your analysis. Failure to verify that your main analysis is justified can lead to huge problems down the line. <span class="citation">Zuur et al. (<a href="#ref-zuur2010" role="doc-biblioref">2010</a>)</span> reviewed a host of common data exploration methods and motivations; although aimed at ecologists, most biologists would benefit from reading their paper.</p>
<div id="descriptive-and-summary-statistics" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Descriptive and summary statistics</h2>
<div id="basic-summary-statistics" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Basic summary statistics</h3>
<p>One of the first steps in understanding your dataset is to summarize the values in each
variable. You can get a quick numerical summary of a vector or a dataset with <code>summary()</code>. The examples below use the built-in dataset <code>iris</code>.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="mod-04.html#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width          Species  
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100   setosa    :50  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300   versicolor:50  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300   virginica :50  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199                  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800                  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500</code></pre>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="mod-04.html#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris<span class="sc">$</span>Petal.Length)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   1.600   4.350   3.758   5.100   6.900</code></pre>
<p>Function <code>range()</code> reports the minimum and maximum values in a vector. Like many of the functions for descriptive statistics, this function does not handle missing (<code>NA</code>) values by default. The argument <code>na.rm=TRUE</code> must be set if there are missing values.</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="mod-04.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(iris<span class="sc">$</span>Petal.Length)</span></code></pre></div>
<pre><code>## [1] 1.0 6.9</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="mod-04.html#cb740-1" aria-hidden="true" tabindex="-1"></a><span class="co"># illustration of working with missing values</span></span>
<span id="cb740-2"><a href="mod-04.html#cb740-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>), <span class="cn">NA</span>)</span>
<span id="cb740-3"><a href="mod-04.html#cb740-3" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(x)</span></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="mod-04.html#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] -2.714130  1.077231</code></pre>
<p>Central tendency can be estimated as the <strong>mean</strong> or <strong>median</strong> using eponymous functions. The mean is what most people refer to as the “average” in everyday conversation: the sum of values divided by the number of values. The mean is the value that values would be if they were all the same.</p>
<p>The median is the central value. If the values are sorted from smallest to greatest, the median is the value in the middle. I.e., half of the values are less than the median, and half are greater. This is also referred to as the “50th percentile” because 50% of values are <span class="math inline">\(\le\)</span> the median.</p>
<p>For many datasets, the mean and median will be approximately the same. Data that are skewed will have a median different from their mean. Biologists typically summarize data using the mean, but median can be appropriate in some situations–especially when data are not normally distributed.</p>
<p>Like range, these functions for mean and median do not handle <code>NA</code> values unless you specify <code>na.rm=TRUE</code>.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="mod-04.html#cb744-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb744-2"><a href="mod-04.html#cb744-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(a)</span></code></pre></div>
<pre><code>## [1] 0.07336362</code></pre>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="mod-04.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(a)</span></code></pre></div>
<pre><code>## [1] 0.02716257</code></pre>
<p><strong>Variance</strong> and <strong>standard deviation (SD)</strong> are calculated by <code>var()</code> and <code>sd()</code>. There is no built-in function for <strong>standard error (SE)</strong> so it must be calculated using the sample size (function <code>length()</code>). Note that you should very rarely compute and report SE because SD is more appropriate in almost every situation that is likely to come up.</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="mod-04.html#cb748-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb748-2"><a href="mod-04.html#cb748-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.148712</code></pre>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="mod-04.html#cb750-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.07178</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="mod-04.html#cb752-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">var</span>(a)) <span class="co"># equivalent to sd(a)</span></span></code></pre></div>
<pre><code>## [1] 1.07178</code></pre>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="mod-04.html#cb754-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard error of the mean</span></span>
<span id="cb754-2"><a href="mod-04.html#cb754-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(a)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(a))</span></code></pre></div>
<pre><code>## [1] 0.1515725</code></pre>
<p><strong>Quantiles</strong> of data are calculated using the function <code>quantile()</code>. A quantile is a value in a distribution or sample such that some specified proportion of observations are less than or equal to that value. For example, the 0.5 quantile is the value such that half of values are less than or equal to that value. Quantiles are usually expressed either as proportions in [0, 1] or as percentiles in [0, 100]. R uses proportions, but you can always multiply by 100 to get percentiles.</p>
<p>Special quantiles are also available as their own functions: minimum <code>min()</code>, median <code>median()</code>, maximum <code>max()</code>, and interquartile range <code>IQR()</code>. Remember that argument <code>na.rm</code> is needed for many of these functions if there are missing values!</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="mod-04.html#cb756-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb756-2"><a href="mod-04.html#cb756-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 20th percentile (aka: 1st quintile)</span></span>
<span id="cb756-3"><a href="mod-04.html#cb756-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(a, <span class="at">probs=</span><span class="fl">0.2</span>) </span></code></pre></div>
<pre><code>##        20% 
## -0.4469422</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="mod-04.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 75th percentile (aka: 3rd quartile)</span></span>
<span id="cb758-2"><a href="mod-04.html#cb758-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(a, <span class="at">probs=</span><span class="fl">0.75</span>) </span></code></pre></div>
<pre><code>##       75% 
## 0.6407535</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="mod-04.html#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.5 and 97.5 percentiles</span></span>
<span id="cb760-2"><a href="mod-04.html#cb760-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e. 95% CI of a normal distribution)</span></span>
<span id="cb760-3"><a href="mod-04.html#cb760-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(a, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) </span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## -1.780417  1.493172</code></pre>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="mod-04.html#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="co"># minimum, or 0th percentile</span></span>
<span id="cb762-2"><a href="mod-04.html#cb762-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(a) </span></code></pre></div>
<pre><code>## [1] -2.178898</code></pre>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="mod-04.html#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maximum, or 100th percentile</span></span>
<span id="cb764-2"><a href="mod-04.html#cb764-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.7061</code></pre>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="mod-04.html#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interquartile range (75th – 25th percentile) </span></span>
<span id="cb766-2"><a href="mod-04.html#cb766-2" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(a) </span></code></pre></div>
<pre><code>## [1] 1.008555</code></pre>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="mod-04.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="co"># demonstration of na.rm</span></span>
<span id="cb768-2"><a href="mod-04.html#cb768-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(a, <span class="cn">NA</span>)</span>
<span id="cb768-3"><a href="mod-04.html#cb768-3" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(b)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="mod-04.html#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(b,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] -2.178898</code></pre>
</div>
<div id="summarizing-data-with-the-apply-family" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Summarizing data with the <code>apply()</code> family</h3>
<p>The <code>apply()</code> family is a group of functions that operate over the <strong>dimensions</strong> of an object. You can use the <code>apply()</code> family to summarize across rows or columns, or across elements of a list, and so on. The function used most often is <code>apply()</code>, which works on data frames, matrices and arrays. There are also <code>lapply()</code>, which works on lists and returns a list; <code>sapply()</code>, which operates on lists and returns the simplest object possible; and many others.</p>
<div id="apply-for-arrays-and-data-frames" class="section level4" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> <code>apply()</code> for arrays and data frames</h4>
<p>Function <code>apply()</code> works on arrays and data frames with <span class="math inline">\(\ge\)</span> 2 dimensions. Its arguments are the object to be operated on, the margin (or dimension) on which to operate, and the operation (or function). The first margin is rows, the second is columns, and so on. The result of <code>apply()</code> will always have one fewer dimension than the input.</p>
<p>Some typical <code>apply()</code> commands are demonstrated below:</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="mod-04.html#cb772-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test dataset with only numeric values</span></span>
<span id="cb772-2"><a href="mod-04.html#cb772-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb772-3"><a href="mod-04.html#cb772-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb772-4"><a href="mod-04.html#cb772-4" aria-hidden="true" tabindex="-1"></a><span class="co"># margin 1 = rows --&gt; row sums</span></span>
<span id="cb772-5"><a href="mod-04.html#cb772-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">1</span>, sum)</span></code></pre></div>
<pre><code>##   [1] 10.2  9.5  9.4  9.4 10.2 11.4  9.7 10.1  8.9  9.6 10.8 10.0  9.3  8.5 11.2 12.0 11.0 10.3 11.5 10.7 10.7 10.7  9.4 10.6 10.3  9.8 10.4 10.4 10.2
##  [30]  9.7  9.7 10.7 10.9 11.3  9.7  9.6 10.5 10.0  8.9 10.2 10.1  8.4  9.1 10.7 11.2  9.5 10.7  9.4 10.7  9.9 16.3 15.6 16.4 13.1 15.4 14.3 15.9 11.6
##  [59] 15.4 13.2 11.5 14.6 13.2 15.1 13.4 15.6 14.6 13.6 14.4 13.1 15.7 14.2 15.2 14.8 14.9 15.4 15.8 16.4 14.9 12.8 12.8 12.6 13.6 15.4 14.4 15.5 16.0
##  [88] 14.3 14.0 13.3 13.7 15.1 13.6 11.6 13.8 14.1 14.1 14.7 11.7 13.9 18.1 15.5 18.1 16.6 17.5 19.3 13.6 18.3 16.8 19.4 16.8 16.3 17.4 15.2 16.1 17.2
## [117] 16.8 20.4 19.5 14.7 18.1 15.3 19.2 15.7 17.8 18.2 15.6 15.8 16.9 17.6 18.2 20.1 17.0 15.7 15.7 19.1 17.7 16.8 15.6 17.5 17.8 17.4 15.5 18.2 18.2
## [146] 17.2 15.7 16.7 17.3 15.8</code></pre>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="mod-04.html#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="co"># margin 2 = columns --&gt; column sums</span></span>
<span id="cb774-2"><a href="mod-04.html#cb774-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, sum) <span class="co"># 2 = columns</span></span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##        876.5        458.6        563.7        179.9</code></pre>
<p>The first <code>apply()</code> command above calculates the sum of values in each row (margin <code>1</code>) of its input <code>x</code>. The second <code>apply()</code> command calculates the sum of values in each column (margin <code>2</code>). The results are vectors whose lengths are the same as the corresponding dimension of the input (number of rows or columns).</p>
<p>The first commmand above is equivalent to:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="mod-04.html#cb776-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(x))</span>
<span id="cb776-2"><a href="mod-04.html#cb776-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)){y[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x[i,])}</span>
<span id="cb776-3"><a href="mod-04.html#cb776-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb776-4"><a href="mod-04.html#cb776-4" aria-hidden="true" tabindex="-1"></a><span class="co"># verify that results are the same:</span></span>
<span id="cb776-5"><a href="mod-04.html#cb776-5" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, sum) <span class="sc">==</span> y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Below are some examples of calculations you can do with the <code>apply()</code> function. Notice that when the function to be applied takes its own arguments, those arguments are supplied following the function name, in the same order as they would be supplied to the function if used outside of <code>apply()</code>.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="mod-04.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="co"># column minima</span></span>
<span id="cb778-2"><a href="mod-04.html#cb778-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, min)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##          4.3          2.0          1.0          0.1</code></pre>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="mod-04.html#cb780-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 75th percentile of each column</span></span>
<span id="cb780-2"><a href="mod-04.html#cb780-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, quantile, <span class="fl">0.75</span>)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##          6.4          3.3          5.1          1.8</code></pre>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="mod-04.html#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interquartile range of each row</span></span>
<span id="cb782-2"><a href="mod-04.html#cb782-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">1</span>, IQR)</span></code></pre></div>
<pre><code>##   [1] 2.800 2.375 2.550 2.300 2.850 2.900 2.575 2.625 2.175 2.400 2.950 2.500 2.375 2.475 3.500 3.500 3.200 2.775 2.925 2.925 2.575 2.825 3.050 2.350
##  [25] 2.275 2.250 2.500 2.750 2.750 2.325 2.275 2.675 3.225 3.425 2.375 2.700 2.975 2.850 2.325 2.650 2.825 1.800 2.475 2.525 2.600 2.325 2.875 2.450
##  [49] 2.925 2.625 2.525 2.200 2.700 2.325 2.600 2.375 2.225 1.650 2.600 1.850 2.125 2.000 2.600 2.525 1.600 2.300 2.150 2.250 2.900 2.175 2.225 2.100
##  [73] 3.000 2.650 2.325 2.350 2.850 2.750 2.325 1.850 2.150 2.100 2.050 2.900 2.100 1.925 2.500 2.825 1.900 2.175 2.425 2.375 2.200 1.750 2.200 2.025
##  [97] 2.075 2.275 1.375 2.075 2.975 2.775 3.425 3.150 3.175 4.075 2.300 3.925 3.700 3.050 2.550 3.075 3.050 2.800 2.575 2.600 3.050 3.550 4.575 3.225
## [121] 3.025 2.475 4.350 2.775 2.950 3.450 2.600 2.500 3.175 3.500 3.850 3.425 3.150 2.925 3.425 3.675 2.625 2.950 2.400 2.925 2.950 2.650 2.775 3.150
## [145] 2.850 2.750 2.975 2.775 2.475 2.600</code></pre>
<p>Arrays with &gt;2 dimensions can have functions applied across multiple dimensions:</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="mod-04.html#cb784-1" aria-hidden="true" tabindex="-1"></a><span class="co"># object with 3 rows, 2 columns, and 3 &quot;layers&quot;:</span></span>
<span id="cb784-2"><a href="mod-04.html#cb784-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>, <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb784-3"><a href="mod-04.html#cb784-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb784-4"><a href="mod-04.html#cb784-4" aria-hidden="true" tabindex="-1"></a><span class="co"># how many dimensions does the result have?</span></span>
<span id="cb784-5"><a href="mod-04.html#cb784-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), sum)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   21   30
## [2,]   24   33
## [3,]   27   36</code></pre>
<p>You can also write custom functions and apply them to rows or columns. Below are some useful functions to apply. These functions can be defined inside <code>apply()</code> or outside <code>apply()</code>. Each of the functions below takes an input called <code>x</code>, but this is not as the <code>x</code> that is the input to <code>apply()</code>. The <code>x</code> in <code>function(x)</code> is used inside the braces <code>{}</code> as the name for the input passed from <code>apply()</code> to the inner function.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="mod-04.html#cb786-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb786-2"><a href="mod-04.html#cb786-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb786-3"><a href="mod-04.html#cb786-3" aria-hidden="true" tabindex="-1"></a><span class="co"># count values &gt; 2</span></span>
<span id="cb786-4"><a href="mod-04.html#cb786-4" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(x <span class="sc">&gt;</span> <span class="dv">2</span>))})</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##          150          149          100           23</code></pre>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="mod-04.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count missing (NA) values</span></span>
<span id="cb788-2"><a href="mod-04.html#cb788-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(x)))})</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##            0            0            0            0</code></pre>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="mod-04.html#cb790-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count non-missing values</span></span>
<span id="cb790-2"><a href="mod-04.html#cb790-2" aria-hidden="true" tabindex="-1"></a>count.nonmissing <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)))}</span>
<span id="cb790-3"><a href="mod-04.html#cb790-3" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, count.nonmissing)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##          150          150          150          150</code></pre>
</div>
<div id="lapply-and-sapply-for-lists-and-other-objects" class="section level4" number="4.1.2.2">
<h4><span class="header-section-number">4.1.2.2</span> <code>lapply()</code> and <code>sapply()</code> for lists and other objects</h4>
<p>The other members of the <code>apply()</code> family that are most often used are <code>lapply()</code> and <code>sapply()</code>.</p>
<ul>
<li><code>lapply()</code>, operates on lists and returns a <em>list</em>. Short for “list apply”, and usually pronounced “el apply” or “lap-lie”.</li>
<li><code>sapply()</code> operates on many object types (including lists) and returns the simplest object possible. Short for “simplify apply”, and usually pronounced “ess apply” or “sap-lie”. Usually the goal with <code>sapply()</code> is to get a vector or matrix out of a list.</li>
</ul>
<p>The code block below makes a list called <code>mylist</code> and illustrates the use of <code>lapply()</code> and <code>sapply()</code>.</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="mod-04.html#cb792-1" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dv">5</span>)</span>
<span id="cb792-2"><a href="mod-04.html#cb792-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mylist)){</span>
<span id="cb792-3"><a href="mod-04.html#cb792-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb792-4"><a href="mod-04.html#cb792-4" aria-hidden="true" tabindex="-1"></a>    mylist[[i]] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x)</span>
<span id="cb792-5"><a href="mod-04.html#cb792-5" aria-hidden="true" tabindex="-1"></a>}<span class="co">#i</span></span>
<span id="cb792-6"><a href="mod-04.html#cb792-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-7"><a href="mod-04.html#cb792-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimated mean of each element of mylist, in a list</span></span>
<span id="cb792-8"><a href="mod-04.html#cb792-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(mylist, <span class="cf">function</span>(x){x<span class="sc">$</span>estimate})</span></code></pre></div>
<pre><code>## [[1]]
##  mean of x 
## -0.2686405 
## 
## [[2]]
## mean of x 
## -0.203565 
## 
## [[3]]
##  mean of x 
## 0.09948298 
## 
## [[4]]
##   mean of x 
## -0.04637868 
## 
## [[5]]
## mean of x 
## 0.1247556</code></pre>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="mod-04.html#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimated mean of each element, simplified to vector</span></span>
<span id="cb794-2"><a href="mod-04.html#cb794-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(mylist, <span class="cf">function</span>(x){x<span class="sc">$</span>estimate})</span></code></pre></div>
<pre><code>##   mean of x   mean of x   mean of x   mean of x   mean of x 
## -0.26864053 -0.20356498  0.09948298 -0.04637868  0.12475562</code></pre>
<p>The function <code>lapply()</code> can sometimes be combined with <code>do.call()</code> to produce similar outputs as <code>sapply()</code>:</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="mod-04.html#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(c, <span class="fu">lapply</span>(mylist, <span class="cf">function</span>(x){x<span class="sc">$</span>estimate}))</span></code></pre></div>
<pre><code>##   mean of x   mean of x   mean of x   mean of x   mean of x 
## -0.26864053 -0.20356498  0.09948298 -0.04637868  0.12475562</code></pre>
</div>
</div>
<div id="mod-04-tabagg" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Tabulation and aggregation</h3>
<div id="tabulation-of-a-single-variable" class="section level4" number="4.1.3.1">
<h4><span class="header-section-number">4.1.3.1</span> Tabulation of a single variable</h4>
<p>The <code>table()</code> function tallies the occurrences of each unique value in a vector. Notice that <code>table()</code> only returns a result for the values that actually occur in the input.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="mod-04.html#cb798-1" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">50</span>,<span class="dv">10</span>)  <span class="co"># Random Poisson distribution</span></span>
<span id="cb798-2"><a href="mod-04.html#cb798-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(aa)</span></code></pre></div>
<pre><code>## aa
##  4  6  7  8  9 10 11 12 13 14 15 16 17 18 19 
##  1  1  5  4  5  5  8  7  6  1  3  1  1  1  1</code></pre>
<p>If you need a count that includes 0s for missing values, there are a few ways to do this. My preferred solution is to use the custom function below. This function counts how many times each value in <code>values</code> occurs in <code>input</code>.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="mod-04.html#cb800-1" aria-hidden="true" tabindex="-1"></a>table.all <span class="ot">&lt;-</span> <span class="cf">function</span>(input, values){</span>
<span id="cb800-2"><a href="mod-04.html#cb800-2" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">sapply</span>(values, </span>
<span id="cb800-3"><a href="mod-04.html#cb800-3" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(input <span class="sc">==</span> x))})</span>
<span id="cb800-4"><a href="mod-04.html#cb800-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(res) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(values)</span>
<span id="cb800-5"><a href="mod-04.html#cb800-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb800-6"><a href="mod-04.html#cb800-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb800-7"><a href="mod-04.html#cb800-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb800-8"><a href="mod-04.html#cb800-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use with random poisson values:</span></span>
<span id="cb800-9"><a href="mod-04.html#cb800-9" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="dv">10</span>)</span>
<span id="cb800-10"><a href="mod-04.html#cb800-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table.all</span>(x1, <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>)</span></code></pre></div>
<pre><code>##  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 
##  0  0  0  0  0  1  4  1  1  3  0  2  1  2  2  2  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0</code></pre>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="mod-04.html#cb802-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to:</span></span>
<span id="cb802-2"><a href="mod-04.html#cb802-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x1)</span></code></pre></div>
<pre><code>## x1
##  5  6  7  8  9 11 12 13 14 15 16 
##  1  4  1  1  3  2  1  2  2  2  1</code></pre>
<p>If you plot a <code>table()</code> result, you get a sort of bar graph. This is similar to what you get with a command like <code>plot(...,type = "h")</code><a href="literature-cited.html#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a>.</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="mod-04.html#cb804-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(aa))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-279-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="cross-tabulation-aka-frequency-tables" class="section level4" number="4.1.3.2">
<h4><span class="header-section-number">4.1.3.2</span> Cross-tabulation (aka: frequency tables)</h4>
<p><strong>Contingency tables</strong>, or <strong>frequency tables</strong> are calculated with <code>ftable()</code>. This function counts the number of values in each combination of different factors. The example below uses the built-in dataset <code>iris</code> modified to have some additional factors.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="mod-04.html#cb805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb805-2"><a href="mod-04.html#cb805-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb805-3"><a href="mod-04.html#cb805-3" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb805-4"><a href="mod-04.html#cb805-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>bloom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;early&quot;</span>, <span class="st">&quot;late&quot;</span>), <span class="fu">nrow</span>(x), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb805-5"><a href="mod-04.html#cb805-5" aria-hidden="true" tabindex="-1"></a>handed.table <span class="ot">&lt;-</span> <span class="fu">ftable</span>(x<span class="sc">$</span>color<span class="sc">~</span>x<span class="sc">$</span>bloom)</span>
<span id="cb805-6"><a href="mod-04.html#cb805-6" aria-hidden="true" tabindex="-1"></a>handed.table</span></code></pre></div>
<pre><code>##         x$color purple white
## x$bloom                     
## early               39    37
## late                36    38</code></pre>
<p>Contingency tables produced by <code>ftable()</code> can be used directly for chi-squared (<span class="math inline">\(\chi^2\)</span>) tests:</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="mod-04.html#cb807-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(handed.table)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  handed.table
## X-squared = 0.026671, df = 1, p-value = 0.8703</code></pre>
<p>The function <code>ftable()</code> also has a formula interface, much like many statistical functions (e.g., <code>lm()</code>). This is useful if you want more complicated tables or more combinations of categories. Notice that the order of variables affects the structure of the resulting table. The 6 commands below produce equivalent tables, but the results are organized differently.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="mod-04.html#cb809-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>Species<span class="sc">~</span>x<span class="sc">$</span>color<span class="sc">+</span>x<span class="sc">$</span>bloom)</span></code></pre></div>
<pre><code>##                 x$Species setosa versicolor virginica
## x$color x$bloom                                      
## purple  early                 17         13         9
##         late                   8         12        16
## white   early                 13         14        10
##         late                  12         11        15</code></pre>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="mod-04.html#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>Species<span class="sc">~</span>x<span class="sc">$</span>bloom<span class="sc">+</span>x<span class="sc">$</span>color)</span></code></pre></div>
<pre><code>##                 x$Species setosa versicolor virginica
## x$bloom x$color                                      
## early   purple                17         13         9
##         white                 13         14        10
## late    purple                 8         12        16
##         white                 12         11        15</code></pre>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="mod-04.html#cb813-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>color<span class="sc">~</span>x<span class="sc">$</span>Species<span class="sc">+</span>x<span class="sc">$</span>bloom)</span></code></pre></div>
<pre><code>##                    x$color purple white
## x$Species  x$bloom                     
## setosa     early               17    13
##            late                 8    12
## versicolor early               13    14
##            late                12    11
## virginica  early                9    10
##            late                16    15</code></pre>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="mod-04.html#cb815-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>color<span class="sc">~</span>x<span class="sc">$</span>bloom<span class="sc">+</span>x<span class="sc">$</span>Species)</span></code></pre></div>
<pre><code>##                    x$color purple white
## x$bloom x$Species                      
## early   setosa                 17    13
##         versicolor             13    14
##         virginica               9    10
## late    setosa                  8    12
##         versicolor             12    11
##         virginica              16    15</code></pre>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="mod-04.html#cb817-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>bloom<span class="sc">~</span>x<span class="sc">$</span>color<span class="sc">+</span>x<span class="sc">$</span>Species)</span></code></pre></div>
<pre><code>##                    x$bloom early late
## x$color x$Species                    
## purple  setosa                17    8
##         versicolor            13   12
##         virginica              9   16
## white   setosa                13   12
##         versicolor            14   11
##         virginica             10   15</code></pre>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="mod-04.html#cb819-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>bloom<span class="sc">~</span>x<span class="sc">$</span>Species<span class="sc">+</span>x<span class="sc">$</span>color)</span></code></pre></div>
<pre><code>##                    x$bloom early late
## x$Species  x$color                   
## setosa     purple             17    8
##            white              13   12
## versicolor purple             13   12
##            white              14   11
## virginica  purple              9   16
##            white              10   15</code></pre>
<p>Variables on the left side of the <code>~</code> will be on the top of the table, and variables on the right side of the <code>~</code> will be on the left side of the table<a href="literature-cited.html#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a>. On each side, variables are ordered in reverse order from the table matrix outwards. Compare the results of these commands:</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="mod-04.html#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>Species<span class="sc">~</span>x<span class="sc">$</span>color<span class="sc">+</span>x<span class="sc">$</span>bloom)</span></code></pre></div>
<pre><code>##                 x$Species setosa versicolor virginica
## x$color x$bloom                                      
## purple  early                 17         13         9
##         late                   8         12        16
## white   early                 13         14        10
##         late                  12         11        15</code></pre>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="mod-04.html#cb823-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(x<span class="sc">$</span>Species<span class="sc">~</span>x<span class="sc">$</span>bloom<span class="sc">+</span>x<span class="sc">$</span>color)</span></code></pre></div>
<pre><code>##                 x$Species setosa versicolor virginica
## x$bloom x$color                                      
## early   purple                17         13         9
##         white                 13         14        10
## late    purple                 8         12        16
##         white                 12         11        15</code></pre>
<p>The output of <code>ftable()</code> is of class <code>ftable</code>, which <em>looks</em> like a matrix or data frame but does not function like one. Sometimes it is necessary to convert an <code>ftable()</code> output to different class in order to pull values from it. This can be done with base R conversion functions. Notice that the data frame form of <code>handed.table</code> resembles the “long” data format we discussed in <a href="mod-03.html#mod-03-reshape">module 3</a>.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="mod-04.html#cb825-1" aria-hidden="true" tabindex="-1"></a>handed.table <span class="ot">&lt;-</span> <span class="fu">ftable</span>(x<span class="sc">$</span>Species<span class="sc">~</span>x<span class="sc">$</span>color)</span>
<span id="cb825-2"><a href="mod-04.html#cb825-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(handed.table)</span></code></pre></div>
<pre><code>##         x$Species
## x$color  setosa versicolor virginica
##   purple     25         25        25
##   white      25         25        25</code></pre>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="mod-04.html#cb827-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(handed.table)</span></code></pre></div>
<pre><code>##   x.color  x.Species Freq
## 1  purple     setosa   25
## 2   white     setosa   25
## 3  purple versicolor   25
## 4   white versicolor   25
## 5  purple  virginica   25
## 6   white  virginica   25</code></pre>
</div>
</div>
<div id="aggregation-aka-pivot-tables" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Aggregation (aka: pivot tables)</h3>
<p>One of the most common data operations is <strong>aggregation</strong>, or <strong>summarization by groups</strong>. In Excel, this is done using <strong>Pivot Tables</strong>. In R, the function <code>aggregate()</code> is used for pivot table-like functionality. But, as we shall see, the R <code>aggregate()</code> function is much more powerful than an Excel pivot table. The <code>tidyverse</code> equivalent is <code>dplyr::summarise()</code>.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_01.jpg" /></p>
<p>The most important inputs to <code>aggregate()</code> are the data to be summarized, the variable or variables that define the groups, and the function to summarize by. The examples below shows how to calculate the mean petal length for each species in the <code>iris</code> dataset. If the variable to be summarized and the grouping variables are in the same data frame (which is usually the case), you can use the formula interface to <code>aggregate()</code>; otherwise, use the <code>by=</code> interface.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="mod-04.html#cb829-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example using by=</span></span>
<span id="cb829-2"><a href="mod-04.html#cb829-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb829-3"><a href="mod-04.html#cb829-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">by=</span><span class="fu">list</span>(iris<span class="sc">$</span>Species),</span>
<span id="cb829-4"><a href="mod-04.html#cb829-4" aria-hidden="true" tabindex="-1"></a>          mean)</span></code></pre></div>
<pre><code>##      Group.1     x
## 1     setosa 1.462
## 2 versicolor 4.260
## 3  virginica 5.552</code></pre>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="mod-04.html#cb831-1" aria-hidden="true" tabindex="-1"></a><span class="co"># better method using formula</span></span>
<span id="cb831-2"><a href="mod-04.html#cb831-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb831-3"><a href="mod-04.html#cb831-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>iris,</span>
<span id="cb831-4"><a href="mod-04.html#cb831-4" aria-hidden="true" tabindex="-1"></a>          mean)</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa        1.462
## 2 versicolor        4.260
## 3  virginica        5.552</code></pre>
<p>The formula interface is cleaner and easier than the <code>by=</code> interface (first example), and has the key advantage that it automatically passes variable names to the result. If you use <code>by=</code> you may want to rename the columns in the result.</p>
<p>In my own code I prefer to name my aggregation tables <code>agg</code>, with additional parts like <code>agg1</code>, <code>agg.fish</code>, and so on if needed. Function <code>aggregate()</code> produces a data frame with a column for each grouping variable (<code>Group.1</code>, <code>Group.2</code> and so on) and a single column <code>x</code> containing the summarized values. We can use this property to construct more complicated tables:</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="mod-04.html#cb833-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb833-2"><a href="mod-04.html#cb833-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add another grouping variable</span></span>
<span id="cb833-3"><a href="mod-04.html#cb833-3" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb833-4"><a href="mod-04.html#cb833-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-5"><a href="mod-04.html#cb833-5" aria-hidden="true" tabindex="-1"></a><span class="co"># by= example: notice how columns in result need to be renamed</span></span>
<span id="cb833-6"><a href="mod-04.html#cb833-6" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(x<span class="sc">$</span>Petal.Length,</span>
<span id="cb833-7"><a href="mod-04.html#cb833-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">by=</span><span class="fu">list</span>(x<span class="sc">$</span>Species, x<span class="sc">$</span>color),</span>
<span id="cb833-8"><a href="mod-04.html#cb833-8" aria-hidden="true" tabindex="-1"></a>                 mean)</span>
<span id="cb833-9"><a href="mod-04.html#cb833-9" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Group.1 Group.2     x
## 1     setosa     red 1.456
## 2 versicolor     red 4.308
## 3  virginica     red 5.564
## 4     setosa   white 1.468
## 5 versicolor   white 4.212
## 6  virginica   white 5.540</code></pre>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="mod-04.html#cb835-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change column names</span></span>
<span id="cb835-2"><a href="mod-04.html#cb835-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;spp&quot;</span>, <span class="st">&quot;color&quot;</span>, <span class="st">&quot;mean&quot;</span>)</span>
<span id="cb835-3"><a href="mod-04.html#cb835-3" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##          spp color  mean
## 1     setosa   red 1.456
## 2 versicolor   red 4.308
## 3  virginica   red 5.564
## 4     setosa white 1.468
## 5 versicolor white 4.212
## 6  virginica white 5.540</code></pre>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="mod-04.html#cb837-1" aria-hidden="true" tabindex="-1"></a><span class="co"># formula example: much easier</span></span>
<span id="cb837-2"><a href="mod-04.html#cb837-2" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species<span class="sc">+</span>color, <span class="at">data=</span>x, mean)</span>
<span id="cb837-3"><a href="mod-04.html#cb837-3" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Species color Petal.Length
## 1     setosa   red        1.456
## 2 versicolor   red        4.308
## 3  virginica   red        5.564
## 4     setosa white        1.468
## 5 versicolor white        4.212
## 6  virginica white        5.540</code></pre>
<p>Notice that in <code>agg</code> the values are sorted by the grouping variables from right to left: in this example, by <code>color</code>, then <code>Species</code>. This is the reverse of the order in the original command. The result of <code>aggregate()</code> is a data frame, so data within it can be rearranged using <code>order()</code>.</p>
<p>Often we want to summarize a variable by multiple functions–for example, to get a table with the mean and SD in each group. The way to do this is to use several <code>aggregate()</code> commands, and then combine the results. The examples below shows two ways to construct a table with the mean and SD of a variable.</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="mod-04.html#cb839-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a formula and save some typing:</span></span>
<span id="cb839-2"><a href="mod-04.html#cb839-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">formula</span>(Petal.Length<span class="sc">~</span>Species)</span>
<span id="cb839-3"><a href="mod-04.html#cb839-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb839-4"><a href="mod-04.html#cb839-4" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: single table</span></span>
<span id="cb839-5"><a href="mod-04.html#cb839-5" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, mean)</span>
<span id="cb839-6"><a href="mod-04.html#cb839-6" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, sd)<span class="sc">$</span>Petal.Length</span>
<span id="cb839-7"><a href="mod-04.html#cb839-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="fu">which</span>(<span class="fu">names</span>(agg) <span class="sc">==</span> <span class="st">&quot;Petal.Length&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;mn&quot;</span></span>
<span id="cb839-8"><a href="mod-04.html#cb839-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb839-9"><a href="mod-04.html#cb839-9" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Species    mn        sd
## 1     setosa 1.462 0.1736640
## 2 versicolor 4.260 0.4699110
## 3  virginica 5.552 0.5518947</code></pre>
<p>The <code>$Petal.Length</code> on the end of <code>aggregate()</code> is important because we want only column <code>Petal.Length</code> of the output. Without <code>$Petal.Length</code>, the result will be messy when we try to add it to <code>agg</code>. If you ever want to do this with the <code>by=</code> method, the column of the output containing the summarized values will be named <code>x</code>.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="mod-04.html#cb841-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: single table, with by=</span></span>
<span id="cb841-2"><a href="mod-04.html#cb841-2" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(iris<span class="sc">$</span>Petal.Length, <span class="at">by=</span><span class="fu">list</span>(iris<span class="sc">$</span>Species), mean)</span>
<span id="cb841-3"><a href="mod-04.html#cb841-3" aria-hidden="true" tabindex="-1"></a><span class="do">## note use of $x:</span></span>
<span id="cb841-4"><a href="mod-04.html#cb841-4" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(iris<span class="sc">$</span>Petal.Length, <span class="at">by=</span><span class="fu">list</span>(iris<span class="sc">$</span>Species), sd)<span class="sc">$</span>x</span>
<span id="cb841-5"><a href="mod-04.html#cb841-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-6"><a href="mod-04.html#cb841-6" aria-hidden="true" tabindex="-1"></a><span class="co"># change names in result:</span></span>
<span id="cb841-7"><a href="mod-04.html#cb841-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="fu">which</span>(<span class="fu">names</span>(agg) <span class="sc">==</span> <span class="st">&quot;x&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;mn&quot;</span></span>
<span id="cb841-8"><a href="mod-04.html#cb841-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="fu">which</span>(<span class="fu">names</span>(agg) <span class="sc">==</span> <span class="st">&quot;Group.1&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;species&quot;</span></span>
<span id="cb841-9"><a href="mod-04.html#cb841-9" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      species    mn        sd
## 1     setosa 1.462 0.1736640
## 2 versicolor 4.260 0.4699110
## 3  virginica 5.552 0.5518947</code></pre>
<p>The second approach is to make several <code>aggregate()</code> tables, and combine them into a single result.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="mod-04.html#cb843-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: multiple tables</span></span>
<span id="cb843-2"><a href="mod-04.html#cb843-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           (note: there are lots of ways to do this)</span></span>
<span id="cb843-3"><a href="mod-04.html#cb843-3" aria-hidden="true" tabindex="-1"></a>agg.mn <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, mean)</span>
<span id="cb843-4"><a href="mod-04.html#cb843-4" aria-hidden="true" tabindex="-1"></a>agg.sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, sd)</span>
<span id="cb843-5"><a href="mod-04.html#cb843-5" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(agg.mn, <span class="at">sd=</span>agg.sd<span class="sc">$</span>Petal.Length)</span>
<span id="cb843-6"><a href="mod-04.html#cb843-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;mn&quot;</span></span>
<span id="cb843-7"><a href="mod-04.html#cb843-7" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Species    mn        sd
## 1     setosa 1.462 0.1736640
## 2 versicolor 4.260 0.4699110
## 3  virginica 5.552 0.5518947</code></pre>
<p>If you’ve ever used Excel Pivot Tables, you will have noticed that data can only be summarized by a limited set of functions. On the other hand, <code>aggregate()</code> can be used with pretty much any function that takes in a vector and returns a scalar. You can even write your own functions! Below are some examples. Notice in the first example that arguments to the summarizing function follow its name.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="mod-04.html#cb845-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first quartile (25th percentile)</span></span>
<span id="cb845-2"><a href="mod-04.html#cb845-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species, <span class="at">data=</span>x, quantile, <span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa          1.4
## 2 versicolor          4.0
## 3  virginica          5.1</code></pre>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="mod-04.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of values</span></span>
<span id="cb847-2"><a href="mod-04.html#cb847-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species, <span class="at">data=</span>x, length)</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa           50
## 2 versicolor           50
## 3  virginica           50</code></pre>
<p>The following examples illustrate <strong>anonymous functions</strong>: functions defined within another function and never defined in the R environment. The <code>x</code> in <code>function(x)</code> is taken to be the values within each group defined by the variable(s) on the right-hand side of <code>~</code> or in <code>by=</code>. Notice that the end of such a command will need a lot of <code>)</code>, <code>}</code>, and sometimes <code>]</code>. Using an editor with syntax highlighting is very helpful!</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="mod-04.html#cb849-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of missing values</span></span>
<span id="cb849-2"><a href="mod-04.html#cb849-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb849-3"><a href="mod-04.html#cb849-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>x,</span>
<span id="cb849-4"><a href="mod-04.html#cb849-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(x)))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa            0
## 2 versicolor            0
## 3  virginica            0</code></pre>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="mod-04.html#cb851-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of non-missing values</span></span>
<span id="cb851-2"><a href="mod-04.html#cb851-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species, </span>
<span id="cb851-3"><a href="mod-04.html#cb851-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>x,</span>
<span id="cb851-4"><a href="mod-04.html#cb851-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa           50
## 2 versicolor           50
## 3  virginica           50</code></pre>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="mod-04.html#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of values &gt;= 2</span></span>
<span id="cb853-2"><a href="mod-04.html#cb853-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb853-3"><a href="mod-04.html#cb853-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>x,</span>
<span id="cb853-4"><a href="mod-04.html#cb853-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(x <span class="sc">&gt;=</span> <span class="dv">2</span>))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa            0
## 2 versicolor           50
## 3  virginica           50</code></pre>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="mod-04.html#cb855-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of UNIQUE values &gt;= 2</span></span>
<span id="cb855-2"><a href="mod-04.html#cb855-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb855-3"><a href="mod-04.html#cb855-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>x,</span>
<span id="cb855-4"><a href="mod-04.html#cb855-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">unique</span>(x[<span class="fu">which</span>(x <span class="sc">&gt;=</span> <span class="dv">2</span>)]))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa            0
## 2 versicolor           19
## 3  virginica           20</code></pre>
<p>Being able to use almost any function, and to define your own functions, makes <code>aggregate()</code> an immensely powerful tool to have in your R toolbox.</p>
</div>
</div>
<div id="mod-04-vis" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Visualizing data distributions</h2>
<p><strong>Probability distributions</strong> are mathematical functions that describe the way that values vary randomly. This is a key idea in statistics and data analysis. We usually consider data to be essentially random, but with the values forming predictable patterns over many observations. The nature of those patterns is what probability distributions attempt to model. A probability distribution does not tell us the value of any particular observation, but it does let us estimate the likelihood of observing any particular value. The figure below demonstrates some common probability distributions: the heights of the bars reflect the likelihood of the values on the <em>x</em>-axes occuring under those distributions.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-292-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Successful data analysis requires paying attention to and thinking deeply about the way that your data are distributed. Different kinds of biological processes, like counts, waiting times, measurements, etc., have randomness that is described by different probability distributions. The assumption that values follow certain distributions is baked into most statistical methods. Trying to use a method that assumes an inappropriate distribution will probably lead to invalid results. For example, if you try to analyze count data as if they came from a continuous, unbounded distribution, your statistical model could predict nonsensical outcomes such as negative or non-integer counts. The figure below shows this:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-293-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Sometimes it is not always obvious what distribution your data should follow. Some cases are relatively straight forward: counts should follow a Poisson or negative binomial distribution. Other cases are less straightforward: should expression data be considered normally, log-normally, or some other-ly distributed? Usually there is a clear <em>a priori</em> answer to this question that can be obtained by thinking about what kind of process gave rise to the numbers.</p>
<p>A related question to “what distribution does my data follow?” is “do my data follow this distribution?” Even if you have some expectation of how your data should be distributed, that is no guarantee that your study system cooperated. You should always check to see if your data follow the distribution you assumed, and the distribution assumed by your statistical test. Deciding what distribution your data follow is always somewhat subjective, and real datasets often contain some departure from expectations. In this section we will explore some graphical techniques and heuristics for determining how data are distributed.</p>
<p>Knowing about <a href="mod-04.html#mod-04-dists1">data distributions</a> is a one thing, but <a href="mod-04.html#mod-04-dists2">figuring out which distribution best fits your data</a> is quite another. Like much of the data analysis workflow, picking a distribution can be as much an art as it is a science. This is because distributions of real data are often messy, or do not conform exactly to any one distribution, or may conform partly to several! Sometimes the answer to “what distribution should I use to analyze this data?” is not clear-cut. The figure below gives a (very) rough guide to starting to identify a response distribution. Note that this is only a guide for where to look first, and not a definitive guide to selecting a response distribution. Even if your choices lead you to, say, the normal distribution, you must still verify that your data conform (at least roughly) to that distribution. Note also that this diagram does not include every distribution out there, but rather a select set of commonly encountered distributions in biology.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/05_05.jpg" /></p>
<div id="boxplots-aka-box-and-whisker-plots" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Boxplots (aka: box-and-whisker plots)</h3>
<p><strong>Boxplots</strong>, or <strong>box-and-whisker plots</strong>, summarize the distribution of continuous variables. They are often used to summarize data by a factor, making it easier to see how the distribution of a variable differs between groups. The boxplot shows extreme values (whiskers), the first and third quartiles, and the median.</p>
<p>Boxplot of a single variable:</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="mod-04.html#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Petal.Width)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-294-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Boxplot with some options for a nicer plot:</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="mod-04.html#cb858-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Petal.Width,</span>
<span id="cb858-2"><a href="mod-04.html#cb858-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal width (cm)&quot;</span>,</span>
<span id="cb858-3"><a href="mod-04.html#cb858-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-295-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Boxplot across levels of a factor (note formula interface):</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="mod-04.html#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Petal.Width<span class="sc">~</span>iris<span class="sc">$</span>Species,</span>
<span id="cb859-2"><a href="mod-04.html#cb859-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Species&quot;</span>,</span>
<span id="cb859-3"><a href="mod-04.html#cb859-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal.Width (cm)&quot;</span>,</span>
<span id="cb859-4"><a href="mod-04.html#cb859-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-296-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>A highly asymmetric box-and-whisker plot can indicate that data are skewed or non-normal.
The base <code>boxplot()</code> function can produce summaries across multiple variables. Essentially it treats each combination of grouping variables as a separate set of values. There are better ways to plot group differences (e.g., for publication), but the base <code>boxplot()</code> does just fine for data exploration.</p>
<p>Boxplots can be constructed using several grouping variables. The order of grouping variables in the formula will determine the order of boxes in the plot.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="mod-04.html#cb860-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb860-2"><a href="mod-04.html#cb860-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>) <span class="co">#made up variable</span></span>
<span id="cb860-3"><a href="mod-04.html#cb860-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-4"><a href="mod-04.html#cb860-4" aria-hidden="true" tabindex="-1"></a><span class="co"># group by species and color:</span></span>
<span id="cb860-5"><a href="mod-04.html#cb860-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Width<span class="sc">~</span>Species<span class="sc">+</span>color, <span class="at">data=</span>x,</span>
<span id="cb860-6"><a href="mod-04.html#cb860-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal width (cm)&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-297-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="mod-04.html#cb861-1" aria-hidden="true" tabindex="-1"></a><span class="co"># notice difference in order of grouping:</span></span>
<span id="cb861-2"><a href="mod-04.html#cb861-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Width<span class="sc">~</span>color<span class="sc">+</span>Species, <span class="at">data=</span>x,</span>
<span id="cb861-3"><a href="mod-04.html#cb861-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal width (cm)&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-297-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="histograms" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Histograms</h3>
<p><strong>Histograms</strong> show how values of a distribution are spread across different intervals. These intervals are sometimes called <strong>cells</strong> or <strong>bins</strong>. A good histogram will show, approximately, the shape of a <strong>probability density function (PDF)</strong> or the <strong>probability mass function (PMF)</strong>. The base function <code>hist()</code> will automatically select intervals that look nice, but you can specify the intervals with argument <code>breaks</code>.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="mod-04.html#cb862-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb862-2"><a href="mod-04.html#cb862-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb862-3"><a href="mod-04.html#cb862-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb862-4"><a href="mod-04.html#cb862-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb862-5"><a href="mod-04.html#cb862-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">by=</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-298-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="mod-04.html#cb863-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset</span></span>
<span id="cb863-2"><a href="mod-04.html#cb863-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>The <em>area</em> of each bar is also proportional to the number of values in each interval.</p>
<p>R histograms can be presented as counts (<code>freq=TRUE</code>, the default), or as probability density (<code>freq=FALSE</code>). We’ll talk more about probability density later in the <a href="mod-04.html#mod-04-dists1">next section</a>.</p>
<p>Compare these results:</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="mod-04.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb864-2"><a href="mod-04.html#cb864-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb864-3"><a href="mod-04.html#cb864-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">freq=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-299-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="mod-04.html#cb865-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset</span></span>
<span id="cb865-2"><a href="mod-04.html#cb865-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Because the second histogram shows probability densities, the areas under the bars sum to 1 (this is part of the definition of a PDF).</p>
<p>A histogram can provide a visual first clue as to the shape of a distribution’s PDF or PMF. For example, the histograms of <code>x1</code> and <code>x2</code> below suggest very different distributions:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-300-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Notice that <code>x1</code> appears roughly normal. It is symmetric, has a bell-shape, and is concentrated near its center. Contrast this with <code>x2</code>. Distribution <code>x2</code> is strongly right-skewed (i.e., lots of small values with a long positive tail), with most values near 0. It also has no negative values (<code>range(x2)</code>). Because of these properties we might suspect that <code>x2</code> is really a log-normal distribution. We can check this by making a histogram of the log of <code>x2</code>:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-301-1.png" width="480" style="display: block; margin: auto;" />
Other distributions might be tricky. Consider the histograms below:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-302-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>What a mess! Histogram <code>x3</code> shows what is commonly referred to as a <strong>bimodal</strong> distribution. This is a distribution with two <strong>modes</strong>, or most common values, with a gap between them. Bimodal distributions often arise from a <strong>mixture</strong> of two distributions (in this case, two normals). Or, they can indicate that something in the data generating process leads to diverging outcomes. For example, in many college courses the grade distribution can be bimodal, with most students making either a B or D.</p>
<p>Histogram <code>x4</code> shows a distribution with some right skew, but not the long, tapering tail characteristic of the lognormal distribution (see <code>x2</code>, above). The fact that the mean is near 5 and not 0 is another point against a lognormal. But the clincher is that there are negative values, which a lognormal distribution cannot take (think about why this is). Think for a few minutes about what distribution <code>x4</code> might be, then click the footnote to find out<a href="literature-cited.html#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a>.</p>
</div>
<div id="kernel-density-plots" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Kernel density plots</h3>
<p>Kernel density plots are a way to empirically estimate the <strong>probability distribution function (PDF)</strong> of a distribution. A plot of the estimated PDF is essentially a smoothed histogram (technically, it is the heights of a histogram as the bin width approaches 0).</p>
<p>The PDF tells us two things. Practically speaking, the PDF of a distribution at a given value is related to how likely that value is to occur relative to other values. However, that is NOT a probability of that value occurring. What the PDF really expresses is the <em>rate of change in cumulative density at a value</em>. In other words, the PDF is the slope or first derivative of the CDF. Conversely, the CDF is the integral of the PDF. The PDF is the rate at which the probability of observing a value <span class="math inline">\(\le\)</span> <em>x</em> increases at each <em>x</em>. Again, this is related to but not the same as the probability of that value occurring.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_02.jpg" /></p>
<p>The kernel density plot is to the PDF what the ECDF is to the CDF. Just like an ECDF plot presents an estimate of the true CDF, the kernel density plot presents an estimate of the true PDF. This means that presenting a kernel density plot or an ECDF plot is largely a matter of preference because they convey the same information in different ways.</p>
<p>Note that a kernel density plot makes more sense for a continuous distribution than for a discrete distribution. The equivalent plot for a discrete distribution is the <strong>probability mass function (PMF)</strong> plot. The PMF of a discrete distribution is 0 for any non-integer value. The example below shows kernel density plots for four distributions: Normal(mean=5, SD=2), Gamma(k=3, <span class="math inline">\(\theta\)</span>=2), Uniform(min=0, max=1), and Poisson(<span class="math inline">\(\lambda\)</span>=4). The first 3 are continuous distributions and the last is a discrete distribution.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="mod-04.html#cb866-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb866-2"><a href="mod-04.html#cb866-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb866-3"><a href="mod-04.html#cb866-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb866-4"><a href="mod-04.html#cb866-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rnorm</span>(n,<span class="dv">5</span>,<span class="dv">2</span>)))</span>
<span id="cb866-5"><a href="mod-04.html#cb866-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rgamma</span>(n, <span class="dv">3</span>, <span class="dv">2</span>)))</span>
<span id="cb866-6"><a href="mod-04.html#cb866-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb866-7"><a href="mod-04.html#cb866-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rpois</span>(n,<span class="dv">4</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-303-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The estimated density functions aren’t too far off from the real functions. But, notice that the plots for the gamma, uniform, and Poisson variables extend outside of the domains of the underlying distributions. For example, the density for the Poisson variable extends below 0. You can truncate the plot using arguments <code>from</code> or <code>to</code> for density. This is a good idea if you are exploring data that you suspect have a natural domain. For example, lengths and times must be non-negative, so you should include <code>from=0</code> in the <code>density()</code> command.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="mod-04.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb867-2"><a href="mod-04.html#cb867-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rnorm</span>(n,<span class="dv">5</span>,<span class="dv">2</span>)))</span>
<span id="cb867-3"><a href="mod-04.html#cb867-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rgamma</span>(n, <span class="dv">3</span>, <span class="dv">2</span>), <span class="at">from=</span><span class="dv">0</span>))</span>
<span id="cb867-4"><a href="mod-04.html#cb867-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">runif</span>(n), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>))</span>
<span id="cb867-5"><a href="mod-04.html#cb867-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rpois</span>(n,<span class="dv">4</span>), <span class="at">from=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-304-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The estimated density functions are now in their supported intervals, which is nice. There’s one more issue with the estimates for the Poisson distribution. Notice that the bottom right plot shows non-zero probability density for non-integer values. This doesn’t make sense for a Poisson distribution, which can only take non-negative integer values. What’s going on here is that the <code>density()</code> function does not know whether a distribution is supposed to be discrete or continuous. As far as the function is concerned, the distribution is continuous and just happens to have no non-integer values.</p>
<p>If you have data that you have good reason to suspect are discrete, there is a better way than <code>density()</code> to visualize the relative likelihood of different values: the probability mass function (PMF, not PDF). The PMF of a discrete distribution can be calculated rather than estimated. In the example below we use the <code>table()</code> function, which tallies up the number of times each value occurs in a vector. We could convert the cell counts to PMF estimates by dividing by the number of observations (e.g., <code>plot(table(x1)/n))</code>.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="mod-04.html#cb868-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make some data</span></span>
<span id="cb868-2"><a href="mod-04.html#cb868-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb868-3"><a href="mod-04.html#cb868-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb868-4"><a href="mod-04.html#cb868-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">4</span>)</span>
<span id="cb868-5"><a href="mod-04.html#cb868-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">20</span>, <span class="fl">0.4</span>)</span>
<span id="cb868-6"><a href="mod-04.html#cb868-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rgeom</span>(n, <span class="fl">0.3</span>)</span>
<span id="cb868-7"><a href="mod-04.html#cb868-7" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(n, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb868-8"><a href="mod-04.html#cb868-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-9"><a href="mod-04.html#cb868-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot cell counts:</span></span>
<span id="cb868-10"><a href="mod-04.html#cb868-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb868-11"><a href="mod-04.html#cb868-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x1))</span>
<span id="cb868-12"><a href="mod-04.html#cb868-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x2))</span>
<span id="cb868-13"><a href="mod-04.html#cb868-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x3))</span>
<span id="cb868-14"><a href="mod-04.html#cb868-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x4))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-305-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Dividing the cell counts by the number of total observations (n) estimates the empirical PMF:</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="mod-04.html#cb869-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb869-2"><a href="mod-04.html#cb869-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x1)<span class="sc">/</span>n)</span>
<span id="cb869-3"><a href="mod-04.html#cb869-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x2)<span class="sc">/</span>n)</span>
<span id="cb869-4"><a href="mod-04.html#cb869-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x3)<span class="sc">/</span>n)</span>
<span id="cb869-5"><a href="mod-04.html#cb869-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x4)<span class="sc">/</span>n)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-306-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>We can verify that the empirical PMFs that we calculated match the actual PMFs:</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="mod-04.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to true PMF:</span></span>
<span id="cb870-2"><a href="mod-04.html#cb870-2" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x1)</span>
<span id="cb870-3"><a href="mod-04.html#cb870-3" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x2)</span>
<span id="cb870-4"><a href="mod-04.html#cb870-4" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x3)</span>
<span id="cb870-5"><a href="mod-04.html#cb870-5" aria-hidden="true" tabindex="-1"></a>v4 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x4)</span>
<span id="cb870-6"><a href="mod-04.html#cb870-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(v1, <span class="dv">4</span>)</span>
<span id="cb870-7"><a href="mod-04.html#cb870-7" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(v2, <span class="dv">20</span>, <span class="fl">0.4</span>)</span>
<span id="cb870-8"><a href="mod-04.html#cb870-8" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dgeom</span>(v3, <span class="fl">0.3</span>)</span>
<span id="cb870-9"><a href="mod-04.html#cb870-9" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(v4, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb870-10"><a href="mod-04.html#cb870-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-11"><a href="mod-04.html#cb870-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb870-12"><a href="mod-04.html#cb870-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x1)<span class="sc">/</span>n)</span>
<span id="cb870-13"><a href="mod-04.html#cb870-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb870-14"><a href="mod-04.html#cb870-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x2)<span class="sc">/</span>n)</span>
<span id="cb870-15"><a href="mod-04.html#cb870-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v2, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb870-16"><a href="mod-04.html#cb870-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x3)<span class="sc">/</span>n)</span>
<span id="cb870-17"><a href="mod-04.html#cb870-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v3, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb870-18"><a href="mod-04.html#cb870-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x4)<span class="sc">/</span>n)</span>
<span id="cb870-19"><a href="mod-04.html#cb870-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v4, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-307-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="empirical-cumulative-distribution-plots-ecdf" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Empirical cumulative distribution plots (ECDF)</h3>
<p>The <strong>cumulative distribution function (CDF)</strong> is the probability that a random variable will take on a value less than or equal to some value. Formally, we say that a continuous distribution <em>X</em> will take on value <span class="math inline">\(\le\)</span> <em>x</em> with probability <span class="math inline">\(F(x)\)</span>. The CDF is <span class="math inline">\(F(x)\)</span>.The figure below shows what this means.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_03.jpg" /></p>
<p>The figure shows the CDF of a normal distribution with mean = 0 and SD = 1 (i.e., the standard normal distribution. Like all CDFs, <span class="math inline">\(F(x)\)</span> increases monotonically (never decreasing) from 0 to 1 as <em>x</em> increases from the lower bound to the upper bound of the distribution. In the case of the normal distribution, the bounds of <em>x</em> are [-<span class="math inline">\(\infty\)</span>, +<span class="math inline">\(\infty\)</span>]. The CDF approaches 0 as <em>x</em> decreases, and approaches 1 as <em>x</em> increases. The red dashed lines show how to interpret the relationship between the axes. For any value on the <em>x</em>-axis, the <em>y</em>-axis shows what proportion of values are <span class="math inline">\(\le\)</span> <em>x</em>. For any value on the <em>y</em>-axis, the <em>x</em>-axis shows the value at the <em>y</em>-th quantile of the distribution.</p>
<p>The CDF is in a very real sense the <em>definition</em> of a probability distribution. Every probability distribution can be identified by a unique CDF. It doesn’t matter whether a distribution is continuous, discrete, or a mixture of both. The figure below shows what the CDFs of a discrete or mixed distribution look like compared to that of a continuous distribution<a href="literature-cited.html#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a>.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_04.jpg" /></p>
<p>The examples below calculate and plot ECDF plots for a uniform (left) and a normal distribution (right).</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="mod-04.html#cb871-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb871-2"><a href="mod-04.html#cb871-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb871-3"><a href="mod-04.html#cb871-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb871-4"><a href="mod-04.html#cb871-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">7</span>, <span class="dv">4</span>)</span>
<span id="cb871-5"><a href="mod-04.html#cb871-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb871-6"><a href="mod-04.html#cb871-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x1))</span>
<span id="cb871-7"><a href="mod-04.html#cb871-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x2))</span>
<span id="cb871-8"><a href="mod-04.html#cb871-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add lines at 20th percentile:</span></span>
<span id="cb871-9"><a href="mod-04.html#cb871-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb871-10"><a href="mod-04.html#cb871-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">quantile</span>(x2, <span class="fl">0.2</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-308-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The <em>y</em>-axis of an ECDF plot shows the calculated quantile of the distribution (e.g., 0.4 quantile = 40th percentile <span class="math inline">\(\equiv\)</span> 40% of <em>x</em> are <span class="math inline">\(\le F(x)\)</span>). The <em>x</em>-axis shows the values of the distribution. In the left plot, we see that the slope of the ECDF plot is roughly constant. This suggests a uniform distribution. The plot on the right shows the S-shaped ECDF typical of a bell-shaped curve, so we might suspect a normal distribution. The red lines on the right plot illustrate that about 20% of values are <span class="math inline">\(\le\)</span> 3.6.</p>
<p>ECDF plots can be calculated for discrete distributions as well—they just look like step functions. Step-like ECDF plots can also appear when a continuous distribution has many more observations than unique values.</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="mod-04.html#cb872-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb872-2"><a href="mod-04.html#cb872-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb872-3"><a href="mod-04.html#cb872-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">3</span>)   <span class="co"># Poisson </span></span>
<span id="cb872-4"><a href="mod-04.html#cb872-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rgeom</span>(n, <span class="fl">0.3</span>) <span class="co"># geometric </span></span>
<span id="cb872-5"><a href="mod-04.html#cb872-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb872-6"><a href="mod-04.html#cb872-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x1))</span>
<span id="cb872-7"><a href="mod-04.html#cb872-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x2))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-309-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Recall that every result in R is an object. The output of the function <code>ecdf()</code> is actually another function that calculates the estimated CDF for a new value. This can be very handy if you want to interpolate the ECDF to make a smoother curve.</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="mod-04.html#cb873-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">ecdf</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;ecdf&quot;     &quot;stepfun&quot;  &quot;function&quot;</code></pre>
<p>Here is how to use it. The example below can be useful if you need to calculate the ECDF for values that are not in the original dataset, but within its domain. In the example below, the ECDF is estimated for x = 30, which is not in the original data <code>x</code>. Notice what happens for values in <code>x1</code> that are greater than <code>max(x)</code> and less than <code>min(x)</code>.</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="mod-04.html#cb875-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb875-2"><a href="mod-04.html#cb875-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e2</span>, <span class="dv">20</span>, <span class="dv">5</span>)</span>
<span id="cb875-3"><a href="mod-04.html#cb875-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x) <span class="co"># define function for CDF(x)</span></span>
<span id="cb875-4"><a href="mod-04.html#cb875-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>  <span class="co"># define new x values at which to calculate CDF</span></span>
<span id="cb875-5"><a href="mod-04.html#cb875-5" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">e1</span>(x1) <span class="co"># calculate CDF at each new x</span></span>
<span id="cb875-6"><a href="mod-04.html#cb875-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-7"><a href="mod-04.html#cb875-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb875-8"><a href="mod-04.html#cb875-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-311-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Obviously, the more data points you have, the better and smoother the estimate of the ECDF will be. Consider the simulated example below that estimates the ECDF using different numbers of points.</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="mod-04.html#cb876-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb876-2"><a href="mod-04.html#cb876-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb876-3"><a href="mod-04.html#cb876-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb876-4"><a href="mod-04.html#cb876-4" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb876-5"><a href="mod-04.html#cb876-5" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sig)</span>
<span id="cb876-6"><a href="mod-04.html#cb876-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x4[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)]</span>
<span id="cb876-7"><a href="mod-04.html#cb876-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> x4[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)]</span>
<span id="cb876-8"><a href="mod-04.html#cb876-8" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> x4[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">1000</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)]</span>
<span id="cb876-9"><a href="mod-04.html#cb876-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb876-10"><a href="mod-04.html#cb876-10" aria-hidden="true" tabindex="-1"></a>xseq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb876-11"><a href="mod-04.html#cb876-11" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x1)(xseq)</span>
<span id="cb876-12"><a href="mod-04.html#cb876-12" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x2)(xseq)</span>
<span id="cb876-13"><a href="mod-04.html#cb876-13" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x3)(xseq)</span>
<span id="cb876-14"><a href="mod-04.html#cb876-14" aria-hidden="true" tabindex="-1"></a>yt <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xseq, mu, sig)</span>
<span id="cb876-15"><a href="mod-04.html#cb876-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb876-16"><a href="mod-04.html#cb876-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xseq, yt, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">6</span>, <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb876-17"><a href="mod-04.html#cb876-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;(E)CDF = F(x)&quot;</span>)</span>
<span id="cb876-18"><a href="mod-04.html#cb876-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xseq, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb876-19"><a href="mod-04.html#cb876-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xseq, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue2&quot;</span>)</span>
<span id="cb876-20"><a href="mod-04.html#cb876-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xseq, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb876-21"><a href="mod-04.html#cb876-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb876-22"><a href="mod-04.html#cb876-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">expression</span>(n<span class="sc">==</span><span class="dv">10</span>), <span class="fu">expression</span>(n<span class="sc">==</span><span class="dv">100</span>), </span>
<span id="cb876-23"><a href="mod-04.html#cb876-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">expression</span>(n<span class="sc">==</span><span class="dv">1000</span>), <span class="st">&quot;True CDF&quot;</span>),</span>
<span id="cb876-24"><a href="mod-04.html#cb876-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb876-25"><a href="mod-04.html#cb876-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue2&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb876-26"><a href="mod-04.html#cb876-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-312-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The estimate with 10 points (red) is a very rough fit, but serviceable. The estimates using 100 or 1000 points are much closer to the truth (black line).</p>
</div>
<div id="quantile-quantile-qq-plots" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Quantile-quantile (QQ) plots</h3>
<p>A <strong>quantile-quantile plot</strong>, or <strong>QQ plot</strong>, is a method for visualizing whether two sets of values come from the same distribution. This is done by plotting the quantiles of one data set against the quantiles of another data set. If the two sets come from the same distribution, then the points should fall along a straight line. QQ plots are usually used to test whether data come from a normal distribution, but could be used with any distribution. The key advantage of QQ plots is that the reference line is straight, and deviations from it are easy to see. Contrast this with the reference line in an ECDF plot, whose shape varies by distribution.</p>
<p>QQ plots are generated by function <code>qqplot()</code> or <code>qqnorm()</code>. The latter function is a shortcut for a QQ plot comparing the data to a normal distribution. The function <code>qqline()</code> is used to add a reference line. Typical use of <code>qqnorm()</code> and <code>qqline()</code> is shown below.</p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="mod-04.html#cb877-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb877-2"><a href="mod-04.html#cb877-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb877-3"><a href="mod-04.html#cb877-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">50</span>, <span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb877-4"><a href="mod-04.html#cb877-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb877-5"><a href="mod-04.html#cb877-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb877-6"><a href="mod-04.html#cb877-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(a)</span>
<span id="cb877-7"><a href="mod-04.html#cb877-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(a, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb877-8"><a href="mod-04.html#cb877-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(b)</span>
<span id="cb877-9"><a href="mod-04.html#cb877-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(b, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-313-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The left panel above shows that distribution a likely follows a normal distribution because the points fall mostly on the reference line. The right panel, however, shows that distribution <code>b</code> likely does not follow a normal distribution. This can be seen because many of the points do not fall on the line. The arch-shaped pattern indicates that the distribution differs from the normal mainly on the tails.</p>
<p>QQ plots can be made to compare your data to any arbitrary distribution. If your target distribution has default parameters in R (e.g., mean = 0 and SD = 1 for the normal distribution), then the method is simple:</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="mod-04.html#cb878-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">50</span>, <span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb878-2"><a href="mod-04.html#cb878-2" aria-hidden="true" tabindex="-1"></a>qqs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span></span>
<span id="cb878-3"><a href="mod-04.html#cb878-3" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(qqs)</span>
<span id="cb878-4"><a href="mod-04.html#cb878-4" aria-hidden="true" tabindex="-1"></a>qy <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, qqs)</span>
<span id="cb878-5"><a href="mod-04.html#cb878-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb878-6"><a href="mod-04.html#cb878-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb878-7"><a href="mod-04.html#cb878-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qx, qy)</span>
<span id="cb878-8"><a href="mod-04.html#cb878-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(qy<span class="sc">~</span>qx), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-314-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>If the target distribution does not have default parameters, or if you don’t want to use the default parameters, you can still make a QQ plot. The example below shows two methods for comparing a suspected gamma distribution to a reference gamma distribution using QQ plots. The parameters of the reference gamma distribution are estimated using the function <code>fitdistr()</code> from package <code>MASS</code>.</p>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="mod-04.html#cb879-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb879-2"><a href="mod-04.html#cb879-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb879-3"><a href="mod-04.html#cb879-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb879-4"><a href="mod-04.html#cb879-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">100</span>, <span class="dv">4</span>, <span class="fl">0.2</span>)</span>
<span id="cb879-5"><a href="mod-04.html#cb879-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb879-6"><a href="mod-04.html#cb879-6" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb879-7"><a href="mod-04.html#cb879-7" aria-hidden="true" tabindex="-1"></a>qqs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span></span>
<span id="cb879-8"><a href="mod-04.html#cb879-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb879-9"><a href="mod-04.html#cb879-9" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: calculate QQ plot manually</span></span>
<span id="cb879-10"><a href="mod-04.html#cb879-10" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">qgamma</span>(qqs, <span class="at">shape=</span>fd<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>fd<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb879-11"><a href="mod-04.html#cb879-11" aria-hidden="true" tabindex="-1"></a>qy <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, qqs)</span>
<span id="cb879-12"><a href="mod-04.html#cb879-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb879-13"><a href="mod-04.html#cb879-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qx, qy)</span>
<span id="cb879-14"><a href="mod-04.html#cb879-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(qy<span class="sc">~</span>qx), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-315-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is an alternative strategy using <code>qqplot()</code>:</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="mod-04.html#cb880-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: use qqplot() </span></span>
<span id="cb880-2"><a href="mod-04.html#cb880-2" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles of reference distribution</span></span>
<span id="cb880-3"><a href="mod-04.html#cb880-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb880-4"><a href="mod-04.html#cb880-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function to draw from reference distribution</span></span>
<span id="cb880-5"><a href="mod-04.html#cb880-5" aria-hidden="true" tabindex="-1"></a>dfun <span class="ot">&lt;-</span> <span class="cf">function</span>(p){</span>
<span id="cb880-6"><a href="mod-04.html#cb880-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qgamma</span>(qqs, <span class="at">shape=</span>fd<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>fd<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb880-7"><a href="mod-04.html#cb880-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb880-8"><a href="mod-04.html#cb880-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb880-9"><a href="mod-04.html#cb880-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get values at each reference quantile</span></span>
<span id="cb880-10"><a href="mod-04.html#cb880-10" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">dfun</span>(qqs)</span>
<span id="cb880-11"><a href="mod-04.html#cb880-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb880-12"><a href="mod-04.html#cb880-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb880-13"><a href="mod-04.html#cb880-13" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qx, x)</span>
<span id="cb880-14"><a href="mod-04.html#cb880-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(qy<span class="sc">~</span>qx), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-316-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is another example with the negative binomial distribution:</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="mod-04.html#cb881-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb881-2"><a href="mod-04.html#cb881-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb881-3"><a href="mod-04.html#cb881-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb881-4"><a href="mod-04.html#cb881-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(n, <span class="at">mu=</span><span class="dv">5</span>, <span class="at">size=</span><span class="dv">10</span>)</span>
<span id="cb881-5"><a href="mod-04.html#cb881-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb881-6"><a href="mod-04.html#cb881-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get parameters of distribution</span></span>
<span id="cb881-7"><a href="mod-04.html#cb881-7" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(a, <span class="st">&quot;negative binomial&quot;</span>)</span>
<span id="cb881-8"><a href="mod-04.html#cb881-8" aria-hidden="true" tabindex="-1"></a>fd</span></code></pre></div>
<pre><code>##       size           mu     
##   118.3001950     5.2000006 
##  (394.2399860) (  0.3295018)</code></pre>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="mod-04.html#cb883-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles of reference distribution</span></span>
<span id="cb883-2"><a href="mod-04.html#cb883-2" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(n)</span>
<span id="cb883-3"><a href="mod-04.html#cb883-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-4"><a href="mod-04.html#cb883-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function to draw from reference distribution</span></span>
<span id="cb883-5"><a href="mod-04.html#cb883-5" aria-hidden="true" tabindex="-1"></a>dfun <span class="ot">&lt;-</span> <span class="cf">function</span>(p){</span>
<span id="cb883-6"><a href="mod-04.html#cb883-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">qnbinom</span>(p, </span>
<span id="cb883-7"><a href="mod-04.html#cb883-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size=</span>fd<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb883-8"><a href="mod-04.html#cb883-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mu=</span>fd<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb883-9"><a href="mod-04.html#cb883-9" aria-hidden="true" tabindex="-1"></a>                    }<span class="co">#function</span></span>
<span id="cb883-10"><a href="mod-04.html#cb883-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-11"><a href="mod-04.html#cb883-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get values at each reference quantile</span></span>
<span id="cb883-12"><a href="mod-04.html#cb883-12" aria-hidden="true" tabindex="-1"></a>qy <span class="ot">&lt;-</span> <span class="fu">dfun</span>(qx)</span>
<span id="cb883-13"><a href="mod-04.html#cb883-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-14"><a href="mod-04.html#cb883-14" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb883-15"><a href="mod-04.html#cb883-15" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qy, a)</span>
<span id="cb883-16"><a href="mod-04.html#cb883-16" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(a, <span class="at">distribution=</span>dfun, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-317-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="how-should-i-plot-my-data" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> How should I plot my data?</h3>
<p>Plotting and examining the distribution of your data is always a good idea. How you plot the distributions is largely up to you. As mentioned above, histograms, ECDF plots, and kernel density plots convey the same information. The information is just presented in different ways. Some people prefer one kind of distribution plot over the others. You should use whichever plot best helps you understand the distribution. Or, use whichever plot your supervisor tells you to use. Consider the figure below, which plots a normal distribution with mean = 20 and SD = 5 in four different ways.</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="mod-04.html#cb884-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>, <span class="dv">20</span>, <span class="dv">5</span>)</span>
<span id="cb884-2"><a href="mod-04.html#cb884-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb884-3"><a href="mod-04.html#cb884-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb884-4"><a href="mod-04.html#cb884-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, </span>
<span id="cb884-5"><a href="mod-04.html#cb884-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.3</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.main=</span><span class="fl">1.3</span>)</span>
<span id="cb884-6"><a href="mod-04.html#cb884-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb884-7"><a href="mod-04.html#cb884-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">main=</span><span class="st">&quot;Kernel density plot&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb884-8"><a href="mod-04.html#cb884-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x), <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb884-9"><a href="mod-04.html#cb884-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span>
<span id="cb884-10"><a href="mod-04.html#cb884-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-318-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Which way is the correct way to plot the data? It depends:</p>
<ul>
<li>If your goal is to show how the data are spread out, use a histogram or kernel density plot.</li>
<li>If your goal is to explore quantiles of the distribution, use an ECDF plot.</li>
<li>If your goal is to compare to a specific distribution, use a QQ plot or an ECDF (with the reference distribution’s CDF superimposed).</li>
</ul>
<p>Methods for visualizing data distributions can be highly field-specific. Usually a histogram, ECDF, or both, will be enough to get a sense of how a variable is distributed. The goal of this visualization is usually to determine what probability distribution is most appropriate for a variable. As we will see in the <a href="mod-04.html#mod-04-dists1">next section</a>, that can be as much a biological decision as a statistical one.</p>
</div>
</div>
<div id="mod-04-dists1" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Statistical distributions</h2>
<p>All data contain some element of randomness. Understanding the nature and consequences of that randomness is what motivates much of modern statistics. <strong>Probability distributions</strong> are the mathematical constructs that describe randomness in statistics. This page describes some probability distributions commonly encountered in biology (and a few that aren’t common). The emphasis here is on practical understanding of what a the distributions imply about data–not on the theoretical underpinnings or mathematical details. If you want or need a rigorous introduction to probability theory, this is probably not the right place.</p>
<div id="probability-distributions" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Probability distributions</h3>
<p>All data contain some element of randomness. Understanding the nature and consequences of that randomness is what motivates much of modern statistics. Consider the figures below:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-319-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Both scatterplots show a linear relationship between <em>X</em> and <em>Y</em>. But what is different about the plot on the right? Variation. Both plots show the same relationship (<span class="math inline">\(Y=22+1.4X\)</span>), but they differ in that the variation about the expected value (the red line) is much greater in the right plot than the left plot. Consequently, <em>X</em> appears to explain much more variation in <em>Y</em> in the left plot than in the right plot. The next figure shows that the <strong>residual variation</strong>, or difference between the expected and observed values, is much greater in the right panel. Each of these differences between the observed value of <em>Y</em> (<span class="math inline">\(Y_i\)</span>) and the expected value of <em>Y</em> (<span class="math inline">\(E(Y_i)\)</span>), or <span class="math inline">\(Y_i-E(Y_i)\)</span>, is called a <strong>residual</strong>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-320-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Residuals are an important part of statistical analysis for two reasons. First, most statistical models make assumptions about the distribution of residuals. Second, the total magnitude of the residuals (usually expressed as sum of squared residuals) is useful for calculating many measures of how well a model fits the data. The residuals of a statistical model are the differences between the observed values and the values predicted by the model. The residual for observation <em>i</em> in variable <em>Y</em>, <span class="math inline">\(R_i\)</span>, is calculated as:</p>
<p><span class="math display">\[R_i=Y_i-E\left[Y_i\right]\]</span></p>
<p>where <span class="math inline">\(E(Y_i)\)</span> is the <strong>expected value</strong> of <span class="math inline">\(Y_i\)</span>. This means that when an observation has a greater value than predicted, the residual is positive; similarly, when an observation is smaller than expected, the residual is negative. In many statistical methods, residuals are squared so that (1) positive and negative residuals do not cancel out; and (2) larger residuals carry more weight.</p>
<p>The figures below show the distributions of residuals for the example linear regressions above. Notice that the left dataset has a much smaller distribution of residuals than the right dataset. This is because of the much tighter fit of the left dataset’s Y values to the predicted curve.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-321-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Notice also that both distributions of residuals have a similar shape, despite the difference in width. This shape is actually very important: the <strong>normal distribution</strong>. If the residuals were not distributed this way (i.e., did not follow a normal distribution), then we would be in trouble for two reasons. First, the data were generated using a normal distribution for residuals, so something would have had to have gone wrong with our statistical test; and second, the linear regression model used to analyze the data assumes that residuals are normally distributed. If they are not, then the test is not going to produce valid estimates of statistical significance or model parameters.</p>
<p>The example above is an example of the importance of thinking about statistical distributions when analyzing data. So just what is a statistical distribution? Distributions are mathematical functions that define the probabilities of random outcomes. Here <strong>random</strong> means that there is some element of chance in what we observe. This randomness is not completely unpredictable. While the outcome of specific observations might be unknowable, we can make predictions about long run frequencies or averages of lots of observations. In other words, single observations are not predictable, but the properties of sets of observations are. Such properties might include the number of times a specific outcome occurs (e.g., number of times a flipped coin comes up heads) or some summary of observations (e.g., the mean tail length of chipmunks). Another term for this kind of randomness that follows a pattern is <strong>stochastic</strong>.</p>
<p><strong>Another example: coin flips</strong></p>
<p>Consider flipping a coin. A fair coin will come up “heads” 50% of the time, and “tails” the other 50%. If you flip a coin once, the probability of getting heads is 50%. But what about if you flip the coin 10 times? How many heads should you get? 5 is a reasonable guess. The table below shows the possible outcomes to 10 coin flips:</p>
<table>
<thead>
<tr class="header">
<th align="center">Heads</th>
<th align="center">Tails</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">7</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">6</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">8</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">9</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">10</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>This table shows that 5 heads is only one of 11 possibilities! So, is the probability of 5 heads 1 in 11 (<span class="math inline">\(\approx\)</span> 0.091)? Of course not, because not all outcomes are equally likely.</p>
<p>One of the reasons statistics is so fun is that we can often use simulation to discover patterns. The R code below will simulate the effects of flipping 1 coin 10 times. Run this code a few times and see what happens.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="mod-04.html#cb885-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>A typical run of results might be something like <code>4 5 5 4 3 5 6 6 5 5 4 6</code>. We can repeat this line many times and graph the results:</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="mod-04.html#cb887-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">20</span>)</span>
<span id="cb887-2"><a href="mod-04.html#cb887-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)}</span>
<span id="cb887-3"><a href="mod-04.html#cb887-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-323-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>There is actually a faster way, by requesting 20 draws of 10 flips each all at once:</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="mod-04.html#cb888-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">20</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)</span>
<span id="cb888-2"><a href="mod-04.html#cb888-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-324-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Is 5 the most likely value? What about if we get a larger sample?</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="mod-04.html#cb889-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb889-2"><a href="mod-04.html#cb889-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">100</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb889-3"><a href="mod-04.html#cb889-3" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">1000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb889-4"><a href="mod-04.html#cb889-4" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">10000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb889-5"><a href="mod-04.html#cb889-5" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">100000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb889-6"><a href="mod-04.html#cb889-6" aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">1000000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb889-7"><a href="mod-04.html#cb889-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb889-8"><a href="mod-04.html#cb889-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb889-9"><a href="mod-04.html#cb889-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 10&quot;</span>)</span>
<span id="cb889-10"><a href="mod-04.html#cb889-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 100&quot;</span>)</span>
<span id="cb889-11"><a href="mod-04.html#cb889-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x3, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 1000&quot;</span>)</span>
<span id="cb889-12"><a href="mod-04.html#cb889-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x4, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 10000&quot;</span>)</span>
<span id="cb889-13"><a href="mod-04.html#cb889-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x5, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 100000&quot;</span>)</span>
<span id="cb889-14"><a href="mod-04.html#cb889-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x6, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 1000000&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-325-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="mod-04.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset graphical parameters</span></span>
<span id="cb890-2"><a href="mod-04.html#cb890-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>You may have guessed by now that the properties of a set of coin flips—such as what number of heads to expect—are described by some kind of mathematical idea. This idea is called a statistical distribution. This particular distribution is the <strong>binomial distribution</strong>, which describes the outcome of any random process with a binary outcome. The name “binomial” is descriptive: “bi” for two, and “nomial” for names or states. Can you think of a biological situation where the binomial distribution might apply?</p>
<p>The sections below describe some distributions commonly encountered in biology, and what kinds of processes give rise to them. It is important to be able to relate biological phenomena to statistical distributions, because the underlying nature of the randomness in some process can affect how we analyze that process statistically. Note that in this class we will focus on the practical applications of these distributions, rather than their mathematical derivations.</p>
</div>
<div id="probability-distributions-in-r" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Probability distributions in R</h3>
<p>Every distribution supported in R has four functions associated with it: <code>r__()</code>, <code>q__()</code>, <code>d__()</code>, and <code>p__()</code> , where <code>__</code> is the name of the distribution (or an abbreviation thereof). These 4 functions calculate different values defined by the distribution:</p>
<ul>
<li><code>r__()</code> draws <strong>random numbers</strong> from the distribution.</li>
<li><code>p__()</code> calculates the <strong>cumulative distribution function (CDF)</strong> at a given value. The reverse of <code>q__()</code>.</li>
<li><code>d__()</code> calculates the <strong>probability density function (PDF)</strong>; i.e., the height of the density curve, or first derivative of the CDF.</li>
<li><code>q__()</code> calculates the <strong>value at a given quantile</strong>. The reverse of <code>p__()</code>.</li>
</ul>
<p>The figure below shows these functions in relation to the PDF and CDF for a normal distribution.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-326-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="discrete-distributions" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Discrete distributions</h3>
<p><strong>Discrete distributions</strong> can take on integer values only. Because of this, many discrete distributions are related in some way to <strong>count data</strong>. Count data result from, well, counting things. Count data can also describe the number of times something happened.</p>
<div id="bernoulli-distribution" class="section level4" number="4.3.3.1">
<h4><span class="header-section-number">4.3.3.1</span> Bernoulli distribution</h4>
<p>The simplest discrete distribution is the <strong>Bernoulli distribution</strong>. It describes the outcome of a single random event with probability <em>p</em>. Thus, the Bernoulli distribution takes the value 1 with probability <em>p</em> or the value 0 with probability <span class="math inline">\(q=(1-p)\)</span>. Any opportunity for the event to happen is also called a <strong>Bernoulli trial</strong>, and the process that it describes a <strong>Bernoulli process</strong>. The probability <em>p</em> can take on any value in the interval [0, 1].</p>
<p>For convenience we usually consider a Bernoulli distribution to take the value of 0 or 1, but really it could represent any binary outcome. For example, <em>yes vs. no</em>, <em>dead vs. alive</em>, <em>&lt; 3 vs. <span class="math inline">\(\ge\)</span> 3</em>, etc., are all outcomes that could be modeled as Bernoulli variables. By convention, the event that occurs with probability <em>p</em> is considered a <strong>success</strong> and has the numerical value 1; the even that occurs with probability 1-<em>p</em> is considered a <strong>failure</strong> and takes the numerical value 0. This is how Bernoulli variables are represented in most statistical packages, including R.</p>
<p>The Bernoulli distribution is rarely used on its own in an analysis<a href="literature-cited.html#fn34" class="footnote-ref" id="fnref34"><sup>34</sup></a>. Instead, it’s useful to think of the Bernoulli distribution as a special case of, or a building block of, more complicated distributions such as the binomial distribution. For example, a single observation of a binomially-distributed variable could be thought of as a Bernoulli distribution.</p>
<p>The Bernoulli distribution is a special case of the binomial distribution, and so it is accessed in R using the functions associated with the binomial. With the <code>size</code> argument set to 1, the binomial distribution <em>is</em> the Bernoulli distribution.</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="mod-04.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flip one fair coin</span></span>
<span id="cb891-2"><a href="mod-04.html#cb891-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="mod-04.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flip 10 fair coins</span></span>
<span id="cb893-2"><a href="mod-04.html#cb893-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 1 1 0 1 1 0 1 0 1 1</code></pre>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="mod-04.html#cb895-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flip 10 coins with a 70% chance of heads</span></span>
<span id="cb895-2"><a href="mod-04.html#cb895-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.7</span>)</span></code></pre></div>
<pre><code>##  [1] 0 1 1 0 1 1 0 0 0 1</code></pre>
</div>
<div id="binomial-distribution" class="section level4" number="4.3.3.2">
<h4><span class="header-section-number">4.3.3.2</span> Binomial distribution</h4>
<p>The binomial distribution describes the <strong>number of successes</strong> in a set of independent Bernoulli trials. Each trial has probability of success <em>p</em>, and there are <em>n</em> trials. The values <em>n</em> and <em>p</em> are the <strong>parameters</strong> of the binomial distribution–the values that describe its behavior. The coin flipping example above is an example of a binomial distribution. Biological examples of binomial processes might be the number of fish that die in an experiment, or the number of plants that flower in a season.</p>
<p>Because it is so simple, thinking about the binomial distribution is a good warm up for learning about the characteristics of probability distributions. One of the most important characteristics is the <strong>expected value</strong> of the distribution. This is the value that most likely to occur, or the <strong>central tendency</strong> of values. There are several kinds of expected value, but they are all related to the most common or central value. The expected value, or mean, of a binomial distribution <em>X</em> is</p>
<p><span class="math display">\[E\left(X\right)=\mu=np\]</span></p>
<p>This is the answer to the question earlier about how many heads to expect if a fair coin is flipped 10 times:</p>
<p><span class="math display">\[E(heads)=n(flips)p(heads)\]</span></p>
<p>If a variable comes from a binomial process, we can make other inferences about it. For example, we can estimate its variance as:</p>
<p><span class="math display">\[Var\left(X\right)=\sigma^2=np(1-p)=npq\]</span></p>
<p>We can also estimate the probability of any number of successes <em>k</em> as:</p>
<p><span class="math display">\[P\left(k\right)=\left(\begin{matrix}n\\k\\\end{matrix}\right)p^k\left(1-p\right)^{n-k}\]</span></p>
<p>The first term (<em>n</em> over <em>k</em>) is known as the <strong>binomial coefficient</strong> and is calculated as:</p>
<p><span class="math display">\[\left(\begin{matrix}n\\k\\\end{matrix}\right)=\frac{n!}{k!\left(n-k\right)!}\]</span></p>
<p>This term represents the number of ways of seeing <em>k</em> successes in <em>n</em> trials. For example, a set of 4 trials could have 2 successes in 6 ways: HHTT, HTHT, THHT, HTTH, THTH, and TTHH.</p>
<p>When <em>n</em> is small, the binomial distribution can be quite skewed (i.e., asymmetric) because the distribution has a hard lower bound of 0. Note that the expression for <span class="math inline">\(P(k)\)</span> is what is calculated by function <code>dbinom()</code> below, and related to what is calculated by function <code>pbinom()</code>. For large <em>n</em>, the binomial distribution can be approximated by a normal distribution (see below) with mean = <em>np</em> and variance = <em>npq</em>.</p>
<div id="binomial-distribution-in-r" class="section level5" number="4.3.3.2.1">
<h5><span class="header-section-number">4.3.3.2.1</span> Binomial distribution in R</h5>
<p>R uses a family of 4 functions to work with each probability distribution. The binomial and Bernoulli distributions are accessed using the <code>_binom</code> group of functions: <code>dbinom()</code>, <code>pbinom()</code>, <code>qbinom()</code>, and <code>rbinom()</code>. Each function calculates or returns something different about the binomial distribution:</p>
<ul>
<li><code>dbinom()</code>: Calculates probability mass function at <em>x</em> for binomial distribution given <em>n</em> and <em>p</em>. Answers the question “What is the probability of <em>x</em> successes in <em>n</em> trials with probability <em>p</em>?”</li>
<li><code>pbinom()</code>: Calculates integral of the probability mass function for a binomial distribution given <em>n</em> and <em>p</em>, from 0 up to <em>x</em>. In other words, given some binomial distribution, at what quantile of that distribution should some value fall? The reverse of <code>qbinom()</code>. Answers the question “What is the probably of at least <em>x</em> successes in <em>n</em> trials with probability <em>p</em>?”</li>
<li><code>qbinom()</code>: Calculates the value at specified quantile of a binomial distribution. Essentially the reverse of <code>pbinom()</code>.</li>
<li><code>rbinom()</code>: Draws random numbers from the binomial distribution defined by <em>n</em> and <em>p</em> (or from the Bernoulli distribution if <em>n</em> = 1).</li>
</ul>
<p>Let’s explore the binomial distribution using these functions. In the plots produced in the two examples, notice how the variance of each distribution (x1, x2, etc.) depends on both n and p. The variance in these plots is shown by the width of the distribution.</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="mod-04.html#cb897-1" aria-hidden="true" tabindex="-1"></a><span class="co"># N = 100, P various</span></span>
<span id="cb897-2"><a href="mod-04.html#cb897-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb897-3"><a href="mod-04.html#cb897-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb897-4"><a href="mod-04.html#cb897-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.2</span>)</span>
<span id="cb897-5"><a href="mod-04.html#cb897-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.4</span>)</span>
<span id="cb897-6"><a href="mod-04.html#cb897-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.6</span>)</span>
<span id="cb897-7"><a href="mod-04.html#cb897-7" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.8</span>)</span>
<span id="cb897-8"><a href="mod-04.html#cb897-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb897-9"><a href="mod-04.html#cb897-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb897-10"><a href="mod-04.html#cb897-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, x1, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span>
<span id="cb897-11"><a href="mod-04.html#cb897-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X, x2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb897-12"><a href="mod-04.html#cb897-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X, x3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb897-13"><a href="mod-04.html#cb897-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X, x4, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-328-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is a plot showing the effect of varying <em>n</em>.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="mod-04.html#cb898-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P = 0.5, N various</span></span>
<span id="cb898-2"><a href="mod-04.html#cb898-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb898-3"><a href="mod-04.html#cb898-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">20</span>, P)</span>
<span id="cb898-4"><a href="mod-04.html#cb898-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">40</span>, P)</span>
<span id="cb898-5"><a href="mod-04.html#cb898-5" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">60</span>, P)</span>
<span id="cb898-6"><a href="mod-04.html#cb898-6" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">80</span>, P)</span>
<span id="cb898-7"><a href="mod-04.html#cb898-7" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">100</span>, P)</span>
<span id="cb898-8"><a href="mod-04.html#cb898-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb898-9"><a href="mod-04.html#cb898-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x1, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span>
<span id="cb898-10"><a href="mod-04.html#cb898-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb898-11"><a href="mod-04.html#cb898-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb898-12"><a href="mod-04.html#cb898-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x4, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb898-13"><a href="mod-04.html#cb898-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x5, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;purple&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-329-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In these plots, the height of the points is called the <strong>probability mass function (PMF)</strong>. For discrete distributions like the binomial, the PMF of any value is the probability that the distribution takes on that value. The sum of the PMF for all integers from 0 to <em>n</em> (inclusive) must be equal to 1. You can verify this by calculating the sum of any of the vectors of densities above.</p>
<p>The function <code>pbinom()</code> sums the PMF from 0 up to and including some value. In other words, it calculates the <strong>cumulative distribution function (CDF)</strong>. This answers the question “where in the distribution is value <em>x</em>?”; put another way, “at what quantile of the distribution does value <em>x</em> lie?”. Yet another way to ask this is, “What is the probability of at least <em>X</em> successes?”.</p>
<p>Consider a binomial distribution with <em>n</em> = 10 and <em>p</em> = 0.5. What is the probability that the distribution takes a value <span class="math inline">\(\le\)</span> 7? We can calculate this as the sum of the PMF for 0 through 7.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="mod-04.html#cb899-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the distribution to see it</span></span>
<span id="cb899-2"><a href="mod-04.html#cb899-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb899-3"><a href="mod-04.html#cb899-3" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb899-4"><a href="mod-04.html#cb899-4" aria-hidden="true" tabindex="-1"></a>xd <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, N, P)</span>
<span id="cb899-5"><a href="mod-04.html#cb899-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, xd, <span class="at">type=</span><span class="st">&quot;h&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-330-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="mod-04.html#cb900-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate p(x&lt;=7)</span></span>
<span id="cb900-2"><a href="mod-04.html#cb900-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(xd[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]) <span class="co"># indices 1:8 correspond to values 0:7</span></span></code></pre></div>
<pre><code>## [1] 0.9453125</code></pre>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="mod-04.html#cb902-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same value:</span></span>
<span id="cb902-2"><a href="mod-04.html#cb902-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">7</span>, N, P)</span></code></pre></div>
<pre><code>## [1] 0.9453125</code></pre>
<p>Or, we could want to know the probability that the distribution takes on a value &gt; 6. This would be the complement of the sum up to and including 6.</p>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="mod-04.html#cb904-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(xd[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])</span></code></pre></div>
<pre><code>## [1] 0.171875</code></pre>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="mod-04.html#cb906-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same value:</span></span>
<span id="cb906-2"><a href="mod-04.html#cb906-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">6</span>,N,P)</span></code></pre></div>
<pre><code>## [1] 0.171875</code></pre>
<p>If the last two calculations seem familiar, that’s because this is exactly how <em>P</em> values for statistical tests are calculated (e.g., using <code>pf()</code> to get the probability from an <em>F</em> distribution for an ANOVA).</p>
<p>The function <code>qbinom()</code> is basically the reverse of function <code>pbinom()</code>. Rather than calculate the quantile at which a value falls in the distribution, <code>qbinom()</code> calculates the value at which a quantile falls. For example, what value do we expect to find at the 60th percentile of a distribution? Put another way, how many successes should 60% of experiments have, on average? The example below shows how <code>qbinom()</code> and <code>pbinom()</code> are reversible.</p>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="mod-04.html#cb908-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb908-2"><a href="mod-04.html#cb908-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb908-3"><a href="mod-04.html#cb908-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">6</span>, N, P)</span></code></pre></div>
<pre><code>## [1] 0.828125</code></pre>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="mod-04.html#cb910-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.828125</span>, N, P)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>Finally, <code>rbinom()</code> draws random values from the binomial or Bernoulli distributions. The syntax of this function can be a little confusing. The first argument, <code>n</code>, is the <em>number of random draws</em> that you want. The second argument, <code>size</code>, is the <em>number of values in each draw</em>; that is, the parameter <em>n</em> of the binomial distribution. Compare these results, all with <em>p</em> = 0.5:</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="mod-04.html#cb912-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 draw of 1 trial</span></span>
<span id="cb912-2"><a href="mod-04.html#cb912-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="mod-04.html#cb914-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 draw of 10 trials</span></span>
<span id="cb914-2"><a href="mod-04.html#cb914-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="mod-04.html#cb916-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 draws of 1 trial per draw </span></span>
<span id="cb916-2"><a href="mod-04.html#cb916-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 0 0 1 0 1 1 1 0 1 0</code></pre>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="mod-04.html#cb918-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 draws of 10 trials per draw</span></span>
<span id="cb918-2"><a href="mod-04.html#cb918-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 3 5 5 7 3 5 5 5 4 3</code></pre>
<p>Result 1 shows a Bernoulli distribution with <em>n</em> = 1. Result 2 shows a single value from a binomial distribution with <em>n</em> = 10. Result 3 shows 10 results from Bernoulli distributions. Notice that if you add up the values in result 3, you get a result like Result 2. Finally, Result 4 shows 10 draws from a binomial distribution, which itself has <em>n</em> = 10. The take home message is that the first argument to <code>rbinom()</code> is not a parameter of the binomial distribution. It is instead the number of draws from the distribution that you want. The <code>size</code> parameter is the argument that helps define the distribution.<a href="literature-cited.html#fn35" class="footnote-ref" id="fnref35"><sup>35</sup></a></p>
</div>
</div>
<div id="poisson-distribution" class="section level4" number="4.3.3.3">
<h4><span class="header-section-number">4.3.3.3</span> Poisson distribution</h4>
<p>The <strong>Poisson distribution</strong> is widely used in biology to model <strong>count data</strong>. If your data result from some sort of count or abundance per time interval, spatial extent, or unit of effort, then the Poisson distribution should be one of the first things to try in the analysis. The Poisson distribution has one parameter, <span class="math inline">\(\lambda\)</span> (“lambda”), which represents the <strong>expected number</strong> of objects counted in a sample (objects being trees, fish, cells, mutations, kangaroos, etc.). This parameter is also the <strong>variance</strong> of the distribution.</p>
<p>Like the binomial distribution, the Poisson distribution is discrete, meaning that it can only take on integer values. Unlike the binomial distribution, which is bounded by 0 and n, the Poisson distribution is bounded by 0 and <span class="math inline">\(+\infty\)</span>. However, values <span class="math inline">\(\gg \lambda\)</span> are highly improbable. If there is a well-defined upper bound for your count, then you might consider them to come from a binomial distribution instead of a Poisson. For example, if you are counting the number of fish in a toxicity trial that survive, the greatest possible count is the number of fish in the trial. On the other hand, if your counts have no <em>a priori</em> upper bound, then use the Poisson.</p>
<p>The expected value and the variance of the Poisson distribution are both <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[E\left(X\right)=Var\left(X\right)=\lambda\]</span></p>
<div id="poisson-distribution-in-r" class="section level5" number="4.3.3.3.1">
<h5><span class="header-section-number">4.3.3.3.1</span> Poisson distribution in R</h5>
<p>The Poisson distribution is accessed using the <code>_pois</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dpois()</code>: Calculates <strong>probability mass function (PMF)</strong> at <em>x</em> for Poisson distribution given <span class="math inline">\(\lambda\)</span>. Answers the question, “what is the probability of observing a count of <em>x</em> given <span class="math inline">\(\lambda\)</span>?”</li>
<li><code>ppois()</code>: Calculates CDF, or integral of PMF, from 0 up to <em>x</em> given <span class="math inline">\(\lambda\)</span>. In other words, given some Poisson distribution, at what quantile of that distribution should some value fall? The reverse of <code>qpois()</code>.</li>
<li><code>qpois()</code>: Calculates the value at specified quantile of a Poisson distribution. The reverse of <code>ppois()</code>.</li>
<li><code>rpois()</code>: Draws random numbers from the Poisson distribution defined by <span class="math inline">\(\lambda\)</span>.</li>
</ul>
<p>Something important to keep in mind about the Poisson distribution is that it only makes sense for discrete counts, not for continuous measurements that are rounded. For example, if you are measuring leaf lengths and round every length to the nearest mm, it might be tempting to use a Poisson distribution to analyze the data because all of the values are integers. But that would be incorrect, because leaf lengths could theoretically take on any positive value. Furthermore, treating rounded continuous values as discrete leads to the awkward issue that changing measurement units can change dimensionless statistics.</p>
<p>For example, the <strong>coefficient of variation (CV)</strong> is the ratio of a distribution’s SD to its mean. Thus, it is unitless and should be independent of units. The CV of a Poisson distribution <em>X</em> is:</p>
<p><span class="math display">\[CV\left(X\right)=\frac{\sqrt\lambda}{\lambda}\]</span></p>
<p>So, if you measured 20 leaves and found a mean length of 17 cm, the CV would thus be <span class="math inline">\(\approx\)</span> 0.242 or 24%. But if you convert the measurements to mm, the CV would be about 0.077, or 7.7%! (In fact, if you change <span class="math inline">\(\lambda\)</span> by some factor <em>a</em>, then the CV will be scaled by <span class="math inline">\(\sqrt a/a\)</span>).</p>
<p>The figure below shows the effect of varying <span class="math inline">\(\lambda\)</span> on a Poisson distribution.</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="mod-04.html#cb920-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">40</span></span>
<span id="cb920-2"><a href="mod-04.html#cb920-2" aria-hidden="true" tabindex="-1"></a>lams <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb920-3"><a href="mod-04.html#cb920-3" aria-hidden="true" tabindex="-1"></a>nlams <span class="ot">&lt;-</span> <span class="fu">length</span>(lams)</span>
<span id="cb920-4"><a href="mod-04.html#cb920-4" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nlams)</span>
<span id="cb920-5"><a href="mod-04.html#cb920-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nlams){dlist[[i]] <span class="ot">&lt;-</span> <span class="fu">dpois</span>(x, lams[i])}</span>
<span id="cb920-6"><a href="mod-04.html#cb920-6" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(nlams)</span>
<span id="cb920-7"><a href="mod-04.html#cb920-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb920-8"><a href="mod-04.html#cb920-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb920-9"><a href="mod-04.html#cb920-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>,</span>
<span id="cb920-10"><a href="mod-04.html#cb920-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb920-11"><a href="mod-04.html#cb920-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, dlist[[<span class="dv">1</span>]], <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">sapply</span>(dlist, max))),</span>
<span id="cb920-12"><a href="mod-04.html#cb920-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Value (x)&quot;</span>)</span>
<span id="cb920-13"><a href="mod-04.html#cb920-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nlams){</span>
<span id="cb920-14"><a href="mod-04.html#cb920-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(x, dlist[[i]], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>,</span>
<span id="cb920-15"><a href="mod-04.html#cb920-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span>cols[i])</span>
<span id="cb920-16"><a href="mod-04.html#cb920-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb920-17"><a href="mod-04.html#cb920-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span>lams,</span>
<span id="cb920-18"><a href="mod-04.html#cb920-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">pt.cex=</span><span class="fl">1.3</span>, <span class="at">col=</span>cols, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>,</span>
<span id="cb920-19"><a href="mod-04.html#cb920-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">expression</span>(lambda))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-334-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="negative-binomial-distribution" class="section level4" number="4.3.3.4">
<h4><span class="header-section-number">4.3.3.4</span> Negative binomial distribution</h4>
<p>The <strong>negative binomial distribution</strong> has two common definitions. The original defintion is as the number of failures that occur in a series of Bernoulli trials until some predetermined number of successes is observed. For example, when flipping a fair coin, how many times should you expect to see tails before you observe 8 heads? The second definition is as an alternative to the Poisson distribution when variance is not equal to the mean<a href="literature-cited.html#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a>. This makes the negative binomial a bit of an odd duck in biological data analysis because it is defined in terms of one distribution, but used as an alternate version of another. The traditional definition of the negative binomial distribution is what names the negative binomial.</p>
<p>Biologists often use the second definition as an <strong>overdispersed</strong> alternative to the Poisson distribution. Overdispersed means that a distribution has a variance greater than expected given other parameters. This is <em>very common</em> in biological count data. For example, a bird species might have low abundance (0 to 4) at most sites in a study, but very high abundance (30 to 40) at a handful of sites. In that case using the Poisson distribution would not be appropriate because doing so would imply that the variance <span class="math inline">\(\lambda\)</span> was greater than the mean (also <span class="math inline">\(\lambda\)</span>); in other words, that <span class="math inline">\(\lambda &gt; \lambda\)</span>.</p>
<p>The version of the negative binomial that biologists use is parameterized by its mean <span class="math inline">\(\mu\)</span> and its overdispersion <em>k</em>. This definition views the negative binomial as a Poisson distribution with parameter <span class="math inline">\(\lambda\)</span>, where <span class="math inline">\(\lambda\)</span> itself is a random variable that follows a Gamma distribution (see below). For this reason, some authors refer to the negative binomial as a <strong>Gamma-Poisson mixture distribution</strong>. A mixture distribution is exactly what it sounds like: a distribution that is formed by “mixing” or combining two distributions. Usually this manifests as having one or more parameters of one distribution vary as another distribution.</p>
<p>The overdispersion parameter <em>k</em> is called <strong>size</strong> in the R functions that work with the negative binomial. Counterintuitively, the overdispersion in a negative binomial distribution gets larger as <em>k</em> becomes smaller. This is seen in the expression for the variance of a negative binomial distribution:</p>
<p><span class="math display">\[Var\left(X\right)=\mu+\frac{\mu^2}{k}\]</span></p>
<p>As <em>k</em> becomes large, the ratio <span class="math inline">\(\mu^2/k\)</span> becomes small, and thus <span class="math inline">\(Var(x)\)</span> approaches <span class="math inline">\(\mu\)</span>. This means that a negative binomial distribution with large <em>k</em> approximates a Poisson distribution. As <em>k</em> approaches 0, the ratio <span class="math inline">\(\mu^2/k\)</span> becomes larger, and thus <span class="math inline">\(Var(x)\)</span> increases to be much larger than <span class="math inline">\(\mu\)</span>.</p>
<div id="negative-binomial-distribution-in-r" class="section level5" number="4.3.3.4.1">
<h5><span class="header-section-number">4.3.3.4.1</span> Negative binomial distribution in R</h5>
<p>The negative binomial distribution is accessed using the <code>_nbinom</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dnbinom()</code>: Calculates PMF at <em>x</em>. Answers the question, “what is the probability of observing a count of <em>x</em>?”</li>
<li><code>pnbinom()</code>: Calculates CDF, or integral of PMF, from 0 up to <em>x</em>. In other words, given some negative binomial distribution, at what quantile of that distribution should some value fall? The reverse of <code>qnbinom()</code>.</li>
<li><code>qnbinom()</code>: Calculates the value at specified quantile of a Poisson distribution. The reverse of <code>pnbinom()</code>.</li>
<li><code>rnbinom()</code>: Draws random numbers from the negative binomial distribution.</li>
</ul>
<p>The R functions for the negative binomial distribution can work with either parameterization (waiting time or mean with overdispersion). Some of the argument names are used for both methods. If you are working with the negative binomial distribution in R you <em>need to name your arguments to make sure you get the version of the negative binomial that you want</em>.</p>
<p>The figure below show the effect of different overdispersion parameters. Notice that as <em>k</em> increases, the distribution looks more and more like a Poisson distribution with <span class="math inline">\(\lambda = 10\)</span>. As <em>k</em> gets smaller, the distribution gets more and more concentrated near 0, and more and more right-skewed.</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="mod-04.html#cb921-1" aria-hidden="true" tabindex="-1"></a>xp <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb921-2"><a href="mod-04.html#cb921-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(xp, <span class="dv">10</span>)</span>
<span id="cb921-3"><a href="mod-04.html#cb921-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="fl">0.2</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb921-4"><a href="mod-04.html#cb921-4" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb921-5"><a href="mod-04.html#cb921-5" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">1</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb921-6"><a href="mod-04.html#cb921-6" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">10</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb921-7"><a href="mod-04.html#cb921-7" aria-hidden="true" tabindex="-1"></a>y6 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">50</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb921-8"><a href="mod-04.html#cb921-8" aria-hidden="true" tabindex="-1"></a>y7 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">100</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb921-9"><a href="mod-04.html#cb921-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb921-10"><a href="mod-04.html#cb921-10" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">6</span>)</span>
<span id="cb921-11"><a href="mod-04.html#cb921-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb921-12"><a href="mod-04.html#cb921-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>,</span>
<span id="cb921-13"><a href="mod-04.html#cb921-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb921-14"><a href="mod-04.html#cb921-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xp, y1, <span class="at">pch=</span><span class="dv">17</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span>
<span id="cb921-15"><a href="mod-04.html#cb921-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xp, y2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">1</span>])</span>
<span id="cb921-16"><a href="mod-04.html#cb921-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xp, y3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">2</span>])</span>
<span id="cb921-17"><a href="mod-04.html#cb921-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xp, y4, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">3</span>])</span>
<span id="cb921-18"><a href="mod-04.html#cb921-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xp, y5, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">4</span>])</span>
<span id="cb921-19"><a href="mod-04.html#cb921-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xp, y6, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">5</span>])</span>
<span id="cb921-20"><a href="mod-04.html#cb921-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xp, y7, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">6</span>])</span>
<span id="cb921-21"><a href="mod-04.html#cb921-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb921-22"><a href="mod-04.html#cb921-22" aria-hidden="true" tabindex="-1"></a><span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Poisson&quot;</span>, <span class="st">&quot;k=0.2&quot;</span>, <span class="st">&quot;k=0.5&quot;</span>, <span class="st">&quot;k=1&quot;</span>, <span class="st">&quot;k=10&quot;</span>, </span>
<span id="cb921-23"><a href="mod-04.html#cb921-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;k=50&quot;</span>, <span class="st">&quot;k=100&quot;</span>),</span>
<span id="cb921-24"><a href="mod-04.html#cb921-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">17</span>, <span class="fu">rep</span>(<span class="dv">16</span>,<span class="dv">6</span>)), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, cols))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-335-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="geometric-distribution" class="section level4" number="4.3.3.5">
<h4><span class="header-section-number">4.3.3.5</span> Geometric distribution</h4>
<p>The <strong>geometric distribution</strong> describes the number of Bernoulli trials that are seen before observing a single failure. It is thus related to the binomial and negative binomial. In fact, the geometric distribution is a special case of the negative binomial, with the number of successes = 1.</p>
<p>The geometric distribution arises in biology when modeling waiting times or life spans. For example, the number of years that an individual organism lives, if it has a constant probability of surviving each year. Or, the number of generations until a mutation in a cell line occurs, if mutations occur at a constant rate per generation.</p>
<p>Imagine a fish that has a 5% chance of dying each year; i.e., a 95% annual survival rate. How long should we expect this fish to live, on average?</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="mod-04.html#cb922-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb922-2"><a href="mod-04.html#cb922-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb922-3"><a href="mod-04.html#cb922-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">dgeom</span>(X, P)</span>
<span id="cb922-4"><a href="mod-04.html#cb922-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-336-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The figure shows that the probability of living to any given age falls off quickly at first, then more gradually as time goes on. What is the mean life expectancy?</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="mod-04.html#cb923-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgeom</span>(<span class="fl">0.5</span>, P)</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<p>What range of life expectancies can we expect for 95% of the population?</p>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="mod-04.html#cb925-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgeom</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), P)</span></code></pre></div>
<pre><code>## [1]  0 71</code></pre>
<p>That’s quite a wide range! What is the probability that a fish lives to be at least 30 years old? 40 years old?</p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="mod-04.html#cb927-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pgeom</span>(<span class="dv">30</span>, P)</span></code></pre></div>
<pre><code>## [1] 0.2039068</code></pre>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="mod-04.html#cb929-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pgeom</span>(<span class="dv">40</span>, P)</span></code></pre></div>
<pre><code>## [1] 0.1220865</code></pre>
</div>
<div id="beta-binomial-distribution" class="section level4" number="4.3.3.6">
<h4><span class="header-section-number">4.3.3.6</span> Beta-binomial distribution</h4>
<p>The <strong>beta-binomial distribution</strong> is a mixture that allows for modeling binomial processes with more variation than would be expected from a garden variety binomial distribution. The beta-binomial is a binomial distribution, but with the probability parameter <em>p</em> itself varying randomly according to a beta distribution (see below). This is similar to how a negative binomial distribution can be defined as a Poisson distribution mixed with a gamma distribution (with the Poisson <span class="math inline">\(\lambda\)</span> varying as a gamma variable).</p>
<p>A beta-binomial distribution <em>X</em> is given by:</p>
<p><span class="math display">\[X \sim Bin\left(n,\ p\right)\]</span></p>
<p><span class="math display">\[p \sim Beta\left(\alpha,\beta\right)\]</span></p>
<p>The parameters of the beta distribution are positive shape parameters (see below). The parameters of the beta part of the beta-binomial distribution can make the binomial part overdispersed relative to an ordinary binomial distribution.</p>
</div>
<div id="multinomial-distribution" class="section level4" number="4.3.3.7">
<h4><span class="header-section-number">4.3.3.7</span> Multinomial distribution</h4>
<p>The <strong>multinomial distribution</strong> is a generalization of the binomial distribution to cases with more than 2 possible outcomes. For example, rolling a 6-sided die many times would yield a distribution of outcomes (1, 2, 3, 4, 5, or 6) described by the multinomial distribution. The multinomial distribution is parameterized by the number of possible outcomes <em>k</em>, the number of trials <em>n</em>, and the probabilities of each outcome <span class="math inline">\(p_1, \ldots, p_k\)</span>. The probabilities must sum to 1.</p>
<p>There are some special cases of the multinomial distribution:</p>
<ul>
<li>When <em>k</em> = 2 and <em>n</em> = 1, the multinomial distribution reduces to the Bernoulli distribution</li>
<li>When <em>k</em> = 2 and <em>n</em> &gt; 1, the multinomial distribution reduces to the binomial distribution</li>
<li>When <em>k</em> &gt; 2 and <em>n</em> = 1, the multinomial distribution is the categorical distribution.</li>
</ul>
<p>The example below shows how to work with the multinomial distribution in R.</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="mod-04.html#cb931-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define 2 different sets of probabilities for</span></span>
<span id="cb931-2"><a href="mod-04.html#cb931-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 different outcomes</span></span>
<span id="cb931-3"><a href="mod-04.html#cb931-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>)</span>
<span id="cb931-4"><a href="mod-04.html#cb931-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)</span>
<span id="cb931-5"><a href="mod-04.html#cb931-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb931-6"><a href="mod-04.html#cb931-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sample from the multinomial distribution</span></span>
<span id="cb931-7"><a href="mod-04.html#cb931-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb931-8"><a href="mod-04.html#cb931-8" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(N, N, <span class="at">prob=</span>p1)</span>
<span id="cb931-9"><a href="mod-04.html#cb931-9" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(N, N, <span class="at">prob=</span>p2)</span>
<span id="cb931-10"><a href="mod-04.html#cb931-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb931-11"><a href="mod-04.html#cb931-11" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize by outcome</span></span>
<span id="cb931-12"><a href="mod-04.html#cb931-12" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(r1, <span class="dv">1</span>, mean)</span>
<span id="cb931-13"><a href="mod-04.html#cb931-13" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(r2, <span class="dv">1</span>, mean)</span>
<span id="cb931-14"><a href="mod-04.html#cb931-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb931-15"><a href="mod-04.html#cb931-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb931-16"><a href="mod-04.html#cb931-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, y1, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, </span>
<span id="cb931-17"><a href="mod-04.html#cb931-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>))</span>
<span id="cb931-18"><a href="mod-04.html#cb931-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, y2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-340-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="continuous-distributions" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Continuous distributions</h3>
<p>A <strong>continuous distribution</strong> can take an infinite number of values. These values can come from an interval on the real line, or the entire real line. Contrast this to a discrete distribution, which can only take on integer values. Computing the probability of any possible outcome of a discrete distribution is relative straightforward because there are a limited number of outcomes. For example, a binomial distribution with <em>n</em> = 10 and <em>p</em> = 0.5 has only 11 possible outcomes (0, 1, 2, …, 9, or 10). The probabilities <span class="math inline">\(p(0)\)</span>, <span class="math inline">\(p(1)\)</span>, …, <span class="math inline">\(p(10)\)</span> must all sum to 1. The probability mass function (PMF) of the binomial distribution at any value is the probability of that value occurring.</p>
<p>This leads to an interesting question. How could we calculate the probability of any given outcome of a continuous distribution? If the probabilities of each individual value must all sum to 1, and there are infinitely many possible values, then doesn’t the probability of each value equal 0? If the probability of every outcome is 0, how can the distribution take on any value?</p>
<p>To resolve this apparent contradiction, we have to take a step back and think about what distributions really mean. The first step is to realize that even if any single value has probability 0, an <em>interval</em> of values can have a non-zero probability. After all, the entire domain of a distribution has probability 1 (by definition). We can define some interval in the domain that covers half of the total probability, or one-quarter, or any arbitrary fraction. This means that for any value <em>x</em> in a distribution <em>X</em> (note lower case vs. upper case) we can calculate the probability of observing a value <span class="math inline">\(\le x\)</span>. The figure below shows this:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-341-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The <em>y</em>-axis in the figure, <span class="math inline">\(P\left(X \le x\right)\)</span>, is called the <strong>cumulative distribution function (CDF)</strong>. This name derives from the fact that the CDF of some value <em>x</em> gives the cumulative probability of all values up to and including <em>x</em>. The CDF is sometimes labeled “<strong>F(x)</strong>” (note the capitalized F). Another way to interpret this is that a value <em>x</em> lies at the <em>CDF(x)</em> quantile of a distribution. For example, if <em>CDF(x)</em> = 0.4, then <em>x</em> lies at the 0.4 quantile or 40th percentile of the distribution. Critically, this means that 40% of the total probability of the distribution lies at or to the left of <em>x</em>.</p>
<p>Just as with discrete distributions, the relative probability of any given value in a continuous distribution is given by the rate at which the CDF changes at that value. For discrete distributions this relative probability also happens to be the absolute probability (because <em>dx</em> = 1 in the expression below). For continuous distributions, this probability is relative. The relative probability of a value in a continuous distribution is given by the <strong>probability density function (PDF)</strong>. The PDF, <strong><em>f(x)</em></strong>, is the derivative of the CDF:</p>
<p><span class="math display">\[f\left(x\right)=\frac{dF(x)}{dx}\]</span></p>
<p>This also means that the CDF is the integral of the PDF, according to the fundamental theorem of calculus:</p>
<p><span class="math display">\[F\left(x\right)=\int_{-\infty}^{x}{f\left(x\right)\ dx}\]</span></p>
<p>This might be easier to see with an example. The plots below show the PDF and CDF of a standard normal distribution (see below). Because the normal is unbounded, its PDF and CDF have the domain [<span class="math inline">\(-\infty\)</span>, <span class="math inline">\(+\infty\)</span>], but we usually truncate the plot to a range that covers most of the CDF.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-342-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>On the left, notice that the PDF peaks near <em>x</em> = 0 and tapers off quickly to either side. On the right, the slope of the CDF is greatest at <em>x</em> = 0. The value of the PDF at <em>x</em> = 0, about 0.4, is neither the probability of observing <em>x</em> = 0 nor the probability of observing <em>x</em> <span class="math inline">\(\le\)</span> 0, which is 0.5. The value <span class="math inline">\(f(0) = 0.4\)</span> is the rate of change in <span class="math inline">\(F(X)\)</span> at <em>x</em> = 0.</p>
<div id="uniform-distribution" class="section level4" number="4.3.4.1">
<h4><span class="header-section-number">4.3.4.1</span> Uniform distribution</h4>
<p>The simplest continuous distribution is the <strong>uniform distribution</strong>. The uniform distribution is parameterized by its upper and lower bounds, usually called <em>a</em> and <em>b</em>, respectively. All values of a uniform distribution in the interval [<em>a</em>, <em>b</em>] are equally likely, and all values outside [<em>a</em>, <em>b</em>] have probability 0. The figure below shows the PDF of 3 different uniform distributions.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-343-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Notice how each distribution has a flat PDF, but that the value of the PDF decreases as the width of the uniform distribution increases. Given what you learned above about the relationship between the CDF and the PDF, can you work out why this is?</p>
<p>Like the normal distribution, there is a standard uniform distribution that is frequently used. The standard uniform is defined as <em>Uniform(0, 1)</em>: a uniform distribution in the interval [0, 1]. The uniform distribution can sometimes be abbreviated as <em>U(a,b)</em> or <em>Unif(a,b)</em> instead of <em>Uniform(a,b)</em>.</p>
<p>The mean of a uniform distribution is just the mean of its limits:</p>
<p><span class="math display">\[\mu\left(X\right)=\frac{a+b}{2}\]</span></p>
<p>The variance of a uniform distribution is:</p>
<p><span class="math display">\[\sigma^2\left(X\right)=\frac{{(b-a)}^2}{12}\]</span></p>
<div id="uniform-distribution-in-r" class="section level5" number="4.3.4.1.1">
<h5><span class="header-section-number">4.3.4.1.1</span> Uniform distribution in R</h5>
<p>The uniform distribution is accessed using the <code>_unif</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dunif()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>punif()</code>: Calculates CDF, from <em>a</em> up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qunif()</code>.</li>
<li><code>qunif()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>punif()</code>.</li>
<li><code>runif()</code>: Draws random numbers from the uniform distribution.</li>
</ul>
<p>The help files for many R functions include a call to <code>runif()</code> to generate example values from the uniform distribution. This can be confusing to new users, who might interpret “runif” as “run if” (i.e., some sort of conditional statement).</p>
<p>One extremely useful application is the generation of values from the standard uniform distribution:</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="mod-04.html#cb932-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span></code></pre></div>
<p>The line above generates 20 numbers from the interval [0, 1]. These values can be used as probabilities or values of a CDF.</p>
<p>If you want to implement a new probability distribution in R, you can use <code>runif()</code> followed by the <code>q__()</code> function that you define for your new distribution to implement a random number generator for it. The example below shows how to implement a “truncated normal” distribution:</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="mod-04.html#cb933-1" aria-hidden="true" tabindex="-1"></a>rtnorm <span class="ot">&lt;-</span> <span class="cf">function</span>(N, lower, upper, mu, sigma){</span>
<span id="cb933-2"><a href="mod-04.html#cb933-2" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(lower, mu, sigma)</span>
<span id="cb933-3"><a href="mod-04.html#cb933-3" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(upper, mu, sigma)</span>
<span id="cb933-4"><a href="mod-04.html#cb933-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, a, b)</span>
<span id="cb933-5"><a href="mod-04.html#cb933-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(x, mu, sigma)</span>
<span id="cb933-6"><a href="mod-04.html#cb933-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb933-7"><a href="mod-04.html#cb933-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb933-8"><a href="mod-04.html#cb933-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb933-9"><a href="mod-04.html#cb933-9" aria-hidden="true" tabindex="-1"></a>use.n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb933-10"><a href="mod-04.html#cb933-10" aria-hidden="true" tabindex="-1"></a>use.mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb933-11"><a href="mod-04.html#cb933-11" aria-hidden="true" tabindex="-1"></a>use.sd <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb933-12"><a href="mod-04.html#cb933-12" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(use.n, use.mu, use.sd)</span>
<span id="cb933-13"><a href="mod-04.html#cb933-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rtnorm</span>(use.n, <span class="dv">8</span>, <span class="dv">12</span>, use.mu, use.sd)</span>
<span id="cb933-14"><a href="mod-04.html#cb933-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb933-15"><a href="mod-04.html#cb933-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb933-16"><a href="mod-04.html#cb933-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x1, <span class="at">main=</span><span class="st">&quot;Normal&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb933-17"><a href="mod-04.html#cb933-17" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x2, <span class="at">main=</span><span class="st">&quot;Truncated normal&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-345-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mod-04-norm" class="section level4" number="4.3.4.2">
<h4><span class="header-section-number">4.3.4.2</span> Normal distribution</h4>
<p>The <strong>normal distribution</strong> is probably the most important distribution in statistics. Many natural processes result in normal distributions. Consequently, most classical statistical methods (e.g., <em>t</em>-tests, ANOVA, and linear models) assume that data come from a normal distribution. The normal distribution is also sometimes called the <strong>Gaussian</strong> distribution because of the work of mathematician Carl Friedrich Gauss, although he did not discover it. The normal distribution is also sometimes called the bell curve because of the shape of its PDF. This term should be avoided because other probability distributions also have a bell shape, and because normal distributions are not always bell-shaped. The figure below shows several normal distributions with different means (<span class="math inline">\(\mu\)</span>) and standard deviations (SD, or <span class="math inline">\(\sigma\)</span>).</p>
<p><img src="_main_files/figure-html/unnamed-chunk-346-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Many phenomena result in normal distributions because of the <strong>Central Limit Theorem (CLT)</strong>. The CLT states that under certain conditions the sum of many random variables will approximate a normal distribution. The main condition is that the random variables will be independent and identically distributed (often abbreviated “<em>i.i.d.</em>”). In other words, the values do not depend on each other, and they all come from the same kind of distribution. The exact distribution does not matter. The example below uses the uniform distribution. The CLT also works with the mean of the random variables instead of the sum, because mean is just the sum scaled by sample size.</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="mod-04.html#cb934-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb934-2"><a href="mod-04.html#cb934-2" aria-hidden="true" tabindex="-1"></a>xvec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb934-3"><a href="mod-04.html#cb934-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){xvec[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">runif</span>(<span class="dv">10</span>))}</span>
<span id="cb934-4"><a href="mod-04.html#cb934-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(xvec)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-347-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>It should be noted that just because a sample size is large does not mean that it is normal. For example, the R commands below produce distributions <code>x1</code> and <code>x2</code> that are in no way normal.</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="mod-04.html#cb935-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb935-2"><a href="mod-04.html#cb935-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e5</span>)</span>
<span id="cb935-3"><a href="mod-04.html#cb935-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x1)</span>
<span id="cb935-4"><a href="mod-04.html#cb935-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="fl">1e5</span>), <span class="fu">rnorm</span>(<span class="fl">1e5</span>, <span class="dv">10</span>, <span class="dv">2</span>))</span>
<span id="cb935-5"><a href="mod-04.html#cb935-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-348-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The normal distribution is parameterized by its mean (<span class="math inline">\(\mu\)</span>, or “mu”) and its variance (<span class="math inline">\(\sigma^2\)</span>, “sigma squared”). Some people prefer to use the mean and standard deviation (<span class="math inline">\(\sigma\)</span>, “sigma”). This is fine because, as the symbols imply, the SD is simply the square root of the variance. Just pay attention to the notation being used. Using <span class="math inline">\(\sigma\)</span> instead of <span class="math inline">\(\sigma^2\)</span> can be convenient because <span class="math inline">\(\sigma\)</span> is in the same units as <span class="math inline">\(\mu\)</span>.</p>
<p>The <strong>standard normal distribution</strong> has <span class="math inline">\(\mu\)</span> = 0 and <span class="math inline">\(\sigma\)</span> = 1. This is often written as <em>N(0,1)</em>. These parameters are the defaults in the R functions that work with the normal distribution.</p>
<div id="normal-distribution-in-r" class="section level5" number="4.3.4.2.1">
<h5><span class="header-section-number">4.3.4.2.1</span> Normal distribution in R</h5>
<p>The normal distribution is accessed using the <code>_norm</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dnorm()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pnorm()</code>: Calculates CDF, from <span class="math inline">\(-\infty\)</span> up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qnorm()</code>.</li>
<li><code>qnorm()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pnorm()</code>.</li>
<li><code>rnorm()</code>: Draws random numbers from the normal distribution.</li>
</ul>
<p>The normal distribution in R is parameterized by the mean (argument <code>mean</code>) and the SD, not the variance (argument <code>sd</code>).
The figure generated below shows the effect of increasing the SD on the shape of a distribution. Greater variance (i.e., greater SD) means that the distribution is more spread out.</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="mod-04.html#cb936-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb936-2"><a href="mod-04.html#cb936-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb936-3"><a href="mod-04.html#cb936-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, <span class="dv">2</span>)</span>
<span id="cb936-4"><a href="mod-04.html#cb936-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, <span class="dv">5</span>)</span>
<span id="cb936-5"><a href="mod-04.html#cb936-5" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, <span class="dv">10</span>)</span>
<span id="cb936-6"><a href="mod-04.html#cb936-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb936-7"><a href="mod-04.html#cb936-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb936-8"><a href="mod-04.html#cb936-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb936-9"><a href="mod-04.html#cb936-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb936-10"><a href="mod-04.html#cb936-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb936-11"><a href="mod-04.html#cb936-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">2</span>), <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">5</span>), <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">10</span>)),</span>
<span id="cb936-12"><a href="mod-04.html#cb936-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-349-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The normal distribution has several useful properties. Generally, the mean and median are the same (if the distribution is not skewed). Approximately 68% of values fall within 1 SD of the mean, 95% of values fall within about 2 SD of the mean (technically 1.9599 SD, or <code>qnorm(0.975)</code>), and 99% of values fall within about 3 SD of the mean. So, deviations of &gt;3 SD are very rare and may signify outliers. The number of SD a value falls away from the mean is sometimes referred to as a <strong><em>z</em>-score</strong> or a <strong>sigma</strong>. <em>Z</em>-scores are calculated as:</p>
<p><span class="math display">\[z\left(x\right)=\frac{x-\mu}{\sigma}\]</span></p>
<p>Where <em>x</em> is the value, <span class="math inline">\(\mu\)</span> is the mean, and <span class="math inline">\(\sigma\)</span> is the SD.</p>
<p><em>Z</em>-scores are sometimes used when comparing variables that are normally distributed, but on very different scales. Converting the raw values to their <em>z</em>-scores is referred to as <strong>standardizing</strong> them. Standardized values are sometimes used in regression analyses in place of raw values. Many ordination methods such as principal components analysis (PCA) standardize variables automatically. <em>Z</em>-scores (or standardized values) are calculated in R using the <code>scale()</code> function:</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="mod-04.html#cb937-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">40</span>)</span>
<span id="cb937-2"><a href="mod-04.html#cb937-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb937-3"><a href="mod-04.html#cb937-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x1)</span>
<span id="cb937-4"><a href="mod-04.html#cb937-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">scale</span>(x1))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-350-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="lognormal-distribution" class="section level4" number="4.3.4.3">
<h4><span class="header-section-number">4.3.4.3</span> Lognormal distribution</h4>
<p>The <strong>lognormal distribution (a.k.a.: log-normal)</strong> is, as the name implies, a distribution that is <em>normal on a logarithmic scale</em>. By convention the <strong>natural log</strong> (log<sub><em>e</em></sub>, ln, or just log) is used although you can use log<sub>10</sub> if you pay attention to what you are doing and are explicit in your write-up<a href="literature-cited.html#fn37" class="footnote-ref" id="fnref37"><sup>37</sup></a>. The functions in R that deal with the lognormal use the natural log<a href="literature-cited.html#fn38" class="footnote-ref" id="fnref38"><sup>38</sup></a>.</p>
<p>The lognormal distribution arises in two ways. First, it comes about from processes where quantities are <em>multiplied together rather than added</em>. For example, growth of organisms or population sizes. This is because of the way that exponentiation relates multiplication and addition. This relationship to multiplication also means that the lognormal distribution results from a version of the CLT where values are multiplied, not added. The example below shows this.</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="mod-04.html#cb938-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb938-2"><a href="mod-04.html#cb938-2" aria-hidden="true" tabindex="-1"></a>xvec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb938-3"><a href="mod-04.html#cb938-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){xvec[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">runif</span>(<span class="dv">10</span>))}</span>
<span id="cb938-4"><a href="mod-04.html#cb938-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb938-5"><a href="mod-04.html#cb938-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(xvec)</span>
<span id="cb938-6"><a href="mod-04.html#cb938-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(xvec))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-351-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The second way that the lognormal arises is more phenomenological (i.e., descriptive). Processes that result in positive values with a long tail (mostly small values with few very large values) or positive values with a variance much larger than the mean. The latter case can also be well described by the gamma distribution. The classic example of a lognormal distribution is personal income: most populations will have mostly small values, but with a small proportion of extreme outliers.</p>
<p>The lognormal distribution is parameterized by a mean (<span class="math inline">\(\mu\)</span>) and variance (<span class="math inline">\(\sigma^2\)</span>), or by a mean and standard deviation (<span class="math inline">\(\sigma\)</span>). These parameters are on the logarithmic scale. The figure below shows various lognormal distributions with <span class="math inline">\(\mu\)</span> = 3 and different SD on a logarithmic scale (left) and a linear scale.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-352-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The figures show the effect that variance can have on the lognormal distribution. When the variance on the log scale is &lt;<span class="math inline">\(\mu\)</span>, the distribution is approximately normal on the log scale. As the variance gets larger, the distribution gets more and more right-skewed. Right-skewed means that the values are more and more concentrated near 0, and there are fewer very large values.</p>
<p>Interestingly, the mean of a log-normal distribution is not simply <span class="math inline">\(e^\mu\)</span> as one might expect. The mean of a lognormal distribution <em>X</em> on the linear scale is</p>
<p><span class="math display">\[mean\left(X\right)=e^{\left(\frac{\mu+\sigma^2}{2}\right)}\]</span></p>
<p>In this equation, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the mean and SD on the logarithmic scale. The variance on the linear scale is:</p>
<p><span class="math display">\[Var\left(X\right)=e^{2\mu+\sigma^2}\left(e^{\sigma^2}-1\right)\]</span></p>
<p>What this means is that you cannot transform the parameters of a lognormal distribution from the logarithmic to the linear scale by simply exponentiating.</p>
<div id="logormal-distribution-in-r" class="section level5" number="4.3.4.3.1">
<h5><span class="header-section-number">4.3.4.3.1</span> Logormal distribution in R</h5>
<p>The lognormal distribution is accessed using the <code>_lnorm</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dlnorm()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>plnorm()</code>: Calculates CDF, from 0 up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qlnorm()</code>.</li>
<li><code>qlnorm()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>plnorm()</code>.</li>
<li><code>rlnorm()</code>: Draws random numbers from the lognormal distribution.</li>
</ul>
<p>When working with the lognormal distribution in R it is important to keep in mind that the parameters (<code>meanlog</code> and <code>sdlog</code>) of the <code>_lnorm</code> functions are on the <em>natural log scale</em>. The <code>meanlog</code> parameter is the <em>mean of the logarithm</em> of the values, not the mean of the values or the logarithm of the mean of the values. Similarly, <code>sdlog</code> is the <code>SD of the logarithm</code> of the values, not the SD of the values or the logarithm of the SD of the values. The example below shows this:</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="mod-04.html#cb939-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="fl">1e4</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb939-2"><a href="mod-04.html#cb939-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb939-3"><a href="mod-04.html#cb939-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of the values vs. mean of the log(values):</span></span>
<span id="cb939-4"><a href="mod-04.html#cb939-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x1)</span></code></pre></div>
<pre><code>## [1] 12.10312</code></pre>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="mod-04.html#cb941-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">log</span>(x1))</span></code></pre></div>
<pre><code>## [1] 2.01172</code></pre>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="mod-04.html#cb943-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sd of the values vs. sd of the log(values):</span></span>
<span id="cb943-2"><a href="mod-04.html#cb943-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x1)</span></code></pre></div>
<pre><code>## [1] 14.81899</code></pre>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="mod-04.html#cb945-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">log</span>(x1))</span></code></pre></div>
<pre><code>## [1] 0.9923424</code></pre>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="mod-04.html#cb947-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(meanlog) != mean(x1)</span></span>
<span id="cb947-2"><a href="mod-04.html#cb947-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 7.389056</code></pre>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb949-1"><a href="mod-04.html#cb949-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x1)</span></code></pre></div>
<pre><code>## [1] 12.10312</code></pre>
</div>
</div>
<div id="gamma-distribution" class="section level4" number="4.3.4.4">
<h4><span class="header-section-number">4.3.4.4</span> Gamma distribution</h4>
<p>The <strong>gamma distribution</strong> describes waiting times until a certain number of events takes place. This means it is the continuous analogue of the negative binomial distribution, which describes the number of trials until some certain number of successes. The gamma distribution can also be used to describe positive data whose SD is much larger than the mean. This makes it an alternative to the lognormal distribution for right-skewed data, much like the negative binomial is an alternative to the Poisson. Example gamma distributions are shown below.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-354-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The Gamma distribution is parameterized by its <strong>shape</strong> and <strong>scale</strong>. The shape parameter <em>k</em> describes the number of events; the scale parameter <span class="math inline">\(\theta\)</span> (“theta”) describes the mean time until each event. The scale is sometimes expressed as the <strong>rate</strong>, which is the reciprocal of scale. Both versions are implemented in R, so you need to specify your arguments when working with the gamma distribution. For example, Gamma(4, 2) is the distribution of length of time in days it would take to observe 4 events if events occur on average once every two days. Equivalently, it is the time to observe 4 events if events occur at a rate of 1/2 event per day. Consequently, the mean of a gamma distribution given shape <em>k</em> and scale <span class="math inline">\(\theta\)</span> (or rate <em>r</em>) is:</p>
<p><span class="math display">\[\mu=k\theta=\frac{k}{r}\]</span></p>
<p>The variance is calculated as:</p>
<p><span class="math display">\[\sigma^2=k\theta^2=\frac{k}{r^2}\]</span></p>
<p>Like the negative binomial, the gamma distribution is often used phenomenologically; that is, used to describe a variable even if its mechanistic description (waiting times) doesn’t make sense biologically. Just as the negative binomial can be used to model count data with variance greater than the mean (i.e., an overdispersed Poisson), a gamma distribution can be used for positive data with <span class="math inline">\(\sigma \gg \mu\)</span>. I.e., the use case for the gamma is similar to that of the lognormal.</p>
<div id="gamma-distribution-in-r" class="section level5" number="4.3.4.4.1">
<h5><span class="header-section-number">4.3.4.4.1</span> Gamma distribution in R</h5>
<p>The gamma distribution is accessed using the <code>_gamma</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dgamma()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pgamma()</code>: Calculates CDF, from 0 up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qgamma()</code>.</li>
<li><code>qgamma()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pgamma()</code>.</li>
<li><code>rgamma()</code>: Draws random numbers from the gamma distribution.</li>
</ul>
<p>Note that when working with the gamma distribution in R, you must supply either the <code>shape</code> and the <code>rate</code>, or the <code>shape</code> and the <code>scale</code>. Supplying <code>scale</code> and <code>rate</code> will return an error.</p>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="mod-04.html#cb951-1" aria-hidden="true" tabindex="-1"></a><span class="co"># will work:</span></span>
<span id="cb951-2"><a href="mod-04.html#cb951-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rgamma</span>(<span class="dv">10</span>, <span class="at">shape=</span><span class="dv">3</span>, <span class="at">scale=</span><span class="dv">2</span>)</span>
<span id="cb951-3"><a href="mod-04.html#cb951-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rgamma</span>(<span class="dv">10</span>, <span class="at">shape=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="fl">0.5</span>)</span>
<span id="cb951-4"><a href="mod-04.html#cb951-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb951-5"><a href="mod-04.html#cb951-5" aria-hidden="true" tabindex="-1"></a><span class="co"># will return error:</span></span>
<span id="cb951-6"><a href="mod-04.html#cb951-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rgamma</span>(<span class="dv">10</span>, <span class="at">scale=</span><span class="dv">2</span>, <span class="at">rate=</span><span class="fl">0.5</span>)</span></code></pre></div>
</div>
</div>
<div id="beta-distribution" class="section level4" number="4.3.4.5">
<h4><span class="header-section-number">4.3.4.5</span> Beta distribution</h4>
<p>The <strong>beta distribution</strong> is defined on the interval [0, 1] and is parameterized by two positive shape parameters, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. For this reason, the beta distribution is often used to model the distribution of probabilities. Besides the uniform, the beta distribution is probably the most well-known continuous distribution that is bounded by an interval. The beta distribution can also be used to model any continuous variable that occurs on a bounded interval, by rescaling the variable to the interval [0, 1]. However, this may be better accomplished with a logit transformation (see the <a href="mod-04.html#mod-04-trans">section on transformations</a>).</p>
<p>The parameters of the beta distribution are a little tricky to understand, and relate to the binomial distribution. Each shape parameter is one plus the number of successes (<span class="math inline">\(\alpha\)</span>) and failures (<span class="math inline">\(\beta\)</span>) in a binomial trial. This gets a little weird when <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are &lt;1 (how can you have &lt;0 successes or failures?) but the distribution is still defined. The shape parameters can also be non-integers. The figure below shows various beta distributions. Notice how the distribution becomes U-shaped when <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> both get close to 0.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-356-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The beta distribution has mean</p>
<p><span class="math display">\[\mu=\frac{\alpha}{\alpha+\beta}\]</span></p>
<p>and variance</p>
<p><span class="math display">\[\sigma^2=\frac{\alpha\beta}{\left(\alpha+\beta\right)^2\left(\alpha+\beta+1\right)}\]</span></p>
<p>These expressions can be re-arranged to solve for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> given a mean and variance:</p>
<p><span class="math display">\[\alpha=\left(\frac{1-\mu}{\sigma^2}-\frac{1}{\mu}\right)\mu^2\]</span></p>
<p><span class="math display">\[\beta=\alpha\left(\frac{1}{\mu}-1\right)\]</span></p>
<p>This is useful if you want to use data that were reported as a mean and variance (or SD, or SE) that describe a proportion. For example, if a paper reports a survival rate estimate as 0.25 <span class="math inline">\(\pm\)</span> 0.18 SE, this implicitly suggests that the survival rate is a normally-distributed variable because a normal distribution is defined by the mean and SD (SE of a parameter estimate is equivalent to the SD of a distribution). However, this would imply that about 8% of the time, the survival rate was negative! (Verify this using R: <code>pnorm(0, 0.25, 0.18)</code>). So, you should convert these estimates to a beta distribution if you want to understand how they might vary:</p>
<p><span class="math display">\[
\alpha=\left(\frac{1-0.25}{\left(0.18\right)^2}-\frac{1}{0.25}\right){0.25}^2\approx1.1968\]</span></p>
<p><span class="math display">\[\beta=1.1968\left(\frac{1}{0.25}-1\right)\approx3.5903\]</span></p>
<p>The figure below shows the two distributions, the normal in black and the beta in blue. The dashed vertical line at 0 shows that part of the normal distribution implied by the mean and SE of a survival “probability” is not possible. Converting to a beta distribution preserves the mean and variance, but probably more accurately reflects the true nature of the uncertainty about the probability. Note that this conversion cannot be done for some combinations of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>: both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> must both be positive, so if you calculate a non-positive value for either parameter then the conversion won’t work. This can sometimes happen for probabilties very close to 0 or 1 with large SE.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-357-1.png" width="576" style="display: block; margin: auto;" /></p>
<div id="beta-distribution-in-r" class="section level5" number="4.3.4.5.1">
<h5><span class="header-section-number">4.3.4.5.1</span> Beta distribution in R</h5>
<p>The beta distribution is accessed using the <code>_beta</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dbeta()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pbeta()</code>: Calculates CDF, from 0 up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qbeta()</code>.</li>
<li><code>qbeta()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pbeta()</code>.</li>
<li><code>rbeta()</code>: Draws random numbers from the beta distribution.</li>
</ul>
</div>
<div id="the-beta-and-the-binomial" class="section level5" number="4.3.4.5.2">
<h5><span class="header-section-number">4.3.4.5.2</span> The beta and the binomial</h5>
<p>The relationship between the beta distribution and the binomial distribution should be obvious: uncertainty about the probability parameter of a binomial distribution (<em>p</em>) can be modeled using a beta distribution. In fact, this practice is so common that it has a name: the beta-binomial distribution.</p>
<p>We can take advantage of the relationship between the binomial and beta distributions to make inferences from count data. Imagine a study where biologists track the probability that fruit flies die before they are 3 weeks old. They report that 30 out of 130 flies die on or before day 21 of life. What can we estimate about the underlying distribution of 3-week survival rates?</p>
<p>First, express the values as <em>successes</em> and <em>failures</em>. Let’s consider survival to be success (<em>n</em> = 100) and mortality to be failure (<em>n</em> = 30). This suggests that the underlying probability of survival to 21 days follows a beta distribution with <span class="math inline">\(\alpha\)</span> = 101 and <span class="math inline">\(\beta\)</span> = 31. Alternatively, we could define “success” as mortality. In this case, the mortality rate would follow a beta distribution with <span class="math inline">\(\alpha\)</span> = 31 and <span class="math inline">\(\beta\)</span> = 101. In R this can be calculated and plotted as shown below. Notice how reversing <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, or reversing perspective from survival to mortality, changes the distribution to its complement:</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="mod-04.html#cb952-1" aria-hidden="true" tabindex="-1"></a><span class="co"># domain of probability</span></span>
<span id="cb952-2"><a href="mod-04.html#cb952-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length=</span><span class="fl">1e3</span>)</span>
<span id="cb952-3"><a href="mod-04.html#cb952-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb952-4"><a href="mod-04.html#cb952-4" aria-hidden="true" tabindex="-1"></a><span class="co"># survival rate distribution</span></span>
<span id="cb952-5"><a href="mod-04.html#cb952-5" aria-hidden="true" tabindex="-1"></a>y.surv <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="at">shape1=</span><span class="dv">101</span>, <span class="at">shape2=</span><span class="dv">31</span>)</span>
<span id="cb952-6"><a href="mod-04.html#cb952-6" aria-hidden="true" tabindex="-1"></a>y.mort <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="at">shape1=</span><span class="dv">31</span>, <span class="at">shape2=</span><span class="dv">101</span>)</span>
<span id="cb952-7"><a href="mod-04.html#cb952-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb952-8"><a href="mod-04.html#cb952-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb952-9"><a href="mod-04.html#cb952-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, </span>
<span id="cb952-10"><a href="mod-04.html#cb952-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.3</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>)</span>
<span id="cb952-11"><a href="mod-04.html#cb952-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y.surv, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb952-12"><a href="mod-04.html#cb952-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;P(survival)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb952-13"><a href="mod-04.html#cb952-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y.mort, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb952-14"><a href="mod-04.html#cb952-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;P(mortality)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-358-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>We could calculate this distribution in another way. Consider the number of flies that survive to come from a binomial distribution. The distribution would have <em>n</em> = 130, and <em>p</em> = 100/130 <span class="math inline">\(\approx\)</span> 0.7692. Using the properties of the binomial distribution, we could infer that the mean of the binomial distribution was</p>
<p><span class="math display">\[\mu=np=100\]</span></p>
<p>and its variance was</p>
<p><span class="math display">\[\sigma^2=\ np(1-p)\approx23.08\]</span></p>
<p>This would imply that the SD of the binomial distribution was about 4.8038, and thus the CV was about 0.048038. The CV is the ratio of the SD to the mean. We could then estimate the SD of <em>p</em> was</p>
<p><span class="math display">\[\sigma\left(p\right)=\left(0.048\right)\left(0.7692\right)\approx0.0369\]</span></p>
<p>We could then use these values, <span class="math inline">\(\mu\left(p\right)\)</span> = 0.7692 and <span class="math inline">\(\sigma\left(p\right)\)</span> = 0.0369 into the expressions for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> to obtain:</p>
<p><span class="math display">\[\alpha=\left(\frac{1-0.7692}{{(0.0369)}^2}-\frac{1}{0.7692}\right){(0.7692)}^2\approx99.23\]</span></p>
<p><span class="math display">\[\beta=99.52\left(\frac{1}{0.7692}-1\right)\approx29.77\]</span></p>
<p>These expressions get us almost the exact answers. The R code to perform these calculations is below:</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="mod-04.html#cb953-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">130</span></span>
<span id="cb953-2"><a href="mod-04.html#cb953-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">/</span><span class="dv">130</span></span>
<span id="cb953-3"><a href="mod-04.html#cb953-3" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb953-4"><a href="mod-04.html#cb953-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma2)</span>
<span id="cb953-5"><a href="mod-04.html#cb953-5" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> sigma<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb953-6"><a href="mod-04.html#cb953-6" aria-hidden="true" tabindex="-1"></a>sdp <span class="ot">&lt;-</span> cv<span class="sc">*</span>p</span>
<span id="cb953-7"><a href="mod-04.html#cb953-7" aria-hidden="true" tabindex="-1"></a>Alpha <span class="ot">&lt;-</span> (((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>(sdp<span class="sc">^</span><span class="dv">2</span>))<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>p))<span class="sc">*</span>(p<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb953-8"><a href="mod-04.html#cb953-8" aria-hidden="true" tabindex="-1"></a>Beta <span class="ot">&lt;-</span> Alpha<span class="sc">*</span>((<span class="dv">1</span><span class="sc">/</span>p)<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p>We can compare the distributions using <code>dbeta</code>.</p>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="mod-04.html#cb954-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span><span class="sc">/</span><span class="fl">1e3</span></span>
<span id="cb954-2"><a href="mod-04.html#cb954-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, <span class="dv">101</span>, <span class="dv">31</span>) <span class="co"># based on counts</span></span>
<span id="cb954-3"><a href="mod-04.html#cb954-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, Alpha, Beta) <span class="co"># calculated from binomial</span></span>
<span id="cb954-4"><a href="mod-04.html#cb954-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb954-5"><a href="mod-04.html#cb954-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb954-6"><a href="mod-04.html#cb954-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">lend=</span><span class="dv">1</span>)</span>
<span id="cb954-7"><a href="mod-04.html#cb954-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb954-8"><a href="mod-04.html#cb954-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x1, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb954-9"><a href="mod-04.html#cb954-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Count-based&quot;</span>, <span class="st">&quot;Calculated&quot;</span>),</span>
<span id="cb954-10"><a href="mod-04.html#cb954-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-360-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The calculated values in <code>y2</code> result in a beta distribution of probabilities very close to the correct values. The difference results from a result known as the <strong>rule of succession</strong>, first published by French mathematician Pierre-Simon LaPlace in the 18th century. Briefly, we should assign the mean probability of success in a future Bernoulli trial <span class="math inline">\(\hat{p}\)</span> as</p>
<p><span class="math display">\[\hat{p}=\frac{x+1}{n+2}\]</span></p>
<p>where <em>x</em> is the number of successes in <em>n</em> trials. In other words, for some vector <em>x</em> of successes and failures (1s and 0s) we need to add one additional 1 and one additional 0 in order to estimate underlying distribution of success rates. The R code below produces the correct result (notice the new values of <em>n</em> and <em>p</em>).</p>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="mod-04.html#cb955-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">132</span></span>
<span id="cb955-2"><a href="mod-04.html#cb955-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">/</span><span class="dv">132</span></span>
<span id="cb955-3"><a href="mod-04.html#cb955-3" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb955-4"><a href="mod-04.html#cb955-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma2)</span>
<span id="cb955-5"><a href="mod-04.html#cb955-5" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> sigma<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb955-6"><a href="mod-04.html#cb955-6" aria-hidden="true" tabindex="-1"></a>sdp <span class="ot">&lt;-</span> cv<span class="sc">*</span>p</span>
<span id="cb955-7"><a href="mod-04.html#cb955-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb955-8"><a href="mod-04.html#cb955-8" aria-hidden="true" tabindex="-1"></a>Alpha <span class="ot">&lt;-</span> (((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>(sdp<span class="sc">^</span><span class="dv">2</span>))<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>p))<span class="sc">*</span>(p<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb955-9"><a href="mod-04.html#cb955-9" aria-hidden="true" tabindex="-1"></a>Beta <span class="ot">&lt;-</span> Alpha<span class="sc">*</span>((<span class="dv">1</span><span class="sc">/</span>p)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb955-10"><a href="mod-04.html#cb955-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb955-11"><a href="mod-04.html#cb955-11" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span><span class="sc">/</span><span class="fl">1e3</span></span>
<span id="cb955-12"><a href="mod-04.html#cb955-12" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, <span class="dv">101</span>, <span class="dv">31</span>) <span class="co"># based on counts</span></span>
<span id="cb955-13"><a href="mod-04.html#cb955-13" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, Alpha, Beta) <span class="co"># calculated from binomial</span></span>
<span id="cb955-14"><a href="mod-04.html#cb955-14" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># and rule of succession</span></span>
<span id="cb955-15"><a href="mod-04.html#cb955-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb955-16"><a href="mod-04.html#cb955-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb955-17"><a href="mod-04.html#cb955-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">lend=</span><span class="dv">1</span>)</span>
<span id="cb955-18"><a href="mod-04.html#cb955-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb955-19"><a href="mod-04.html#cb955-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x1, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb955-20"><a href="mod-04.html#cb955-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Count-based&quot;</span>, <span class="st">&quot;Calculated&quot;</span>),</span>
<span id="cb955-21"><a href="mod-04.html#cb955-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-361-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="dirichlet-distribution" class="section level4" number="4.3.4.6">
<h4><span class="header-section-number">4.3.4.6</span> Dirichlet distribution</h4>
<p>The <strong>Dirichlet distribution</strong> (pronounced “Deer-eesh-lay”) is the distribution of probabilities for multiple outcomes of a random process. This makes it the generalization of beta distribution to multiple outcomes. The values of a Dirichlet distribution must add up to 1. For example, the beta distribution models the probability of throwing heads when you flip a coin. The Dirichlet distribution describes the probability of getting 1, 2, 3, 4, 5, or 6 when you throw a 6-sided die. Just as the probabilities of heads and not-heads must add to 1, the probabilities of 1, 2, 3, 4, 5, and 6 must add up to 1.</p>
<p>The Dirichlet distribution doesn’t come up on its own very often. Usually, biologists encounter the Dirichlet distribution when performing Bayesian analysis of multinomial outcomes. The Dirichlet distribution is the “conjugate prior” of the categorical and multinomial distributions.</p>
</div>
<div id="exponential-distribution" class="section level4" number="4.3.4.7">
<h4><span class="header-section-number">4.3.4.7</span> Exponential distribution</h4>
<p>The <strong>exponential distribution</strong> describes the distribution of waiting times until a single event occurs, given a constant probability per unit time of that event occurring. This makes it the continuous analog of the geometric distribution. The exponential distribution is also a special case of the gamma distribution where k = 1.</p>
<p>The exponential distribution should not be confused with the <strong>exponential family of distributions</strong>, although the exponential distribution is part of that family. The exponential family of distributions includes many whose PDF can be expressed as an exponential function (e.g., <span class="math inline">\(f\left(x\right)=e^x\)</span>). The exponential family includes the normal, exponential, gamma, beta, Poisson, and many others.</p>
<p>The exponential distribution is parameterized by a single rate parameter, <span class="math inline">\(\lambda\)</span>, which describes the number of events occurring per unit time. This means that <span class="math inline">\(\lambda\)</span> must be &gt;0. This is exactly the same as the rate parameter <em>r</em> sometimes used to describe the gamma distribution. The mean of an exponential distribution <em>X</em> is:</p>
<p><span class="math display">\[\mu\left(X\right)=\frac{1}{\lambda}\]</span></p>
<p>and the variance is:</p>
<p><span class="math display">\[\sigma^2\left(X\right)=\frac{1}{\lambda^2}\]</span></p>
<p>Interestingly, this implies that the standard deviation <span class="math inline">\(\sigma\)</span> is the same as the mean <span class="math inline">\(\mu\)</span>. Contrast this with the Poisson distribution, where the <em>variance</em> <span class="math inline">\(\sigma^2\)</span> is the same as the mean. Thus, the CV of the exponential distribution is always 1.</p>
<p>The exponential distribution is supported for all non-negative real numbers; i.e., the half-open interval [0, <span class="math inline">\(+\infty\)</span>). Like the gamma distribution, the exponential distribution can be used to model biological processes for which its mechanistic description makes sense (e.g., waiting times or lifespans), or for any situation resulting in primarily 0 or small values and few large values.</p>
<div id="exponential-distribution-in-r" class="section level5" number="4.3.4.7.1">
<h5><span class="header-section-number">4.3.4.7.1</span> Exponential distribution in R</h5>
<p>The exponential distribution is accessed using the <code>_exp</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dexp()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pexp()</code>: Calculates CDF up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qexp()</code>.</li>
<li><code>qexp()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pexp()</code>.</li>
<li><code>rexp()</code>: Draws random numbers from the exponential distribution.</li>
</ul>
</div>
</div>
<div id="triangular-distribution" class="section level4" number="4.3.4.8">
<h4><span class="header-section-number">4.3.4.8</span> Triangular distribution</h4>
<p>The <strong>triangular distribution</strong> is sometimes called the “distribution of ignorance” or “lack of knowledge distribution”. Sometimes we need to model a process about which we have very little information. For example, we may want to simulate population dynamics without knowing a key survival rate, or organismal growth without knowing a key growth constant. In these situations we might have only a vague idea of how a parameter or an outcome are distributed. At a minimum, we can usually infer or estimate the range and central tendency of a variable. Those are enough to estimate a triangular distribution.</p>
<p>The triangular distribution is parameterized by three parameters: the lower limit <em>a</em>, the upper limit <em>b</em>, and the mode (most common value) <em>c</em>. Any triangular distribution must satisfy <em>a</em> &lt; <em>b</em> and <em>a</em> <span class="math inline">\(\le\)</span> <em>c</em> <span class="math inline">\(\le\)</span> <em>b</em>.</p>
<p>The mean of a triangular distribution <em>X</em> is the mean of its parameters:</p>
<p><span class="math display">\[\mu\left(X\right)=\frac{a+b+c}{3}\]</span></p>
<p>and the variance is</p>
<p><span class="math display">\[\sigma^2\left(X\right)=\frac{a^2+b^2+c^2-ab-ac-bc}{18}\]</span></p>
<p>In addition to serving as a stand-in distribution when data are scarce, the triangular distribution can arise in several natural situations. For example, the mean of two standard uniform variables follows a triangular distribution (see below).</p>
<div id="triangular-distribution-in-r" class="section level5" number="4.3.4.8.1">
<h5><span class="header-section-number">4.3.4.8.1</span> Triangular distribution in R</h5>
<p>The triangular distribution is available in the add-on package “triangle” <span class="citation">(<a href="#ref-carnell2019" role="doc-biblioref">Carnell 2019</a>)</span>. The triangular distribution is accessed using the <code>_triangle</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dtriangle()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>ptriangle()</code>: Calculates CDF up <em>a</em> to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qtriangle()</code>.</li>
<li><code>qtriangle()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>ptriangle()</code>.</li>
<li><code>rtriangle()</code>: Draws random numbers from the triangular distribution.</li>
</ul>
<p>The code below shows the PDFs of various triangular distributions. Notice that <code>c</code> is not used as a variable name, to avoid potentially masking the very critical R function <code>c</code>.</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="mod-04.html#cb956-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(triangle)</span></code></pre></div>
<pre><code>## Warning: package &#39;triangle&#39; was built under R version 4.1.2</code></pre>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="mod-04.html#cb958-1" aria-hidden="true" tabindex="-1"></a>ax <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb958-2"><a href="mod-04.html#cb958-2" aria-hidden="true" tabindex="-1"></a>bx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">7</span>)</span>
<span id="cb958-3"><a href="mod-04.html#cb958-3" aria-hidden="true" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb958-4"><a href="mod-04.html#cb958-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb958-5"><a href="mod-04.html#cb958-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(ax[<span class="dv">1</span>], bx[<span class="dv">1</span>], <span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb958-6"><a href="mod-04.html#cb958-6" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(ax[<span class="dv">2</span>], bx[<span class="dv">2</span>], <span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb958-7"><a href="mod-04.html#cb958-7" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(ax[<span class="dv">3</span>], bx[<span class="dv">3</span>], <span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb958-8"><a href="mod-04.html#cb958-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dtriangle</span>(x1, ax[<span class="dv">1</span>], bx[<span class="dv">1</span>], cx[<span class="dv">1</span>])</span>
<span id="cb958-9"><a href="mod-04.html#cb958-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dtriangle</span>(x2, ax[<span class="dv">2</span>], bx[<span class="dv">2</span>], cx[<span class="dv">2</span>])</span>
<span id="cb958-10"><a href="mod-04.html#cb958-10" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dtriangle</span>(x3, ax[<span class="dv">3</span>], bx[<span class="dv">3</span>], cx[<span class="dv">3</span>])</span>
<span id="cb958-11"><a href="mod-04.html#cb958-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb958-12"><a href="mod-04.html#cb958-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb958-13"><a href="mod-04.html#cb958-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb958-14"><a href="mod-04.html#cb958-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x2, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb958-15"><a href="mod-04.html#cb958-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x3, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb958-16"><a href="mod-04.html#cb958-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Tri(1, 5, 3)&quot;</span>, <span class="st">&quot;Tri(1, 10, 3)&quot;</span>, <span class="st">&quot;Tri(3, 7, 6)&quot;</span>), </span>
<span id="cb958-17"><a href="mod-04.html#cb958-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-362-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The code below demonstrates how a triangular distribution can arise as the distribution of means of two standard uniform variables x1 and x2. The command density estimates the kernel density estimate of a vector. The kernel density estimate is an empirical estimate of the PDF of a variable.</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="mod-04.html#cb959-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb959-2"><a href="mod-04.html#cb959-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb959-3"><a href="mod-04.html#cb959-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(n))</span>
<span id="cb959-4"><a href="mod-04.html#cb959-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb959-5"><a href="mod-04.html#cb959-5" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> (<span class="fu">runif</span>(n[i]) <span class="sc">+</span> <span class="fu">runif</span>(n[i]))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb959-6"><a href="mod-04.html#cb959-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb959-7"><a href="mod-04.html#cb959-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb959-8"><a href="mod-04.html#cb959-8" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">density</span>(x[[i]])</span>
<span id="cb959-9"><a href="mod-04.html#cb959-9" aria-hidden="true" tabindex="-1"></a>    x1[[i]] <span class="ot">&lt;-</span> z<span class="sc">$</span>x</span>
<span id="cb959-10"><a href="mod-04.html#cb959-10" aria-hidden="true" tabindex="-1"></a>    y[[i]] <span class="ot">&lt;-</span> z<span class="sc">$</span>y</span>
<span id="cb959-11"><a href="mod-04.html#cb959-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb959-12"><a href="mod-04.html#cb959-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb959-13"><a href="mod-04.html#cb959-13" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">3</span>)</span>
<span id="cb959-14"><a href="mod-04.html#cb959-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1[[<span class="dv">1</span>]], y[[<span class="dv">1</span>]], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">1</span>],</span>
<span id="cb959-15"><a href="mod-04.html#cb959-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Kernel density estimate&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb959-16"><a href="mod-04.html#cb959-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb959-17"><a href="mod-04.html#cb959-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(x1[[i]], y[[i]], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[i])</span>
<span id="cb959-18"><a href="mod-04.html#cb959-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb959-19"><a href="mod-04.html#cb959-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;n=100&quot;</span>, <span class="st">&quot;n=1000&quot;</span>, <span class="st">&quot;n=10000&quot;</span>),</span>
<span id="cb959-20"><a href="mod-04.html#cb959-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-363-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="distributions-summary" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Distributions summary</h3>
<p>The table below summarizes some the key features of the <strong>discrete distributions</strong> we explored in this module.</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution</th>
<th>Support</th>
<th>What it models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bernoulli</td>
<td>0 or 1</td>
<td>Outcome of a single binary trial</td>
</tr>
<tr class="even">
<td>Binomial</td>
<td>[0, <em>n</em>]</td>
<td>Number of successes in <em>n</em> trials with constant probability <em>p</em>.</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Number of events occurring independently at constant rate (i.e., count data)</td>
</tr>
<tr class="even">
<td>Negative binomial</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Number of failures until a success; or, counts with overdispersion</td>
</tr>
<tr class="odd">
<td>Geometric</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Number of trials until a single failure with constant probability</td>
</tr>
<tr class="even">
<td>Beta-binomial</td>
<td>[0, <em>n</em>]</td>
<td>Number of successes in <em>n</em> trials, with varying <em>p</em>.</td>
</tr>
<tr class="odd">
<td>Multinomial</td>
<td>[0, <em>n</em>] for each <em>x<sub>i</sub></em>, with sum(<em>x<sub>i</sub></em>) = <em>n</em></td>
<td>Number of counts <em>x<sub>i</sub></em> in <em>k</em> categories out of <em>n</em> trials.</td>
</tr>
</tbody>
</table>
<p>The table below summarizes some the key features of the <strong>continuous distributions</strong> we explored in this module.</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution</th>
<th>Support</th>
<th>What it models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Uniform</td>
<td>[min, max]</td>
<td>Continuous variables where all values are equally likely.</td>
</tr>
<tr class="even">
<td>Normal</td>
<td>[<span class="math inline">\(-\infty\)</span>, <span class="math inline">\(+\infty\)</span>]</td>
<td>Many natural processes</td>
</tr>
<tr class="odd">
<td>Lognormal</td>
<td>(0, <span class="math inline">\(+\infty\)</span>)</td>
<td>Many processes that are normally distributed on log scale; values arising from multiplicative processes</td>
</tr>
<tr class="even">
<td>Gamma</td>
<td>(0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Waiting times until an event occurs</td>
</tr>
<tr class="odd">
<td>Beta</td>
<td>[0, 1]</td>
<td>Probabilities of single events (i.e., probabilities for binomial processes)</td>
</tr>
<tr class="even">
<td>Dirichlet</td>
<td>[0, 1] for each <em>x<sub>i</sub></em>, and sum(<em>x<sub>i</sub></em>) = 1</td>
<td>Probabilities of multiple events (i.e., probabilities for multinomial processes)</td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Waiting times between events</td>
</tr>
<tr class="even">
<td>Triangular</td>
<td>[min, max]</td>
<td>Continuous variables about which little is known; requires minimum, maximum, and mode.</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="mod-04-dists2" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Fitting and testing distributions</h2>
<p>Deciding what probability distribution to use to analyze your data is an important step in biological data analysis. The next step is to see how well your data actually match a distribution. This page demonstrates ways to compare data to probability distributions. We will also explore some methods to explicitly test whether or not a set of values came from a particular distribution.</p>
<div id="estimating-distributional-parameters" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Estimating distributional parameters</h3>
<p>The function <code>fitdistr()</code> in package <code>MASS</code> estimates the <strong>parameters</strong> of a distribution most likely to produce random variables supplied as input. Simply put, if you have a variable <em>x</em> and want to know what parameters of some distribution are most likely to produce <em>x</em>, then <code>fitdistr()</code> will estimate this for you. The method of estimation is called <strong>maximum-likelihood</strong>, which we will explore in more detail later. Examples of distribution fitting are shown below. Note that for the beta distribution, starting values for the fitting function must be supplied. This is because for this distribution the parameter estimation process is stochastic and iterative and needs somewhere to start.</p>
<p>The function <code>fitdistr()</code> is in the package <code>MASS</code>, which is short for “Modern Applied Statistics with S”. This widely used package implements many methods described in the textbook of the same name <span class="citation">(<a href="#ref-venables2002" role="doc-biblioref">Venables and Ripley 2002</a>)</span>. The titular language S was a precursor language to R.</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="mod-04.html#cb960-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb960-2"><a href="mod-04.html#cb960-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb960-3"><a href="mod-04.html#cb960-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb960-4"><a href="mod-04.html#cb960-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb960-5"><a href="mod-04.html#cb960-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb960-6"><a href="mod-04.html#cb960-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb960-7"><a href="mod-04.html#cb960-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(x1, <span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<pre><code>##       mean          sd    
##   12.0688071    1.8331290 
##  ( 0.2592436) ( 0.1833129)</code></pre>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="mod-04.html#cb962-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">8</span>)</span>
<span id="cb962-2"><a href="mod-04.html#cb962-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(x2, <span class="st">&quot;Poisson&quot;</span>)</span></code></pre></div>
<pre><code>##     lambda  
##   8.2200000 
##  (0.4054627)</code></pre>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="mod-04.html#cb964-1" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rgeom</span>(n, <span class="fl">0.7</span>)</span>
<span id="cb964-2"><a href="mod-04.html#cb964-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(x3, <span class="st">&quot;geometric&quot;</span>)</span></code></pre></div>
<pre><code>##       prob   
##   0.90909091 
##  (0.03876377)</code></pre>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb966-1"><a href="mod-04.html#cb966-1" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="dv">2</span>, <span class="fl">0.5</span>)</span>
<span id="cb966-2"><a href="mod-04.html#cb966-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(x4, <span class="st">&quot;beta&quot;</span>, <span class="at">start=</span><span class="fu">list</span>(<span class="at">shape1=</span><span class="dv">1</span>, <span class="at">shape2=</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<pre><code>##     shape1      shape2  
##   2.1520168   0.5070293 
##  (0.4828815) (0.0844015)</code></pre>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="mod-04.html#cb969-1" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(n, <span class="dv">4</span>, <span class="fl">0.2</span>)</span>
<span id="cb969-2"><a href="mod-04.html#cb969-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(x5, <span class="st">&quot;negative binomial&quot;</span>)</span></code></pre></div>
<pre><code>##      size         mu    
##    3.674590   15.660000 
##  ( 0.907684) ( 1.283731)</code></pre>
<p>How did <code>fitdistr()</code> do? Most of the parameter estimates were pretty close to the true values. The estimates generally get closer as the sample size increases. Try increasing <code>n</code> to 500 and rerunning the code above.</p>
</div>
<div id="graphical-methods-for-examining-distributions" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Graphical methods for examining distributions</h3>
<div id="comparing-distributions-with-pdf-or-pmf-plots" class="section level4" number="4.4.2.1">
<h4><span class="header-section-number">4.4.2.1</span> Comparing distributions with PDF or PMF plots</h4>
<p>We can compare the distributions implied by the estimated parameters to the actual data using the quantile or distribution functions. The basic idea is to plot the data distribution, and superimpose the equivalent plots of the hypothetical distributions.</p>
<p>In the example below, we compare the probability mass function (PMF) of a a discrete distribution (e.g., counts) to the PMFs of two possible distributions that might match the data. Note that the PMF of a discrete distribution can be estimated as the proportion of observations that take on each value.</p>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="mod-04.html#cb971-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb971-2"><a href="mod-04.html#cb971-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb971-3"><a href="mod-04.html#cb971-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the counts:</span></span>
<span id="cb971-4"><a href="mod-04.html#cb971-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">100</span>, <span class="at">mu=</span><span class="dv">4</span>, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb971-5"><a href="mod-04.html#cb971-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb971-6"><a href="mod-04.html#cb971-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit parameters for poisson and negative binomial</span></span>
<span id="cb971-7"><a href="mod-04.html#cb971-7" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;Poisson&quot;</span>)</span>
<span id="cb971-8"><a href="mod-04.html#cb971-8" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;negative binomial&quot;</span>)</span>
<span id="cb971-9"><a href="mod-04.html#cb971-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb971-10"><a href="mod-04.html#cb971-10" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate PMFs of candidate distributions across</span></span>
<span id="cb971-11"><a href="mod-04.html#cb971-11" aria-hidden="true" tabindex="-1"></a><span class="co"># range of data</span></span>
<span id="cb971-12"><a href="mod-04.html#cb971-12" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x)</span>
<span id="cb971-13"><a href="mod-04.html#cb971-13" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(xx, f1<span class="sc">$</span>estimate)</span>
<span id="cb971-14"><a href="mod-04.html#cb971-14" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xx, <span class="at">size=</span>f2<span class="sc">$</span>estimate[<span class="st">&quot;size&quot;</span>],</span>
<span id="cb971-15"><a href="mod-04.html#cb971-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">mu=</span>f2<span class="sc">$</span>estimate[<span class="st">&quot;mu&quot;</span>])</span>
<span id="cb971-16"><a href="mod-04.html#cb971-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb971-17"><a href="mod-04.html#cb971-17" aria-hidden="true" tabindex="-1"></a><span class="co"># empirical PMF of counts</span></span>
<span id="cb971-18"><a href="mod-04.html#cb971-18" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">table</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb971-19"><a href="mod-04.html#cb971-19" aria-hidden="true" tabindex="-1"></a>plot.x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(y3))</span>
<span id="cb971-20"><a href="mod-04.html#cb971-20" aria-hidden="true" tabindex="-1"></a>plot.y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(y3)</span>
<span id="cb971-21"><a href="mod-04.html#cb971-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb971-22"><a href="mod-04.html#cb971-22" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb971-23"><a href="mod-04.html#cb971-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb971-24"><a href="mod-04.html#cb971-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb971-25"><a href="mod-04.html#cb971-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb971-26"><a href="mod-04.html#cb971-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(plot.x, plot.y, <span class="at">type=</span><span class="st">&quot;o&quot;</span>, </span>
<span id="cb971-27"><a href="mod-04.html#cb971-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb971-28"><a href="mod-04.html#cb971-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>)</span>
<span id="cb971-29"><a href="mod-04.html#cb971-29" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;o&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb971-30"><a href="mod-04.html#cb971-30" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;o&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb971-31"><a href="mod-04.html#cb971-31" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;Poisson&quot;</span>, <span class="st">&quot;negative binomial&quot;</span>),</span>
<span id="cb971-32"><a href="mod-04.html#cb971-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">16</span>, <span class="at">pt.cex=</span><span class="fl">1.3</span>,</span>
<span id="cb971-33"><a href="mod-04.html#cb971-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-365-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In this example, the data (black) seem to be better described by the negative binomial (blue) than by the Poisson (red).</p>
<p>The example below shows the same procedure applied to a continuous distribution. The only difference is in how the probability density function (PDF) of the data is estimated (note PDF, not PMF). The PDF of a continuous distribution is estimated with function <code>density()</code>. It is a good idea to limit the estimation of density functions to the domain of the data. Keep in mind, however, that different distributions have different limits. If a suspected distribution is supported outside the possible range of the data, then it might not be the right one. The example below illustrates this: the data (<code>x</code>) are all positive, but one of the distributions tested (normal) will produce negative values using the estimated parameters (<code>f1</code>). That alone should lead the researcher in this situation to eliminate the normal as a possibility; the plot only confirms the unsuitability of the normal for modeling <code>x</code>.</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="mod-04.html#cb972-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb972-2"><a href="mod-04.html#cb972-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb972-3"><a href="mod-04.html#cb972-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the data:</span></span>
<span id="cb972-4"><a href="mod-04.html#cb972-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">200</span>, <span class="at">shape=</span><span class="dv">2</span>, <span class="at">scale=</span><span class="dv">20</span>)</span>
<span id="cb972-5"><a href="mod-04.html#cb972-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-366-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="mod-04.html#cb973-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit parameters for poisson and negative binomial</span></span>
<span id="cb973-2"><a href="mod-04.html#cb973-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb973-3"><a href="mod-04.html#cb973-3" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb973-4"><a href="mod-04.html#cb973-4" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="mod-04.html#cb975-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate PMFs of candidate distributions across</span></span>
<span id="cb975-2"><a href="mod-04.html#cb975-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range of data</span></span>
<span id="cb975-3"><a href="mod-04.html#cb975-3" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb975-4"><a href="mod-04.html#cb975-4" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xx, f1<span class="sc">$</span>estimate[<span class="dv">1</span>], f1<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb975-5"><a href="mod-04.html#cb975-5" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dlnorm</span>(xx, f2<span class="sc">$</span>estimate[<span class="dv">1</span>], f2<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb975-6"><a href="mod-04.html#cb975-6" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(xx, <span class="at">shape=</span>f3<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>f3<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb975-7"><a href="mod-04.html#cb975-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb975-8"><a href="mod-04.html#cb975-8" aria-hidden="true" tabindex="-1"></a><span class="co"># empirical PDF of data</span></span>
<span id="cb975-9"><a href="mod-04.html#cb975-9" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">density</span>(x, <span class="at">from=</span><span class="fu">min</span>(x), <span class="at">to=</span><span class="fu">max</span>(x))</span>
<span id="cb975-10"><a href="mod-04.html#cb975-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb975-11"><a href="mod-04.html#cb975-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb975-12"><a href="mod-04.html#cb975-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb975-13"><a href="mod-04.html#cb975-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb975-14"><a href="mod-04.html#cb975-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb975-15"><a href="mod-04.html#cb975-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dx<span class="sc">$</span>x, dx<span class="sc">$</span>y,</span>
<span id="cb975-16"><a href="mod-04.html#cb975-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.025</span>),</span>
<span id="cb975-17"><a href="mod-04.html#cb975-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>)</span>
<span id="cb975-18"><a href="mod-04.html#cb975-18" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>, <span class="at">line=</span><span class="dv">4</span>)</span>
<span id="cb975-19"><a href="mod-04.html#cb975-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb975-20"><a href="mod-04.html#cb975-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb975-21"><a href="mod-04.html#cb975-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb975-22"><a href="mod-04.html#cb975-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb975-23"><a href="mod-04.html#cb975-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;lognormal&quot;</span>, <span class="st">&quot;gamma&quot;</span>),</span>
<span id="cb975-24"><a href="mod-04.html#cb975-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</span>
<span id="cb975-25"><a href="mod-04.html#cb975-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-366-2.png" width="576" style="display: block; margin: auto;" /></p>
<p>The plot suggests that the data are better described by a gamma distribution than by a normal or lognormal. This is because the curve for the data is most closely matched by the curve for the gamma. Try adjusting the sample size in the example above (e.g., <code>n &lt;- 50</code>) and see if the correct distribution always matches the data.</p>
</div>
<div id="comparing-distributions-using-cdf-and-ecdf" class="section level4" number="4.4.2.2">
<h4><span class="header-section-number">4.4.2.2</span> Comparing distributions using CDF and ECDF</h4>
<p>Another way to compare data to distributions is with the cumulative distribution function (CDF). The basic idea is the same as using density functions: compare the empirical CDF (ECDF) of the data to the CDFs potential distributions and judge which one best matches the data.</p>
<p>The example below shows how to use ECDF and CDF to compare a continuous distribution to various target distributions.</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="mod-04.html#cb976-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb976-2"><a href="mod-04.html#cb976-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-3"><a href="mod-04.html#cb976-3" aria-hidden="true" tabindex="-1"></a><span class="co"># make the data:</span></span>
<span id="cb976-4"><a href="mod-04.html#cb976-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb976-5"><a href="mod-04.html#cb976-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">100</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="dv">4</span>), <span class="at">sdlog=</span><span class="fu">log</span>(<span class="dv">3</span>))</span>
<span id="cb976-6"><a href="mod-04.html#cb976-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-7"><a href="mod-04.html#cb976-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fit some distributions</span></span>
<span id="cb976-8"><a href="mod-04.html#cb976-8" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb976-9"><a href="mod-04.html#cb976-9" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb976-10"><a href="mod-04.html#cb976-10" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb976-11"><a href="mod-04.html#cb976-11" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;exponential&quot;</span>)</span>
<span id="cb976-12"><a href="mod-04.html#cb976-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-13"><a href="mod-04.html#cb976-13" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate density functions over domain of x</span></span>
<span id="cb976-14"><a href="mod-04.html#cb976-14" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb976-15"><a href="mod-04.html#cb976-15" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xx, f1<span class="sc">$</span>estimate[<span class="st">&quot;mean&quot;</span>], f1<span class="sc">$</span>estimate[<span class="st">&quot;sd&quot;</span>])</span>
<span id="cb976-16"><a href="mod-04.html#cb976-16" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">plnorm</span>(xx, f2<span class="sc">$</span>estimate[<span class="st">&quot;meanlog&quot;</span>], f2<span class="sc">$</span>estimate[<span class="st">&quot;sdlog&quot;</span>])</span>
<span id="cb976-17"><a href="mod-04.html#cb976-17" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">pgamma</span>(xx,</span>
<span id="cb976-18"><a href="mod-04.html#cb976-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span>f3<span class="sc">$</span>estimate[<span class="st">&quot;shape&quot;</span>], </span>
<span id="cb976-19"><a href="mod-04.html#cb976-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">rate=</span>f3<span class="sc">$</span>estimate[<span class="st">&quot;rate&quot;</span>])</span>
<span id="cb976-20"><a href="mod-04.html#cb976-20" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">pexp</span>(xx, <span class="at">rate=</span>f4<span class="sc">$</span>estimate[<span class="st">&quot;rate&quot;</span>])</span>
<span id="cb976-21"><a href="mod-04.html#cb976-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-22"><a href="mod-04.html#cb976-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ecdf of data</span></span>
<span id="cb976-23"><a href="mod-04.html#cb976-23" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)(xx)</span>
<span id="cb976-24"><a href="mod-04.html#cb976-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-25"><a href="mod-04.html#cb976-25" aria-hidden="true" tabindex="-1"></a><span class="co"># fancy plot</span></span>
<span id="cb976-26"><a href="mod-04.html#cb976-26" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="fu">rainbow</span>(<span class="dv">4</span>))</span>
<span id="cb976-27"><a href="mod-04.html#cb976-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb976-28"><a href="mod-04.html#cb976-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb976-29"><a href="mod-04.html#cb976-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb976-30"><a href="mod-04.html#cb976-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xx, y5, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,</span>
<span id="cb976-31"><a href="mod-04.html#cb976-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;(E)CDF&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span>cols[<span class="dv">1</span>])</span>
<span id="cb976-32"><a href="mod-04.html#cb976-32" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">2</span>])</span>
<span id="cb976-33"><a href="mod-04.html#cb976-33" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">3</span>])</span>
<span id="cb976-34"><a href="mod-04.html#cb976-34" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">4</span>])</span>
<span id="cb976-35"><a href="mod-04.html#cb976-35" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">5</span>])</span>
<span id="cb976-36"><a href="mod-04.html#cb976-36" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb976-37"><a href="mod-04.html#cb976-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;ECDF(data)&quot;</span>, <span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;Lognormal&quot;</span>, <span class="st">&quot;Gamma&quot;</span>, <span class="st">&quot;Exponential&quot;</span>), </span>
<span id="cb976-38"><a href="mod-04.html#cb976-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-367-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In this example, the ECDF of the original data (black) appears to best match the lognormal (green)—as well it should, because the data came from a lognormal distribution. The normal (red) is clearly inappropriate because it diverges from the actual data over most of the range of the data. The gamma and exponential are each better than the normal, but not as close to the data as the lognormal.</p>
</div>
<div id="comparing-distributions-using-qq-plots" class="section level4" number="4.4.2.3">
<h4><span class="header-section-number">4.4.2.3</span> Comparing distributions using QQ plots</h4>
<p>Finally, you can use <strong>quantile-quantile (QQ) plots</strong> to compare data to different distributions that you suspect they may follow. The example below uses a QQ plot instead of ECDF as seen above.</p>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb977-1"><a href="mod-04.html#cb977-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb977-2"><a href="mod-04.html#cb977-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb977-3"><a href="mod-04.html#cb977-3" aria-hidden="true" tabindex="-1"></a><span class="co"># true distribution: lognormal</span></span>
<span id="cb977-4"><a href="mod-04.html#cb977-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb977-5"><a href="mod-04.html#cb977-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(n, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="dv">4</span>), <span class="at">sdlog=</span><span class="fu">log</span>(<span class="dv">3</span>))</span>
<span id="cb977-6"><a href="mod-04.html#cb977-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb977-7"><a href="mod-04.html#cb977-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate distributional parameters</span></span>
<span id="cb977-8"><a href="mod-04.html#cb977-8" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb977-9"><a href="mod-04.html#cb977-9" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb977-10"><a href="mod-04.html#cb977-10" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb977-11"><a href="mod-04.html#cb977-11" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;exponential&quot;</span>)</span>
<span id="cb977-12"><a href="mod-04.html#cb977-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb977-13"><a href="mod-04.html#cb977-13" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles of reference distribution</span></span>
<span id="cb977-14"><a href="mod-04.html#cb977-14" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(n)</span>
<span id="cb977-15"><a href="mod-04.html#cb977-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb977-16"><a href="mod-04.html#cb977-16" aria-hidden="true" tabindex="-1"></a><span class="co"># define functions to draw from each reference distribution</span></span>
<span id="cb977-17"><a href="mod-04.html#cb977-17" aria-hidden="true" tabindex="-1"></a>dfun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qnorm</span>(p, f1<span class="sc">$</span>estimate[<span class="dv">1</span>], f1<span class="sc">$</span>estimate[<span class="dv">2</span>])}</span>
<span id="cb977-18"><a href="mod-04.html#cb977-18" aria-hidden="true" tabindex="-1"></a>dfun2 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qlnorm</span>(p, f2<span class="sc">$</span>estimate[<span class="dv">1</span>], f2<span class="sc">$</span>estimate[<span class="dv">2</span>])}</span>
<span id="cb977-19"><a href="mod-04.html#cb977-19" aria-hidden="true" tabindex="-1"></a>dfun3 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qgamma</span>(p, <span class="at">shape=</span>f3<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb977-20"><a href="mod-04.html#cb977-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">rate=</span>f3<span class="sc">$</span>estimate[<span class="dv">2</span>])}</span>
<span id="cb977-21"><a href="mod-04.html#cb977-21" aria-hidden="true" tabindex="-1"></a>dfun4 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qexp</span>(p, f4<span class="sc">$</span>estimate)}</span>
<span id="cb977-22"><a href="mod-04.html#cb977-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb977-23"><a href="mod-04.html#cb977-23" aria-hidden="true" tabindex="-1"></a><span class="co"># get values at each reference quantile</span></span>
<span id="cb977-24"><a href="mod-04.html#cb977-24" aria-hidden="true" tabindex="-1"></a>qy1 <span class="ot">&lt;-</span> <span class="fu">dfun1</span>(qx)</span>
<span id="cb977-25"><a href="mod-04.html#cb977-25" aria-hidden="true" tabindex="-1"></a>qy2 <span class="ot">&lt;-</span> <span class="fu">dfun2</span>(qx)</span>
<span id="cb977-26"><a href="mod-04.html#cb977-26" aria-hidden="true" tabindex="-1"></a>qy3 <span class="ot">&lt;-</span> <span class="fu">dfun3</span>(qx)</span>
<span id="cb977-27"><a href="mod-04.html#cb977-27" aria-hidden="true" tabindex="-1"></a>qy4 <span class="ot">&lt;-</span> <span class="fu">dfun4</span>(qx)</span>
<span id="cb977-28"><a href="mod-04.html#cb977-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb977-29"><a href="mod-04.html#cb977-29" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb977-30"><a href="mod-04.html#cb977-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb977-31"><a href="mod-04.html#cb977-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb977-32"><a href="mod-04.html#cb977-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb977-33"><a href="mod-04.html#cb977-33" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qy1, x, <span class="at">main=</span><span class="st">&quot;Normal&quot;</span>)</span>
<span id="cb977-34"><a href="mod-04.html#cb977-34" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun1, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb977-35"><a href="mod-04.html#cb977-35" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qy2, x, <span class="at">main=</span><span class="st">&quot;Lognormal&quot;</span>)</span>
<span id="cb977-36"><a href="mod-04.html#cb977-36" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun2, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb977-37"><a href="mod-04.html#cb977-37" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qy3, x, <span class="at">main=</span><span class="st">&quot;Gamma&quot;</span>)</span>
<span id="cb977-38"><a href="mod-04.html#cb977-38" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun3, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb977-39"><a href="mod-04.html#cb977-39" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qy4, x, <span class="at">main=</span><span class="st">&quot;Exponential&quot;</span>)</span>
<span id="cb977-40"><a href="mod-04.html#cb977-40" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun4, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-368-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The figure shows that the normal is clearly inappropriate because the points do not fall on the line. The gamma and exponential are okay over most of the domain of x, but depart for large values. The lognormal plot (top right) shows the best match between the data and the reference distribution.</p>
<p>It is important to keep in mind that the comparisons we’ve made here are of idealized cases. Real data are often much messier and noisier than the distributions used in these examples. Sometimes real data are best characterized by mixture distributions for which there are no straightforward ways to estimate parameters. Still, the steps outlined above for estimating distributional parameters and comparing to idealized distributions are important first steps in data analysis.</p>
</div>
</div>
<div id="formal-tests-for-distributions" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Formal tests for distributions</h3>
<div id="tests-for-normality" class="section level4" number="4.4.3.1">
<h4><span class="header-section-number">4.4.3.1</span> Tests for normality</h4>
<p>The normal distribution is so important for so many statistical methods that people have developed tests to formally determine whether data come from a normal distribution. The most common test for normality is the <strong>Shapiro-Wilk test</strong>. The Shapiro-Wilk test tests the null hypothesis that a sample <em>x</em><sub>1</sub>, …, <em>x</em><sub><em>n</em></sub> comes from a normally distributed population. The test statistic <em>W</em> is calculated as:</p>
<p><span class="math display">\[W=\frac{\left(\sum_{i=1}^{n}{a_ix_{(i)}}\right)^2}{\sum_{i=1}^{n}\left(x_i-\bar{x}\right)^2}\]</span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> is the sample mean, <em>x</em><sub>(<em>i</em>)</sub> is the <em>i</em><sup>th</sup> order statistic, and <em>a<sub>i</sub></em> is a coefficient related to expected values of <em>i.i.d.</em> normal variables. When the null hypothesis of a Shapiro-Wilk test is rejected, then there is evidence that the data are not normally distributed. The code below shows some examples of the Shapiro-Wilk test in R.</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="mod-04.html#cb978-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb978-2"><a href="mod-04.html#cb978-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb978-3"><a href="mod-04.html#cb978-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(x1)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x1
## W = 0.96858, p-value = 0.7247</code></pre>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="mod-04.html#cb980-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="dv">10</span>)</span>
<span id="cb980-2"><a href="mod-04.html#cb980-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(x2)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x2
## W = 0.90741, p-value = 0.0569</code></pre>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="mod-04.html#cb982-1" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span>
<span id="cb982-2"><a href="mod-04.html#cb982-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(x3)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x3
## W = 0.9316, p-value = 0.1658</code></pre>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="mod-04.html#cb984-1" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb984-2"><a href="mod-04.html#cb984-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(x4)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x4
## W = 0.96392, p-value = 0.007723</code></pre>
<p>Interestingly, the Shapiro-Wilk test turns out to be very powerful. That is, it can detect very small differences from the null hypothesis (i.e., normality) if the sample size is large enough. So, if you have data that you suspect are normal, but the Shapiro-Wilk test says otherwise, you need to visually inspect the data to determine how serious the departure from normality is. Another situation where the Shapiro-Wilk test does not perform well is when data with many repeated values. Consider the following example:</p>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="mod-04.html#cb986-1" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat each value 3 times</span></span>
<span id="cb986-2"><a href="mod-04.html#cb986-2" aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">3</span>), <span class="at">each=</span><span class="dv">3</span>) </span>
<span id="cb986-3"><a href="mod-04.html#cb986-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb986-4"><a href="mod-04.html#cb986-4" aria-hidden="true" tabindex="-1"></a><span class="co"># P &lt; 0.05, so test says nonnormal</span></span>
<span id="cb986-5"><a href="mod-04.html#cb986-5" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(x6) </span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x6
## W = 0.97026, p-value = 0.1502</code></pre>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="mod-04.html#cb988-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density plot look normal!</span></span>
<span id="cb988-2"><a href="mod-04.html#cb988-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb988-3"><a href="mod-04.html#cb988-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x6))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-370-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="kolmogorov-smirnov-tests" class="section level4" number="4.4.3.2">
<h4><span class="header-section-number">4.4.3.2</span> Kolmogorov-Smirnov tests</h4>
<p>The <strong>Kolmogorov-Smirnov (KS) test</strong> is a non-parametric test that compares a dataset to a distribution. Unlike the Shapiro-Wilk test, which only tests for normality, the KS test can compare data to any distribution. The KS test is useful because it is sensitive to differences in both location (i.e., mean) and shape. The example below illustrates the use of the KS test and plots the distributions.</p>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="mod-04.html#cb989-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e2</span></span>
<span id="cb989-2"><a href="mod-04.html#cb989-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb989-3"><a href="mod-04.html#cb989-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb989-4"><a href="mod-04.html#cb989-4" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">2</span>)</span>
<span id="cb989-5"><a href="mod-04.html#cb989-5" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">20</span>)</span>
<span id="cb989-6"><a href="mod-04.html#cb989-6" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">14</span>)</span>
<span id="cb989-7"><a href="mod-04.html#cb989-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb989-8"><a href="mod-04.html#cb989-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run KS tests:</span></span>
<span id="cb989-9"><a href="mod-04.html#cb989-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x1, x2)</span></code></pre></div>
<pre><code>## 
##  Two-sample Kolmogorov-Smirnov test
## 
## data:  x1 and x2
## D = 0.12, p-value = 0.4676
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="mod-04.html#cb991-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x1, x3)</span></code></pre></div>
<pre><code>## 
##  Two-sample Kolmogorov-Smirnov test
## 
## data:  x1 and x3
## D = 0.64, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="mod-04.html#cb993-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x3, x4)</span></code></pre></div>
<pre><code>## 
##  Two-sample Kolmogorov-Smirnov test
## 
## data:  x3 and x4
## D = 0.41, p-value = 1.001e-07
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="mod-04.html#cb995-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x3, x5)</span></code></pre></div>
<pre><code>## Warning in ks.test(x3, x5): p-value will be approximate in the presence of ties</code></pre>
<pre><code>## 
##  Two-sample Kolmogorov-Smirnov test
## 
## data:  x3 and x5
## D = 0.24, p-value = 0.006302
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb998-1"><a href="mod-04.html#cb998-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot</span></span>
<span id="cb998-2"><a href="mod-04.html#cb998-2" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb998-3"><a href="mod-04.html#cb998-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x1)(xx)</span>
<span id="cb998-4"><a href="mod-04.html#cb998-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x2)(xx)</span>
<span id="cb998-5"><a href="mod-04.html#cb998-5" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x3)(xx)</span>
<span id="cb998-6"><a href="mod-04.html#cb998-6" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x4)(xx)</span>
<span id="cb998-7"><a href="mod-04.html#cb998-7" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x5)(xx)</span>
<span id="cb998-8"><a href="mod-04.html#cb998-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb998-9"><a href="mod-04.html#cb998-9" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">5</span>)</span>
<span id="cb998-10"><a href="mod-04.html#cb998-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb998-11"><a href="mod-04.html#cb998-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>,</span>
<span id="cb998-12"><a href="mod-04.html#cb998-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>)</span>
<span id="cb998-13"><a href="mod-04.html#cb998-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb998-14"><a href="mod-04.html#cb998-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ECDF&quot;</span>, <span class="at">col=</span>cols[<span class="dv">1</span>])</span>
<span id="cb998-15"><a href="mod-04.html#cb998-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">2</span>])</span>
<span id="cb998-16"><a href="mod-04.html#cb998-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">3</span>])</span>
<span id="cb998-17"><a href="mod-04.html#cb998-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">4</span>])</span>
<span id="cb998-18"><a href="mod-04.html#cb998-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xx, y5, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">5</span>])</span>
<span id="cb998-19"><a href="mod-04.html#cb998-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb998-20"><a href="mod-04.html#cb998-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;N(10,2)&quot;</span>, <span class="st">&quot;N(10,2)&quot;</span>, </span>
<span id="cb998-21"><a href="mod-04.html#cb998-21" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;N(14,2)&quot;</span>, <span class="st">&quot;N(14,20)&quot;</span>, <span class="st">&quot;Pois(14)&quot;</span>),</span>
<span id="cb998-22"><a href="mod-04.html#cb998-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-371-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The KS test results show that distributions <code>x1</code> and <code>x2</code> are not different (<em>P</em> &gt; 0.05). This makes sense because they are both normal distributions with the same mean and SD. Distributions <code>x1</code> and <code>x3</code> are different (<em>P</em> &lt; 0.05) because they have different means (10 vs. 14). Distributions <code>x3</code> and <code>x4</code> were different (<em>P</em> &lt; 0.05) because they had different SD (2 vs. 20). Finally, distributions <code>x3</code> and <code>x5</code> were different (<em>P</em> &lt; 0.05) because they were different distributions with different shapes (normal vs. Poisson).</p>
<p>The KS test can be useful when you want to see how well your data matches up with their theoretical distribution. Consider the example of a lognormally distributed response below. If we suspect that the data come from a lognormal distribution or a gamma distribution, we can use the function <code>fitdistr()</code> to estimate the parameters of a lognormal and a gamma distribution that are most likely to produce those data. Then, we use a KS test to compare the data to the idealized candidates.</p>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="mod-04.html#cb999-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb999-2"><a href="mod-04.html#cb999-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb999-3"><a href="mod-04.html#cb999-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate moments</span></span>
<span id="cb999-4"><a href="mod-04.html#cb999-4" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x1, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb999-5"><a href="mod-04.html#cb999-5" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x1, <span class="st">&quot;gamma&quot;</span>)</span></code></pre></div>
<p>Notice that the parameters from <code>fitdistr()</code> are supplied as arguments to <code>ks.test()</code>, following the name of the distribution we want to compare to. If parameters are not supplied, then R will perform the KS test using the default parameter values (<code>meanlog=0</code> and <code>sdlog=1</code> for <code>plnorm()</code>; none for <code>pgamma()</code>), which is not what we want.</p>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="mod-04.html#cb1000-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x1, <span class="st">&quot;plnorm&quot;</span>, fit1<span class="sc">$</span>estimate[<span class="dv">1</span>], fit1<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x1
## D = 0.058719, p-value = 0.8808
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1002-1"><a href="mod-04.html#cb1002-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x1, <span class="st">&quot;pgamma&quot;</span>, <span class="at">shape=</span>fit2<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb1002-2"><a href="mod-04.html#cb1002-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">rate=</span>fit2<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x1
## D = 0.16211, p-value = 0.01043
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb1004"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1004-1"><a href="mod-04.html#cb1004-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot x1 and its theoretical distribution</span></span>
<span id="cb1004-2"><a href="mod-04.html#cb1004-2" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x1), <span class="fu">max</span>(x1), <span class="at">length=</span><span class="dv">500</span>)</span>
<span id="cb1004-3"><a href="mod-04.html#cb1004-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x1)(xx)</span>
<span id="cb1004-4"><a href="mod-04.html#cb1004-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">plnorm</span>(xx, fit1<span class="sc">$</span>estimate[<span class="dv">1</span>], fit1<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb1004-5"><a href="mod-04.html#cb1004-5" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">pgamma</span>(xx, <span class="at">shape=</span>fit2<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>fit2<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb1004-6"><a href="mod-04.html#cb1004-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1004-7"><a href="mod-04.html#cb1004-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb1004-8"><a href="mod-04.html#cb1004-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>)</span>
<span id="cb1004-9"><a href="mod-04.html#cb1004-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(xx), y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;log(X)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ECDF&quot;</span>)</span>
<span id="cb1004-10"><a href="mod-04.html#cb1004-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">log</span>(xx), y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1004-11"><a href="mod-04.html#cb1004-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">log</span>(xx), y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1004-12"><a href="mod-04.html#cb1004-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb1004-13"><a href="mod-04.html#cb1004-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Lognormal&quot;</span>, <span class="st">&quot;Gamma&quot;</span>),</span>
<span id="cb1004-14"><a href="mod-04.html#cb1004-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb1004-15"><a href="mod-04.html#cb1004-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb1004-16"><a href="mod-04.html#cb1004-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1004-17"><a href="mod-04.html#cb1004-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-373-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>While neither the lognormal distribution nor the gamma distribution are awful at representing the data, the KS test suggests that the simulated data <code>x1</code> come from a lognormal distribution, not a gamma distribution. This is because the KS test was non-significant when comparing the data to the lognormal, and significant (<em>P</em> &lt; 0.05) when comparing the data to the gamma distribution. The test comparing the data to the gamma distribution was, however, close to non-significant (<em>P</em> <span class="math inline">\(\approx\)</span> 0.01). See what happens if you change the random number seed and re-run the random generation and the test.</p>
</div>
</div>
</div>
<div id="mod-04-trans" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Data transformations</h2>
<p>Data transformation is the proces of changing the values in your data according to a function. This is usually done to make the data better conform to the assumptions of a statistical test, or to make graphs easier to interpret. Transformation is done to make patterns easier to detect. In many fields transformations may be standard practice, and with good reason. Just make sure that you understand what the transform function is doing, and most importantly, why you are transforming your data.</p>
<div id="why-transform" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Why transform?</h3>
<p><strong>Data transformation</strong> is the process changing the values of your data according to a function. This is usually done so that the data better conform to the assumptions of a statistical test, or to make graphs of your data more interpretable. The functions that transform data are usually called “transforms”. There are many transforms out there, but only a few are very common in biology. All convert values on the <strong>original scale</strong> to values on the <strong>transformed scale</strong>. Variables often have different properties after a transformation, such as normality, or a different domain, or a different distribution shape. In general, a function for transforming data should be <strong>deterministic</strong> and <strong>invertible</strong>:</p>
<ul>
<li><strong>Deterministic:</strong> means that the function always returns the same transformed value for a given input.</li>
<li><strong>Invertible:</strong> means that values on the transformed scale can be converted unambiguously to values on the original scale. In mathematics such functions are also called “bijections”.</li>
</ul>
<p>Data transformations are commonly used to make data fit certain distributions. For example, consider the figure below:</p>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="mod-04.html#cb1005-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="fl">1.5</span>, <span class="dv">2</span>)</span>
<span id="cb1005-2"><a href="mod-04.html#cb1005-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1005-3"><a href="mod-04.html#cb1005-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(a)</span>
<span id="cb1005-4"><a href="mod-04.html#cb1005-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(a))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-374-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The left panel shows data with mostly small values and a strong positive skew. The right panel shows the same data on the log scale. Notice how the log-transformed values look much more like a normal distribution. This is very important for many statistical methods, which require normality either in the values or in the residuals. The log-transformed plot also lets us see more details about the distribution that are obscured on the original scale.</p>
</div>
<div id="transforms-vs.-link-functions" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Transforms vs. link functions</h3>
<p>In <a href="mod-05.html#mod-05-basic">generalized linear models (GLM)</a> the response variable is modeled on a scale defined by a <strong>link function</strong>. That link function works a little like a transform, and is often confused with a transform, but it is not a transform. The figure below shows an example of this: the response variable on its original scale (right panel), a proportion, is analyzed on the logit scale (left panel). The ranks of observations do not change, but their values do. Additionally, putting the values on another scale can affect the variance of those values.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-375-1.png" width="768" /></p>
<p><em>GLM link functions are not transforms because the variance is still modeled on the original scale</em>. However, when data are transformed and then analyzed, the variance is modeled on the transformed scale. The equations below show the differences between a Gaussian GLM with a link function and an ordinary linear model on transformed data. Notice the difference in how each model includes stochasticity.</p>
<p><strong>Linear model (LM) with transformation</strong></p>
<p><span class="math display">\[y_i = e^{z_i}\]</span></p>
<p><span class="math display">\[ z_i \sim Normal\left(mu_i,\sigma^2 \right)\]</span></p>
<p><span class="math display">\[mu_i = f\left(\theta \right)\]</span></p>
<p><strong>Generalized linear model (GLM) with link function</strong></p>
<p><span class="math display">\[ y_i \sim Normal\left(z_i,\sigma^2 \right) \]</span></p>
<p><span class="math display">\[ z_i = e^{mu_i} \]</span></p>
<p><span class="math display">\[mu_i = f\left(\theta \right)\]</span></p>
<p>In the LM, the expected value <span class="math inline">\(mu_i\)</span> and its variance are both on the log scale. In the GLM, <span class="math inline">\(mu_i\)</span> is on the log scale but the variance in observed values is not. This difference can have important consequences on the estimates of a statistical model. See the example <a href="mod-05.html#mod-05-loglin-examp">here</a> for a worked example.</p>
</div>
<div id="log-transformation" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Log transformation</h3>
<p>The <strong>log-transform</strong> is one of the most common transforms in biology. It is simply the <strong>logarithm of the values</strong><a href="literature-cited.html#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a>. Most biologists use either the natural logarithm (<strong>log<sub><em>e</em></sub></strong>, <strong>ln</strong> or just <strong>log</strong>) or the base-10 logarithm (log<sub>10</sub>). The choice of base is not that important, because any log-transform will accomplish the same effect. The default in math and statistics (and in R) is the natural logarithm. Log<sub>10</sub> is also very common in biology and engineering. It is sometimes called the “common log”, but most people just say “log 10” when referring to this function. Whatever base you use, just be consistent and make it clear to your audience what you did<a href="literature-cited.html#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a>. It is depressingly common to be unable to use values from old papers because they didn’t specify which base logarithm they used.</p>
<p>There are usually two reasons to use a log-transform: normalization (i.e., variance stabilization) and positivity. As seen above, many variables that appear non-normal turn out to be normally distributed on a logarithmic scale. This often occurs when something about the values is multiplicative in nature. For example, body sizes, population sizes, and bank account balances are often log-normally distributed. This is because these quantities tend to grow at a rate that is proportional to their current size . Transforming to the logarithmic scale changes multiplicative changes to additive changes. The figure below shows how values separated by a factor of 2 on the linear scale map to values separated by 1 (i.e., 20) on the log2 scale. Values separated by a common <em>scaling</em> factor on the original scale are mapped to values separated by a common <em>additive</em> constant on the log scale<a href="literature-cited.html#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a>.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_05.jpg" /></p>
<p>As a side effect of this normalization, log-transformation allows researchers to work with variables that vary over several orders of magnitude. This is because scalar multiplication on the untransformed scale is the same as addition on the log-transformed scale<a href="literature-cited.html#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a>. The figure below shows how values ranging from 0.001 to 1000 (spanning 6 orders of magnitude) can be managed on the log-transformed scale.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_06.jpg" /></p>
<p>The second reason that the log-transform is commonly used is to ensure that values are always positive. One of the properties of the exponential function is that for any positive base, raising that base to a real power will always return a positive result. For this reason, it is common practice to analyze variables with a positive domain on the logarithmic scale. Such variables include lengths, masses, and counts, which must be positive or non-negative. Log transformation can ensure that your analysis does not predict impossibilities like negative masses.</p>
<div id="log-transformation-in-r" class="section level4" number="4.5.3.1">
<h4><span class="header-section-number">4.5.3.1</span> Log transformation in R</h4>
<p>Values in a data frame can be log-transformed with the <code>log()</code> (natural log) or <code>log10()</code> (log<sub>10</sub>) function. Other bases can be used via arguments to the <code>log()</code> function (e.g., <code>log(8,base=2)</code>). It is usually a good idea to keep the transformed values in their own variable, rather than overwriting the original values. This way you can quickly access the original values without having to back-transform. It is often useful to have the original values around for making figures. Keeping the original values also means you don’t have to remember whether a variable or object contains the original or transformed values.</p>
<div class="sourceCode" id="cb1006"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1006-1"><a href="mod-04.html#cb1006-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spare copy:</span></span>
<span id="cb1006-2"><a href="mod-04.html#cb1006-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb1006-3"><a href="mod-04.html#cb1006-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1006-4"><a href="mod-04.html#cb1006-4" aria-hidden="true" tabindex="-1"></a><span class="co"># natural log transform:</span></span>
<span id="cb1006-5"><a href="mod-04.html#cb1006-5" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>log.petal.len <span class="ot">&lt;-</span> <span class="fu">log</span>(x<span class="sc">$</span>Petal.Length)</span>
<span id="cb1006-6"><a href="mod-04.html#cb1006-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1006-7"><a href="mod-04.html#cb1006-7" aria-hidden="true" tabindex="-1"></a><span class="co"># log base 10 transform:</span></span>
<span id="cb1006-8"><a href="mod-04.html#cb1006-8" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>log.petal.wid <span class="ot">&lt;-</span> <span class="fu">log10</span>(x<span class="sc">$</span>Petal.Width)</span></code></pre></div>
<p>You can also log-transform many variables at once using the function <code>apply()</code>. In a data frame this means <code>apply</code>-ing the <code>log()</code> function to multiple columns (margin 2).</p>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="mod-04.html#cb1007-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the dataset from package MASS</span></span>
<span id="cb1007-2"><a href="mod-04.html#cb1007-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(crabs, <span class="at">package=</span><span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb1007-3"><a href="mod-04.html#cb1007-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1007-4"><a href="mod-04.html#cb1007-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a spare copy</span></span>
<span id="cb1007-5"><a href="mod-04.html#cb1007-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> crabs</span>
<span id="cb1007-6"><a href="mod-04.html#cb1007-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##   sp sex index   FL  RW   CL   CW  BD
## 1  B   M     1  8.1 6.7 16.1 19.0 7.0
## 2  B   M     2  8.8 7.7 18.1 20.8 7.4
## 3  B   M     3  9.2 7.8 19.0 22.4 7.7
## 4  B   M     4  9.6 7.9 20.1 23.1 8.2
## 5  B   M     5  9.8 8.0 20.3 23.0 8.2
## 6  B   M     6 10.8 9.0 23.0 26.5 9.8</code></pre>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1009-1"><a href="mod-04.html#cb1009-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overwrite (transform in place)</span></span>
<span id="cb1009-2"><a href="mod-04.html#cb1009-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (ok but can cause headaches later)</span></span>
<span id="cb1009-3"><a href="mod-04.html#cb1009-3" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">2</span>, log)</span>
<span id="cb1009-4"><a href="mod-04.html#cb1009-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##   sp sex index       FL       RW       CL       CW       BD
## 1  B   M     1 2.091864 1.902108 2.778819 2.944439 1.945910
## 2  B   M     2 2.174752 2.041220 2.895912 3.034953 2.001480
## 3  B   M     3 2.219203 2.054124 2.944439 3.109061 2.041220
## 4  B   M     4 2.261763 2.066863 3.000720 3.139833 2.104134
## 5  B   M     5 2.282382 2.079442 3.010621 3.135494 2.104134
## 6  B   M     6 2.379546 2.197225 3.135494 3.277145 2.282382</code></pre>
<div class="sourceCode" id="cb1011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1011-1"><a href="mod-04.html#cb1011-1" aria-hidden="true" tabindex="-1"></a><span class="co"># better way:</span></span>
<span id="cb1011-2"><a href="mod-04.html#cb1011-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make new variables and </span></span>
<span id="cb1011-3"><a href="mod-04.html#cb1011-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add to original data frame (better)</span></span>
<span id="cb1011-4"><a href="mod-04.html#cb1011-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> crabs</span>
<span id="cb1011-5"><a href="mod-04.html#cb1011-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">apply</span>(x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">2</span>, log)</span>
<span id="cb1011-6"><a href="mod-04.html#cb1011-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(z)</span>
<span id="cb1011-7"><a href="mod-04.html#cb1011-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(z) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(z), <span class="st">&quot;log&quot;</span>, <span class="at">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb1011-8"><a href="mod-04.html#cb1011-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,z)</span>
<span id="cb1011-9"><a href="mod-04.html#cb1011-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##   sp sex index   FL  RW   CL   CW  BD   FL.log   RW.log   CL.log   CW.log   BD.log
## 1  B   M     1  8.1 6.7 16.1 19.0 7.0 2.091864 1.902108 2.778819 2.944439 1.945910
## 2  B   M     2  8.8 7.7 18.1 20.8 7.4 2.174752 2.041220 2.895912 3.034953 2.001480
## 3  B   M     3  9.2 7.8 19.0 22.4 7.7 2.219203 2.054124 2.944439 3.109061 2.041220
## 4  B   M     4  9.6 7.9 20.1 23.1 8.2 2.261763 2.066863 3.000720 3.139833 2.104134
## 5  B   M     5  9.8 8.0 20.3 23.0 8.2 2.282382 2.079442 3.010621 3.135494 2.104134
## 6  B   M     6 10.8 9.0 23.0 26.5 9.8 2.379546 2.197225 3.135494 3.277145 2.282382</code></pre>
</div>
<div id="log-transforming-with-0-values" class="section level4" number="4.5.3.2">
<h4><span class="header-section-number">4.5.3.2</span> Log transforming with 0 values</h4>
<p>One problem that comes up with log-transformation is what to do with values of 0. The logarithm of 0 is undefined, and returns <span class="math inline">\(-\infty\)</span> in R. This is usually a problem with counts, rather than with measurements. The simplest solution is to add a small constant to the values before transforming. If the smallest nonzero value is 1, then it is easiest to just add 1 to the values:</p>
<p><span class="math display">\[y_i=\log{\left(x_i+1\right)}\]</span></p>
<p>Where <em>x<sub>i</sub></em> is the original value and <em>y<sub>i</sub></em> is the transformed value (i.e., <span class="math inline">\(f\left(x_i\right)\)</span>). Again, this works just fine if the smallest nonzero is about 1. Values between 0 and 1 can cause problems. Adding 1 to these values before log-transforming will tend to compress the lower end of the distribution and expand the upper end of the distribution. The R commands below show this:</p>
<div class="sourceCode" id="cb1013"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1013-1"><a href="mod-04.html#cb1013-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.003</span>, <span class="fl">0.03</span>, <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="fl">1.3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">99</span>)</span>
<span id="cb1013-2"><a href="mod-04.html#cb1013-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">log</span>(x<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb1013-3"><a href="mod-04.html#cb1013-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-378-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>If the smallest nonzero value differs from 1 by more than an order of magnitude (i.e., <span class="math inline">\(\ge\)</span> 10 or <span class="math inline">\(\le\)</span> 0.1), then a slightly different procedure is called for. The transformation below generalizes the “log of <em>x</em>+1” method in such a way as to result in 0 for 0 values and somewhat preserve the original orders of magnitude <span class="citation">(<a href="#ref-mccune2002analysis" role="doc-biblioref">McCune et al. 2002</a>)</span>.</p>
<p><span class="math display">\[y_i=\log{\left(x_i+d\right)}-c\]</span>
In this equation:</p>
<p><span class="math display">\[\begin{matrix}c=&amp;Trunc\left(\log{\left(min\left(x\right)\right)}\right)\\d=&amp;e^c\\min\left(x\right)=&amp;smallest\ nonzero\ x\\Trunc\left(x\right)=&amp;function\ that\ truncates\ x\ to\ an\ integer\\\end{matrix}\]</span></p>
<p>This can be implemented in R using the following custom function:</p>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="mod-04.html#cb1014-1" aria-hidden="true" tabindex="-1"></a>mgtrans <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1014-2"><a href="mod-04.html#cb1014-2" aria-hidden="true" tabindex="-1"></a>    minx <span class="ot">&lt;-</span> <span class="fu">min</span>(x[x <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb1014-3"><a href="mod-04.html#cb1014-3" aria-hidden="true" tabindex="-1"></a>    cons <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="fu">log</span>(minx))</span>
<span id="cb1014-4"><a href="mod-04.html#cb1014-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="fu">exp</span>(cons)) <span class="sc">-</span> cons</span>
<span id="cb1014-5"><a href="mod-04.html#cb1014-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb1014-6"><a href="mod-04.html#cb1014-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1014-7"><a href="mod-04.html#cb1014-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1014-8"><a href="mod-04.html#cb1014-8" aria-hidden="true" tabindex="-1"></a><span class="co"># example usage:</span></span>
<span id="cb1014-9"><a href="mod-04.html#cb1014-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">rlnorm</span>(<span class="dv">9</span>))</span>
<span id="cb1014-10"><a href="mod-04.html#cb1014-10" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(a)</span></code></pre></div>
<pre><code>##  [1]         -Inf  1.025571370 -0.284773007 -1.220717712  0.181303480 -0.138891362  0.005764186  0.385280401 -0.370660032  0.644376549</code></pre>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="mod-04.html#cb1016-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mgtrans</span>(a)</span></code></pre></div>
<pre><code>##  [1] 0.0000000 2.1494853 1.1133862 0.5888655 1.4489449 1.2136603 1.3174789 1.6086268 1.0565297 1.8209591</code></pre>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="mod-04.html#cb1018-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count the points:</span></span>
<span id="cb1018-2"><a href="mod-04.html#cb1018-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1018-3"><a href="mod-04.html#cb1018-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="fu">log</span>(a))     <span class="co"># missing one!</span></span>
<span id="cb1018-4"><a href="mod-04.html#cb1018-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="fu">mgtrans</span>(a))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-379-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Note that if you use the McCune and Grace transform, you should keep the original values around for plotting because back-transforming can be tricky (if not impossible, if you don’t know <em>d</em> and <em>c</em>). If you are going to back-transform other values, such as model predictions, you will need to know <em>d</em> and <em>c</em>.</p>
<p>The example below shows how the McCune and Grace transform can be advantageous. First, we create 1000 random values from a lognormal distribution. Then, randomly set 100 of the values to 0. Log-transforming the data to acheive normality comes at the cost of losing 10% of the values because <code>log(0)</code> is undefined (left panel). The <span class="math inline">\(log\left(x+1\right)\)</span> transform retains all of the values, but distorts the shape of the distribution (middle panel) because many values are between 0 and 1. The McCune and Grace method (right panel) achieves normality (mostly) <em>and</em> retains all values.</p>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1019-1"><a href="mod-04.html#cb1019-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1019-2"><a href="mod-04.html#cb1019-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb1019-3"><a href="mod-04.html#cb1019-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(n, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb1019-4"><a href="mod-04.html#cb1019-4" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1019-5"><a href="mod-04.html#cb1019-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1019-6"><a href="mod-04.html#cb1019-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1019-7"><a href="mod-04.html#cb1019-7" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb1019-8"><a href="mod-04.html#cb1019-8" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">log</span>(x<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb1019-9"><a href="mod-04.html#cb1019-9" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">mgtrans</span>(x)</span>
<span id="cb1019-10"><a href="mod-04.html#cb1019-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1019-11"><a href="mod-04.html#cb1019-11" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.finite</span>(t1)))</span></code></pre></div>
<pre><code>## [1] 900</code></pre>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1021-1"><a href="mod-04.html#cb1021-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">cex.main=</span><span class="fl">1.2</span>)</span>
<span id="cb1021-2"><a href="mod-04.html#cb1021-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t1, <span class="at">main=</span><span class="fu">expression</span>(Log<span class="sc">~</span>transform<span class="sc">~</span>(<span class="fu">italic</span>(n)<span class="sc">==</span><span class="dv">900</span>)))</span>
<span id="cb1021-3"><a href="mod-04.html#cb1021-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t2, <span class="at">main=</span><span class="fu">expression</span>(Log<span class="sc">~</span>(<span class="fu">italic</span>(x)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">~</span>transform<span class="sc">~</span>(<span class="fu">italic</span>(n)<span class="sc">==</span><span class="dv">1000</span>)))</span>
<span id="cb1021-4"><a href="mod-04.html#cb1021-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t3, <span class="at">main=</span><span class="fu">expression</span>(McCune<span class="sc">-</span>Grace<span class="sc">~</span>transform<span class="sc">~</span>(<span class="fu">italic</span>(n)<span class="sc">==</span><span class="dv">1000</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-380-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The spike in the right histogram comes from the fact that the McCune and Grace method maps values of 0 to 0.</p>
</div>
</div>
<div id="rank-transformation" class="section level3" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Rank transformation</h3>
<p>The <strong>rank transform</strong> is just what it sounds like: replacing original values with their ranks. In R the function <code>rank()</code> does just that. Smaller values having smaller ranks and greater values having greater ranks. The smallest value maps to value 1 and the largest value maps to the number of values. That is, for any vector x <code>rank(x)[x==min(x)]</code> = 1 and <code>rank(x)[x==max(x)]</code> = <code>length(x)</code>.</p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1022-1"><a href="mod-04.html#cb1022-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb1022-2"><a href="mod-04.html#cb1022-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rank</span>(x)</span>
<span id="cb1022-3"><a href="mod-04.html#cb1022-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-381-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Notice how the transformed variables <code>y</code> are evenly spaced while the original values are not. This can be useful if values are very “clumped” or “spread out”. Rank transforms are commonly used in nonparametric procedures. Note that the <code>rank()</code> function may return fractional or repeated ranks if there are ties:</p>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1023-1"><a href="mod-04.html#cb1023-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make some random values</span></span>
<span id="cb1023-2"><a href="mod-04.html#cb1023-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb1023-3"><a href="mod-04.html#cb1023-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1023-4"><a href="mod-04.html#cb1023-4" aria-hidden="true" tabindex="-1"></a><span class="co"># force a tie</span></span>
<span id="cb1023-5"><a href="mod-04.html#cb1023-5" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb1023-6"><a href="mod-04.html#cb1023-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1023-7"><a href="mod-04.html#cb1023-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fractional ranks for ties:</span></span>
<span id="cb1023-8"><a href="mod-04.html#cb1023-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rank</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1.5  1.5  4.0  6.0  7.0  9.0  5.0 10.0  8.0  3.0</code></pre>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1025-1"><a href="mod-04.html#cb1025-1" aria-hidden="true" tabindex="-1"></a><span class="co"># force a three-way tie:</span></span>
<span id="cb1025-2"><a href="mod-04.html#cb1025-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">3</span>] <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb1025-3"><a href="mod-04.html#cb1025-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1025-4"><a href="mod-04.html#cb1025-4" aria-hidden="true" tabindex="-1"></a><span class="co"># repeated ranks:</span></span>
<span id="cb1025-5"><a href="mod-04.html#cb1025-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rank</span>(x)</span></code></pre></div>
<pre><code>##  [1]  2  2  2  6  7  9  5 10  8  4</code></pre>
</div>
<div id="other-transforms-less-common" class="section level3" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Other transforms (less common)</h3>
<div id="square-root-transformation" class="section level4" number="4.5.5.1">
<h4><span class="header-section-number">4.5.5.1</span> Square-root transformation</h4>
<p><strong>Square-root transforms</strong> map values to their square roots. This is sometimes used as a variance-stabilizing transformation, similar to the log transform. Square-root transforms are useful when a response variable is proportional to the square of the explanatory variable, or when the data show heteroscedasticity (non-constant variance). Counts are sometimes analyzed using a square-root transform. The square-root transform is a special case of the <strong>power transform</strong> (where values are raised to a power) and a special case of the Box-Cox transform (see below). The square-root function in R is <code>sqrt()</code>. There are several ways to accomplish a square-root transform in R:</p>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1027-1"><a href="mod-04.html#cb1027-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb1027-2"><a href="mod-04.html#cb1027-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(x)</span>
<span id="cb1027-3"><a href="mod-04.html#cb1027-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="fl">0.5</span></span></code></pre></div>
<p>Higher roots (cube root, fourth root, etc.) are sometimes used as transforms, but this is not very common.</p>
<div class="sourceCode" id="cb1028"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1028-1"><a href="mod-04.html#cb1028-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="co"># cube root</span></span></code></pre></div>
</div>
<div id="logit-transformation" class="section level4" number="4.5.5.2">
<h4><span class="header-section-number">4.5.5.2</span> Logit transformation</h4>
<p>The <strong>logit transformation</strong> is used to map proportions to the real number line. Usually this changes values into something resembling a normal distribution. The logit is defined as the <em>logarithm of the odds ratio</em>. Its inverse (back-transformation function) is the <strong>logistic function</strong>. For any value <em>x</em> in the open interval<a href="literature-cited.html#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a> (0, 1), the logit is calculated as:</p>
<p><span class="math display">\[logit\left(x\right)=\log{\left(\frac{x}{1-x}\right)}\]</span></p>
<p>If <em>x</em> is a probability or proportion, then logit(<em>x</em>) is also the logarithm of the odds ratio. For this reason, the logit is also called the “log-odds”. The logit function is also the inverse of the logistic function. The logistic function of a variable <em>x</em> is:</p>
<p><span class="math display">\[logistic\left(x\right)=\frac{e^x}{e^x+1}=\frac{1}{1+e^{-x}}\]</span></p>
<p>The figure below shows the relationship between the logit and logistic functions:</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_07.jpg" /></p>
<p>The logit transformation has the effect of stretching out the ends of a distribution, while keeping the relationship between the original and transformed values roughly linear near the middle of the distribution. The logit transformation can be accomplished in R using the function <code>qlogis()</code>; its inverse, the logistic function, is <code>plogis()</code>.</p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1029-1"><a href="mod-04.html#cb1029-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span><span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb1029-2"><a href="mod-04.html#cb1029-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(x)</span>
<span id="cb1029-3"><a href="mod-04.html#cb1029-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1029-4"><a href="mod-04.html#cb1029-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compare:</span></span>
<span id="cb1029-5"><a href="mod-04.html#cb1029-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1029-6"><a href="mod-04.html#cb1029-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb1029-7"><a href="mod-04.html#cb1029-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-385-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Why is this useful? The logistic function takes any real input and outputs a value between 0 and 1. This means that the logit function takes values between 0 and 1 and outputs a real number. The example below shows how this can be applied to analyze proportions:</p>
<p>The first figure below shows how analyzing proportions with linear models leads to clearly inappropriate results. The predicted values of the model extend well outside the possible range of a probability.</p>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1030-1"><a href="mod-04.html#cb1030-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1030-2"><a href="mod-04.html#cb1030-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1030-3"><a href="mod-04.html#cb1030-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb1030-4"><a href="mod-04.html#cb1030-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.75</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1030-5"><a href="mod-04.html#cb1030-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">plogis</span>(z)</span>
<span id="cb1030-6"><a href="mod-04.html#cb1030-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1030-7"><a href="mod-04.html#cb1030-7" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb1030-8"><a href="mod-04.html#cb1030-8" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb1030-9"><a href="mod-04.html#cb1030-9" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>px), <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1030-10"><a href="mod-04.html#cb1030-10" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">&lt;-</span> pred<span class="sc">$</span>fit</span>
<span id="cb1030-11"><a href="mod-04.html#cb1030-11" aria-hidden="true" tabindex="-1"></a>lo <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, mn, pred<span class="sc">$</span>se.fit) </span>
<span id="cb1030-12"><a href="mod-04.html#cb1030-12" aria-hidden="true" tabindex="-1"></a>up <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, mn, pred<span class="sc">$</span>se.fit)</span>
<span id="cb1030-13"><a href="mod-04.html#cb1030-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1030-14"><a href="mod-04.html#cb1030-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb1030-15"><a href="mod-04.html#cb1030-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.3</span>))</span>
<span id="cb1030-16"><a href="mod-04.html#cb1030-16" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1030-17"><a href="mod-04.html#cb1030-17" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1030-18"><a href="mod-04.html#cb1030-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1030-19"><a href="mod-04.html#cb1030-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1030-20"><a href="mod-04.html#cb1030-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-386-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The linear model predicts probabilities (<code>y</code>) less than 0 and greater than 1, so clearly it is inappropriate for analyzing probabilities. However, applying a logit transform to the data for analysis (and later back-transforming using the logistic function) can allow you to analyze proportions. Another (and sometimes better way) to accomplish this is to use a <a href="mod-05.html#mod-05-logistic">GLM with binomial family and logit link</a>.</p>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1031-1"><a href="mod-04.html#cb1031-1" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(y)</span>
<span id="cb1031-2"><a href="mod-04.html#cb1031-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2<span class="sc">~</span>x)</span>
<span id="cb1031-3"><a href="mod-04.html#cb1031-3" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>px), <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1031-4"><a href="mod-04.html#cb1031-4" aria-hidden="true" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> pred2<span class="sc">$</span>fit</span>
<span id="cb1031-5"><a href="mod-04.html#cb1031-5" aria-hidden="true" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, mn2, pred2<span class="sc">$</span>se.fit) </span>
<span id="cb1031-6"><a href="mod-04.html#cb1031-6" aria-hidden="true" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, mn2, pred2<span class="sc">$</span>se.fit)</span>
<span id="cb1031-7"><a href="mod-04.html#cb1031-7" aria-hidden="true" tabindex="-1"></a><span class="co"># backtransform</span></span>
<span id="cb1031-8"><a href="mod-04.html#cb1031-8" aria-hidden="true" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(mn2)</span>
<span id="cb1031-9"><a href="mod-04.html#cb1031-9" aria-hidden="true" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(lo2)</span>
<span id="cb1031-10"><a href="mod-04.html#cb1031-10" aria-hidden="true" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(up2)</span>
<span id="cb1031-11"><a href="mod-04.html#cb1031-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1031-12"><a href="mod-04.html#cb1031-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb1031-13"><a href="mod-04.html#cb1031-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.3</span>))</span>
<span id="cb1031-14"><a href="mod-04.html#cb1031-14" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1031-15"><a href="mod-04.html#cb1031-15" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1031-16"><a href="mod-04.html#cb1031-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1031-17"><a href="mod-04.html#cb1031-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1031-18"><a href="mod-04.html#cb1031-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1031-19"><a href="mod-04.html#cb1031-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1031-20"><a href="mod-04.html#cb1031-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1031-21"><a href="mod-04.html#cb1031-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1031-22"><a href="mod-04.html#cb1031-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb1031-23"><a href="mod-04.html#cb1031-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Logit-transformed&quot;</span>),</span>
<span id="cb1031-24"><a href="mod-04.html#cb1031-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">bg=</span><span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-387-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The downside of the logit transform is that it is undefined at at 0 and 1 (it approaches <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(+\infty\)</span> as the inputs approach 0 and 1). One workaround is to add a small constant to avoid taking log(0) or dividing by 0 <span class="citation">(<a href="#ref-mccune2002analysis" role="doc-biblioref">McCune et al. 2002</a>, <a href="#ref-warton2011" role="doc-biblioref">Warton and Hui 2011</a>)</span>. The latter reference suggests adding the minimum non-zero value. You could also censor the values to be arbitrarily close to 0 or 1: for example, set all values &lt;0.001 to 0.001 and all values &gt; 0.999 to 0.999. This practice is sometimes called “stabilizing the logit” <span class="citation">(<a href="#ref-kery2010" role="doc-biblioref">Kéry 2010</a>)</span>.</p>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1032-1"><a href="mod-04.html#cb1032-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change some values in y to 1 and 0</span></span>
<span id="cb1032-2"><a href="mod-04.html#cb1032-2" aria-hidden="true" tabindex="-1"></a>y[<span class="fu">which.max</span>(y)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1032-3"><a href="mod-04.html#cb1032-3" aria-hidden="true" tabindex="-1"></a>y[<span class="fu">which.min</span>(y)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1032-4"><a href="mod-04.html#cb1032-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1032-5"><a href="mod-04.html#cb1032-5" aria-hidden="true" tabindex="-1"></a><span class="co"># logit transformed values include infinities!</span></span>
<span id="cb1032-6"><a href="mod-04.html#cb1032-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(y)</span></code></pre></div>
<pre><code>##  [1] -2.5298619  3.7500756  0.2207000  2.4844936  5.3073196 -2.2318620  0.6657197  4.5882685  2.0138961  1.2461916  4.8648903  0.9539238  2.0198681
## [14]  0.9887879 -2.6085359  3.0539803 -1.3622593       -Inf  1.6283614  5.3667394  2.5484363  1.7931407  1.3371457  5.2369884  1.8344244  2.5672970
## [27]  1.0519484  1.4131947  0.5373003 -2.1224186        Inf  2.2184900  2.7649033  3.0898599 -2.5994558  0.9631093  2.1861231 -1.7101479 -1.6322178
## [40] -2.3345978 -1.6254712  0.5573073  0.1559367  0.6886083  0.1934203 -2.4499857 -3.5614131  1.5004569 -1.7144060  2.7456992</code></pre>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1034-1"><a href="mod-04.html#cb1034-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stabilize logit by setting max to 0.999 and min to 0.001</span></span>
<span id="cb1034-2"><a href="mod-04.html#cb1034-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fl">0.999</span>, y)</span>
<span id="cb1034-3"><a href="mod-04.html#cb1034-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fl">0.001</span>, y)</span>
<span id="cb1034-4"><a href="mod-04.html#cb1034-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(y)</span></code></pre></div>
<pre><code>##  [1] -2.5298619  3.7500756  0.2207000  2.4844936  5.3073196 -2.2318620  0.6657197  4.5882685  2.0138961  1.2461916  4.8648903  0.9539238  2.0198681
## [14]  0.9887879 -2.6085359  3.0539803 -1.3622593 -6.9067548  1.6283614  5.3667394  2.5484363  1.7931407  1.3371457  5.2369884  1.8344244  2.5672970
## [27]  1.0519484  1.4131947  0.5373003 -2.1224186  6.9067548  2.2184900  2.7649033  3.0898599 -2.5994558  0.9631093  2.1861231 -1.7101479 -1.6322178
## [40] -2.3345978 -1.6254712  0.5573073  0.1559367  0.6886083  0.1934203 -2.4499857 -3.5614131  1.5004569 -1.7144060  2.7456992</code></pre>
<p>The probit function is similar to the logit function, is used in similar situations, and produces similar results, but uses the CDF of the standard normal distribution instead of the logit function. The probit function is given by:</p>
<p><span class="math display">\[
probit\left(x\right)=\left(\sqrt2\right){erf}^{-1}\left(2x-1\right)=\left(\sqrt2\right)\left(\frac{2}{\sqrt\pi}\right)\int_{0}^{2x-1}{e^{-t^2}dt}\]</span></p>
<p>The R command for the probit function is just the function <code>qnorm()</code>. As you might suspect, the inverse function is <code>pnorm()</code>.</p>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1036-1"><a href="mod-04.html#cb1036-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span></span>
<span id="cb1036-2"><a href="mod-04.html#cb1036-2" aria-hidden="true" tabindex="-1"></a>x.log <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb1036-3"><a href="mod-04.html#cb1036-3" aria-hidden="true" tabindex="-1"></a>x.prb <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb1036-4"><a href="mod-04.html#cb1036-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1036-5"><a href="mod-04.html#cb1036-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, x.log, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb1036-6"><a href="mod-04.html#cb1036-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;f(x)&quot;</span>)</span>
<span id="cb1036-7"><a href="mod-04.html#cb1036-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, x.prb, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb1036-8"><a href="mod-04.html#cb1036-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1036-9"><a href="mod-04.html#cb1036-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb1036-10"><a href="mod-04.html#cb1036-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Logit(x)&quot;</span>, <span class="st">&quot;Probit(x)&quot;</span>),</span>
<span id="cb1036-11"><a href="mod-04.html#cb1036-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-389-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="arcsine-transformation" class="section level4" number="4.5.5.3">
<h4><span class="header-section-number">4.5.5.3</span> Arcsine transformation</h4>
<p>Another option for proportional data is to use the arcsine transform:</p>
<p><span class="math display">\[y_i=\frac{2}{\pi}arcsin\left(\sqrt{x_i}\right)\]</span></p>
<p>Some sources omit the coefficient <span class="math inline">\(2/\pi\)</span>; others do not. Including the <span class="math inline">\(2/\pi\)</span> ensures that the transformed values range from 0 to 1 <span class="citation">(<a href="#ref-mccune2002analysis" role="doc-biblioref">McCune et al. 2002</a>)</span>. It should be noted that the arcsine transformation should probably <em>not</em> be used when the data come from a binomial process. In those cases, logistic or binomial GLMs are likely to be more appropriate than an arcsine transformation. Simulation results have found that the arcsine transform should probably <strong><em>not</em></strong> be used for ecological data <span class="citation">(<a href="#ref-warton2011" role="doc-biblioref">Warton and Hui 2011</a>)</span>. I couldn’t find a reference on its acceptability in other areas of biology but I’d be surprised if it was appropriate given the arguments presented by <span class="citation">Warton and Hui (<a href="#ref-warton2011" role="doc-biblioref">2011</a>)</span>.</p>
<p>If you insist on using the arcsine transform, you can do it in R using <code>asin()</code> function. In the examples below, <code>asin()</code> is embedded inside custom functions that perform the other parts of the arcsine transform.</p>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1037-1"><a href="mod-04.html#cb1037-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unbounded version:</span></span>
<span id="cb1037-2"><a href="mod-04.html#cb1037-2" aria-hidden="true" tabindex="-1"></a>asin.trans1 <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="fu">asin</span>(<span class="fu">sqrt</span>(p))}</span>
<span id="cb1037-3"><a href="mod-04.html#cb1037-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1037-4"><a href="mod-04.html#cb1037-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bounded version:</span></span>
<span id="cb1037-5"><a href="mod-04.html#cb1037-5" aria-hidden="true" tabindex="-1"></a>asin.trans2 <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="dv">2</span><span class="sc">/</span>pi<span class="sc">*</span><span class="fu">asin</span>(<span class="fu">sqrt</span>(p))}</span>
<span id="cb1037-6"><a href="mod-04.html#cb1037-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1037-7"><a href="mod-04.html#cb1037-7" aria-hidden="true" tabindex="-1"></a><span class="co"># example of use</span></span>
<span id="cb1037-8"><a href="mod-04.html#cb1037-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb1037-9"><a href="mod-04.html#cb1037-9" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">asin.trans1</span>(x)</span>
<span id="cb1037-10"><a href="mod-04.html#cb1037-10" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">asin.trans2</span>(x)</span>
<span id="cb1037-11"><a href="mod-04.html#cb1037-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1037-12"><a href="mod-04.html#cb1037-12" aria-hidden="true" tabindex="-1"></a><span class="co"># compare with and without 2/pi coefficient:</span></span>
<span id="cb1037-13"><a href="mod-04.html#cb1037-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y1, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.6</span>))</span>
<span id="cb1037-14"><a href="mod-04.html#cb1037-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, y2, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1037-15"><a href="mod-04.html#cb1037-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb1037-16"><a href="mod-04.html#cb1037-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Unbounded version&quot;</span>, <span class="st">&quot;Bounded version&quot;</span>),</span>
<span id="cb1037-17"><a href="mod-04.html#cb1037-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb1037-18"><a href="mod-04.html#cb1037-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-390-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The plot below compares the arcsine to the logit transformation for proportional data.</p>
<div class="sourceCode" id="cb1038"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1038-1"><a href="mod-04.html#cb1038-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to logit transform:</span></span>
<span id="cb1038-2"><a href="mod-04.html#cb1038-2" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(x)</span>
<span id="cb1038-3"><a href="mod-04.html#cb1038-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y1, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb1038-4"><a href="mod-04.html#cb1038-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, y2, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1038-5"><a href="mod-04.html#cb1038-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, y3, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1038-6"><a href="mod-04.html#cb1038-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb1038-7"><a href="mod-04.html#cb1038-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Unbounded arcsine&quot;</span>,</span>
<span id="cb1038-8"><a href="mod-04.html#cb1038-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Bounded arcsine&quot;</span>,</span>
<span id="cb1038-9"><a href="mod-04.html#cb1038-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Logit&quot;</span>),</span>
<span id="cb1038-10"><a href="mod-04.html#cb1038-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">cex=</span><span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-391-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="box-cox-transformation" class="section level4" number="4.5.5.4">
<h4><span class="header-section-number">4.5.5.4</span> Box-Cox transformation</h4>
<p>The <strong>Box-Cox transformation</strong> is a kind of power transform that can achieve a normal distribution in a non-normally distributed response variable <span class="citation">(<a href="#ref-box1964" role="doc-biblioref">Box and Cox 1964</a>)</span>.</p>
<p><span class="math display">\[y_i=\left\{\begin{matrix}log{\left(x_i\right)}&amp;if\ \lambda=0\\\left(x_i^\lambda-1\right)/\lambda&amp;otherwise\\\end{matrix}\right.\]</span></p>
<p>Here the parameter <span class="math inline">\(\lambda\)</span> is some constant that must be optimized for a given variable. When <span class="math inline">\(\lambda\)</span> = 0, the transformation is defined as <span class="math inline">\(y_i=\log{\left(x_i\right)}\)</span>. Unlike the other transformations presented here, the Box-Cox transformation only makes sense in the context of a data model such as linear regression. The basic procedure is to first estimate the optimal <span class="math inline">\(\lambda\)</span> for a given model, then use that <span class="math inline">\(\lambda\)</span> to transform the data.</p>
<p>The Box-Cox transformation is available in several packages, but not base R. Here is an example using the functions in package MASS:</p>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1039-1"><a href="mod-04.html#cb1039-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1039-2"><a href="mod-04.html#cb1039-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1039-3"><a href="mod-04.html#cb1039-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some data</span></span>
<span id="cb1039-4"><a href="mod-04.html#cb1039-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1039-5"><a href="mod-04.html#cb1039-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1039-6"><a href="mod-04.html#cb1039-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb1039-7"><a href="mod-04.html#cb1039-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb1039-8"><a href="mod-04.html#cb1039-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1039-9"><a href="mod-04.html#cb1039-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-392-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1040-1"><a href="mod-04.html#cb1040-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a linear model</span></span>
<span id="cb1040-2"><a href="mod-04.html#cb1040-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb1040-3"><a href="mod-04.html#cb1040-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1040-4"><a href="mod-04.html#cb1040-4" aria-hidden="true" tabindex="-1"></a><span class="co"># run the box-cox transformation</span></span>
<span id="cb1040-5"><a href="mod-04.html#cb1040-5" aria-hidden="true" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(m1)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-392-2.png" width="576" style="display: block; margin: auto;" /></p>
<p>The figure below illustrates how the optimal <span class="math inline">\(\lambda\)</span> is determined:</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_08.jpg" /></p>
<div class="sourceCode" id="cb1041"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1041-1"><a href="mod-04.html#cb1041-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get optimal lambda:</span></span>
<span id="cb1041-2"><a href="mod-04.html#cb1041-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> bc<span class="sc">$</span>x[<span class="fu">which.max</span>(bc<span class="sc">$</span>y)]</span>
<span id="cb1041-3"><a href="mod-04.html#cb1041-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1041-4"><a href="mod-04.html#cb1041-4" aria-hidden="true" tabindex="-1"></a><span class="co"># boxcox transformation</span></span>
<span id="cb1041-5"><a href="mod-04.html#cb1041-5" aria-hidden="true" tabindex="-1"></a>bc.trans <span class="ot">&lt;-</span> <span class="cf">function</span>(x, lam){</span>
<span id="cb1041-6"><a href="mod-04.html#cb1041-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(lam <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb1041-7"><a href="mod-04.html#cb1041-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">log</span>(x)</span>
<span id="cb1041-8"><a href="mod-04.html#cb1041-8" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1041-9"><a href="mod-04.html#cb1041-9" aria-hidden="true" tabindex="-1"></a>        ((x<span class="sc">^</span>lam)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>lam</span>
<span id="cb1041-10"><a href="mod-04.html#cb1041-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1041-11"><a href="mod-04.html#cb1041-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1041-12"><a href="mod-04.html#cb1041-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1041-13"><a href="mod-04.html#cb1041-13" aria-hidden="true" tabindex="-1"></a>yt <span class="ot">&lt;-</span> <span class="fu">bc.trans</span>(y, lambda)</span>
<span id="cb1041-14"><a href="mod-04.html#cb1041-14" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yt<span class="sc">~</span>x)</span>
<span id="cb1041-15"><a href="mod-04.html#cb1041-15" aria-hidden="true" tabindex="-1"></a><span class="co"># note difference in R-squared:</span></span>
<span id="cb1041-16"><a href="mod-04.html#cb1041-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.037 -10.734  -1.496   6.798  22.138 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -56.86      12.34  -4.606  0.00174 ** 
## x              31.80       3.53   9.009 1.84e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.49 on 8 degrees of freedom
## Multiple R-squared:  0.9103, Adjusted R-squared:  0.8991 
## F-statistic: 81.15 on 1 and 8 DF,  p-value: 1.84e-05</code></pre>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1043-1"><a href="mod-04.html#cb1043-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yt ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.15135 -0.04794 -0.01449  0.06522  0.11884 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.08013    0.08491  -12.72 1.37e-06 ***
## x            1.96623    0.02428   80.97 6.04e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08589 on 8 degrees of freedom
## Multiple R-squared:  0.9988, Adjusted R-squared:  0.9986 
## F-statistic:  6556 on 1 and 8 DF,  p-value: 6.035e-13</code></pre>
</div>
</div>
</div>
<div id="multivariate-data-exploration" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Multivariate data exploration</h2>
<p>So far in this course we have explored ways to <a href="mod-04.html#mod-04-vis">explore distributions of single variables</a>: histograms, ECDF plots, probability density plots, and so on. On this page we will explore ways to explore relationships between variables. This is a vital preliminary step in studying how two or more variables might be correlated with each other, or how one might cause the other. The focus on this page is on exploratory, correlative methods. Actual inference about relationships between two variables is better handled by <a href="mod-05.html#mod-05-lm">linear models (LM)</a>, <a href="mod-05.html#mod-05-basic">generalized linear models (GLM)</a>, or <a href="mod-06.html#mod-06">other kinds of models</a>. This page also contain a brief introduction to ordination, which can help identify patterns in datasets with many variables. A more complete presentation of ordination can be found on <a href="mod-08.html#mod-08">another page</a>.</p>
<div id="scatterplots-for-two-variables" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Scatterplots for two variables</h3>
<p>The <strong>scatterplot</strong> is one of the most important tools in the biologist’s data toolbox. It is probably the simplest type of figure in routine use: simply plot the values in one variable on one axis, and the values of another variable on another (perpendicular) axis. The role of the scatterplot in exploratory data analysis is to help visualize the form of the relationship between two variables <span class="citation">(<a href="#ref-bolker2008ecological" role="doc-biblioref">Bolker 2008</a>)</span>. The figure below shows just 6 of the possible curve types that you might discover.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-394-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>We have already made some scatterplots, but it’s worth taking a closer look at the R methods for scatterplots. The basic function for scatterplots is <code>plot()</code>. The first argument is taken to be the x coordinates, and the second argument to be the y coordinates. You can also use the formula interface (<code>y ~ x</code>), but the coordinates method (x, y) usually makes for cleaner code.</p>
<p>Calling <code>plot()</code> does two things: first, it <em>creates a new plot</em>; second, it <em>plots the data</em> on the new plot area. Other components can be added to the plot with subsequent commands: <code>points()</code> for points, <code>text()</code> for text, <code>lines()</code> for lines, <code>polygon()</code> for polygons, <code>segments()</code> for line segments, and so on. These functions will add to an existing plot, but will not create a new plot area. So, call <code>plot()</code> first, then <code>points()</code> or one of the others if needed. Calling <code>points()</code> or one of the “adding” functions if there is not already an active plot area will return an error.</p>
<p>Here is a basic scatterplot:</p>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1045-1"><a href="mod-04.html#cb1045-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-395-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The default scatterplot is rather unattractive, but works just fine for exploring data. Fortunately, almost every aspect of a plot can be customized using different plot arguments and graphical parameters. Here are some commonly used plot options:</p>
<div class="sourceCode" id="cb1046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1046-1"><a href="mod-04.html#cb1046-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1046-2"><a href="mod-04.html#cb1046-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Petal width (cm)&quot;</span>,             <span class="co"># x label</span></span>
<span id="cb1046-3"><a href="mod-04.html#cb1046-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Petal Length (cm)&quot;</span>,            <span class="co"># y label</span></span>
<span id="cb1046-4"><a href="mod-04.html#cb1046-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),                         <span class="co"># x axis limits</span></span>
<span id="cb1046-5"><a href="mod-04.html#cb1046-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>),                         <span class="co"># y axis limits</span></span>
<span id="cb1046-6"><a href="mod-04.html#cb1046-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&quot;Petal length vs. petal width&quot;</span>  <span class="co"># plot title</span></span>
<span id="cb1046-7"><a href="mod-04.html#cb1046-7" aria-hidden="true" tabindex="-1"></a>)<span class="co">#plot  </span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-396-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Sometimes it helps to change the color or style of points to show categories in the data. This can be done using some arguments to <code>plot()</code>:</p>
<ul>
<li><code>pch</code> changes the symbol used for points. Think “<strong>p</strong>oint <strong>ch</strong>aracter”. See <code>?points</code> for a list of available symbols.</li>
<li><code>cex</code> changes the size of symbols. Think “<strong>c</strong>haracter <strong>ex</strong>pansion”. The default <code>cex</code> is 1; other values scale the points relative to this. E.g., <code>cex=2</code> makes points twice as large.</li>
<li><code>col</code> changes the color. Think “<strong>col</strong>or”.R can produce many colors; run the command <code>colors()</code> to see a named list<a href="literature-cited.html#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a>.</li>
</ul>
<p>Each these arguments can take vector of values, so you can assign colors or shape to each point. The values will be used in the same order as the observations used to draw the points (e.g., rows of a data frame). I find it convenient to use rules like <code>ifelse()</code> commands to define symbology for plots.</p>
<p>The examples below illustrate several ways of assigning symbology to observations within a data frame. In the first, <code>ifelse()</code> is used to make vectors of colors (<code>use.col</code>) defined by the variable <code>species</code>. Notice that a legend is provided to tell the reader which symbols mean what.</p>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1047-1"><a href="mod-04.html#cb1047-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: ifelse()</span></span>
<span id="cb1047-2"><a href="mod-04.html#cb1047-2" aria-hidden="true" tabindex="-1"></a>use.col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;black&quot;</span>, </span>
<span id="cb1047-3"><a href="mod-04.html#cb1047-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;versicolor&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span>
<span id="cb1047-4"><a href="mod-04.html#cb1047-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1047-5"><a href="mod-04.html#cb1047-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1047-6"><a href="mod-04.html#cb1047-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span>use.col, <span class="co"># color by species</span></span>
<span id="cb1047-7"><a href="mod-04.html#cb1047-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>      <span class="co"># solid dots    </span></span>
<span id="cb1047-8"><a href="mod-04.html#cb1047-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1047-9"><a href="mod-04.html#cb1047-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb1047-10"><a href="mod-04.html#cb1047-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Setosa&quot;</span>, <span class="st">&quot;Versicolor&quot;</span>, <span class="st">&quot;Virginica&quot;</span>),</span>
<span id="cb1047-11"><a href="mod-04.html#cb1047-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-397-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The next example uses <code>match()</code> instead of <code>ifelse()</code> to assign colors by <code>species</code>.</p>
<div class="sourceCode" id="cb1048"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1048-1"><a href="mod-04.html#cb1048-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: match()</span></span>
<span id="cb1048-2"><a href="mod-04.html#cb1048-2" aria-hidden="true" tabindex="-1"></a>spps <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(iris<span class="sc">$</span>Species))</span>
<span id="cb1048-3"><a href="mod-04.html#cb1048-3" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb1048-4"><a href="mod-04.html#cb1048-4" aria-hidden="true" tabindex="-1"></a>use.col <span class="ot">&lt;-</span> cols[<span class="fu">match</span>(iris<span class="sc">$</span>Species, spps)]</span>
<span id="cb1048-5"><a href="mod-04.html#cb1048-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1048-6"><a href="mod-04.html#cb1048-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1048-7"><a href="mod-04.html#cb1048-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span>use.col, <span class="co"># color by species</span></span>
<span id="cb1048-8"><a href="mod-04.html#cb1048-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>      <span class="co"># solid dots    </span></span>
<span id="cb1048-9"><a href="mod-04.html#cb1048-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1048-10"><a href="mod-04.html#cb1048-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb1048-11"><a href="mod-04.html#cb1048-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Setosa&quot;</span>, <span class="st">&quot;Versicolor&quot;</span>, <span class="st">&quot;Virginica&quot;</span>),</span>
<span id="cb1048-12"><a href="mod-04.html#cb1048-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-398-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is an example of using shapes (<code>use.pch</code>) to define groups:</p>
<div class="sourceCode" id="cb1049"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1049-1"><a href="mod-04.html#cb1049-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 3: match(), but with shape</span></span>
<span id="cb1049-2"><a href="mod-04.html#cb1049-2" aria-hidden="true" tabindex="-1"></a>spps <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(iris<span class="sc">$</span>Species))</span>
<span id="cb1049-3"><a href="mod-04.html#cb1049-3" aria-hidden="true" tabindex="-1"></a>shps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>)</span>
<span id="cb1049-4"><a href="mod-04.html#cb1049-4" aria-hidden="true" tabindex="-1"></a>use.shp <span class="ot">&lt;-</span> shps[<span class="fu">match</span>(iris<span class="sc">$</span>Species, spps)]</span>
<span id="cb1049-5"><a href="mod-04.html#cb1049-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1049-6"><a href="mod-04.html#cb1049-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1049-7"><a href="mod-04.html#cb1049-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span>use.shp <span class="co"># shape by species</span></span>
<span id="cb1049-8"><a href="mod-04.html#cb1049-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1049-9"><a href="mod-04.html#cb1049-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb1049-10"><a href="mod-04.html#cb1049-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Setosa&quot;</span>, <span class="st">&quot;Versicolor&quot;</span>, <span class="st">&quot;Virginica&quot;</span>),</span>
<span id="cb1049-11"><a href="mod-04.html#cb1049-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span>shps)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-399-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>You can think of the plot generated by <code>plot()</code> like a canvas. Once the canvas is in place, things can be “painted” on, but like paint cannot be removed. If you want to remove something, you’ll need to remake the plot without it. You can also just comment out the command you don’t want.</p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1050-1"><a href="mod-04.html#cb1050-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1050-2"><a href="mod-04.html#cb1050-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span>use.col, <span class="at">pch=</span><span class="dv">16</span></span>
<span id="cb1050-3"><a href="mod-04.html#cb1050-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1050-4"><a href="mod-04.html#cb1050-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, <span class="dv">5</span>, <span class="st">&quot;Flowers!&quot;</span>, <span class="at">cex=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1050-5"><a href="mod-04.html#cb1050-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span>spps, <span class="at">col=</span>cols, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-400-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>There’s no way to remove the offending text: R doesn’t have an “Undo” button! Our only option is just to remake the plot without the text.</p>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1051-1"><a href="mod-04.html#cb1051-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remake without the offending text:</span></span>
<span id="cb1051-2"><a href="mod-04.html#cb1051-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1051-3"><a href="mod-04.html#cb1051-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span>use.col, <span class="at">pch=</span><span class="dv">16</span></span>
<span id="cb1051-4"><a href="mod-04.html#cb1051-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1051-5"><a href="mod-04.html#cb1051-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span>spps, <span class="at">col=</span>cols, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-401-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Sometimes I’ll just comment out the plot component that needs deleting; this way it is easier to add back in later.</p>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1052-1"><a href="mod-04.html#cb1052-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not run:</span></span>
<span id="cb1052-2"><a href="mod-04.html#cb1052-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1052-3"><a href="mod-04.html#cb1052-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remake without the offending text (commented out):</span></span>
<span id="cb1052-4"><a href="mod-04.html#cb1052-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width,iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1052-5"><a href="mod-04.html#cb1052-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span>use.col, <span class="at">pch=</span><span class="dv">16</span></span>
<span id="cb1052-6"><a href="mod-04.html#cb1052-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1052-7"><a href="mod-04.html#cb1052-7" aria-hidden="true" tabindex="-1"></a><span class="co">#text(1.5, 5, &quot;Flowers!&quot;, cex=4, col=&quot;red&quot;)</span></span>
<span id="cb1052-8"><a href="mod-04.html#cb1052-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span>spps, <span class="at">col=</span>cols, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<div id="graphical-parameters-and-the-par-command" class="section level4" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Graphical parameters and the <code>par()</code> command</h4>
<p>Many options that affect plots can only be set using the <code>par()</code> function. Take a look at the <code>par()</code> help page to get a sense of the variety of options available (<code>?par</code>). It is important to keep in mind is that once <code>par()</code> options are set, they will stay that way until you change them using <code>par()</code> again. So, if you are making multiple figures within the same R workspace you will need to pay attention to what you have done. You can always see all current settings by running the command <code>par()</code>.</p>
<p>Below is an illustration of using <code>par()</code> to change graphics options:</p>
<p>Without <code>par()</code>:</p>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1053-1"><a href="mod-04.html#cb1053-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Length<span class="sc">~</span>iris<span class="sc">$</span>Sepal.Length,</span>
<span id="cb1053-2"><a href="mod-04.html#cb1053-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Sepal length (cm)&quot;</span>,</span>
<span id="cb1053-3"><a href="mod-04.html#cb1053-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Petal length (cm)&quot;</span>,</span>
<span id="cb1053-4"><a href="mod-04.html#cb1053-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-403-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>With <code>par()</code>:</p>
<ul>
<li>Narrow the margins (<code>mar</code>)</li>
<li>Remove the box (<code>bty</code>)</li>
<li>Turn <em>y</em>-axis numbers to horizontal (<code>las</code>)</li>
<li>Bring axis labels in closer (<code>mgp</code>)</li>
<li>Set size of axis text (<code>cex.axis</code>) and labels (<code>cex.lab</code>)</li>
</ul>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1054-1"><a href="mod-04.html#cb1054-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),  <span class="co"># margin sizes</span></span>
<span id="cb1054-2"><a href="mod-04.html#cb1054-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,                    <span class="co"># no box around plot</span></span>
<span id="cb1054-3"><a href="mod-04.html#cb1054-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>,                      <span class="co"># axis labels in reading direction</span></span>
<span id="cb1054-4"><a href="mod-04.html#cb1054-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.25</span>, <span class="dv">1</span>,<span class="dv">0</span>),           <span class="co"># position of axis components</span></span>
<span id="cb1054-5"><a href="mod-04.html#cb1054-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>,               <span class="co"># size of axis numbers</span></span>
<span id="cb1054-6"><a href="mod-04.html#cb1054-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.2</span>)                <span class="co"># size of axis titles</span></span>
<span id="cb1054-7"><a href="mod-04.html#cb1054-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Length<span class="sc">~</span>iris<span class="sc">$</span>Sepal.Length,</span>
<span id="cb1054-8"><a href="mod-04.html#cb1054-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Sepal length (cm)&quot;</span>,</span>
<span id="cb1054-9"><a href="mod-04.html#cb1054-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Petal length (cm)&quot;</span>,</span>
<span id="cb1054-10"><a href="mod-04.html#cb1054-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-404-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We will use <code>par()</code> often in this course to clean up figures and make them more attractive. Most of the time you won’t need to mess with <code>par()</code> (except for making multi-panel figures), but you should definitely use <code>par()</code> when preparing figures for publication. Proper use of <code>par()</code> is the key to making clean, informative, and professional-looking figures.</p>
</div>
<div id="multi-panel-figures-with-par" class="section level4" number="4.6.1.2">
<h4><span class="header-section-number">4.6.1.2</span> Multi-panel figures with <code>par()</code></h4>
<p>One of the most common ways to use <code>par()</code> is to make multi-panel figures. The panels are specified in terms of the number of rows and columns in the figure. The arguments <code>mfrow</code> and <code>mfcol</code> define the panel layout.</p>
<ul>
<li><code>mfrow</code>: you supply the number of rows and number of columns, in that order.</li>
<li><code>mfcol</code>: works the same way, but in reverse: supply the number of columns and number of rows, in that order.</li>
</ul>
<p>Once you set <code>mfrow</code> or <code>mfcol</code> (but never both), a new plot panel will be produced each time you call <code>plot()</code>. The graphics window will be divided evenly according to the number of panels you requested (e.g., <code>mfrow=c(2,3)</code> will yield 6 panels). Panels are drawn by row and then by column (with <code>mfrow</code>) or by column and then by row (with <code>mfcol</code>).</p>
<p>If you produce more plots than you have “slots” specified by <code>mfrow</code> or <code>mfcol</code>, the graphics device will be cleared and the plot panels will be filled again, in the same order as before. So, if you set <code>mfrow=c(2,2)</code>, and then make 5 plots, you will end up with a graphics window that has 1 plot in the upper left corner.</p>
<p>The example below shows the use of <code>par()$mfrow</code> to make a 2 <span class="math inline">\(\times\)</span> 2 figure.</p>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1055-1"><a href="mod-04.html#cb1055-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),           <span class="co"># layout</span></span>
<span id="cb1055-2"><a href="mod-04.html#cb1055-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">4.1</span>,<span class="fl">4.1</span>,<span class="fl">1.1</span>,<span class="fl">1.1</span>), <span class="co"># margin sizes</span></span>
<span id="cb1055-3"><a href="mod-04.html#cb1055-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,                <span class="co"># no box around plot</span></span>
<span id="cb1055-4"><a href="mod-04.html#cb1055-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>,                  <span class="co"># rotate axis text</span></span>
<span id="cb1055-5"><a href="mod-04.html#cb1055-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>,           <span class="co"># axis text size</span></span>
<span id="cb1055-6"><a href="mod-04.html#cb1055-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.2</span>)            <span class="co"># label text size</span></span>
<span id="cb1055-7"><a href="mod-04.html#cb1055-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Petal.Length, <span class="at">main=</span><span class="st">&quot;Plot 1&quot;</span>)</span>
<span id="cb1055-8"><a href="mod-04.html#cb1055-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Petal.Width, <span class="at">main=</span><span class="st">&quot;Plot 2&quot;</span>)</span>
<span id="cb1055-9"><a href="mod-04.html#cb1055-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Sepal.Length, <span class="at">main=</span><span class="st">&quot;Plot 3&quot;</span>)</span>
<span id="cb1055-10"><a href="mod-04.html#cb1055-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Sepal.Width, <span class="at">main=</span><span class="st">&quot;Plot 4&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-405-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>When making multi-panel plots, it helps to line up axes that correspond to each other. The commands below show two separate figures with aligned axes. This can be helpful when showing different responses to the same explanatory variable (the 2 <span class="math inline">\(\times\)</span> 1 figure):</p>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1056-1"><a href="mod-04.html#cb1056-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),           <span class="co"># layout</span></span>
<span id="cb1056-2"><a href="mod-04.html#cb1056-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">4.1</span>,<span class="fl">4.1</span>,<span class="fl">1.1</span>,<span class="fl">1.1</span>), <span class="co"># margin sizes</span></span>
<span id="cb1056-3"><a href="mod-04.html#cb1056-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,                <span class="co"># no box around plot</span></span>
<span id="cb1056-4"><a href="mod-04.html#cb1056-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>,                  <span class="co"># rotate axis text</span></span>
<span id="cb1056-5"><a href="mod-04.html#cb1056-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>,           <span class="co"># axis text size</span></span>
<span id="cb1056-6"><a href="mod-04.html#cb1056-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.2</span>)            <span class="co"># label text size</span></span>
<span id="cb1056-7"><a href="mod-04.html#cb1056-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Length, iris<span class="sc">$</span>Sepal.Length)</span>
<span id="cb1056-8"><a href="mod-04.html#cb1056-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Length, iris<span class="sc">$</span>Sepal.Width)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-406-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The figure below is a 1 <span class="math inline">\(\times\)</span> 2 figure that shows how a single response variable relates to two different predictors.</p>
<div class="sourceCode" id="cb1057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1057-1"><a href="mod-04.html#cb1057-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),           <span class="co"># layout</span></span>
<span id="cb1057-2"><a href="mod-04.html#cb1057-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">4.1</span>,<span class="fl">4.1</span>,<span class="fl">1.1</span>,<span class="fl">1.1</span>), <span class="co"># margin sizes</span></span>
<span id="cb1057-3"><a href="mod-04.html#cb1057-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,                <span class="co"># no box around plot</span></span>
<span id="cb1057-4"><a href="mod-04.html#cb1057-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>,                  <span class="co"># rotate axis text</span></span>
<span id="cb1057-5"><a href="mod-04.html#cb1057-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>,           <span class="co"># axis text size</span></span>
<span id="cb1057-6"><a href="mod-04.html#cb1057-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.2</span>)            <span class="co"># label text size</span></span>
<span id="cb1057-7"><a href="mod-04.html#cb1057-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width, iris<span class="sc">$</span>Petal.Length)</span>
<span id="cb1057-8"><a href="mod-04.html#cb1057-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Petal.Length<span class="sc">~</span>iris<span class="sc">$</span>Species)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-407-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Sometimes you may need to manually set axis limits to make sure that the panels line up exactly.</p>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="mod-04.html#cb1058-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example with X and Y axes not aligned:</span></span>
<span id="cb1058-2"><a href="mod-04.html#cb1058-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> iris[<span class="fu">which</span>(iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;setosa&quot;</span>),]</span>
<span id="cb1058-3"><a href="mod-04.html#cb1058-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> iris[<span class="fu">which</span>(iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;versicolor&quot;</span>),]</span>
<span id="cb1058-4"><a href="mod-04.html#cb1058-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1058-5"><a href="mod-04.html#cb1058-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb1058-6"><a href="mod-04.html#cb1058-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d1<span class="sc">$</span>Petal.Length, d1<span class="sc">$</span>Sepal.Length)</span>
<span id="cb1058-7"><a href="mod-04.html#cb1058-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d2<span class="sc">$</span>Petal.Length, d2<span class="sc">$</span>Sepal.Length)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-408-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Here’s the same plot, but with the axes lined up by setting the axis limits with <code>xlim</code> and <code>ylim</code>.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1059-1"><a href="mod-04.html#cb1059-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same plot but with axes lined up:</span></span>
<span id="cb1059-2"><a href="mod-04.html#cb1059-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb1059-3"><a href="mod-04.html#cb1059-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d1<span class="sc">$</span>Petal.Length, d1<span class="sc">$</span>Sepal.Length, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span>
<span id="cb1059-4"><a href="mod-04.html#cb1059-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d2<span class="sc">$</span>Petal.Length, d2<span class="sc">$</span>Sepal.Length, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-409-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The argument <code>mfcol</code> to <code>par()</code> works similarly to <code>mfrow</code>, but on columns instead of rows. For <code>mfcol</code> you supply the number of columns, then the number of rows. Likewise, panels are filled by column first instead of row first. The panel layout <code>mfrow=c(2,3)</code> is the same as <code>mfcol=c(3,2)</code>, but the panels will be filled in a different order:</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_09.jpg" /></p>
<p>Whether to use <code>mfrow</code> or <code>mfcol</code> is usually a matter of preference. Clever use of one or the other can allow you to automatically make multi-panel plots in a preferred layout from data stored in a list or indexed by a vector.</p>
<p>One last thing about multi-panel plots: the <code>plot()</code> function both creates new panels and the plot within each panel. Part of this process is defining the coordinate system for a panel. When you make a plot, subsequent commands that add elements to plots such as <code>points()</code>, <code>abline()</code>, <code>legend()</code>, etc., will use the coordinate system of the most recent panel. Think about this when designing complicated figures. The example below demonstrates how a legend is placed according to the coordinate system of the most recently-created plot.</p>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1060-1"><a href="mod-04.html#cb1060-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb1060-2"><a href="mod-04.html#cb1060-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1060-3"><a href="mod-04.html#cb1060-3" aria-hidden="true" tabindex="-1"></a><span class="co"># legend in first panel:</span></span>
<span id="cb1060-4"><a href="mod-04.html#cb1060-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb1060-5"><a href="mod-04.html#cb1060-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(n))</span>
<span id="cb1060-6"><a href="mod-04.html#cb1060-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="st">&quot;Data&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightgrey&quot;</span>)</span>
<span id="cb1060-7"><a href="mod-04.html#cb1060-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(n))</span>
<span id="cb1060-8"><a href="mod-04.html#cb1060-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(n))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-410-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1061-1"><a href="mod-04.html#cb1061-1" aria-hidden="true" tabindex="-1"></a><span class="co"># legend in second panel (note where legend() is):</span></span>
<span id="cb1061-2"><a href="mod-04.html#cb1061-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb1061-3"><a href="mod-04.html#cb1061-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(n))</span>
<span id="cb1061-4"><a href="mod-04.html#cb1061-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(n))</span>
<span id="cb1061-5"><a href="mod-04.html#cb1061-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="st">&quot;Data&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightgrey&quot;</span>)</span>
<span id="cb1061-6"><a href="mod-04.html#cb1061-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(n))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-411-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mod-04-smat" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Scatterplot matrices for many variables</h3>
<p>A scatterplot plots one variable against another, and is probably the best way to see the relationship (if any) between two variables. But what if you have many variables? Making dozens of scatterplots can be tedious and time consuming. A scatterplot matrix makes many scatterplots at once, allowing relationships between many variables to be visualized at once. The base function to do this is <code>pairs()</code>.</p>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1062-1"><a href="mod-04.html#cb1062-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load some data</span></span>
<span id="cb1062-2"><a href="mod-04.html#cb1062-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(crabs, <span class="at">package=</span><span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb1062-3"><a href="mod-04.html#cb1062-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1062-4"><a href="mod-04.html#cb1062-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a spare copy</span></span>
<span id="cb1062-5"><a href="mod-04.html#cb1062-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> crabs</span>
<span id="cb1062-6"><a href="mod-04.html#cb1062-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1062-7"><a href="mod-04.html#cb1062-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define columns for scatterplot matrix</span></span>
<span id="cb1062-8"><a href="mod-04.html#cb1062-8" aria-hidden="true" tabindex="-1"></a>dat.cols <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb1062-9"><a href="mod-04.html#cb1062-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1062-10"><a href="mod-04.html#cb1062-10" aria-hidden="true" tabindex="-1"></a><span class="co"># make scatterplot matrix</span></span>
<span id="cb1062-11"><a href="mod-04.html#cb1062-11" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x[,dat.cols])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-412-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>In the scatterplot matrix, every variable is plotted against every other variable. Variables are labeled on the diagonal. E.g., the plots in the first row have “FL” as their <em>y</em>-axis, and “RW”, “CL”, “CW”, and “BD” as their <em>x</em>-axes. Likewise, plots in the first column have “FL” as their <em>x</em>-axis, and “RW”, “CL”, “CW”, and “BD” as their <em>y</em>-axes.</p>
<p>One common modification to the default <code>pairs()</code> plot is to replace scatterplots above the diagonal with correlation coefficients. Another modification is to add linear regression or LOESS<a href="literature-cited.html#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a> lines to the lower plots to help highlight the relationships. The function below is adapted from the help page for <code>pairs()</code>. Notice that the size of the text for each coefficient is scaled to the magnitude of the coefficient. Can you figure out what piece of the code is doing that?</p>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1063-1"><a href="mod-04.html#cb1063-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a function to add correlation coefficients</span></span>
<span id="cb1063-2"><a href="mod-04.html#cb1063-2" aria-hidden="true" tabindex="-1"></a>panel.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">&quot;&quot;</span>, cex.cor, ...)</span>
<span id="cb1063-3"><a href="mod-04.html#cb1063-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1063-4"><a href="mod-04.html#cb1063-4" aria-hidden="true" tabindex="-1"></a>    usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr))</span>
<span id="cb1063-5"><a href="mod-04.html#cb1063-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1063-6"><a href="mod-04.html#cb1063-6" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y)</span>
<span id="cb1063-7"><a href="mod-04.html#cb1063-7" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>]</span>
<span id="cb1063-8"><a href="mod-04.html#cb1063-8" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(prefix, txt)</span>
<span id="cb1063-9"><a href="mod-04.html#cb1063-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb1063-10"><a href="mod-04.html#cb1063-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">abs</span>(r))</span>
<span id="cb1063-11"><a href="mod-04.html#cb1063-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1063-12"><a href="mod-04.html#cb1063-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1063-13"><a href="mod-04.html#cb1063-13" aria-hidden="true" tabindex="-1"></a><span class="co"># example of use:</span></span>
<span id="cb1063-14"><a href="mod-04.html#cb1063-14" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x[,<span class="fu">c</span>(<span class="dv">2</span>, dat.cols)], </span>
<span id="cb1063-15"><a href="mod-04.html#cb1063-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower.panel=</span>panel.smooth,</span>
<span id="cb1063-16"><a href="mod-04.html#cb1063-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">upper.panel=</span>panel.cor, <span class="at">gap=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-413-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Sometimes the Spearman rank correlation coefficient <span class="math inline">\(\rho\)</span> is more informative than the Pearson linear correlation coefficient <em>r</em>. The function <code>panel.cor()</code> can be modified to use <span class="math inline">\(\rho\)</span> instead of <em>r</em>:</p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1064-1"><a href="mod-04.html#cb1064-1" aria-hidden="true" tabindex="-1"></a>panel.cor2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">&quot;&quot;</span>, cex.cor, ...)</span>
<span id="cb1064-2"><a href="mod-04.html#cb1064-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1064-3"><a href="mod-04.html#cb1064-3" aria-hidden="true" tabindex="-1"></a>    usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr))</span>
<span id="cb1064-4"><a href="mod-04.html#cb1064-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1064-5"><a href="mod-04.html#cb1064-5" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb1064-6"><a href="mod-04.html#cb1064-6" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>]</span>
<span id="cb1064-7"><a href="mod-04.html#cb1064-7" aria-hidden="true" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(prefix, txt)</span>
<span id="cb1064-8"><a href="mod-04.html#cb1064-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb1064-9"><a href="mod-04.html#cb1064-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">abs</span>(r))</span>
<span id="cb1064-10"><a href="mod-04.html#cb1064-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1064-11"><a href="mod-04.html#cb1064-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1064-12"><a href="mod-04.html#cb1064-12" aria-hidden="true" tabindex="-1"></a><span class="co"># example of use:</span></span>
<span id="cb1064-13"><a href="mod-04.html#cb1064-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (might return warnings but these are ok)</span></span>
<span id="cb1064-14"><a href="mod-04.html#cb1064-14" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x[,dat.cols], </span>
<span id="cb1064-15"><a href="mod-04.html#cb1064-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower.panel=</span>panel.smooth,</span>
<span id="cb1064-16"><a href="mod-04.html#cb1064-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">upper.panel=</span>panel.cor2, <span class="at">gap=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-414-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="lattice-plots-for-hierarchical-data" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Lattice plots for hierarchical data</h3>
<p>In another module we will explore mixed models, also known as hierarchical models, which can account for relationships that differ between groups of data. These are similar in some ways to analysis of covariance (ANCOVA) models with interactions. An example of what ANCOVA can look like is shown below:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-415-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>In the left panel, the <em>Y</em> variable increases as a function of the <em>X</em> variable. There is also an effect of the group variable (i.e., a factor): <em>Y</em> values in group 2 are on average greater than values in group 1. This is called “main effects” ANCOVA. In the right panel, <em>Y</em> increases with <em>X</em>, and the slope of <em>Y</em> with respect to <em>X</em> varies between groups. In other words, <em>X</em> has a greater effect on <em>Y</em> in group 2 than in group 1. This is called an “interaction” between <em>X</em> and the grouping variable. Analyses that include such interactions are sometimes called “interaction effects” ANCOVA because the effects of one variable “interact with” the effects of another variable. Both types of ANCOVA are extremely common in biology.</p>
<p>One key difference between an ANCOVA model and a mixed model is that while in ANCOVA the slope and intercept are fitted specifically to each level of the grouping variable, consuming degrees of freedom, in a mixed model these slopes and intercepts are considered to be drawn from a random distribution. For now, all you need to understand is that the relationship between response and predictor variables can differ between groups. A <strong>lattice</strong> or <strong>trellis</strong> plot is a way to visualize such differences. In R these are named for package <code>lattice</code> which is an older package for producing hierarchical plots. The newer <code>tidyverse</code> packages can also do the job (and are becoming much more popular than <code>lattice</code>, from what I can tell).</p>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="mod-04.html#cb1065-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1065-2"><a href="mod-04.html#cb1065-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1065-3"><a href="mod-04.html#cb1065-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot of 2 continuous variables</span></span>
<span id="cb1065-4"><a href="mod-04.html#cb1065-4" aria-hidden="true" tabindex="-1"></a><span class="co"># by species</span></span>
<span id="cb1065-5"><a href="mod-04.html#cb1065-5" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(Petal.Length <span class="sc">~</span> Sepal.Length <span class="sc">|</span> Species, <span class="at">data=</span>iris)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-416-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Lattice plots can group observations by more than one variable, as shown below.</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1066-1"><a href="mod-04.html#cb1066-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add another (pretend) variable</span></span>
<span id="cb1066-2"><a href="mod-04.html#cb1066-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb1066-3"><a href="mod-04.html#cb1066-3" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb1066-4"><a href="mod-04.html#cb1066-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1066-5"><a href="mod-04.html#cb1066-5" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(Petal.Length <span class="sc">~</span> Sepal.Length <span class="sc">|</span> Species<span class="sc">+</span>color, <span class="at">data=</span>x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-417-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1067-1"><a href="mod-04.html#cb1067-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same plot, different layout:</span></span>
<span id="cb1067-2"><a href="mod-04.html#cb1067-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(Petal.Length <span class="sc">~</span> Sepal.Length <span class="sc">|</span> color<span class="sc">+</span>Species, <span class="at">data=</span>x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-417-2.png" width="768" style="display: block; margin: auto;" /></p>
<p><code>lattice</code> can also produce hierarchical boxplots. This is the graphical equivalent of <a href="mod-04.html#mod-04-tabagg">aggregating by more than one variable</a>.</p>
<div class="sourceCode" id="cb1068"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1068-1"><a href="mod-04.html#cb1068-1" aria-hidden="true" tabindex="-1"></a><span class="co"># box-and-whisker plots by color within species</span></span>
<span id="cb1068-2"><a href="mod-04.html#cb1068-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(Petal.Length<span class="sc">~</span>color<span class="sc">|</span>Species, <span class="at">data=</span>x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-418-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The <code>tidyverse</code> equivalent to the first <code>lattice</code> plot above is:</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="mod-04.html#cb1069-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1069-2"><a href="mod-04.html#cb1069-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>x) <span class="sc">+</span> </span>
<span id="cb1069-3"><a href="mod-04.html#cb1069-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span> </span>
<span id="cb1069-4"><a href="mod-04.html#cb1069-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-419-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1070-1"><a href="mod-04.html#cb1070-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same plot, different layout:</span></span>
<span id="cb1070-2"><a href="mod-04.html#cb1070-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>x) <span class="sc">+</span> </span>
<span id="cb1070-3"><a href="mod-04.html#cb1070-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span> </span>
<span id="cb1070-4"><a href="mod-04.html#cb1070-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-419-2.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1071-1"><a href="mod-04.html#cb1071-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same plot, another layout:</span></span>
<span id="cb1071-2"><a href="mod-04.html#cb1071-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>x) <span class="sc">+</span> </span>
<span id="cb1071-3"><a href="mod-04.html#cb1071-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>Petal.Length, <span class="at">x=</span>color)) <span class="sc">+</span> </span>
<span id="cb1071-4"><a href="mod-04.html#cb1071-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species,<span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-419-3.png" width="768" style="display: block; margin: auto;" /></p>
<p>Whether you use <code>lattice</code> or <code>ggplot2</code> to make your hierarchical graphs is largely a matter of personal preference. Both packages work just fine for exploratory data analysis. Both share the advantage of being very fast, with the ability to represent a lot of data with very little “ink” and code. Both share the disadvantage of being tricky to customize because many of the graphical options are “hidden” inside layers of other functions.</p>
<p>If you need to present a hierarchical plot in a presentation or manuscript, and need to meet very specific formatting requirements, you may need to make your figure using <code>base</code> graphics. The commands below reproduce the figures above in <code>base</code> graphics. Note that while using <code>base</code> graphics requires more coding to get the same result, it is much easier to customize the plots because the plotting options are not buried inside other functions.</p>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1072-1"><a href="mod-04.html#cb1072-1" aria-hidden="true" tabindex="-1"></a>flag1 <span class="ot">&lt;-</span> <span class="fu">which</span>(x<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;setosa&quot;</span>)</span>
<span id="cb1072-2"><a href="mod-04.html#cb1072-2" aria-hidden="true" tabindex="-1"></a>flag2 <span class="ot">&lt;-</span> <span class="fu">which</span>(x<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;versicolor&quot;</span>)</span>
<span id="cb1072-3"><a href="mod-04.html#cb1072-3" aria-hidden="true" tabindex="-1"></a>flag3 <span class="ot">&lt;-</span> <span class="fu">which</span>(x<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;virginica&quot;</span>)</span>
<span id="cb1072-4"><a href="mod-04.html#cb1072-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1072-5"><a href="mod-04.html#cb1072-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1072-6"><a href="mod-04.html#cb1072-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1072-7"><a href="mod-04.html#cb1072-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb1072-8"><a href="mod-04.html#cb1072-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x<span class="sc">$</span>Sepal.Length[flag1], x<span class="sc">$</span>Petal.Length[flag1], </span>
<span id="cb1072-9"><a href="mod-04.html#cb1072-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), </span>
<span id="cb1072-10"><a href="mod-04.html#cb1072-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;Sepal length&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Petal length&quot;</span>) </span>
<span id="cb1072-11"><a href="mod-04.html#cb1072-11" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">italic</span>(Iris)<span class="sc">~</span><span class="fu">italic</span>(setosa)))</span>
<span id="cb1072-12"><a href="mod-04.html#cb1072-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x<span class="sc">$</span>Sepal.Length[flag2], x<span class="sc">$</span>Petal.Length[flag2], </span>
<span id="cb1072-13"><a href="mod-04.html#cb1072-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), </span>
<span id="cb1072-14"><a href="mod-04.html#cb1072-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;Sepal length&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Petal length&quot;</span>) </span>
<span id="cb1072-15"><a href="mod-04.html#cb1072-15" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">italic</span>(Iris)<span class="sc">~</span><span class="fu">italic</span>(versicolor)))</span>
<span id="cb1072-16"><a href="mod-04.html#cb1072-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x<span class="sc">$</span>Sepal.Length[flag3], x<span class="sc">$</span>Petal.Length[flag3], </span>
<span id="cb1072-17"><a href="mod-04.html#cb1072-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), </span>
<span id="cb1072-18"><a href="mod-04.html#cb1072-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;Sepal length&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Petal length&quot;</span>) </span>
<span id="cb1072-19"><a href="mod-04.html#cb1072-19" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">italic</span>(Iris)<span class="sc">~</span><span class="fu">italic</span>(virginica)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-420-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Here is the hierarchical boxplot:</p>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1073-1"><a href="mod-04.html#cb1073-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>), </span>
<span id="cb1073-2"><a href="mod-04.html#cb1073-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb1073-3"><a href="mod-04.html#cb1073-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb1073-4"><a href="mod-04.html#cb1073-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Length<span class="sc">~</span>color, <span class="at">data=</span>x[flag1,], </span>
<span id="cb1073-5"><a href="mod-04.html#cb1073-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Color&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Petal length&quot;</span>,</span>
<span id="cb1073-6"><a href="mod-04.html#cb1073-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</span>
<span id="cb1073-7"><a href="mod-04.html#cb1073-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">italic</span>(Iris)<span class="sc">~</span><span class="fu">italic</span>(setosa)))</span>
<span id="cb1073-8"><a href="mod-04.html#cb1073-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Length<span class="sc">~</span>color, <span class="at">data=</span>x[flag2,],</span>
<span id="cb1073-9"><a href="mod-04.html#cb1073-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Color&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Petal length&quot;</span>,</span>
<span id="cb1073-10"><a href="mod-04.html#cb1073-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</span>
<span id="cb1073-11"><a href="mod-04.html#cb1073-11" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">italic</span>(Iris)<span class="sc">~</span><span class="fu">italic</span>(versicolor)))</span>
<span id="cb1073-12"><a href="mod-04.html#cb1073-12" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Length<span class="sc">~</span>color, <span class="at">data=</span>x[flag3,], </span>
<span id="cb1073-13"><a href="mod-04.html#cb1073-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Color&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Petal length&quot;</span>,</span>
<span id="cb1073-14"><a href="mod-04.html#cb1073-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</span>
<span id="cb1073-15"><a href="mod-04.html#cb1073-15" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">italic</span>(Iris)<span class="sc">~</span><span class="fu">italic</span>(virginica)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-421-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="ordination-brief-introduction" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Ordination (brief introduction)</h2>
<p>The methods above are a way to examine single variables, or single pairs of variables. But what about many variables at once? In other words, how can we examine variation between samples by taking into account multiple variables at once? This is the realm of <strong>multivariate statistics</strong>. In biology many of the most common multivariate methods revolve around ordination.</p>
<p><strong>Ordination</strong> is literally plotting or ordering observations along two or more axes. How that ordering is done varies wildly among techniques. We will get deeper into ordination later in the course, but for now let’s look at just two ordination techniques, <strong>principal components analysis (PCA)</strong> and <strong>nonmetric multidimensional scaling (NMDS or NMS)</strong>, with a focus on interpretation rather than calculation. Some of the goals of all ordination techniques are:</p>
<ul>
<li><strong>Cluster identification:</strong> observations that are closer to each other in the ordination space are more similar to each other</li>
<li><strong>Dimension reduction:</strong> the axes of an ordination are estimates of synthetic variables that combine information about many variables at once</li>
</ul>
<div id="principal-components-analysis-pca" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Principal components analysis (PCA)</h3>
<p>Principal components analysis (PCA) is a method for extracting gradients from a multivariate dataset that capture most of the variation in that dataset. These gradients are calculated by finding linear combinations of the variables that minimize sums of squared deviations from the gradient. This means that PCA has a lot in common with linear regression, and many of the same assumptions apply.</p>
<p>If you’ve never heard of PCA or ordination, it might be worth watching a video that explains and shows the basic ideas. Here is <a href="https://www.youtube.com/watch?v=HMOI_lkzW08">one that only takes 5 minutes and has a nice theme song</a> (accessed 2021-08-10). For a more in-depth introduction to PCA, see <a href="mod-08.html#mod-08-ord">this page</a>. Then come back here for some notes on how to use PCA for data exploration.</p>
<p>PCA is available in base R using the functions <code>prcomp()</code> and <code>princomp()</code>. Both of these functions produce similar outputs, but there are some subtle differences between them. For this course we are going to use the functions in package <code>vegan</code>. Although designed for community ecology, <code>vegan</code> is widely used for ordination and multivariate analysis in many fields. Importantly, <code>vegan</code> is actively maintained and updated with new techniques as they are developed. Also importantly, <code>vegan</code> offers a common interface for many kinds of ordination.</p>
<p>The example below uses the <code>varespec</code> dataset from <code>vegan</code>. Each column contains % cover by different species of plants in lichen pastures in northern Finland and Scandinavia. For the sake of making a simple example, we will ordinate only the 15 species with the most variance (many species in the dataset are rare or sparse, so including them makes the plot harder to interpret…in “real life”, don’t remove variables from your analysis without good reason!).</p>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1074-1"><a href="mod-04.html#cb1074-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span></code></pre></div>
<pre><code>## Loading required package: permute</code></pre>
<pre><code>## This is vegan 2.5-7</code></pre>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1077-1"><a href="mod-04.html#cb1077-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get data and make a spare copy</span></span>
<span id="cb1077-2"><a href="mod-04.html#cb1077-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varespec)</span>
<span id="cb1077-3"><a href="mod-04.html#cb1077-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> varespec</span>
<span id="cb1077-4"><a href="mod-04.html#cb1077-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1077-5"><a href="mod-04.html#cb1077-5" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the variables with most variance</span></span>
<span id="cb1077-6"><a href="mod-04.html#cb1077-6" aria-hidden="true" tabindex="-1"></a>vx <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">sort</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, var)))</span>
<span id="cb1077-7"><a href="mod-04.html#cb1077-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[,<span class="fu">names</span>(vx)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]]</span>
<span id="cb1077-8"><a href="mod-04.html#cb1077-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1077-9"><a href="mod-04.html#cb1077-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate PCA and plot it</span></span>
<span id="cb1077-10"><a href="mod-04.html#cb1077-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">rda</span>(x, <span class="at">scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb1077-11"><a href="mod-04.html#cb1077-11" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(p1)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-422-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The figure above is called a <strong>PCA biplot</strong>. Each point is a sample (site) where vegetation was sampled. By default, the samples are identified by their row number. The red arrows show sites where different species were more abundant (or, more generally, where the variables are increasing). For example, sites towards the top right had greater cover by species “Cladstel” (short for <em>Cladonia stellaris</em>). Sites towards the lower left had less cover by Cladstel. Sites towards the top left had more cover by “Pleuschr” (<em>Pleurozium schreberi</em>).</p>
<p>The <code>summary()</code> command will print a lot of information about the ordination. It prints the eigenvalues of each PC, then scales them as “Proportion explained”. I.e., the proportion of variation explained by each PC is the same as its eigenvalue divided by the sum of all eigenvalues.</p>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="mod-04.html#cb1078-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(p1)</span></code></pre></div>
<pre><code>## 
## Call:
## rda(X = x, scale = TRUE) 
## 
## Partitioning of correlations:
##               Inertia Proportion
## Total              10          1
## Unconstrained      10          1
## 
## Eigenvalues, and their contribution to the correlations 
## 
## Importance of components:
##                          PC1    PC2    PC3    PC4     PC5    PC6     PC7     PC8     PC9    PC10
## Eigenvalue            2.7808 1.9382 1.3148 1.0987 0.83622 0.7150 0.69134 0.33428 0.17151 0.11919
## Proportion Explained  0.2781 0.1938 0.1315 0.1099 0.08362 0.0715 0.06913 0.03343 0.01715 0.01192
## Cumulative Proportion 0.2781 0.4719 0.6034 0.7132 0.79687 0.8684 0.93750 0.97093 0.98808 1.00000
## 
## Scaling 2 for species and site scores
## * Species are scaled proportional to eigenvalues
## * Sites are unscaled: weighted dispersion equal on all dimensions
## * General scaling constant of scores:  3.894323 
## 
## 
## Species scores
## 
##               PC1        PC2     PC3     PC4      PC5      PC6
## Cladstel  0.22980 -0.9638221  0.2063 -0.5766  0.22839 -0.13546
## Pleuschr -0.94726  0.3626752 -0.2495  0.2859  0.31322 -0.08035
## Cladrang  1.03450 -0.0478938 -0.2618  0.4311  0.14433 -0.14610
## Cladarbu  0.92222  0.5003246 -0.1221  0.3915 -0.31092  0.13843
## Dicrfusc -0.33989  0.7013881 -0.1721 -0.5513 -0.19752 -0.32352
## Vaccviti -0.57531 -0.5738560  0.1310  0.1739 -0.66855  0.52296
## Dicrsp   -0.38606  0.2903390  0.8144  0.3716  0.52606  0.26321
## Callvulg  0.34621  0.5471556 -0.3068 -0.6120  0.25486  0.73026
## Cladunci -0.02526  0.6491055  0.7160 -0.1866 -0.41338 -0.19511
## Vaccmyrt -0.79400 -0.0005864 -0.6992  0.1767 -0.04322 -0.01670
## 
## 
## Site scores (weighted sums of species scores)
## 
##         PC1      PC2       PC3      PC4      PC5        PC6
## 18  0.39657 -0.16342 -0.079895  0.68235 -0.98085  0.6198150
## 15 -0.40025  0.48524 -0.119881  0.10251 -0.25276 -0.2907006
## 24 -0.88573  0.67138  2.334307  1.08698  1.26348  0.8403431
## 27 -1.10452 -0.03240 -0.660890  0.55886  0.14165 -0.0003119
## 23 -0.40297 -0.35825  0.084662  0.42892 -1.19313  0.8452582
## 19 -0.26161 -0.30040 -0.123290  0.01983  0.17886 -0.1684937
## 22 -0.85012  1.13056 -0.797382 -1.33729 -0.65017 -0.5866657
## 16 -0.15994  0.98635 -0.571647 -0.91477  0.37822 -0.8158903
## 28 -1.65484  0.25754 -1.629606  0.80391  1.00293 -0.5951382
## 13  1.11019  1.09130 -0.918028 -1.32805  1.01767  2.7409133
## 14  0.14308  1.65235  1.451371 -1.01710 -1.53004 -0.9476702
## 20 -0.14436  0.02087  0.385155  0.19971 -0.55881  0.0248203
## 25 -0.70668  0.52484  0.951767  0.41019  0.99674  0.1995443
## 7   1.27601  0.28464 -0.392360  1.25885 -0.39985 -0.1596378
## 5   1.33049  0.15587 -0.500076  1.08816  0.58014 -0.9228755
## 6   1.24463  0.31814 -0.096950  1.06221 -0.85622 -0.0198950
## 3   0.70748 -0.62339  0.020031 -0.26749  0.77095 -0.8805476
## 4   0.73772  0.02904 -0.134862 -0.22867  0.70704 -0.3411419
## 2   0.39724 -1.10654  0.219538 -0.67452  0.72211 -0.6843507
## 9  -0.23911 -1.53329  0.521191 -0.91391 -0.36176  0.3560478
## 12  0.05053 -1.04256  0.379673 -0.50633 -0.09530  0.0281206
## 10  0.09930 -1.27173  0.418480 -1.00789  0.35197 -0.2898518
## 11  0.32926 -0.31288 -0.003708  0.12732  0.07082  0.0582269
## 21 -1.01237 -0.86325 -0.737599  0.36622 -1.30368  0.9900814</code></pre>
<p>The “Importance of components” part tells us that the first principal component (PC1) explains about 55% of the variation in the dataset. PC2 explains an additional 26%. The rule of thumb is to present enough PCs to account for <span class="math inline">\(\ge\)</span> 80% of the variation. In this case, PC1 and PC2 are sufficient. If it takes many PCs to reach 80% of variation, that may be a sign that the PCs are not capturing much meaningful structure in your dataset (or, there simply isn’t much structure to capture).</p>
<p>Finally, we can see the variable “loadings”, which tell us how much each variable is correlated with each principal component<a href="literature-cited.html#fn46" class="footnote-ref" id="fnref46"><sup>46</sup></a>. These values are interpreted the same way as linear correlation coefficients. In the example below the loadings for PCs 1-4 are requested using argument choices = 1:4.</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="mod-04.html#cb1080-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scores</span>(p1, <span class="at">choices =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">scaling =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##                 PC1           PC2         PC3        PC4
## Cladstel  0.1118986 -0.5621722123  0.14606363 -0.4467186
## Pleuschr -0.4612677  0.2115389675 -0.17670529  0.2214946
## Cladrang  0.5037497 -0.0279351716 -0.18537465  0.3339431
## Cladarbu  0.4490762  0.2918262462 -0.08645467  0.3032787
## Dicrfusc -0.1655069  0.4091013432 -0.12191016 -0.4270946
## Vaccviti -0.2801468 -0.3347151730  0.09280300  0.1347303
## Dicrsp   -0.1879928  0.1693471498  0.57673161  0.2878989
## Callvulg  0.1685866  0.3191415425 -0.21724150 -0.4741263
## Cladunci -0.0123003  0.3786062372  0.50705444 -0.1445745
## Vaccmyrt -0.3866379 -0.0003420561 -0.49518742  0.1368990
## attr(,&quot;const&quot;)
## [1] 3.894323</code></pre>
<p>The loadings tell us that PC1 is strongly influenced by species Cladstel and less so by Pleuschr. Compare this to the orientation and lengths of the arrows for these species in the biplot and see if you can find a connection.</p>
</div>
<div id="nonmetric-multidimensional-scaling-nmds" class="section level3" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Nonmetric multidimensional scaling (NMDS)</h3>
<p>PCA and many related techniques are based on linear algebra and eigenvalues. This is fine for datasets where variables are mostly linearly related to each other, or can be transformed to be linearly related. Most of the eigenvalue-based techniques also require data to be mostly normally distributed.</p>
<p>If relationships between variables are nonlinear, or if the many other assumptions of eigenvalue-based ordination cannot be met, then the next best option is a non-parametric ordination technique called nonmetric multidimensional scaling (NMDS or NMS). Unlike PCA, which solves linear algebra problems to extract synthetic gradients (“principal components”), NMDS works by trying iteratively to arrange the samples into a reduced dimensional space that preserves the rank order of the distance matrix.</p>
<p>What? Let’s break that down:</p>
<p><strong>Distance matrix:</strong> a matrix containing a measure of dissimilarity (aka: “distance”) between each pair of samples. This is exactly analogous to a road mileage chart in an old paper road atlas.</p>
<p><strong>Distance (dissimilarity) measure:</strong> a quantity that measures how different two samples are in terms of several variables. Greater values indicate that two samples are more different from each other; smaller values indicate that two samples are more similar to each other. See <a href="mod-08.html#mod-08-dist">this page</a> for a more in-depth explanation of distance measures.</p>
<p>The most famous distance metric is the Euclidean distance metric, shown here as the distance between two points on the <em>XY</em> plane:</p>
<p><span class="math display">\[D_{Euc.}=\sqrt{\left(x_1-x_2\right)^2+\left(y_1-y_2\right)^2}\]</span></p>
<p>The metric can be generalized to any number of dimensions <em>k</em>.</p>
<p><span class="math display">\[D_{Euc.}=\sqrt{\sum_{k=1}^{k}\left(x_1-x_2\right)^2}\]</span></p>
<p>The Euclidean distance is rarely used for NMDS. Instead, the default distance metric is the <strong>Bray-Curtis distance</strong>. This metric is called <strong>Sørensen distance</strong> when used for binary values (e.g., presence-absence), and Bray-Curtis when used for quantitative values.</p>
<p>The distance matrix contains the dissimilarities between samples, in terms of all of the variables in the dataset. If there are <em>k</em> variables, then these are distances through <em>k</em>-dimensional space. NMDS tries to represent the relative dissimilarities between samples in fewer than <em>k</em> dimensions, while preserving the <strong>rank order</strong> of those dissimilarities.</p>
<p>The R function <code>metaMDS()</code> performs NMDS. Getting a biplot of the ordination is a little more involved than for PCA. Note that NMDS involves some random number sampling in its algorithms, so you should set the random number seed to make sure your analysis is reproducible.</p>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1082-1"><a href="mod-04.html#cb1082-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1082-2"><a href="mod-04.html#cb1082-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1082-3"><a href="mod-04.html#cb1082-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fit NMDS</span></span>
<span id="cb1082-4"><a href="mod-04.html#cb1082-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(x)</span></code></pre></div>
<pre><code>## Square root transformation
## Wisconsin double standardization
## Run 0 stress 0.1258291 
## Run 1 stress 0.128478 
## Run 2 stress 0.128478 
## Run 3 stress 0.1273261 
## Run 4 stress 0.2014993 
## Run 5 stress 0.1991787 
## Run 6 stress 0.128478 
## Run 7 stress 0.128478 
## Run 8 stress 0.128478 
## Run 9 stress 0.1258291 
## ... Procrustes: rmse 2.910913e-06  max resid 9.961616e-06 
## ... Similar to previous best
## Run 10 stress 0.1258291 
## ... Procrustes: rmse 1.699748e-06  max resid 4.320923e-06 
## ... Similar to previous best
## Run 11 stress 0.128478 
## Run 12 stress 0.128478 
## Run 13 stress 0.128478 
## Run 14 stress 0.1258291 
## ... Procrustes: rmse 1.791907e-06  max resid 5.731764e-06 
## ... Similar to previous best
## Run 15 stress 0.128478 
## Run 16 stress 0.1976983 
## Run 17 stress 0.1258291 
## ... Procrustes: rmse 3.90069e-06  max resid 1.369466e-05 
## ... Similar to previous best
## Run 18 stress 0.1273261 
## Run 19 stress 0.1258291 
## ... Procrustes: rmse 2.251913e-06  max resid 7.461718e-06 
## ... Similar to previous best
## Run 20 stress 0.235875 
## *** Solution reached</code></pre>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1084-1"><a href="mod-04.html#cb1084-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract &quot;scores&quot; (coordinates in NMDS space)</span></span>
<span id="cb1084-2"><a href="mod-04.html#cb1084-2" aria-hidden="true" tabindex="-1"></a><span class="co"># these are matrices: column 1 = x, column 2 = y</span></span>
<span id="cb1084-3"><a href="mod-04.html#cb1084-3" aria-hidden="true" tabindex="-1"></a>n1s <span class="ot">&lt;-</span> <span class="fu">scores</span>(n1, <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb1084-4"><a href="mod-04.html#cb1084-4" aria-hidden="true" tabindex="-1"></a>n1p <span class="ot">&lt;-</span> <span class="fu">scores</span>(n1, <span class="st">&quot;species&quot;</span>)</span>
<span id="cb1084-5"><a href="mod-04.html#cb1084-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1084-6"><a href="mod-04.html#cb1084-6" aria-hidden="true" tabindex="-1"></a><span class="co"># basic NMDS plot</span></span>
<span id="cb1084-7"><a href="mod-04.html#cb1084-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n1s)</span>
<span id="cb1084-8"><a href="mod-04.html#cb1084-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add biplot arrows and labels</span></span>
<span id="cb1084-9"><a href="mod-04.html#cb1084-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, n1p[,<span class="dv">1</span>], n1p[,<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1084-10"><a href="mod-04.html#cb1084-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(n1p[,<span class="dv">1</span>], n1p[,<span class="dv">2</span>], <span class="fu">rownames</span>(n1p), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">xpd=</span><span class="cn">NA</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-425-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Because NMDS solutions are reached through random sampling, they are not guaranteed to reach a stable condition every time. You will need to set the random number seed to get reproducible results. There is also no guarantee that the solution reached by NMDS will be the optimal one.</p>
<p>Another consequence of the way that NMDS works is that the axes themselves are arbitrary, unlike the axes in PCA. This means that we can’t calculate a percentage of variation explained by each axis the way we did for PCA. By default, R will rotate NMDS solutions so that the greatest amount of variation is associated with axis 1, but there is no guarantee that this axis captures a meaningful biological gradient.</p>
<p>The most important diagnostic parameter in an NMDS is the <strong>stress</strong>, which is a measure of how much the distance matrix is distorted by compression into low dimensional space. Lower stress value indicate better fit. Most people consider a stress <span class="math inline">\(\ge\)</span> 0.2 to indicate an unreliable fit. Some authors recommend lower thresholds like 0.15 or 0.1. Package <code>vegan</code> and most sources use stress values &lt;1 <span class="citation">(e.g., <a href="#ref-legendre2012numerical" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>; some authors scale stress by a factor of 100 relative to the values in <code>vegan</code>. For example, the program PC-ORD <span class="citation">(<a href="#ref-mccune2002analysis" role="doc-biblioref">McCune et al. 2002</a>)</span> uses stress values on this greater scale.</p>
</div>
<div id="plotting-ordinations" class="section level3" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Plotting ordinations</h3>
<p>Extracting the scores from an ordination object can let you plot points with all of the <code>base</code> graphics formatting tricks we learned above, such as using color or shape to indicate group membership. In my experience this is more flexible than using the built-in graphics capabilities in <code>vegan</code><a href="literature-cited.html#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a>, but your mileage may vary.</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="mod-04.html#cb1085-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> crabs</span>
<span id="cb1085-2"><a href="mod-04.html#cb1085-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">rda</span>(x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>])</span>
<span id="cb1085-3"><a href="mod-04.html#cb1085-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>])</span></code></pre></div>
<pre><code>## Square root transformation
## Wisconsin double standardization
## Run 0 stress 0.08013593 
## Run 1 stress 0.08013594 
## ... Procrustes: rmse 2.47761e-06  max resid 3.004629e-05 
## ... Similar to previous best
## Run 2 stress 0.08013594 
## ... Procrustes: rmse 5.318632e-06  max resid 5.42044e-05 
## ... Similar to previous best
## Run 3 stress 0.08013593 
## ... Procrustes: rmse 1.789737e-05  max resid 0.0001945269 
## ... Similar to previous best
## Run 4 stress 0.08013596 
## ... Procrustes: rmse 1.021893e-05  max resid 0.0001280391 
## ... Similar to previous best
## Run 5 stress 0.08013593 
## ... New best solution
## ... Procrustes: rmse 3.631654e-06  max resid 4.608495e-05 
## ... Similar to previous best
## Run 6 stress 0.08013593 
## ... Procrustes: rmse 4.019493e-06  max resid 5.419834e-05 
## ... Similar to previous best
## Run 7 stress 0.08013592 
## ... New best solution
## ... Procrustes: rmse 6.01397e-06  max resid 8.261179e-05 
## ... Similar to previous best
## Run 8 stress 0.08013594 
## ... Procrustes: rmse 1.059936e-05  max resid 0.0001315101 
## ... Similar to previous best
## Run 9 stress 0.08013592 
## ... New best solution
## ... Procrustes: rmse 2.632514e-06  max resid 3.234954e-05 
## ... Similar to previous best
## Run 10 stress 0.08013593 
## ... Procrustes: rmse 1.374691e-05  max resid 0.0001352853 
## ... Similar to previous best
## Run 11 stress 0.08013593 
## ... Procrustes: rmse 9.848983e-06  max resid 9.509947e-05 
## ... Similar to previous best
## Run 12 stress 0.08013593 
## ... Procrustes: rmse 9.871024e-06  max resid 0.0001008813 
## ... Similar to previous best
## Run 13 stress 0.08013593 
## ... Procrustes: rmse 6.457749e-06  max resid 6.335005e-05 
## ... Similar to previous best
## Run 14 stress 0.08013595 
## ... Procrustes: rmse 1.626131e-05  max resid 0.0001518457 
## ... Similar to previous best
## Run 15 stress 0.08013595 
## ... Procrustes: rmse 1.446168e-05  max resid 0.0001679656 
## ... Similar to previous best
## Run 16 stress 0.08013593 
## ... Procrustes: rmse 1.148406e-05  max resid 0.0001448735 
## ... Similar to previous best
## Run 17 stress 0.08013593 
## ... Procrustes: rmse 9.122826e-06  max resid 0.000112683 
## ... Similar to previous best
## Run 18 stress 0.08013594 
## ... Procrustes: rmse 1.22868e-05  max resid 0.0001430928 
## ... Similar to previous best
## Run 19 stress 0.08013595 
## ... Procrustes: rmse 1.588575e-05  max resid 0.000217428 
## ... Similar to previous best
## Run 20 stress 0.08013592 
## ... Procrustes: rmse 2.291841e-06  max resid 1.545649e-05 
## ... Similar to previous best
## *** Solution reached</code></pre>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="mod-04.html#cb1087-1" aria-hidden="true" tabindex="-1"></a>p1s <span class="ot">&lt;-</span> <span class="fu">scores</span>(p1)<span class="sc">$</span>sites</span>
<span id="cb1087-2"><a href="mod-04.html#cb1087-2" aria-hidden="true" tabindex="-1"></a>p1p <span class="ot">&lt;-</span> <span class="fu">scores</span>(p1)<span class="sc">$</span>species</span>
<span id="cb1087-3"><a href="mod-04.html#cb1087-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1087-4"><a href="mod-04.html#cb1087-4" aria-hidden="true" tabindex="-1"></a>n1s <span class="ot">&lt;-</span> <span class="fu">scores</span>(n1, <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb1087-5"><a href="mod-04.html#cb1087-5" aria-hidden="true" tabindex="-1"></a>n1p <span class="ot">&lt;-</span> <span class="fu">scores</span>(n1, <span class="st">&quot;species&quot;</span>)</span>
<span id="cb1087-6"><a href="mod-04.html#cb1087-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1087-7"><a href="mod-04.html#cb1087-7" aria-hidden="true" tabindex="-1"></a>cols1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;F&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1087-8"><a href="mod-04.html#cb1087-8" aria-hidden="true" tabindex="-1"></a>pch1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x<span class="sc">$</span>sp <span class="sc">==</span> <span class="st">&quot;B&quot;</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb1087-9"><a href="mod-04.html#cb1087-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1087-10"><a href="mod-04.html#cb1087-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1087-11"><a href="mod-04.html#cb1087-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1s, <span class="at">col=</span>cols1, <span class="at">pch=</span>pch1, <span class="at">main=</span><span class="st">&quot;PCA fit&quot;</span>)</span>
<span id="cb1087-12"><a href="mod-04.html#cb1087-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb1087-13"><a href="mod-04.html#cb1087-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;B female&quot;</span>, <span class="st">&quot;B male&quot;</span>, <span class="st">&quot;O female&quot;</span>, <span class="st">&quot;O male&quot;</span>),</span>
<span id="cb1087-14"><a href="mod-04.html#cb1087-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1087-15"><a href="mod-04.html#cb1087-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span>
<span id="cb1087-16"><a href="mod-04.html#cb1087-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n1s, <span class="at">col=</span>cols1, <span class="at">pch=</span>pch1, <span class="at">main=</span><span class="st">&quot;NMDS fit&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-426-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="ordination-wrap-up-for-now" class="section level3" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Ordination wrap-up (for now)</h3>
<p>Ordination is a collection of methods for reducing the dimensionality of data. Biological datasets often have many variables, but most variation in those datasets can often be captured using only a few of them (or few combinations of the variables). The positions of the samples in the ordination space can thus reveal patterns that are too complicated to see in the full data space. Interpreting ordination axes in biological terms can be very fruitful. When an axis captures important information about the samples, it can be used as a variable in another method (e.g., as a predictor variable in a linear model). Analysis of clustering or positional differences between groups in ordination space (especially NMDS space) can allow for researchers to test for differences in many variables at once.</p>
</div>
</div>
<div id="mod-04-prob" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Common statistical problems</h2>
<p>Many statistical methods assume that data follow certain distributions, and we have already explored methods for making sure your data follow those distributions. Other problems are not so easy to diagnose or fix. This section will introduce you to some methods for dealing with more subtle data problems. Note that none of these issues have one-size-fits-all solutions. Dealing with these issues will require understanding your study system and thinking through the consequences of potential solutions.</p>
<div id="outliers-and-erroneous-values" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Outliers and erroneous values</h3>
<p>Outliers are values that much larger or smaller than other values in the data set. While these values are theoretically possible in any distribution, they are by their nature extremely unlikely. Outliers can cause problems with many statistical tests because they are often given undue weight. This is because deviations from the mean are often squared.</p>
<p>There are two problems with outliers: how to detect them, and what to do with them.</p>
<div id="detecting-outliers" class="section level4" number="4.8.1.1">
<h4><span class="header-section-number">4.8.1.1</span> Detecting outliers</h4>
<p>There are several definitions of outlier. Some researchers have suggested simple measures such as <em>Z</em>-scores to detect outliers. <em>Z</em>-scores measure how many standard deviations (SD) an observation is away from the mean. The <em>Z</em>-score of an observation <span class="math inline">\(x_i\)</span> (observation <em>i</em> of variable <em>x</em>) is calculated as:</p>
<p><span class="math display">\[Z\left(x_i\right)=\frac{x_i-\bar{x}}{\sigma\left(x\right)}\]</span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> is the mean of <em>x</em> and <span class="math inline">\(\sigma\left(x\right)\)</span> is the SD of <em>x</em>. For example, <em>Z</em>-scores of -2.3 and +4.1 indicate observations 2.3 SD below and 4.1 SD above the mean, respectively. <em>Z</em>-scores are also referred to as <strong>sigmas</strong>, referring to the symbol for SD. E.g., a 4<span class="math inline">\(\sigma\)</span> observation is 4 SD away from the mean. Various <span class="math inline">\(\sigma\)</span> levels have been used to detect outliers, in which researchers discard any observation 2<span class="math inline">\(\sigma\)</span>, 3<span class="math inline">\(\sigma\)</span>, etc., away from the mean. This threshold varies by discipline so follow the conventions in your field.</p>
<p>The figure below shows <em>Z</em>-scores relative to the standard normal distribution (<span class="math inline">\(\mu\)</span> = 0, SD = 1). About 68% of observations are expected to have a <em>Z</em>-score between -1 and 1–i.e., deviate by <span class="math inline">\(\le\)</span> 1 <span class="math inline">\(\sigma\)</span>. About 95% of observations should be <span class="math inline">\(\le\)</span> 2 <span class="math inline">\(\sigma\)</span>, and over 99% of observations should be <span class="math inline">\(\le\)</span> 3 <span class="math inline">\(\sigma\)</span>. The greater the magnitude of a value’s <em>Z</em>-score, the less likely it is. Values with &gt; 3 or 4 <span class="math inline">\(\sigma\)</span> should almost never occur. Thus, observations with large-magnitude <em>Z</em>-scores may turn out to be outliers.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-427-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>It must be noted that a large <em>Z</em>-score does <strong><em>not</em></strong> prove that an observation is an outlier. Like <em>p</em>-values, <em>Z</em>-scores are just a heuristic for making decisions. Don’t just delete any observation <span class="math inline">\(|Z|\ge\)</span> 3; examine those observations to see if they are legitmate and don’t take any action without a good biological reason.</p>
</div>
<div id="dealing-with-outliers" class="section level4" number="4.8.1.2">
<h4><span class="header-section-number">4.8.1.2</span> Dealing with outliers</h4>
<p>The easiest way to deal with outliers is simply to delete them. This can be fine if you have a lot of data—many 1000s or even millions of records. I’ve worked with several statisticians who routinely delete observations with response variables in the top and bottom 5 percentiles. This may not always be an appropriate strategy in biology. For one thing, outliers can occur for completely legitimate reasons and deleting them would be discarding important information about the study system. You should never delete an observation based solely on its magnitude. There should be some other reason: e.g., experimental errors, inappropriate sampling, extraordinary field conditions, etc. Furthermore, you should always document when observations were deleted and why, and disclose that information to reviewers. The possibility of including supplemental information or documents with manuscripts leaves little excuse not to be transparent about what observations you deleted and why.</p>
<p>Another way to deal with outliers is to <a href="mod-04.html#mod-04-trans">transform the data</a>. Variance-stabilizing transformations, such as the log-transform, often have the side-effect of reducing outliers in the data.</p>
<p>The third method for dealing with outliers is <strong>censoring</strong>. Censoring data in statistics means analyzing data as either the measured value or the interval in which the value falls. For example, if a mouse is weighed with a scale that goes up to 60 g, and maxes out the scale, we record the mouse as weighing <span class="math inline">\(\ge\)</span> 60 g. Statistical methods for censored data have been developed but are outside the scope of this course. One popular form of censoring is called <strong>Winsorizing</strong>, where values below the 5th percentile are set to the 5th percentile and values above the 95th percentile are set to the 95th percentile. Censoring is common practice in fields involving certain types of instrumentation. For example, many spectrophotometers (e.g., microplate readers) record <strong>optical density (OD)</strong> as the amount of light passing through a specimen as a measurement of concentration. Most machines have a lower limit to the OD that they can detect. Observations below this minimum OD might be censored to 0, or to some pre-determined fraction of the minimum detectable OD.</p>
<p>Similar to censoring, outlying data can be removed by <strong>truncation</strong>. Truncation in statistics means ignoring values outside of a certain range. As with deletion, you must be very explicit about what criteria were used to truncate the data.</p>
<p><strong>Weighting</strong> is a strategy where observations can be given greater or lesser weight to adjust how much influence they have. This strategy can become very complicated and involve a lot of arbitrary decisions. So, a simpler strategy such as truncation or transformation might be more appropriate.</p>
<p>Finally, researchers can use analysis strategies that are less sensitive to outliers. For example, <strong>robust statistics</strong> use absolute deviations rather than squared deviations. This gives outliers much less influence than under conventional methods based on sums of squared errors. <strong>Nonparametric methods</strong>, particularly those based on rank order, can also be less sensitive to outliers.</p>
<p>Whatever strategy you choose to deal with your outliers, you need to be aware of how much your decision affected the outcome. It is a good idea to analyze your data both with and without suspected outliers to measure how much influence they really have. If the analysis returns the same results with and without the outliers, leave them in.</p>
</div>
</div>
<div id="autocorrelation" class="section level3" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Autocorrelation</h3>
<p>Autocorrelation describes a phenomenon where set of values is correlated with itself, with the strength of that correlation determined by the distance between observations. In biology, the “distance” that defines autocorrelation is often spatial, temporal, or phylogenetic.</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Autocorrelation type</th>
<th>Distance measure</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Spatial</td>
<td>Space (e.g., km)</td>
<td>Samples from sites that are close together in space are more similar to each other than they are to sites that are farther away, just because they are closer to each other.</td>
</tr>
<tr class="even">
<td>Temporal</td>
<td>Time (e.g., days)</td>
<td>Observations taken closer together in time are more similar to each other than they are to observations separated by more time.</td>
</tr>
<tr class="odd">
<td>Phylogenetic</td>
<td>Relatedness</td>
<td>Taxa that share a more recent common ancestor (i.e., are more closely related) are more similar to each other than they are to taxa that are less closely related to each other.</td>
</tr>
</tbody>
</table>
<p>The main consequence of autocorrelation is similar to the problems associated with pseudoreplication: because observations are not independent, the statistically relevant number of observations (degrees of freedom) is smaller than the nominal number of observations. This means that the power of the test is inflated. A related idea is that the residuals of a statistical model can be autocorrelated. In that case, the model violates the assumption of independent residuals shared by most statistical methods. Autocorrelation can be controlled for if you have some idea of its source and nature.</p>
<div id="graphical-methods-to-identify-autocorrelation" class="section level4" number="4.8.2.1">
<h4><span class="header-section-number">4.8.2.1</span> Graphical methods to identify autocorrelation</h4>
<p>One way to explore potential autocorrelation is to construct a variogram. A variogram plots the squared differences between samples against their distance (temporal, spatial, etc.). A semivariogram uses half of that variance. An example semivariogram is below.</p>
<p>This figure shows some important quantities on the semivariogram:</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_13.jpg" /></p>
<ul>
<li><strong>Nugget</strong>: The variance or semivariance at 0 distance. I.e., the y-intercept. Variation at zero distance represents other sources of error, such as sampling error, demographic stochasticity, etc.</li>
<li><strong>Sill</strong>: The variance or semivariance at which the curve gets close to its maximum or asymptotic value.</li>
<li><strong>Range</strong>: The distance at which the variance or semivariance reaches the sill.</li>
</ul>
<p>Semivariograms should always increase, at least initially, because closer observations should be similar to each other simply as a matter of proximity. Samples separated by distances less than the range are autocorrelated. Semivariograms sometimes reach a peak and then start decreasing, or varying up and down. The initial peak is usually interpreted as the sill, and the distance when the curve reaches the sill is considered the range. The importance and interpreation of the semivariogram is something that you, as a biologist, have to figure out.</p>
</div>
<div id="mantel-tests-for-autocorrelation" class="section level4" number="4.8.2.2">
<h4><span class="header-section-number">4.8.2.2</span> Mantel tests for autocorrelation</h4>
<p><strong>Spatial autocorrelation</strong> is a particular problem for ecologists and environmental biologists. The <a href="mod-08.html#mod-08-sims"><strong>Mantel test</strong></a> can be used to measure spatial autocorrelation as the correlation between distance in space and distance in terms of the measured variables. Generally, the Mantel test can be thought of as a multivariate generalization of linear correlation that measures correlation between two matrices. Whereas linear correlation measures how variation in one variable is related to variation in another variable, the Mantel test measures how variation in one matrix (i.e., set of variables) is related to variation in another matrix.</p>
<p>The application to spatial autocorrelation is obvious. The spatial distance matrix can be calculated from coordinates such as latitude or longitude<a href="literature-cited.html#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a>, and compared to the biological distance matrix. When other types of autocorrelation are of interest, you can calculate a distance matrix based on time or on phylogenetic relatedness, or whatever else might be driving the autocorrelation.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/04_11.jpg" /></p>
<p>The <a href="mod-08.html#mod-08-sims">Mantel test</a> works by first calculating two <strong>distance matrices</strong>, which define the <a href="mod-08.html#mod-08-dist">“distances” or “dissimilarities” between each sample</a>. One distance matrix relates to spatial, temporal, or phylogenetic distance. The other relates to dissimilarity in terms of the measured variables. The dissimilarity metric incorporates information about how much any pair of observations differ in terms of every variable represented in the matrix. The Mantel correlation coefficient <em>r</em> is the linear correlation coefficient (like Pearson’s <em>r</em>) between the two distance matrices. It answers the question, “How is variation in this set of variables related to distance in space (or time, or phylogeny)?”.</p>
<p>The example below illustrates another use for the Mantel test: measuring association between two sets of variables taken from the same sample units. In this example, dissimilarity in terms of species composition is related to dissimilarity in soil chemical characteristics.</p>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1088-1"><a href="mod-04.html#cb1088-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1088-2"><a href="mod-04.html#cb1088-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1088-3"><a href="mod-04.html#cb1088-3" aria-hidden="true" tabindex="-1"></a><span class="co"># biological data</span></span>
<span id="cb1088-4"><a href="mod-04.html#cb1088-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varespec)</span>
<span id="cb1088-5"><a href="mod-04.html#cb1088-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1088-6"><a href="mod-04.html#cb1088-6" aria-hidden="true" tabindex="-1"></a><span class="co"># soil chemistry data</span></span>
<span id="cb1088-7"><a href="mod-04.html#cb1088-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varechem)</span>
<span id="cb1088-8"><a href="mod-04.html#cb1088-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1088-9"><a href="mod-04.html#cb1088-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> varechem</span>
<span id="cb1088-10"><a href="mod-04.html#cb1088-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> varespec</span>
<span id="cb1088-11"><a href="mod-04.html#cb1088-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1088-12"><a href="mod-04.html#cb1088-12" aria-hidden="true" tabindex="-1"></a>dy <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(varespec) <span class="co"># Bray-Curtis metric</span></span>
<span id="cb1088-13"><a href="mod-04.html#cb1088-13" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">scale</span>(varechem), <span class="st">&quot;euclid&quot;</span>) <span class="co"># Euclidean metric</span></span>
<span id="cb1088-14"><a href="mod-04.html#cb1088-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(dx, dy)</span></code></pre></div>
<pre><code>## 
## Mantel statistic based on Pearson&#39;s product-moment correlation 
## 
## Call:
## mantel(xdis = dx, ydis = dy) 
## 
## Mantel statistic r: 0.3047 
##       Significance: 0.002 
## 
## Upper quantiles of permutations (null model):
##   90%   95% 97.5%   99% 
## 0.130 0.152 0.170 0.195 
## Permutation: free
## Number of permutations: 999</code></pre>
<div class="sourceCode" id="cb1090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1090-1"><a href="mod-04.html#cb1090-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1090-2"><a href="mod-04.html#cb1090-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>)</span>
<span id="cb1090-3"><a href="mod-04.html#cb1090-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dx, dy, <span class="at">xlab=</span><span class="st">&quot;Chemical dissimilarity&quot;</span>,</span>
<span id="cb1090-4"><a href="mod-04.html#cb1090-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Vegetation dissimilarity&quot;</span>,</span>
<span id="cb1090-5"><a href="mod-04.html#cb1090-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb1090-6"><a href="mod-04.html#cb1090-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, </span>
<span id="cb1090-7"><a href="mod-04.html#cb1090-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">expression</span>(Mantel<span class="sc">~</span><span class="fu">italic</span>(r)<span class="sc">==</span><span class="fl">0.305</span>),</span>
<span id="cb1090-8"><a href="mod-04.html#cb1090-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb1090-9"><a href="mod-04.html#cb1090-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">5.38</span>, <span class="fl">0.2</span>, </span>
<span id="cb1090-10"><a href="mod-04.html#cb1090-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Each point represents </span><span class="sc">\n</span><span class="st"> a pair of observations&quot;</span>,</span>
<span id="cb1090-11"><a href="mod-04.html#cb1090-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">adj=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-429-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The figure above shows the result visually. The Mantel <em>r</em> statistic describes the sign and magnitude of the correlation between dissimilarity in terms of chemistry (<em>x</em>-axis) and dissimilarity in terms of the plant community (<em>y</em>-axis). It is interpreted just like Pearson’s <em>r</em>. In the plot it is important to realize that each point represents a <em>pair</em> of observations, plotted by the dissimilarities between them. The correct interpretation of this plot is that samples with similar soil chemistry tend to also have similar plant communities. Alternatively, you could say that the larger the difference in soil chemistry, the larger the difference in plant communities (or something like that).</p>
</div>
<div id="dealing-with-autocorrelation" class="section level4" number="4.8.2.3">
<h4><span class="header-section-number">4.8.2.3</span> Dealing with autocorrelation</h4>
<p>Autocorrelation may or may not be a problem in your dataset. As pointed out by <span class="citation">Kuehn and Dormann (<a href="#ref-kuehn2012" role="doc-biblioref">2012</a>)</span>, there is a difference between autocorrelation in a response variable and autocorrelation in the residuals of a statistical model. Autocorrelation in a response variable can be managed by inclusion of appropriate predictor variables (which may themselves be autocorrelated or correlated; see next section). This works because if autocorrelated values can be predicted by a predictor variable, then the autocorrelation is controlled for, by definition. Autocorrelation in residuals, however, represents a pattern in the data that is not accounted for. There are methods for accounting for autocorrelated residuals such as conditional autoregressive models (CAR) <span class="citation">(<a href="#ref-gelfand2003" role="doc-biblioref">Gelfand and Vounatsou 2003</a>)</span>, generalized or ordinary least squares models (GLS or OLS), classification and regression trees or CART <span class="citation">(<a href="#ref-mccune2002analysis" role="doc-biblioref">McCune et al. 2002</a>)</span>, and mixed models <span class="citation">(<a href="#ref-bolker2009" role="doc-biblioref">Bolker et al. 2009</a>)</span>. None of these solutions is appropriate for every situation.</p>
</div>
</div>
<div id="mod-04-multicol" class="section level3" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> Collinearity</h3>
<p>Sometimes we face the problem of having predictor variables that are not only related to the response variable, but also related to each other. This phenomenon is called <strong>collinearity</strong>. In large datasets the problem becomes <strong>multicollinearity</strong>, when many variables are related to each other. Including collinear predictor variables in an analysis can severely bias the parameter estimates of that analysis (e.g., regression coefficients) and as a result make the results misleading or not generalizable. The effects of collinear predictor variables are by definition confounded with each other, meaning that the effects cannot be separated <span class="citation">(<a href="#ref-dormann2013" role="doc-biblioref">Dormann et al. 2013</a>)</span>.</p>
<p>The most straightforward way of detecting collinearity is with scatterplot matrices and correlation coefficients (see <a href="mod-04.html#mod-04-smat">here</a>). This is a technique to visualize how many variables in a dataset relate to each other simultaneously. As shown in the linked section, replacing the upper triangle of boxes with the correlation coefficients can help detect potentially problematic pairs of variables. The figure below shows an example from the <code>crabs</code> dataset in package <code>MASS</code>. In this dataset, all of the variables are highly correlated with each other.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-430-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>If you have many variables, then a figure like the one above can be hard to read or interpret. One solution might be to create a table of correlation coefficients between every pair of variables. The base function <code>cor()</code> can do this, but a better-formatted table takes a little more work.</p>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1091-1"><a href="mod-04.html#cb1091-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(crabs, <span class="at">package=</span><span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb1091-2"><a href="mod-04.html#cb1091-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> crabs</span>
<span id="cb1091-3"><a href="mod-04.html#cb1091-3" aria-hidden="true" tabindex="-1"></a>dat.cols <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb1091-4"><a href="mod-04.html#cb1091-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x[,dat.cols])</span></code></pre></div>
<pre><code>##           FL        RW        CL        CW        BD
## FL 1.0000000 0.9069876 0.9788418 0.9649558 0.9876272
## RW 0.9069876 1.0000000 0.8927430 0.9004021 0.8892054
## CL 0.9788418 0.8927430 1.0000000 0.9950225 0.9832038
## CW 0.9649558 0.9004021 0.9950225 1.0000000 0.9678117
## BD 0.9876272 0.8892054 0.9832038 0.9678117 1.0000000</code></pre>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1093-1"><a href="mod-04.html#cb1093-1" aria-hidden="true" tabindex="-1"></a><span class="co"># better table:</span></span>
<span id="cb1093-2"><a href="mod-04.html#cb1093-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">names</span>(x)[dat.cols]</span>
<span id="cb1093-3"><a href="mod-04.html#cb1093-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1093-4"><a href="mod-04.html#cb1093-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate every unique pair of two variables by name:</span></span>
<span id="cb1093-5"><a href="mod-04.html#cb1093-5" aria-hidden="true" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">combn</span>(vars, <span class="dv">2</span>)))</span>
<span id="cb1093-6"><a href="mod-04.html#cb1093-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1093-7"><a href="mod-04.html#cb1093-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate correlation coefficients for each pair:</span></span>
<span id="cb1093-8"><a href="mod-04.html#cb1093-8" aria-hidden="true" tabindex="-1"></a>cx<span class="sc">$</span>r <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1093-9"><a href="mod-04.html#cb1093-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cx)){</span>
<span id="cb1093-10"><a href="mod-04.html#cb1093-10" aria-hidden="true" tabindex="-1"></a>    cx<span class="sc">$</span>r[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x[,cx<span class="sc">$</span>X1[i]], x[,cx<span class="sc">$</span>X2[i]])</span>
<span id="cb1093-11"><a href="mod-04.html#cb1093-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1093-12"><a href="mod-04.html#cb1093-12" aria-hidden="true" tabindex="-1"></a>cx</span></code></pre></div>
<pre><code>##    X1 X2         r
## 1  FL RW 0.9069876
## 2  FL CL 0.9788418
## 3  FL CW 0.9649558
## 4  FL BD 0.9876272
## 5  RW CL 0.8927430
## 6  RW CW 0.9004021
## 7  RW BD 0.8892054
## 8  CL CW 0.9950225
## 9  CL BD 0.9832038
## 10 CW BD 0.9678117</code></pre>
<p>The resulting table can then be sorted or filtered by <code>r</code> to identify pairs of variables that are correlated with each other.</p>
<div class="sourceCode" id="cb1095"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1095-1"><a href="mod-04.html#cb1095-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not run:</span></span>
<span id="cb1095-2"><a href="mod-04.html#cb1095-2" aria-hidden="true" tabindex="-1"></a><span class="co"># filter to |r| &gt; 0.7</span></span>
<span id="cb1095-3"><a href="mod-04.html#cb1095-3" aria-hidden="true" tabindex="-1"></a>cx[<span class="fu">which</span>(<span class="fu">abs</span>(cx<span class="sc">$</span>r) <span class="sc">&gt;</span> <span class="fl">0.7</span>),]</span></code></pre></div>
<p><span class="citation">Dormann et al. (<a href="#ref-dormann2013" role="doc-biblioref">2013</a>)</span> suggest to use a cutoff of <span class="math inline">\(|r|\)</span> in between 0.5 and 0.7 to identify collinear pairs of variables. When a pair of variables are identified as collinear, the easiest solution is to simply run the analysis without one of them. This is because the variables are redundant, and any conclusions made using one would also be obtained using the other.</p>
</div>
<div id="missing-data" class="section level3" number="4.8.4">
<h3><span class="header-section-number">4.8.4</span> Missing data</h3>
<p>The last target of exploratory data analysis that we will explore is <strong>missing data</strong>. Data can be missing for many reasons. Equipment failures, human error, natural disasters, and other causes can cause values in your dataset to go missing or otherwise be invalid. How to handle the missing data is up to you as a biologist: <em>there is no one-size-fits-all statistical solution</em>. The two basic ways to deal with missing data are to (1) not deal with it and (2) estimate the missing values.</p>
<div id="option-1-ignore-missing-data" class="section level4" number="4.8.4.1">
<h4><span class="header-section-number">4.8.4.1</span> Option 1: Ignore missing data</h4>
<p>The easiest solution is simply to ignore missing data. Consider <a href="https://greenquanteco.github.io/missing_data_example.csv">this dataset</a>, which contains morphological data on 63 species of bats <span class="citation">(<a href="#ref-hutcheon2002" role="doc-biblioref">Hutcheon et al. 2002</a>)</span>. This dataset is modified from <a href="mod-06.html#mod-06-cart1">an example in the unit on nonlinear models</a>. Notice that in this version the brain masses (<code>brw</code>) are missing for 3 species of bats.</p>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1096-1"><a href="mod-04.html#cb1096-1" aria-hidden="true" tabindex="-1"></a>in.name <span class="ot">&lt;-</span> <span class="st">&quot;missing_data_example.csv&quot;</span></span>
<span id="cb1096-2"><a href="mod-04.html#cb1096-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(in.name, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Because there are a lot of data, one option for analyzing this dataset would be to simply ignore the missing observations. For example, if someone was interested in the relationship between body size (variable <code>bow</code>) and brain mass, they could just fit a model and R would (for most methods) automatically ignore missing values. Note that in this example both variables are log-transformed to ensure normality and positivity.</p>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1097-1"><a href="mod-04.html#cb1097-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>logbw <span class="ot">&lt;-</span> <span class="fu">log</span>(dat<span class="sc">$</span>bow)</span>
<span id="cb1097-2"><a href="mod-04.html#cb1097-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>logbr <span class="ot">&lt;-</span> <span class="fu">log</span>(dat<span class="sc">$</span>brw)</span>
<span id="cb1097-3"><a href="mod-04.html#cb1097-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1097-4"><a href="mod-04.html#cb1097-4" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbr<span class="sc">~</span>logbw, <span class="at">data=</span>dat)</span>
<span id="cb1097-5"><a href="mod-04.html#cb1097-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logbr ~ logbw, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.82879 -0.16408  0.05009  0.19548  0.35881 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.96599    0.09476   41.85   &lt;2e-16 ***
## logbw        0.75322    0.02881   26.14   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2616 on 58 degrees of freedom
##   (3 observations deleted due to missingness)
## Multiple R-squared:  0.9218, Adjusted R-squared:  0.9204 
## F-statistic: 683.4 on 1 and 58 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The parameter estimates of intercept = 3.9659 and slope = 0.7532 are very close to the values obtained using the full dataset of 3.9685 and 0.7516. In this case, ignoring the missing data worked just fine.</p>
</div>
<div id="option-2-interpolate-or-impute-missing-data" class="section level4" number="4.8.4.2">
<h4><span class="header-section-number">4.8.4.2</span> Option 2: Interpolate or impute missing data</h4>
<p>If you need to replace the missing data, then the best option is to <strong>interpolate</strong> or <strong>impute</strong> them. How exactly to do this depends on the question being asked. If there is a clear relationship between the variable with missing values and another variable, then you can use that relationship to estimate the missing values. You can also use <strong>multiple imputation</strong> to estimate the missing values using information from several related variables at once. The example below illustrates simple interpolation (aka: single imputation) to replace the missing brain weights using known body masses.</p>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1099-1"><a href="mod-04.html#cb1099-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flag missing observations</span></span>
<span id="cb1099-2"><a href="mod-04.html#cb1099-2" aria-hidden="true" tabindex="-1"></a>flag <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(dat<span class="sc">$</span>brw))</span>
<span id="cb1099-3"><a href="mod-04.html#cb1099-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1099-4"><a href="mod-04.html#cb1099-4" aria-hidden="true" tabindex="-1"></a><span class="co"># log transform (if not done already)</span></span>
<span id="cb1099-5"><a href="mod-04.html#cb1099-5" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>logbw <span class="ot">&lt;-</span> <span class="fu">log</span>(dat<span class="sc">$</span>bow)</span>
<span id="cb1099-6"><a href="mod-04.html#cb1099-6" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>logbr <span class="ot">&lt;-</span> <span class="fu">log</span>(dat<span class="sc">$</span>brw)</span>
<span id="cb1099-7"><a href="mod-04.html#cb1099-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1099-8"><a href="mod-04.html#cb1099-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb1099-9"><a href="mod-04.html#cb1099-9" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbr<span class="sc">~</span>logbw, <span class="at">data=</span>dat)</span>
<span id="cb1099-10"><a href="mod-04.html#cb1099-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1099-11"><a href="mod-04.html#cb1099-11" aria-hidden="true" tabindex="-1"></a><span class="co"># predict missing logbr at logbw</span></span>
<span id="cb1099-12"><a href="mod-04.html#cb1099-12" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">logbw=</span>dat<span class="sc">$</span>logbw[flag])</span>
<span id="cb1099-13"><a href="mod-04.html#cb1099-13" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, <span class="at">newdata=</span><span class="fu">data.frame</span>(px))</span>
<span id="cb1099-14"><a href="mod-04.html#cb1099-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1099-15"><a href="mod-04.html#cb1099-15" aria-hidden="true" tabindex="-1"></a><span class="co"># insert predicted values</span></span>
<span id="cb1099-16"><a href="mod-04.html#cb1099-16" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>logbr[flag] <span class="ot">&lt;-</span> pr</span>
<span id="cb1099-17"><a href="mod-04.html#cb1099-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1099-18"><a href="mod-04.html#cb1099-18" aria-hidden="true" tabindex="-1"></a><span class="co"># back-transform to original scale</span></span>
<span id="cb1099-19"><a href="mod-04.html#cb1099-19" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>brw[flag] <span class="ot">&lt;-</span> <span class="fu">exp</span>(dat<span class="sc">$</span>logbr[flag])</span></code></pre></div>
<p>The interpolated values are similar to the true values, but with quite a bit of error. The term for this is “correct to an order of magnitude”.</p>
<div class="sourceCode" id="cb1100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1100-1"><a href="mod-04.html#cb1100-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>brw[flag]</span></code></pre></div>
<pre><code>## [1]  729.7784  507.7160 2138.6809</code></pre>
<div class="sourceCode" id="cb1102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1102-1"><a href="mod-04.html#cb1102-1" aria-hidden="true" tabindex="-1"></a>true.vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">597</span>, <span class="dv">543</span>, <span class="dv">2070</span>)</span>
<span id="cb1102-2"><a href="mod-04.html#cb1102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1102-3"><a href="mod-04.html#cb1102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage bias in interpolated values:</span></span>
<span id="cb1102-4"><a href="mod-04.html#cb1102-4" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (dat<span class="sc">$</span>brw[flag]<span class="sc">-</span>true.vals) <span class="sc">/</span> true.vals</span></code></pre></div>
<pre><code>## [1] 22.240932 -6.497972  3.317919</code></pre>
<p>Interpolation can be improved by predicting the missing values using additional variables. Multiple imputation, like any statistical model, can suffer from the effects of multicollinearity in the “predictors”, so be mindful that you don’t obtain–and use–biased estimates of your missing values. <span class="citation">Penone et al. (<a href="#ref-penone2014" role="doc-biblioref">2014</a>)</span> reviewed some strategies for imputing missing data in the context of life history traits, but the approaches could be applied to other areas of biology.</p>

</div>
</div>
</div>
</div>
<h3>Literature Cited</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-bolker2008ecological" class="csl-entry">
Bolker, B. M. 2008. Ecological models and data in <span>R</span>. Princeton University Press, Princeton, New Jersey, USA.
</div>
<div id="ref-bolker2009" class="csl-entry">
Bolker, B. M., M. E. Brooks, C. J. Clark, S. W. Geange, J. R. Poulsen, M. H. H. Stevens, and J.-S. S. White. 2009. <a href="https://doi.org/10.1016/j.tree.2008.10.008">Generalized linear mixed models: A practical guide for ecology and evolution</a>. Trends in Ecology &amp; Evolution 24:127–135.
</div>
<div id="ref-box1964" class="csl-entry">
Box, G. E. P., and D. R. Cox. 1964. <a href="https://doi.org/10.1111/j.2517-6161.1964.tb00553.x">An analysis of transformations</a>. Journal of the Royal Statistical Society: Series B (Methodological) 26:211–243.
</div>
<div id="ref-carnell2019" class="csl-entry">
Carnell, R. 2019. <a href="https://CRAN.R-project.org/package=triangle">Triangle: Provides the standard distribution functions for the triangle distribution</a>.
</div>
<div id="ref-dormann2013" class="csl-entry">
Dormann, C. F., J. Elith, S. Bacher, C. Buchmann, G. Carl, G. Carré, J. R. G. Marquéz, B. Gruber, B. Lafourcade, P. J. Leitão, T. Münkemüller, C. McClean, P. E. Osborne, B. Reineking, B. Schröder, A. K. Skidmore, D. Zurell, and S. Lautenbach. 2013. <a href="https://doi.org/10.1111/j.1600-0587.2012.07348.x">Collinearity: A review of methods to deal with it and a simulation study evaluating their performance</a>. Ecography 36:27–46.
</div>
<div id="ref-gelfand2003" class="csl-entry">
Gelfand, A. E., and P. Vounatsou. 2003. <a href="https://doi.org/10.1093/biostatistics/4.1.11">Proper multivariate conditional autoregressive models for spatial data analysis</a>. Biostatistics 4:11–15.
</div>
<div id="ref-hutcheon2002" class="csl-entry">
Hutcheon, J. M., J. A. W. Kirsch, and T. G. Jr. 2002. <a href="https://doi.org/10.1159/000065938">A comparative analysis of brain size in relation to foraging ecology and phylogeny in the <span>C</span>hiroptera</a>. Brain, behavior and evolution 60:165–180.
</div>
<div id="ref-kery2010" class="csl-entry">
Kéry, M. 2010. Introduction to <span>W</span>in<span>BUGS</span> for ecologists: <span>B</span>ayesian approach to regression, <span>ANOVA</span>, mixed models and related analyses. Academic Press.
</div>
<div id="ref-kuehn2012" class="csl-entry">
Kuehn, I., and C. F. Dormann. 2012. <a href="https://doi.org/10.1111/j.1365-2699.2012.02707.x">Less than eight (and a half) misconceptions of spatial analysis</a>. Journal of Biogeography 39:995–998.
</div>
<div id="ref-legendre2012numerical" class="csl-entry">
Legendre, P., and L. Legendre. 2012. Numerical ecology. Elsevier, Amsterdam.
</div>
<div id="ref-mccune2002analysis" class="csl-entry">
McCune, B., J. B. Grace, and D. L. Urban. 2002. Analysis of ecological communities. MjM software design Gleneden Beach, Oregon, USA.
</div>
<div id="ref-penone2014" class="csl-entry">
Penone, C., A. D. Davidson, K. T. Shoemaker, M. Di Marco, C. Rondinini, T. M. Brooks, B. E. Young, C. H. Graham, and G. C. Costa. 2014. <a href="https://doi.org/10.1111/2041-210X.12232">Imputation of missing data in life-history trait datasets: Which approach performs the best?</a> Methods in Ecology and Evolution 5:961–970.
</div>
<div id="ref-venables2002" class="csl-entry">
Venables, W. N., and B. D. Ripley. 2002. <a href="https://www.stats.ox.ac.uk/pub/MASS4/">Modern applied statistics with <span>S</span></a>. Fourth. Springer, New York.
</div>
<div id="ref-warton2011" class="csl-entry">
Warton, D. I., and F. K. C. Hui. 2011. <a href="https://doi.org/10.1890/10-0340.1">The arcsine is asinine: The analysis of proportions in ecology</a>. Ecology 92:3–10.
</div>
<div id="ref-zuur2010" class="csl-entry">
Zuur, A. F., E. N. Ieno, and C. S. Elphick. 2010. <a href="https://doi.org/10.1111/j.2041-210X.2009.00001.x">A protocol for data exploration to avoid common statistical problems</a>. Methods in ecology and evolution 1:3–14.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-03.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-05.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
