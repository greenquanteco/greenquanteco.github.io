<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.5 (Generalized) additive mixed models (AMM/GAMM) | Applied Biological Data Analysis</title>
  <meta name="description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7.5 (Generalized) additive mixed models (AMM/GAMM) | Applied Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://greenquanteco.github.io/index.html" />
  <meta property="og:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />
  <meta property="og:description" content="Helping biologists to become more informed users of R and statistical methods." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.5 (Generalized) additive mixed models (AMM/GAMM) | Applied Biological Data Analysis" />
  
  <meta name="twitter:description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="twitter:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />

<meta name="author" content="Nick Green, Kennesaw State University" />


<meta name="date" content="2022-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="7.4-mod-07-nlme.html"/>
<link rel="next" href="8-mod-08.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="license-and-permissions.html"><a href="license-and-permissions.html"><i class="fa fa-check"></i>License and permissions</a></li>
<li class="chapter" data-level="" data-path="course-description.html"><a href="course-description.html"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="course-objectives.html"><a href="course-objectives.html"><i class="fa fa-check"></i>Course objectives</a></li>
<li class="chapter" data-level="" data-path="course-requirements.html"><a href="course-requirements.html"><i class="fa fa-check"></i>Course requirements</a></li>
<li class="chapter" data-level="" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i>Recommended reading</a></li>
<li class="chapter" data-level="" data-path="course-organization.html"><a href="course-organization.html"><i class="fa fa-check"></i>Course organization</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-mod-01.html"><a href="1-mod-01.html"><i class="fa fa-check"></i><b>1</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-overview.html"><a href="1.1-overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html"><i class="fa fa-check"></i><b>1.2</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html#the-scientific-method"><i class="fa fa-check"></i><b>1.2.1</b> The scientific method</a></li>
<li class="chapter" data-level="1.2.2" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html#example-data-analysis"><i class="fa fa-check"></i><b>1.2.2</b> Example data analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html"><i class="fa fa-check"></i><b>1.3</b> Misuses of statistics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#proving-the-trivial-and-meaningless-hypotheses"><i class="fa fa-check"></i><b>1.3.1</b> “Proving” the trivial and meaningless hypotheses</a></li>
<li class="chapter" data-level="1.3.2" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#inappropriate-methods"><i class="fa fa-check"></i><b>1.3.2</b> Inappropriate methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#p-hacking-and-data-dredging"><i class="fa fa-check"></i><b>1.3.3</b> <em>P</em>-hacking and data dredging</a></li>
<li class="chapter" data-level="1.3.4" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#inadequate-sample-sizes-and-pseudoreplication"><i class="fa fa-check"></i><b>1.3.4</b> Inadequate sample sizes and pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><i class="fa fa-check"></i><b>1.4</b> <em>P</em>-values and null hypothesis significance testing (NHST)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#definition"><i class="fa fa-check"></i><b>1.4.1</b> Definition</a></li>
<li class="chapter" data-level="1.4.2" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#history-and-status-of-p-values"><i class="fa fa-check"></i><b>1.4.2</b> History and status of <em>P</em>-values</a></li>
<li class="chapter" data-level="1.4.3" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#where-p-values-come-from"><i class="fa fa-check"></i><b>1.4.3</b> Where <em>P</em>-values come from</a></li>
<li class="chapter" data-level="1.4.4" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#what-p-values-mean-and-do-not-mean"><i class="fa fa-check"></i><b>1.4.4</b> What <em>P</em>-values mean and do not mean</a></li>
<li class="chapter" data-level="1.4.5" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#do-you-need-a-p-value"><i class="fa fa-check"></i><b>1.4.5</b> Do you need a <em>P</em>-value?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html"><i class="fa fa-check"></i><b>1.5</b> Alternatives to NHST</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.1</b> Bayesian inference</a></li>
<li class="chapter" data-level="1.5.2" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#information-theoretic-methods"><i class="fa fa-check"></i><b>1.5.2</b> Information-theoretic methods</a></li>
<li class="chapter" data-level="1.5.3" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#machine-learning"><i class="fa fa-check"></i><b>1.5.3</b> Machine learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-mod-02.html"><a href="2-mod-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html"><i class="fa fa-check"></i><b>2.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#advantages-of-r"><i class="fa fa-check"></i><b>2.1.2</b> Advantages of R</a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#disadvantages-of-r"><i class="fa fa-check"></i><b>2.1.3</b> Disadvantages of R</a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#base-r-and-vs.-tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Base R and (vs.?) <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-download-and-install-r-and-rstudio.html"><a href="2.2-download-and-install-r-and-rstudio.html"><i class="fa fa-check"></i><b>2.2</b> Download and install R (and RStudio)</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-using-r.html"><a href="2.3-using-r.html"><i class="fa fa-check"></i><b>2.3</b> Using R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-the-base-r-gui"><i class="fa fa-check"></i><b>2.3.1</b> Using the base R GUI</a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-r-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Using R in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-r-with-other-programs"><i class="fa fa-check"></i><b>2.3.3</b> Using R with other programs</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html"><i class="fa fa-check"></i><b>2.4</b> A first R session</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#import-data"><i class="fa fa-check"></i><b>2.4.1</b> Import data</a></li>
<li class="chapter" data-level="2.4.2" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#explore-and-visualize-data"><i class="fa fa-check"></i><b>2.4.2</b> Explore and visualize data</a></li>
<li class="chapter" data-level="2.4.3" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#transform-data"><i class="fa fa-check"></i><b>2.4.3</b> Transform data</a></li>
<li class="chapter" data-level="2.4.4" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#analyze-data"><i class="fa fa-check"></i><b>2.4.4</b> Analyze data</a></li>
<li class="chapter" data-level="2.4.5" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#write-out-results"><i class="fa fa-check"></i><b>2.4.5</b> Write out results</a></li>
<li class="chapter" data-level="2.4.6" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#save-your-work"><i class="fa fa-check"></i><b>2.4.6</b> Save your work?</a></li>
<li class="chapter" data-level="2.4.7" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#whats-next"><i class="fa fa-check"></i><b>2.4.7</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html"><i class="fa fa-check"></i><b>2.5</b> Write and execute commands in the R console</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#r-commandsbasics"><i class="fa fa-check"></i><b>2.5.1</b> R commands–basics</a></li>
<li class="chapter" data-level="2.5.2" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#elements-of-r-code"><i class="fa fa-check"></i><b>2.5.2</b> Elements of R code</a></li>
<li class="chapter" data-level="2.5.3" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#the-r-workspace"><i class="fa fa-check"></i><b>2.5.3</b> The R workspace</a></li>
<li class="chapter" data-level="2.5.4" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#r-code-basics-assignment-and-operators"><i class="fa fa-check"></i><b>2.5.4</b> R code basics: assignment and operators</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html"><i class="fa fa-check"></i><b>2.6</b> Basic R data structures</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#data-frames"><i class="fa fa-check"></i><b>2.6.2</b> Data frames</a></li>
<li class="chapter" data-level="2.6.3" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.6.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.6.4" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#lists"><i class="fa fa-check"></i><b>2.6.4</b> Lists</a></li>
<li class="chapter" data-level="2.6.5" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#s4-objects"><i class="fa fa-check"></i><b>2.6.5</b> S4 objects</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html"><i class="fa fa-check"></i><b>2.7</b> R data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#character-type"><i class="fa fa-check"></i><b>2.7.1</b> Character type</a></li>
<li class="chapter" data-level="2.7.2" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#numeric-type"><i class="fa fa-check"></i><b>2.7.2</b> Numeric type</a></li>
<li class="chapter" data-level="2.7.3" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#integer-type"><i class="fa fa-check"></i><b>2.7.3</b> Integer type</a></li>
<li class="chapter" data-level="2.7.4" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#logical-type"><i class="fa fa-check"></i><b>2.7.4</b> Logical type</a></li>
<li class="chapter" data-level="2.7.5" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#special-values"><i class="fa fa-check"></i><b>2.7.5</b> Special values</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2.8-manage-r-code-as-scripts-.r-files.html"><a href="2.8-manage-r-code-as-scripts-.r-files.html"><i class="fa fa-check"></i><b>2.8</b> Manage R code as scripts (.r files)</a></li>
<li class="chapter" data-level="2.9" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html"><i class="fa fa-check"></i><b>2.9</b> Manage and use R packages</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#your-r-library"><i class="fa fa-check"></i><b>2.9.1</b> Your R library</a></li>
<li class="chapter" data-level="2.9.2" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-using-the-r-gui"><i class="fa fa-check"></i><b>2.9.2</b> Installing packages using the R GUI</a></li>
<li class="chapter" data-level="2.9.3" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-in-rstudio"><i class="fa fa-check"></i><b>2.9.3</b> Installing packages in RStudio</a></li>
<li class="chapter" data-level="2.9.4" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-using-the-r-console"><i class="fa fa-check"></i><b>2.9.4</b> Installing packages using the R console</a></li>
<li class="chapter" data-level="2.9.5" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#working-with-packages-in-r"><i class="fa fa-check"></i><b>2.9.5</b> Working with packages in R</a></li>
<li class="chapter" data-level="2.9.6" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#package-dependencies"><i class="fa fa-check"></i><b>2.9.6</b> Package dependencies</a></li>
<li class="chapter" data-level="2.9.7" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#citing-packages"><i class="fa fa-check"></i><b>2.9.7</b> Citing packages</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html"><i class="fa fa-check"></i><b>2.10</b> R documentation</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#documentation-help-files"><i class="fa fa-check"></i><b>2.10.1</b> Documentation (help) files</a></li>
<li class="chapter" data-level="2.10.2" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#r-vignettes"><i class="fa fa-check"></i><b>2.10.2</b> R vignettes</a></li>
<li class="chapter" data-level="2.10.3" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#official-r-project-resources"><i class="fa fa-check"></i><b>2.10.3</b> Official R Project resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#unofficial-online-resources"><i class="fa fa-check"></i><b>2.10.4</b> Unofficial online resources</a></li>
<li class="chapter" data-level="2.10.5" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#r-books"><i class="fa fa-check"></i><b>2.10.5</b> R books</a></li>
<li class="chapter" data-level="2.10.6" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#two-reminders"><i class="fa fa-check"></i><b>2.10.6</b> Two reminders</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-mod-03.html"><a href="3-mod-03.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html"><i class="fa fa-check"></i><b>3.1</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-preliminaries"><i class="fa fa-check"></i><b>3.1.1</b> Importing data: preliminaries</a></li>
<li class="chapter" data-level="3.1.2" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-from-text-files-with-read.csv-and-read.table"><i class="fa fa-check"></i><b>3.1.2</b> Importing data from text files with <code>read.csv()</code> and <code>read.table()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-from-saved-workspaces"><i class="fa fa-check"></i><b>3.1.3</b> Importing data from saved workspaces</a></li>
<li class="chapter" data-level="3.1.4" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-special-cases"><i class="fa fa-check"></i><b>3.1.4</b> Importing data: special cases:</a></li>
<li class="chapter" data-level="3.1.5" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#export-data-from-r"><i class="fa fa-check"></i><b>3.1.5</b> Export data from R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html"><i class="fa fa-check"></i><b>3.2</b> Making values in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#producing-arbitrary-values-with-c"><i class="fa fa-check"></i><b>3.2.1</b> Producing arbitrary values with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#generating-regular-values"><i class="fa fa-check"></i><b>3.2.2</b> Generating regular values</a></li>
<li class="chapter" data-level="3.2.3" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#generating-random-values"><i class="fa fa-check"></i><b>3.2.3</b> Generating random values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html"><i class="fa fa-check"></i><b>3.3</b> Selecting data with <code>[]</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html#mod-03-brackets"><i class="fa fa-check"></i><b>3.3.1</b> Basics of brackets</a></li>
<li class="chapter" data-level="3.3.2" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html#extracting-and-selecting-data-with-logical-tests"><i class="fa fa-check"></i><b>3.3.2</b> Extracting and selecting data with logical tests</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html"><i class="fa fa-check"></i><b>3.4</b> Managing dates and characters</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html#temporal-data-and-dates"><i class="fa fa-check"></i><b>3.4.1</b> Temporal data and dates</a></li>
<li class="chapter" data-level="3.4.2" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html#character-data-text"><i class="fa fa-check"></i><b>3.4.2</b> Character data (text)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html"><i class="fa fa-check"></i><b>3.5</b> Data frame management</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#data-frame-structure"><i class="fa fa-check"></i><b>3.5.1</b> Data frame structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#common-data-frame-operations"><i class="fa fa-check"></i><b>3.5.2</b> Common data frame operations</a></li>
<li class="chapter" data-level="3.5.3" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#other-data-frame-operations"><i class="fa fa-check"></i><b>3.5.3</b> Other data frame operations</a></li>
<li class="chapter" data-level="3.5.4" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#mod-03-reshape"><i class="fa fa-check"></i><b>3.5.4</b> Reshaping data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-mod-04.html"><a href="4-mod-04.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html"><i class="fa fa-check"></i><b>4.1</b> Descriptive and summary statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#basic-summary-statistics"><i class="fa fa-check"></i><b>4.1.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="4.1.2" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#summarizing-data-with-the-apply-family"><i class="fa fa-check"></i><b>4.1.2</b> Summarizing data with the <code>apply()</code> family</a></li>
<li class="chapter" data-level="4.1.3" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#mod-04-tabagg"><i class="fa fa-check"></i><b>4.1.3</b> Tabulation and aggregation</a></li>
<li class="chapter" data-level="4.1.4" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#aggregation-aka-pivot-tables"><i class="fa fa-check"></i><b>4.1.4</b> Aggregation (aka: pivot tables)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html"><i class="fa fa-check"></i><b>4.2</b> Visualizing data distributions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#boxplots-aka-box-and-whisker-plots"><i class="fa fa-check"></i><b>4.2.1</b> Boxplots (aka: box-and-whisker plots)</a></li>
<li class="chapter" data-level="4.2.2" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#histograms"><i class="fa fa-check"></i><b>4.2.2</b> Histograms</a></li>
<li class="chapter" data-level="4.2.3" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#kernel-density-plots"><i class="fa fa-check"></i><b>4.2.3</b> Kernel density plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#empirical-cumulative-distribution-plots-ecdf"><i class="fa fa-check"></i><b>4.2.4</b> Empirical cumulative distribution plots (ECDF)</a></li>
<li class="chapter" data-level="4.2.5" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#quantile-quantile-qq-plots"><i class="fa fa-check"></i><b>4.2.5</b> Quantile-quantile (QQ) plots</a></li>
<li class="chapter" data-level="4.2.6" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#how-should-i-plot-my-data"><i class="fa fa-check"></i><b>4.2.6</b> How should I plot my data?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html"><i class="fa fa-check"></i><b>4.3</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#probability-distributions"><i class="fa fa-check"></i><b>4.3.1</b> Probability distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>4.3.2</b> Probability distributions in R</a></li>
<li class="chapter" data-level="4.3.3" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#discrete-distributions"><i class="fa fa-check"></i><b>4.3.3</b> Discrete distributions</a></li>
<li class="chapter" data-level="4.3.4" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#continuous-distributions"><i class="fa fa-check"></i><b>4.3.4</b> Continuous distributions</a></li>
<li class="chapter" data-level="4.3.5" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#distributions-summary"><i class="fa fa-check"></i><b>4.3.5</b> Distributions summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html"><i class="fa fa-check"></i><b>4.4</b> Fitting and testing distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#estimating-distributional-parameters"><i class="fa fa-check"></i><b>4.4.1</b> Estimating distributional parameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#graphical-methods-for-examining-distributions"><i class="fa fa-check"></i><b>4.4.2</b> Graphical methods for examining distributions</a></li>
<li class="chapter" data-level="4.4.3" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#formal-tests-for-distributions"><i class="fa fa-check"></i><b>4.4.3</b> Formal tests for distributions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html"><i class="fa fa-check"></i><b>4.5</b> Data transformations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#why-transform"><i class="fa fa-check"></i><b>4.5.1</b> Why transform?</a></li>
<li class="chapter" data-level="4.5.2" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#transforms-vs.-link-functions"><i class="fa fa-check"></i><b>4.5.2</b> Transforms vs. link functions</a></li>
<li class="chapter" data-level="4.5.3" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#log-transformation"><i class="fa fa-check"></i><b>4.5.3</b> Log transformation</a></li>
<li class="chapter" data-level="4.5.4" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#rank-transformation"><i class="fa fa-check"></i><b>4.5.4</b> Rank transformation</a></li>
<li class="chapter" data-level="4.5.5" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#other-transforms-less-common"><i class="fa fa-check"></i><b>4.5.5</b> Other transforms (less common)</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html"><i class="fa fa-check"></i><b>4.6</b> Multivariate data exploration</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#scatterplots-for-two-variables"><i class="fa fa-check"></i><b>4.6.1</b> Scatterplots for two variables</a></li>
<li class="chapter" data-level="4.6.2" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#mod-04-smat"><i class="fa fa-check"></i><b>4.6.2</b> Scatterplot matrices for many variables</a></li>
<li class="chapter" data-level="4.6.3" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#lattice-plots-for-hierarchical-data"><i class="fa fa-check"></i><b>4.6.3</b> Lattice plots for hierarchical data</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html"><i class="fa fa-check"></i><b>4.7</b> Ordination (brief introduction)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>4.7.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="4.7.2" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#nonmetric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>4.7.2</b> Nonmetric multidimensional scaling (NMDS)</a></li>
<li class="chapter" data-level="4.7.3" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#plotting-ordinations"><i class="fa fa-check"></i><b>4.7.3</b> Plotting ordinations</a></li>
<li class="chapter" data-level="4.7.4" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#ordination-wrap-up-for-now"><i class="fa fa-check"></i><b>4.7.4</b> Ordination wrap-up (for now)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html"><i class="fa fa-check"></i><b>4.8</b> Common statistical problems</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#outliers-and-erroneous-values"><i class="fa fa-check"></i><b>4.8.1</b> Outliers and erroneous values</a></li>
<li class="chapter" data-level="4.8.2" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#autocorrelation"><i class="fa fa-check"></i><b>4.8.2</b> Autocorrelation</a></li>
<li class="chapter" data-level="4.8.3" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#mod-04-multicol"><i class="fa fa-check"></i><b>4.8.3</b> Collinearity</a></li>
<li class="chapter" data-level="4.8.4" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#missing-data"><i class="fa fa-check"></i><b>4.8.4</b> Missing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-mod-05.html"><a href="5-mod-05.html"><i class="fa fa-check"></i><b>5</b> Generalized linear models (GLM)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html"><i class="fa fa-check"></i><b>5.1</b> Prelude with linear models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#assumptions-of-linear-models"><i class="fa fa-check"></i><b>5.1.1</b> Assumptions of linear models</a></li>
<li class="chapter" data-level="5.1.2" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#linear-regression-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Linear regression in R</a></li>
<li class="chapter" data-level="5.1.3" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="5.1.4" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#mod-05-anova"><i class="fa fa-check"></i><b>5.1.4</b> ANOVA and ANCOVA with <code>lm()</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#variations-on-linear-models"><i class="fa fa-check"></i><b>5.1.5</b> Variations on linear models</a></li>
<li class="chapter" data-level="5.1.6" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#example-linear-regression-workflow"><i class="fa fa-check"></i><b>5.1.6</b> Example linear regression workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html"><i class="fa fa-check"></i><b>5.2</b> GLM basics</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#example-glms"><i class="fa fa-check"></i><b>5.2.1</b> Example GLMS</a></li>
<li class="chapter" data-level="5.2.2" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#glm-families"><i class="fa fa-check"></i><b>5.2.2</b> GLM families</a></li>
<li class="chapter" data-level="5.2.3" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#glm-link-functions"><i class="fa fa-check"></i><b>5.2.3</b> GLM link functions</a></li>
<li class="chapter" data-level="5.2.4" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#deviance-and-other-glm-diagnostics"><i class="fa fa-check"></i><b>5.2.4</b> Deviance and other GLM diagnostics</a></li>
<li class="chapter" data-level="5.2.5" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#to-pseudo-r2-or-not-to-pseudo-r2"><i class="fa fa-check"></i><b>5.2.5</b> To pseudo-<em>R</em><sup>2</sup> or not to pseudo-<em>R</em><sup>2</sup>?</a></li>
<li class="chapter" data-level="5.2.6" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#common-glms"><i class="fa fa-check"></i><b>5.2.6</b> Common GLMs</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html"><i class="fa fa-check"></i><b>5.3</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html#mod-05-loglin-examp"><i class="fa fa-check"></i><b>5.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.3.2" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html#example-with-real-data"><i class="fa fa-check"></i><b>5.3.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html"><i class="fa fa-check"></i><b>5.4</b> Poisson GLM for counts</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html#example-with-simulated-data"><i class="fa fa-check"></i><b>5.4.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.4.2" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html#example-with-real-data-1"><i class="fa fa-check"></i><b>5.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html"><i class="fa fa-check"></i><b>5.5</b> Quasi-Poisson and negative binomial GLM</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html#example-with-simulated-data-1"><i class="fa fa-check"></i><b>5.5.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.5.2" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html#example-with-real-data-2"><i class="fa fa-check"></i><b>5.5.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html"><i class="fa fa-check"></i><b>5.6</b> Logistic regression for binary outcomes</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#example-with-simulated-data-2"><i class="fa fa-check"></i><b>5.6.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.6.2" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#example-with-real-data-3"><i class="fa fa-check"></i><b>5.6.2</b> Example with real data</a></li>
<li class="chapter" data-level="5.6.3" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#mod-05-auc"><i class="fa fa-check"></i><b>5.6.3</b> Logistic GLM diagnostics: AUC and ROC</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html"><i class="fa fa-check"></i><b>5.7</b> Binomial GLM for proportional data</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html#binomial-glm"><i class="fa fa-check"></i><b>5.7.1</b> Binomial GLM</a></li>
<li class="chapter" data-level="5.7.2" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html#example-with-simulated-data-3"><i class="fa fa-check"></i><b>5.7.2</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="5.8-mod-05-gamma.html"><a href="5.8-mod-05-gamma.html"><i class="fa fa-check"></i><b>5.8</b> Gamma models for overdispersed data</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="5.8-mod-05-gamma.html"><a href="5.8-mod-05-gamma.html#example-with-simulated-data-4"><i class="fa fa-check"></i><b>5.8.1</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html"><i class="fa fa-check"></i><b>5.9</b> Beyond GLM: Overview of GAM and GEE</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html#mod-05-gam"><i class="fa fa-check"></i><b>5.9.1</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="5.9.2" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html#mod-05-gee"><i class="fa fa-check"></i><b>5.9.2</b> Generalized estimating equations (GEE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-mod-06.html"><a href="6-mod-06.html"><i class="fa fa-check"></i><b>6</b> Nonlinear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-background.html"><a href="6.1-background.html"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-mod-06-intro.html"><a href="6.2-mod-06-intro.html"><i class="fa fa-check"></i><b>6.2</b> Nonlinear least squares (NLS)</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html"><i class="fa fa-check"></i><b>6.3</b> Michaelis-Menten curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#mod-06-micmen-sim"><i class="fa fa-check"></i><b>6.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="6.3.2" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#example-with-real-data-4"><i class="fa fa-check"></i><b>6.3.2</b> Example with real data</a></li>
<li class="chapter" data-level="6.3.3" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#alternative-strategies-for-the-analysis"><i class="fa fa-check"></i><b>6.3.3</b> Alternative strategies for the analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html"><i class="fa fa-check"></i><b>6.4</b> Biological growth curves</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html#gompertz-and-von-bertalanffy-curves"><i class="fa fa-check"></i><b>6.4.1</b> Gompertz and von Bertalanffy curves</a></li>
<li class="chapter" data-level="6.4.2" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html#example-with-real-data-5"><i class="fa fa-check"></i><b>6.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6.5-dose-response-curves.html"><a href="6.5-dose-response-curves.html"><i class="fa fa-check"></i><b>6.5</b> Dose response curves</a></li>
<li class="chapter" data-level="6.6" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html"><i class="fa fa-check"></i><b>6.6</b> Alternatives to NLS</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#generalized-nonlinear-models"><i class="fa fa-check"></i><b>6.6.1</b> Generalized nonlinear models</a></li>
<li class="chapter" data-level="6.6.2" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#quantile-regression"><i class="fa fa-check"></i><b>6.6.2</b> Quantile regression</a></li>
<li class="chapter" data-level="6.6.3" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#mod-06-gam"><i class="fa fa-check"></i><b>6.6.3</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="6.6.4" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>6.6.4</b> Classification and regression trees (CART)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-mod-07.html"><a href="7-mod-07.html"><i class="fa fa-check"></i><b>7</b> Mixed models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-prelude-glm.html"><a href="7.1-prelude-glm.html"><i class="fa fa-check"></i><b>7.1</b> Prelude (GLM)</a></li>
<li class="chapter" data-level="7.2" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html"><i class="fa fa-check"></i><b>7.2</b> Linear mixed models (LMM)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#formal-definition-and-example"><i class="fa fa-check"></i><b>7.2.1</b> Formal definition and example</a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#example-with-simulated-data-5"><i class="fa fa-check"></i><b>7.2.2</b> Example with simulated data</a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#p-values-in-lmm"><i class="fa fa-check"></i><b>7.2.3</b> <em>P</em>-values in LMM</a></li>
<li class="chapter" data-level="7.2.4" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#specifying-random-effects"><i class="fa fa-check"></i><b>7.2.4</b> Specifying random effects</a></li>
<li class="chapter" data-level="7.2.5" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#lmm-example-with-real-data"><i class="fa fa-check"></i><b>7.2.5</b> LMM example with real data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html"><i class="fa fa-check"></i><b>7.3</b> Generalized linear mixed models (GLMM)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#definition-1"><i class="fa fa-check"></i><b>7.3.1</b> Definition</a></li>
<li class="chapter" data-level="7.3.2" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#glmm-on-simulated-data"><i class="fa fa-check"></i><b>7.3.2</b> GLMM on simulated data</a></li>
<li class="chapter" data-level="7.3.3" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#glmm-on-real-data"><i class="fa fa-check"></i><b>7.3.3</b> GLMM on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html"><i class="fa fa-check"></i><b>7.4</b> Nonlinear mixed models (NLME)</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#definition-and-background"><i class="fa fa-check"></i><b>7.4.1</b> Definition and background</a></li>
<li class="chapter" data-level="7.4.2" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#nlme-on-simulated-data"><i class="fa fa-check"></i><b>7.4.2</b> NLME on simulated data</a></li>
<li class="chapter" data-level="7.4.3" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#nlme-on-real-data"><i class="fa fa-check"></i><b>7.4.3</b> NLME on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7.5-mod-07-gamm.html"><a href="7.5-mod-07-gamm.html"><i class="fa fa-check"></i><b>7.5</b> (Generalized) additive mixed models (AMM/GAMM)</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7.5-mod-07-gamm.html"><a href="7.5-mod-07-gamm.html#example-gamm-with-real-data"><i class="fa fa-check"></i><b>7.5.1</b> Example GAMM with real data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-mod-08.html"><a href="8-mod-08.html"><i class="fa fa-check"></i><b>8</b> Multivariate data analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html"><i class="fa fa-check"></i><b>8.1</b> Multivariate data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html#univariate-vs.-multivariate-data"><i class="fa fa-check"></i><b>8.1.1</b> Univariate vs. multivariate data</a></li>
<li class="chapter" data-level="8.1.2" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html#components-of-multivariate-data"><i class="fa fa-check"></i><b>8.1.2</b> Components of multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html"><i class="fa fa-check"></i><b>8.2</b> Distance metrics: biological (dis)similarity</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html#euclidean-distance"><i class="fa fa-check"></i><b>8.2.1</b> Euclidean distance</a></li>
<li class="chapter" data-level="8.2.2" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html#bray-curtis-and-other-distance-metrics"><i class="fa fa-check"></i><b>8.2.2</b> Bray-Curtis and other distance metrics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8.3-clustering.html"><a href="8.3-clustering.html"><i class="fa fa-check"></i><b>8.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8.3-clustering.html"><a href="8.3-clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>8.3.1</b> <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="8.3.2" data-path="8.3-clustering.html"><a href="8.3-clustering.html#hierarchical-agglomerative-clustering"><i class="fa fa-check"></i><b>8.3.2</b> Hierarchical agglomerative clustering</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html"><i class="fa fa-check"></i><b>8.4</b> Analyzing dissimilarity</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html#mantel-tests-distance-vs.-distance"><i class="fa fa-check"></i><b>8.4.1</b> Mantel tests: distance vs. distance</a></li>
<li class="chapter" data-level="8.4.2" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html#comparing-dissimilarity-between-groups"><i class="fa fa-check"></i><b>8.4.2</b> Comparing dissimilarity between groups</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html"><i class="fa fa-check"></i><b>8.5</b> Ordination</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#principal-components-analysis-pca-1"><i class="fa fa-check"></i><b>8.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="8.5.2" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#nmds-and-other-ordination-methods"><i class="fa fa-check"></i><b>8.5.2</b> NMDS and other ordination methods</a></li>
<li class="chapter" data-level="8.5.3" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#other-ordination-techniques"><i class="fa fa-check"></i><b>8.5.3</b> Other ordination techniques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-mod-09.html"><a href="9-mod-09.html"><i class="fa fa-check"></i><b>9</b> Planning your analysis (what test?)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9.1-how-to-use-this-guide.html"><a href="9.1-how-to-use-this-guide.html"><i class="fa fa-check"></i><b>9.1</b> How to use this guide</a></li>
<li class="chapter" data-level="9.2" data-path="9.2-what-question-are-you-trying-to-answer.html"><a href="9.2-what-question-are-you-trying-to-answer.html"><i class="fa fa-check"></i><b>9.2</b> What question are you trying to answer?</a></li>
<li class="chapter" data-level="9.3" data-path="9.3-testing-for-a-difference-in-mean-or-location.html"><a href="9.3-testing-for-a-difference-in-mean-or-location.html"><i class="fa fa-check"></i><b>9.3</b> Testing for a difference in mean or location</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="9.3-testing-for-a-difference-in-mean-or-location.html"><a href="9.3-testing-for-a-difference-in-mean-or-location.html#additional-considerations"><i class="fa fa-check"></i><b>9.3.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><a href="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><i class="fa fa-check"></i><b>9.4</b> Testing for a continuous relationship between two or more variables</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><a href="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html#additional-considerations-1"><i class="fa fa-check"></i><b>9.4.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9.5-classifying-observations.html"><a href="9.5-classifying-observations.html"><i class="fa fa-check"></i><b>9.5</b> Classifying observations</a></li>
<li class="chapter" data-level="9.6" data-path="9.6-conclusions.html"><a href="9.6-conclusions.html"><i class="fa fa-check"></i><b>9.6</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literature-cited.html"><a href="literature-cited.html"><i class="fa fa-check"></i>Literature Cited</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-07-gamm" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> (Generalized) additive mixed models (AMM/GAMM)</h2>
<p>The last category of mixed models that we will cover are <strong>generalized additive mixed models (GAMM)</strong>. GAMM extend <a href="6.6-alternatives-to-nls.html#mod-06-gam">generalized additive models (GAM)</a> by allowing for observations in different groups to have different intercepts or different smoothing functions. If that sounds complicated, that’s because it is.</p>
<ul>
<li><strong>Additive models (AM)</strong> are a generalization of linear models, where a <strong>smoother</strong> of arbitrary shape is fit instead of a straight line. Smoothers can describe nonlinear patterns (very common in biology), but the process of fitting smoothers is sensitive to many assumptions and methodological details.</li>
<li><strong>Generalized additive models (GAM)</strong> generalize AM by relaxing the assumption of normal residuals and introducing a link function to additive models. This adds a layer of complexity to additive modeling<a href="literature-cited.html#fn77" class="footnote-ref" id="fnref77"><sup>77</sup></a>.</li>
<li><strong>Generalized additive mixed models (GAMM)</strong> generalize GAM by allowing different groups of observations to have different smoothers, or different coefficients on those smoothers. This adds even more complexity to the model.</li>
</ul>
<p>Going from a linear model to a generalized linear model adds a layer of complication. Going from a fixed effects model to a mixed effects model adds more complication. And going from a linear model to an additive one compounds all of these complications. I’m not trying to warn you away from trying GAMM–just advising you to be prepared for frustration.</p>
<div id="example-gamm-with-real-data" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Example GAMM with real data</h3>
<p><span class="citation">Pethybridge et al. (<a href="#ref-pethybridge2018" role="doc-biblioref">2018</a>)</span> compiled data on stable isotope concentrations in 3 species of tuna throughout the Atlantic, Pacific, and Indian Oceans. They used these concentrations to estimate the trophic position of each species. The data were made available in a separate publication <span class="citation">(<a href="#ref-bodin2021" role="doc-biblioref">Bodin et al. 2021</a>)</span>. Download this <a href="https://greenquanteco.github.io/bodin_data_2021-10-22.csv">adapted version of the dataset</a> and save it to your R home directory (or other favorite folder). Import the data and take a look.</p>
<div class="sourceCode" id="cb1564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1564-1"><a href="7.5-mod-07-gamm.html#cb1564-1" aria-hidden="true" tabindex="-1"></a>in.name <span class="ot">&lt;-</span> <span class="st">&quot;bodin_data_2021-10-22.csv&quot;</span></span>
<span id="cb1564-2"><a href="7.5-mod-07-gamm.html#cb1564-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(in.name, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb1564-3"><a href="7.5-mod-07-gamm.html#cb1564-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove observations missing trophic position</span></span>
<span id="cb1564-4"><a href="7.5-mod-07-gamm.html#cb1564-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="sc">!</span><span class="fu">is.na</span>(dat<span class="sc">$</span>tp),]</span>
<span id="cb1564-5"><a href="7.5-mod-07-gamm.html#cb1564-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1564-6"><a href="7.5-mod-07-gamm.html#cb1564-6" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect dataset</span></span>
<span id="cb1564-7"><a href="7.5-mod-07-gamm.html#cb1564-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##            species        common       date    lat    long ocean fork  d15n
## 1 Thunnus alalunga Albacore tuna 2002-10-10 -16.64 -150.79    PO   91 15.17
## 2 Thunnus alalunga Albacore tuna 2004-16-09 -25.85  153.98    PO   87  9.55
## 3 Thunnus alalunga Albacore tuna 2004-16-09 -25.85  153.98    PO   99  9.48
## 4 Thunnus alalunga Albacore tuna 2004-20-09 -28.17  155.82    PO   78 10.46
## 5 Thunnus alalunga Albacore tuna 2004-23-09 -28.37  160.13    PO   76 12.23
## 6 Thunnus alalunga Albacore tuna 2004-23-09 -28.37  160.13    PO   80 10.35
##     tp
## 1 7.32
## 2 4.98
## 3 4.95
## 4 5.36
## 5 6.10
## 6 5.31</code></pre>
<p>The dataset has the following variables:</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Units</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>species</code></td>
<td>N/A</td>
<td>Scientific name (binomen) of species.</td>
</tr>
<tr class="even">
<td><code>common</code></td>
<td>N/A</td>
<td>Common name of species.</td>
</tr>
<tr class="odd">
<td><code>date</code></td>
<td>Days</td>
<td>Date of observation in YYYY-MM-DD format.</td>
</tr>
<tr class="even">
<td><code>lat</code></td>
<td><span class="math inline">\(^\circ\)</span>N</td>
<td>Latitude of observation. Positive values indicate <span class="math inline">\(^\circ\)</span>N; negative values indicate <span class="math inline">\(^\circ\)</span>S.</td>
</tr>
<tr class="odd">
<td><code>long</code></td>
<td><span class="math inline">\(^\circ\)</span>E</td>
<td>Longitude of observation. Positive values indicate <span class="math inline">\(^\circ\)</span>E; negative values indicate <span class="math inline">\(^\circ\)</span>W.</td>
</tr>
<tr class="even">
<td><code>ocean</code></td>
<td>N/A</td>
<td>Ocean where observation was taken. <code>AO</code> = Atlantic Ocean; <code>IO</code> = Indian Ocean; <code>PO</code> = Pacific Ocean.</td>
</tr>
<tr class="odd">
<td><code>fork</code></td>
<td>cm</td>
<td>Fork length (FL) of individual fish (distance from tip of snout to middle caudal fin rays). Slightly less than total length (TL).</td>
</tr>
<tr class="even">
<td><code>d15n</code></td>
<td>Parts per thousand</td>
<td>Ratio of <sup>15</sup>N to <sup>14</sup>N in sample (aka: <span class="math inline">\(\delta\)</span><sup>15</sup>N or “delta fifteen N”)</td>
</tr>
<tr class="odd">
<td><code>tp</code></td>
<td>Tropic levels</td>
<td>Estimated trophic level of individual based on <span class="math inline">\(\delta\)</span><sup>15</sup>N in tissue samples.</td>
</tr>
</tbody>
</table>
<p>The researchers were interested in how the trophic level of tuna varied with body size and geography. The trophic level expresses how high in the food chain an animal is. Primary producers such as plants and phytoplankton have a trophic level of 1. Animals that consume primary producers have a trophic level of 2. For example, grasses have trophic level 1, zebras have trophic level 2, and lions have trophic level 3.</p>
<p>The variables in play are animal size (fork length), latitude, longitude, ocean, and species. Fork length, latitude, and longitude can be modeled as continuous predictors. Ocean and species are factors. Ocean has 3 levels (Atlantic, Indian, and Pacific), as does species (<em>Thunnus albacares</em>, <em>T. obesus</em>, and <em>T. alalunga</em>). Which of these factors should be treated as fixed? Which as random? It depends on the researchers’ goals. If the objective is to predict the trophic position of particular species, or to predict the trophic position of species within particular oceans, then those factors should be fixed. If the sets of oceans and species in the dataset are just taken as representing other, unexamined oceans and/or species, then these factors should be treated as random. We will follow the example of the original authors and treat ocean as a random factor, with species as fixed.</p>
<p>Now that we have decided on a mixed model approach, we need to decide whether to use linear models or additive models. A quick plot of the data, with species and ocean overlaid as shapes and colors, respectively, suggests that linear models are unlikely to describe the data very well. So, we can try an additive model.</p>
<div class="sourceCode" id="cb1566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1566-1"><a href="7.5-mod-07-gamm.html#cb1566-1" aria-hidden="true" tabindex="-1"></a><span class="co"># color by ocean</span></span>
<span id="cb1566-2"><a href="7.5-mod-07-gamm.html#cb1566-2" aria-hidden="true" tabindex="-1"></a>ocs <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(dat<span class="sc">$</span>ocean))</span>
<span id="cb1566-3"><a href="7.5-mod-07-gamm.html#cb1566-3" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(ocs), <span class="at">alpha=</span><span class="fl">0.4</span>)</span>
<span id="cb1566-4"><a href="7.5-mod-07-gamm.html#cb1566-4" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>col <span class="ot">&lt;-</span> cols[<span class="fu">match</span>(dat<span class="sc">$</span>ocean, ocs)]</span>
<span id="cb1566-5"><a href="7.5-mod-07-gamm.html#cb1566-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1566-6"><a href="7.5-mod-07-gamm.html#cb1566-6" aria-hidden="true" tabindex="-1"></a><span class="co"># shape by species</span></span>
<span id="cb1566-7"><a href="7.5-mod-07-gamm.html#cb1566-7" aria-hidden="true" tabindex="-1"></a>spps <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(dat<span class="sc">$</span>species))</span>
<span id="cb1566-8"><a href="7.5-mod-07-gamm.html#cb1566-8" aria-hidden="true" tabindex="-1"></a>pchs <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">17</span></span>
<span id="cb1566-9"><a href="7.5-mod-07-gamm.html#cb1566-9" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>pch <span class="ot">&lt;-</span> pchs[<span class="fu">match</span>(dat<span class="sc">$</span>species, spps)]</span>
<span id="cb1566-10"><a href="7.5-mod-07-gamm.html#cb1566-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1566-11"><a href="7.5-mod-07-gamm.html#cb1566-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">cex.lab=</span><span class="fl">1.4</span>, <span class="at">cex.axis=</span><span class="fl">1.4</span>)</span>
<span id="cb1566-12"><a href="7.5-mod-07-gamm.html#cb1566-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>lat, dat<span class="sc">$</span>tp, <span class="at">col=</span>dat<span class="sc">$</span>col, <span class="at">pch=</span>dat<span class="sc">$</span>pch)</span>
<span id="cb1566-13"><a href="7.5-mod-07-gamm.html#cb1566-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>long, dat<span class="sc">$</span>tp, <span class="at">col=</span>dat<span class="sc">$</span>col, <span class="at">pch=</span>dat<span class="sc">$</span>pch)</span>
<span id="cb1566-14"><a href="7.5-mod-07-gamm.html#cb1566-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>fork, dat<span class="sc">$</span>tp, <span class="at">col=</span>dat<span class="sc">$</span>col, <span class="at">pch=</span>dat<span class="sc">$</span>pch)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-707-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Next, we need to consider what kind of additive model to use. The decision of whether to use an additive mixed model (AMM) or generalized additive mixed model (GAMM) hinges on the distribution of the response variable. Trophic positions cannot be negative (or &lt;1), so we might think of the values as coming from a lognormal distribution. This would be a GAMM with Gaussian family and log link function.</p>
<p>The main R package for fitting GAMM is the same package for fitting GAM: <code>mgcv</code> <span class="citation">(<a href="#ref-wood2017generalized" role="doc-biblioref">Wood 2017</a>)</span>. It should be noted that there are several ways within <code>mgcv</code> to fit GAMM. We’ll use the function <code>gamm()</code>; function <code>gam()</code> can also be used by manipulating some of the arguments to the smoother functions <code>s()</code>.</p>
<p>For this example we will fit 3 models, each with smoothers for a single continuous predictor. Each species will have its own smoother: this is what the <code>by=spp</code> argument in <code>s()</code> does. The random intercept of <code>ocean</code> is specified as a list.</p>
<div class="sourceCode" id="cb1567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1567-1"><a href="7.5-mod-07-gamm.html#cb1567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1567-2"><a href="7.5-mod-07-gamm.html#cb1567-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1567-3"><a href="7.5-mod-07-gamm.html#cb1567-3" aria-hidden="true" tabindex="-1"></a><span class="co"># very important: make a factor version of species to be </span></span>
<span id="cb1567-4"><a href="7.5-mod-07-gamm.html#cb1567-4" aria-hidden="true" tabindex="-1"></a><span class="co"># used by gamm()</span></span>
<span id="cb1567-5"><a href="7.5-mod-07-gamm.html#cb1567-5" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>spp <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>species)</span>
<span id="cb1567-6"><a href="7.5-mod-07-gamm.html#cb1567-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1567-7"><a href="7.5-mod-07-gamm.html#cb1567-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb1567-8"><a href="7.5-mod-07-gamm.html#cb1567-8" aria-hidden="true" tabindex="-1"></a>mod01 <span class="ot">&lt;-</span> <span class="fu">gamm</span>(tp<span class="sc">~</span><span class="fu">s</span>(lat, <span class="at">by=</span>spp), <span class="at">data=</span>dat,</span>
<span id="cb1567-9"><a href="7.5-mod-07-gamm.html#cb1567-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">random=</span><span class="fu">list</span>(<span class="at">ocean=</span><span class="sc">~</span><span class="dv">1</span>), <span class="at">family=</span><span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<div class="sourceCode" id="cb1573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1573-1"><a href="7.5-mod-07-gamm.html#cb1573-1" aria-hidden="true" tabindex="-1"></a>mod02 <span class="ot">&lt;-</span> <span class="fu">gamm</span>(tp<span class="sc">~</span><span class="fu">s</span>(long, <span class="at">by=</span>spp), <span class="at">data=</span>dat,</span>
<span id="cb1573-2"><a href="7.5-mod-07-gamm.html#cb1573-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">random=</span><span class="fu">list</span>(<span class="at">ocean=</span><span class="sc">~</span><span class="dv">1</span>), <span class="at">family=</span><span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<div class="sourceCode" id="cb1580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1580-1"><a href="7.5-mod-07-gamm.html#cb1580-1" aria-hidden="true" tabindex="-1"></a>mod03 <span class="ot">&lt;-</span> <span class="fu">gamm</span>(tp<span class="sc">~</span><span class="fu">s</span>(fork, <span class="at">by=</span>spp), <span class="at">data=</span>dat,</span>
<span id="cb1580-2"><a href="7.5-mod-07-gamm.html#cb1580-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">random=</span><span class="fu">list</span>(<span class="at">ocean=</span><span class="sc">~</span><span class="dv">1</span>), <span class="at">family=</span><span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<p>Outputs from <code>gamm()</code> are very complicated and intimidating, even to experts. The most important part of the output is in the <code>$gam</code> component.</p>
<div class="sourceCode" id="cb1586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1586-1"><a href="7.5-mod-07-gamm.html#cb1586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod01<span class="sc">$</span>gam, <span class="at">cor=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: log 
## 
## Formula:
## tp ~ s(lat, by = spp)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.64874    0.01467   112.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                               edf Ref.df      F p-value    
## s(lat):sppThunnus alalunga  7.257  7.257 122.11  &lt;2e-16 ***
## s(lat):sppThunnus albacares 8.743  8.743  27.61  &lt;2e-16 ***
## s(lat):sppThunnus obesus    8.661  8.661  20.05  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.365   
##   Scale est. = 0.68458   n = 3177</code></pre>
<p>The output contains only one parametric component, the estimated intercept. The overall or mean intercept was estimated as 1.648 <span class="math inline">\(\pm\)</span> 0.015, and was statistically significant. The “approximate signicance” of smooth terms is presented in a table separate from the parametric components. The “approximate” part of the name is very important: take estimates of <em>P</em>-values, <em>R</em><sup>2</sup>, and other such measures from GAMMs with a grain of salt. Even the help page for <code>summary.gam()</code> states that the <em>P</em>-value presented are likely to be too small.</p>
<p>If you have a factor with &gt;2 levels, you can print an ANOVA for the level-specific smoothers:</p>
<div class="sourceCode" id="cb1588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1588-1"><a href="7.5-mod-07-gamm.html#cb1588-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod01<span class="sc">$</span>gam)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: log 
## 
## Formula:
## tp ~ s(lat, by = spp)
## 
## Approximate significance of smooth terms:
##                               edf Ref.df      F p-value
## s(lat):sppThunnus alalunga  7.257  7.257 122.11  &lt;2e-16
## s(lat):sppThunnus albacares 8.743  8.743  27.61  &lt;2e-16
## s(lat):sppThunnus obesus    8.661  8.661  20.05  &lt;2e-16</code></pre>
<p>You can see the estimated smoothers using <code>plot()</code> on the <code>$gam</code> output.</p>
<div class="sourceCode" id="cb1590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1590-1"><a href="7.5-mod-07-gamm.html#cb1590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="co"># 1x3 panels, because 3 smoothers</span></span>
<span id="cb1590-2"><a href="7.5-mod-07-gamm.html#cb1590-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod01<span class="sc">$</span>gam)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-711-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1591-1"><a href="7.5-mod-07-gamm.html#cb1591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod02<span class="sc">$</span>gam)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-711-2.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1592-1"><a href="7.5-mod-07-gamm.html#cb1592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod03<span class="sc">$</span>gam)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-711-3.png" width="864" style="display: block; margin: auto;" /></p>
<p>Some of the smoothers for the predictor variables have quite different shapes for each species! The original study authors fit a separate model for each species and continuous predictor combination. But, with this many observations <code>(nrow(dat))</code>, we might be able to fit a single model that includes all predictors.</p>
<div class="sourceCode" id="cb1593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1593-1"><a href="7.5-mod-07-gamm.html#cb1593-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can we fit all the predictors in one model?</span></span>
<span id="cb1593-2"><a href="7.5-mod-07-gamm.html#cb1593-2" aria-hidden="true" tabindex="-1"></a>mod04 <span class="ot">&lt;-</span> <span class="fu">gamm</span>(tp<span class="sc">~</span><span class="fu">s</span>(lat, <span class="at">by=</span>spp)<span class="sc">+</span><span class="fu">s</span>(long, <span class="at">by=</span>spp)<span class="sc">+</span><span class="fu">s</span>(fork, <span class="at">by=</span>spp),</span>
<span id="cb1593-3"><a href="7.5-mod-07-gamm.html#cb1593-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat,</span>
<span id="cb1593-4"><a href="7.5-mod-07-gamm.html#cb1593-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">random=</span><span class="fu">list</span>(<span class="at">ocean=</span><span class="sc">~</span><span class="dv">1</span>),</span>
<span id="cb1593-5"><a href="7.5-mod-07-gamm.html#cb1593-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family=</span><span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<div class="sourceCode" id="cb1599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1599-1"><a href="7.5-mod-07-gamm.html#cb1599-1" aria-hidden="true" tabindex="-1"></a><span class="co"># yes!</span></span>
<span id="cb1599-2"><a href="7.5-mod-07-gamm.html#cb1599-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod04<span class="sc">$</span>gam)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: log 
## 
## Formula:
## tp ~ s(lat, by = spp) + s(long, by = spp) + s(fork, by = spp)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.8114     0.1406   12.88   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                                edf Ref.df      F  p-value    
## s(lat):sppThunnus alalunga   6.581  6.581 66.471  &lt; 2e-16 ***
## s(lat):sppThunnus albacares  8.518  8.518 20.780  &lt; 2e-16 ***
## s(lat):sppThunnus obesus     8.848  8.848 32.363  &lt; 2e-16 ***
## s(long):sppThunnus alalunga  8.100  8.100 40.762  &lt; 2e-16 ***
## s(long):sppThunnus albacares 8.020  8.020 23.551  &lt; 2e-16 ***
## s(long):sppThunnus obesus    8.010  8.010 52.744  &lt; 2e-16 ***
## s(fork):sppThunnus alalunga  3.660  3.660  8.713 1.64e-05 ***
## s(fork):sppThunnus albacares 6.447  6.447 14.814  &lt; 2e-16 ***
## s(fork):sppThunnus obesus    7.625  7.625  4.212 4.67e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  -0.0545   
##   Scale est. = 0.48822   n = 3168</code></pre>
<p>Examine the smoothers:</p>
<div class="sourceCode" id="cb1601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1601-1"><a href="7.5-mod-07-gamm.html#cb1601-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 predictors * 3 species = 9 panels</span></span>
<span id="cb1601-2"><a href="7.5-mod-07-gamm.html#cb1601-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note use of mfcol to fill by column,</span></span>
<span id="cb1601-3"><a href="7.5-mod-07-gamm.html#cb1601-3" aria-hidden="true" tabindex="-1"></a><span class="co"># so species are rows and predictors are columns</span></span>
<span id="cb1601-4"><a href="7.5-mod-07-gamm.html#cb1601-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb1601-5"><a href="7.5-mod-07-gamm.html#cb1601-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod04<span class="sc">$</span>gam)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-713-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The plots produced by plotting a <code>$gam</code> output show the effect of each smoother, not the actual predicted <em>y</em> value. The predicted value for an observation is obtained by adding the intercept to the effect of each smoother (this is what the “additive” in “additive model” means). For your manuscript, you probably want to show model predictions on the original data scale. The method below should work for most situations.</p>
<p>In the past, we’ve predicted response variables with single continuous predictor variables. For this example, we have 3 continuous predictors. The usual strategy a situation with &gt;1 continuous predictor is to present model predictions for each predictor with the other predictors held at their median. This makes the bookkeeping a little complicated, but the final graph is well worth the effort.</p>
<div class="sourceCode" id="cb1602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1602-1"><a href="7.5-mod-07-gamm.html#cb1602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of x values for prediction</span></span>
<span id="cb1602-2"><a href="7.5-mod-07-gamm.html#cb1602-2" aria-hidden="true" tabindex="-1"></a>pn <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1602-3"><a href="7.5-mod-07-gamm.html#cb1602-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-4"><a href="7.5-mod-07-gamm.html#cb1602-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sequence of each x value acros its domain</span></span>
<span id="cb1602-5"><a href="7.5-mod-07-gamm.html#cb1602-5" aria-hidden="true" tabindex="-1"></a>px1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>lat), <span class="fu">max</span>(dat<span class="sc">$</span>lat), <span class="at">length=</span>pn)</span>
<span id="cb1602-6"><a href="7.5-mod-07-gamm.html#cb1602-6" aria-hidden="true" tabindex="-1"></a>px2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>long), <span class="fu">max</span>(dat<span class="sc">$</span>long), <span class="at">length=</span>pn)</span>
<span id="cb1602-7"><a href="7.5-mod-07-gamm.html#cb1602-7" aria-hidden="true" tabindex="-1"></a>px3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>fork, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb1602-8"><a href="7.5-mod-07-gamm.html#cb1602-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(dat<span class="sc">$</span>fork, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">length=</span>pn)</span>
<span id="cb1602-9"><a href="7.5-mod-07-gamm.html#cb1602-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-10"><a href="7.5-mod-07-gamm.html#cb1602-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame of all factors and an index for row number (z)</span></span>
<span id="cb1602-11"><a href="7.5-mod-07-gamm.html#cb1602-11" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">ocean=</span><span class="cn">NA</span>, <span class="at">spp=</span>spps, <span class="at">z=</span><span class="dv">1</span><span class="sc">:</span>pn)</span>
<span id="cb1602-12"><a href="7.5-mod-07-gamm.html#cb1602-12" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> dx[<span class="fu">order</span>(dx<span class="sc">$</span>ocean, dx<span class="sc">$</span>spp, dx<span class="sc">$</span>z),]</span>
<span id="cb1602-13"><a href="7.5-mod-07-gamm.html#cb1602-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-14"><a href="7.5-mod-07-gamm.html#cb1602-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add median of each predictor to dx</span></span>
<span id="cb1602-15"><a href="7.5-mod-07-gamm.html#cb1602-15" aria-hidden="true" tabindex="-1"></a>dx<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="fu">median</span>(dat<span class="sc">$</span>lat)</span>
<span id="cb1602-16"><a href="7.5-mod-07-gamm.html#cb1602-16" aria-hidden="true" tabindex="-1"></a>dx<span class="sc">$</span>long <span class="ot">&lt;-</span> <span class="fu">median</span>(dat<span class="sc">$</span>long)</span>
<span id="cb1602-17"><a href="7.5-mod-07-gamm.html#cb1602-17" aria-hidden="true" tabindex="-1"></a>dx<span class="sc">$</span>fork <span class="ot">&lt;-</span> <span class="fu">median</span>(dat<span class="sc">$</span>fork, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb1602-18"><a href="7.5-mod-07-gamm.html#cb1602-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-19"><a href="7.5-mod-07-gamm.html#cb1602-19" aria-hidden="true" tabindex="-1"></a><span class="co"># need separate data frame of predictions for</span></span>
<span id="cb1602-20"><a href="7.5-mod-07-gamm.html#cb1602-20" aria-hidden="true" tabindex="-1"></a><span class="co"># each predictor</span></span>
<span id="cb1602-21"><a href="7.5-mod-07-gamm.html#cb1602-21" aria-hidden="true" tabindex="-1"></a>dx1 <span class="ot">&lt;-</span> dx</span>
<span id="cb1602-22"><a href="7.5-mod-07-gamm.html#cb1602-22" aria-hidden="true" tabindex="-1"></a>dx2 <span class="ot">&lt;-</span> dx</span>
<span id="cb1602-23"><a href="7.5-mod-07-gamm.html#cb1602-23" aria-hidden="true" tabindex="-1"></a>dx3 <span class="ot">&lt;-</span> dx</span>
<span id="cb1602-24"><a href="7.5-mod-07-gamm.html#cb1602-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-25"><a href="7.5-mod-07-gamm.html#cb1602-25" aria-hidden="true" tabindex="-1"></a><span class="co"># in each prediction data frame, assign ONE of</span></span>
<span id="cb1602-26"><a href="7.5-mod-07-gamm.html#cb1602-26" aria-hidden="true" tabindex="-1"></a><span class="co"># the predictors its sequence of values, leaving</span></span>
<span id="cb1602-27"><a href="7.5-mod-07-gamm.html#cb1602-27" aria-hidden="true" tabindex="-1"></a><span class="co"># other predictors at their median.</span></span>
<span id="cb1602-28"><a href="7.5-mod-07-gamm.html#cb1602-28" aria-hidden="true" tabindex="-1"></a><span class="do">## works because of recycling rule:</span></span>
<span id="cb1602-29"><a href="7.5-mod-07-gamm.html#cb1602-29" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>lat <span class="ot">&lt;-</span> px1</span>
<span id="cb1602-30"><a href="7.5-mod-07-gamm.html#cb1602-30" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>long <span class="ot">&lt;-</span> px2</span>
<span id="cb1602-31"><a href="7.5-mod-07-gamm.html#cb1602-31" aria-hidden="true" tabindex="-1"></a>dx3<span class="sc">$</span>fork <span class="ot">&lt;-</span> px3</span>
<span id="cb1602-32"><a href="7.5-mod-07-gamm.html#cb1602-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-33"><a href="7.5-mod-07-gamm.html#cb1602-33" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate predictions</span></span>
<span id="cb1602-34"><a href="7.5-mod-07-gamm.html#cb1602-34" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod04<span class="sc">$</span>gam, <span class="at">newdata=</span><span class="fu">data.frame</span>(dx1),</span>
<span id="cb1602-35"><a href="7.5-mod-07-gamm.html#cb1602-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1602-36"><a href="7.5-mod-07-gamm.html#cb1602-36" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod04<span class="sc">$</span>gam, <span class="at">newdata=</span><span class="fu">data.frame</span>(dx2),</span>
<span id="cb1602-37"><a href="7.5-mod-07-gamm.html#cb1602-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1602-38"><a href="7.5-mod-07-gamm.html#cb1602-38" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod04<span class="sc">$</span>gam, <span class="at">newdata=</span><span class="fu">data.frame</span>(dx3), </span>
<span id="cb1602-39"><a href="7.5-mod-07-gamm.html#cb1602-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1602-40"><a href="7.5-mod-07-gamm.html#cb1602-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-41"><a href="7.5-mod-07-gamm.html#cb1602-41" aria-hidden="true" tabindex="-1"></a><span class="co"># add predictions and SE to data frames</span></span>
<span id="cb1602-42"><a href="7.5-mod-07-gamm.html#cb1602-42" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>mu <span class="ot">&lt;-</span> pred1<span class="sc">$</span>fit</span>
<span id="cb1602-43"><a href="7.5-mod-07-gamm.html#cb1602-43" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>mu <span class="ot">&lt;-</span> pred2<span class="sc">$</span>fit</span>
<span id="cb1602-44"><a href="7.5-mod-07-gamm.html#cb1602-44" aria-hidden="true" tabindex="-1"></a>dx3<span class="sc">$</span>mu <span class="ot">&lt;-</span> pred3<span class="sc">$</span>fit</span>
<span id="cb1602-45"><a href="7.5-mod-07-gamm.html#cb1602-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-46"><a href="7.5-mod-07-gamm.html#cb1602-46" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>se <span class="ot">&lt;-</span> pred1<span class="sc">$</span>se.fit</span>
<span id="cb1602-47"><a href="7.5-mod-07-gamm.html#cb1602-47" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>se <span class="ot">&lt;-</span> pred2<span class="sc">$</span>se.fit</span>
<span id="cb1602-48"><a href="7.5-mod-07-gamm.html#cb1602-48" aria-hidden="true" tabindex="-1"></a>dx3<span class="sc">$</span>se <span class="ot">&lt;-</span> pred3<span class="sc">$</span>se.fit</span>
<span id="cb1602-49"><a href="7.5-mod-07-gamm.html#cb1602-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-50"><a href="7.5-mod-07-gamm.html#cb1602-50" aria-hidden="true" tabindex="-1"></a><span class="co"># normal approximation for 95% CI</span></span>
<span id="cb1602-51"><a href="7.5-mod-07-gamm.html#cb1602-51" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>lo <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.025</span>, dx1<span class="sc">$</span>mu, dx1<span class="sc">$</span>se)</span>
<span id="cb1602-52"><a href="7.5-mod-07-gamm.html#cb1602-52" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>lo <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.025</span>, dx2<span class="sc">$</span>mu, dx2<span class="sc">$</span>se)</span>
<span id="cb1602-53"><a href="7.5-mod-07-gamm.html#cb1602-53" aria-hidden="true" tabindex="-1"></a>dx3<span class="sc">$</span>lo <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.025</span>, dx3<span class="sc">$</span>mu, dx3<span class="sc">$</span>se)</span>
<span id="cb1602-54"><a href="7.5-mod-07-gamm.html#cb1602-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-55"><a href="7.5-mod-07-gamm.html#cb1602-55" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>mn <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.5</span>, dx1<span class="sc">$</span>mu, dx1<span class="sc">$</span>se)</span>
<span id="cb1602-56"><a href="7.5-mod-07-gamm.html#cb1602-56" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>mn <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.5</span>, dx2<span class="sc">$</span>mu, dx2<span class="sc">$</span>se)</span>
<span id="cb1602-57"><a href="7.5-mod-07-gamm.html#cb1602-57" aria-hidden="true" tabindex="-1"></a>dx3<span class="sc">$</span>mn <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.5</span>, dx3<span class="sc">$</span>mu, dx3<span class="sc">$</span>se)</span>
<span id="cb1602-58"><a href="7.5-mod-07-gamm.html#cb1602-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-59"><a href="7.5-mod-07-gamm.html#cb1602-59" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>up <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.975</span>, dx1<span class="sc">$</span>mu, dx1<span class="sc">$</span>se)</span>
<span id="cb1602-60"><a href="7.5-mod-07-gamm.html#cb1602-60" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>up <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.975</span>, dx2<span class="sc">$</span>mu, dx2<span class="sc">$</span>se)</span>
<span id="cb1602-61"><a href="7.5-mod-07-gamm.html#cb1602-61" aria-hidden="true" tabindex="-1"></a>dx3<span class="sc">$</span>up <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.975</span>, dx3<span class="sc">$</span>mu, dx3<span class="sc">$</span>se)</span>
<span id="cb1602-62"><a href="7.5-mod-07-gamm.html#cb1602-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1602-63"><a href="7.5-mod-07-gamm.html#cb1602-63" aria-hidden="true" tabindex="-1"></a><span class="co"># add variable &quot;panel&quot; to help organize the plot later</span></span>
<span id="cb1602-64"><a href="7.5-mod-07-gamm.html#cb1602-64" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>panel <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each=</span>pn)</span>
<span id="cb1602-65"><a href="7.5-mod-07-gamm.html#cb1602-65" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>panel <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">each=</span>pn)</span>
<span id="cb1602-66"><a href="7.5-mod-07-gamm.html#cb1602-66" aria-hidden="true" tabindex="-1"></a>dx3<span class="sc">$</span>panel <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">each=</span>pn)</span>
<span id="cb1602-67"><a href="7.5-mod-07-gamm.html#cb1602-67" aria-hidden="true" tabindex="-1"></a>dz <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dx1, dx2, dx3)</span>
<span id="cb1602-68"><a href="7.5-mod-07-gamm.html#cb1602-68" aria-hidden="true" tabindex="-1"></a>dz <span class="ot">&lt;-</span> dz[<span class="fu">order</span>(dz<span class="sc">$</span>panel),]</span></code></pre></div>
<p>Next we make the plot.</p>
<div class="sourceCode" id="cb1603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1603-1"><a href="7.5-mod-07-gamm.html#cb1603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># helps with bookkeeping</span></span>
<span id="cb1603-2"><a href="7.5-mod-07-gamm.html#cb1603-2" aria-hidden="true" tabindex="-1"></a>pan.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">panel=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, </span>
<span id="cb1603-3"><a href="7.5-mod-07-gamm.html#cb1603-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">con=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;lat&quot;</span>, <span class="st">&quot;long&quot;</span>, <span class="st">&quot;fork&quot;</span>), <span class="at">each=</span><span class="dv">3</span>),</span>
<span id="cb1603-4"><a href="7.5-mod-07-gamm.html#cb1603-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spp=</span><span class="fu">rep</span>(spps, <span class="at">times=</span><span class="dv">3</span>))</span>
<span id="cb1603-5"><a href="7.5-mod-07-gamm.html#cb1603-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-6"><a href="7.5-mod-07-gamm.html#cb1603-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1603-7"><a href="7.5-mod-07-gamm.html#cb1603-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb1603-8"><a href="7.5-mod-07-gamm.html#cb1603-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb1603-9"><a href="7.5-mod-07-gamm.html#cb1603-9" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> <span class="fu">which</span>(dz<span class="sc">$</span>panel <span class="sc">==</span> i)</span>
<span id="cb1603-10"><a href="7.5-mod-07-gamm.html#cb1603-10" aria-hidden="true" tabindex="-1"></a>    zi <span class="ot">&lt;-</span> dz[flag,]</span>
<span id="cb1603-11"><a href="7.5-mod-07-gamm.html#cb1603-11" aria-hidden="true" tabindex="-1"></a>    xvar <span class="ot">&lt;-</span> pan.df<span class="sc">$</span>con[i]</span>
<span id="cb1603-12"><a href="7.5-mod-07-gamm.html#cb1603-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> zi[,xvar]</span>
<span id="cb1603-13"><a href="7.5-mod-07-gamm.html#cb1603-13" aria-hidden="true" tabindex="-1"></a>    sppi <span class="ot">&lt;-</span> pan.df<span class="sc">$</span>spp[i]</span>
<span id="cb1603-14"><a href="7.5-mod-07-gamm.html#cb1603-14" aria-hidden="true" tabindex="-1"></a>    di <span class="ot">&lt;-</span> dat[<span class="fu">which</span>(dat<span class="sc">$</span>species <span class="sc">==</span> sppi),]</span>
<span id="cb1603-15"><a href="7.5-mod-07-gamm.html#cb1603-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-16"><a href="7.5-mod-07-gamm.html#cb1603-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(xvar <span class="sc">==</span> <span class="st">&quot;lat&quot;</span>){</span>
<span id="cb1603-17"><a href="7.5-mod-07-gamm.html#cb1603-17" aria-hidden="true" tabindex="-1"></a>        use.xlab <span class="ot">&lt;-</span> <span class="fu">expression</span>(Latitude<span class="sc">~</span>(degree<span class="sc">*</span>N))</span>
<span id="cb1603-18"><a href="7.5-mod-07-gamm.html#cb1603-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1603-19"><a href="7.5-mod-07-gamm.html#cb1603-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(xvar <span class="sc">==</span> <span class="st">&quot;long&quot;</span>){</span>
<span id="cb1603-20"><a href="7.5-mod-07-gamm.html#cb1603-20" aria-hidden="true" tabindex="-1"></a>        use.xlab <span class="ot">&lt;-</span> <span class="fu">expression</span>(Longitude<span class="sc">~</span>(degree<span class="sc">*</span>E))</span>
<span id="cb1603-21"><a href="7.5-mod-07-gamm.html#cb1603-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1603-22"><a href="7.5-mod-07-gamm.html#cb1603-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(xvar <span class="sc">==</span> <span class="st">&quot;fork&quot;</span>){</span>
<span id="cb1603-23"><a href="7.5-mod-07-gamm.html#cb1603-23" aria-hidden="true" tabindex="-1"></a>        use.xlab <span class="ot">&lt;-</span> <span class="st">&quot;Fork length (cm)&quot;</span></span>
<span id="cb1603-24"><a href="7.5-mod-07-gamm.html#cb1603-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1603-25"><a href="7.5-mod-07-gamm.html#cb1603-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(di[,xvar], di<span class="sc">$</span>tp, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;#00000020&quot;</span>,</span>
<span id="cb1603-26"><a href="7.5-mod-07-gamm.html#cb1603-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">16</span>), <span class="at">xlab=</span>use.xlab,</span>
<span id="cb1603-27"><a href="7.5-mod-07-gamm.html#cb1603-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Trophic level (unitless)&quot;</span>)</span>
<span id="cb1603-28"><a href="7.5-mod-07-gamm.html#cb1603-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(x, zi<span class="sc">$</span>mn, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1603-29"><a href="7.5-mod-07-gamm.html#cb1603-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(x, zi<span class="sc">$</span>lo, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1603-30"><a href="7.5-mod-07-gamm.html#cb1603-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(x, zi<span class="sc">$</span>up, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1603-31"><a href="7.5-mod-07-gamm.html#cb1603-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main=</span>pan.df<span class="sc">$</span>spp[i], <span class="at">adj=</span><span class="dv">0</span>, <span class="at">font.main=</span><span class="dv">3</span>)</span>
<span id="cb1603-32"><a href="7.5-mod-07-gamm.html#cb1603-32" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-715-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The fitted smoothers are pretty good for some species and predictors, but not so much for others. Refinement of the analysis should involve revisiting what distribution to use and what random effects structure to include in the model. Fiddling with the options for fitting smoothers (see <code>?s</code>) might help as well.</p>

</div>
</div>
<!-- </div> -->
<h3>Literature Cited</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-bodin2021" class="csl-entry">
Bodin, N., H. Pethybridge, L. M. Duffy, A. Lorrain, V. Allain, J. M. Logan, F. Ménard, B. Graham, C. A. Choy, C. J. Somes, R. J. Olson, and J. W. Young. 2021. <a href="https://doi.org/10.1002/ecy.3265">Global data set for nitrogen and carbon stable isotopes of tunas</a>. Ecology 102:e03265.
</div>
<div id="ref-pethybridge2018" class="csl-entry">
Pethybridge, H., C. A. Choy, J. M. Logan, V. Allain, A. Lorrain, N. Bodin, C. J. Somes, J. Young, F. Ménard, C. Langlais, L. Duffy, A. J. Hobday, P. Kuhnert, B. Fry, C. Menkes, and R. J. Olson. 2018. <a href="https://doi.org/10.1111/geb.12763">A global meta-analysis of marine predator nitrogen stable isotopes: Relationships between trophic structure and environmental conditions</a>. Global Ecology and Biogeography 27:1043–1055.
</div>
<div id="ref-wood2017generalized" class="csl-entry">
Wood, S. N. 2017. Generalized additive models: An introduction with <span>R</span>. 2nd edition. CRC press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7.4-mod-07-nlme.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="8-mod-08.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
