<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.4 Poisson GLM for counts | Applied Biological Data Analysis</title>
  <meta name="description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5.4 Poisson GLM for counts | Applied Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://greenquanteco.github.io/index.html" />
  <meta property="og:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />
  <meta property="og:description" content="Helping biologists to become more informed users of R and statistical methods." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.4 Poisson GLM for counts | Applied Biological Data Analysis" />
  
  <meta name="twitter:description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="twitter:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />

<meta name="author" content="Nick Green, Kennesaw State University" />


<meta name="date" content="2022-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="5.3-mod-05-loglin.html"/>
<link rel="next" href="5.5-mod-05-quasi.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="license-and-permissions.html"><a href="license-and-permissions.html"><i class="fa fa-check"></i>License and permissions</a></li>
<li class="chapter" data-level="" data-path="course-description.html"><a href="course-description.html"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="course-objectives.html"><a href="course-objectives.html"><i class="fa fa-check"></i>Course objectives</a></li>
<li class="chapter" data-level="" data-path="course-requirements.html"><a href="course-requirements.html"><i class="fa fa-check"></i>Course requirements</a></li>
<li class="chapter" data-level="" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i>Recommended reading</a></li>
<li class="chapter" data-level="" data-path="course-organization.html"><a href="course-organization.html"><i class="fa fa-check"></i>Course organization</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-mod-01.html"><a href="1-mod-01.html"><i class="fa fa-check"></i><b>1</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-overview.html"><a href="1.1-overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html"><i class="fa fa-check"></i><b>1.2</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html#the-scientific-method"><i class="fa fa-check"></i><b>1.2.1</b> The scientific method</a></li>
<li class="chapter" data-level="1.2.2" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html#example-data-analysis"><i class="fa fa-check"></i><b>1.2.2</b> Example data analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html"><i class="fa fa-check"></i><b>1.3</b> Misuses of statistics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#proving-the-trivial-and-meaningless-hypotheses"><i class="fa fa-check"></i><b>1.3.1</b> “Proving” the trivial and meaningless hypotheses</a></li>
<li class="chapter" data-level="1.3.2" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#inappropriate-methods"><i class="fa fa-check"></i><b>1.3.2</b> Inappropriate methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#p-hacking-and-data-dredging"><i class="fa fa-check"></i><b>1.3.3</b> <em>P</em>-hacking and data dredging</a></li>
<li class="chapter" data-level="1.3.4" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#inadequate-sample-sizes-and-pseudoreplication"><i class="fa fa-check"></i><b>1.3.4</b> Inadequate sample sizes and pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><i class="fa fa-check"></i><b>1.4</b> <em>P</em>-values and null hypothesis significance testing (NHST)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#definition"><i class="fa fa-check"></i><b>1.4.1</b> Definition</a></li>
<li class="chapter" data-level="1.4.2" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#history-and-status-of-p-values"><i class="fa fa-check"></i><b>1.4.2</b> History and status of <em>P</em>-values</a></li>
<li class="chapter" data-level="1.4.3" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#where-p-values-come-from"><i class="fa fa-check"></i><b>1.4.3</b> Where <em>P</em>-values come from</a></li>
<li class="chapter" data-level="1.4.4" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#what-p-values-mean-and-do-not-mean"><i class="fa fa-check"></i><b>1.4.4</b> What <em>P</em>-values mean and do not mean</a></li>
<li class="chapter" data-level="1.4.5" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#do-you-need-a-p-value"><i class="fa fa-check"></i><b>1.4.5</b> Do you need a <em>P</em>-value?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html"><i class="fa fa-check"></i><b>1.5</b> Alternatives to NHST</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.1</b> Bayesian inference</a></li>
<li class="chapter" data-level="1.5.2" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#information-theoretic-methods"><i class="fa fa-check"></i><b>1.5.2</b> Information-theoretic methods</a></li>
<li class="chapter" data-level="1.5.3" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#machine-learning"><i class="fa fa-check"></i><b>1.5.3</b> Machine learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-mod-02.html"><a href="2-mod-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html"><i class="fa fa-check"></i><b>2.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#advantages-of-r"><i class="fa fa-check"></i><b>2.1.2</b> Advantages of R</a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#disadvantages-of-r"><i class="fa fa-check"></i><b>2.1.3</b> Disadvantages of R</a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#base-r-and-vs.-tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Base R and (vs.?) <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-download-and-install-r-and-rstudio.html"><a href="2.2-download-and-install-r-and-rstudio.html"><i class="fa fa-check"></i><b>2.2</b> Download and install R (and RStudio)</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-using-r.html"><a href="2.3-using-r.html"><i class="fa fa-check"></i><b>2.3</b> Using R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-the-base-r-gui"><i class="fa fa-check"></i><b>2.3.1</b> Using the base R GUI</a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-r-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Using R in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-r-with-other-programs"><i class="fa fa-check"></i><b>2.3.3</b> Using R with other programs</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html"><i class="fa fa-check"></i><b>2.4</b> A first R session</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#import-data"><i class="fa fa-check"></i><b>2.4.1</b> Import data</a></li>
<li class="chapter" data-level="2.4.2" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#explore-and-visualize-data"><i class="fa fa-check"></i><b>2.4.2</b> Explore and visualize data</a></li>
<li class="chapter" data-level="2.4.3" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#transform-data"><i class="fa fa-check"></i><b>2.4.3</b> Transform data</a></li>
<li class="chapter" data-level="2.4.4" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#analyze-data"><i class="fa fa-check"></i><b>2.4.4</b> Analyze data</a></li>
<li class="chapter" data-level="2.4.5" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#write-out-results"><i class="fa fa-check"></i><b>2.4.5</b> Write out results</a></li>
<li class="chapter" data-level="2.4.6" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#save-your-work"><i class="fa fa-check"></i><b>2.4.6</b> Save your work?</a></li>
<li class="chapter" data-level="2.4.7" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#whats-next"><i class="fa fa-check"></i><b>2.4.7</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html"><i class="fa fa-check"></i><b>2.5</b> Write and execute commands in the R console</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#r-commandsbasics"><i class="fa fa-check"></i><b>2.5.1</b> R commands–basics</a></li>
<li class="chapter" data-level="2.5.2" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#elements-of-r-code"><i class="fa fa-check"></i><b>2.5.2</b> Elements of R code</a></li>
<li class="chapter" data-level="2.5.3" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#the-r-workspace"><i class="fa fa-check"></i><b>2.5.3</b> The R workspace</a></li>
<li class="chapter" data-level="2.5.4" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#r-code-basics-assignment-and-operators"><i class="fa fa-check"></i><b>2.5.4</b> R code basics: assignment and operators</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html"><i class="fa fa-check"></i><b>2.6</b> Basic R data structures</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#data-frames"><i class="fa fa-check"></i><b>2.6.2</b> Data frames</a></li>
<li class="chapter" data-level="2.6.3" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.6.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.6.4" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#lists"><i class="fa fa-check"></i><b>2.6.4</b> Lists</a></li>
<li class="chapter" data-level="2.6.5" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#s4-objects"><i class="fa fa-check"></i><b>2.6.5</b> S4 objects</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html"><i class="fa fa-check"></i><b>2.7</b> R data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#character-type"><i class="fa fa-check"></i><b>2.7.1</b> Character type</a></li>
<li class="chapter" data-level="2.7.2" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#numeric-type"><i class="fa fa-check"></i><b>2.7.2</b> Numeric type</a></li>
<li class="chapter" data-level="2.7.3" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#integer-type"><i class="fa fa-check"></i><b>2.7.3</b> Integer type</a></li>
<li class="chapter" data-level="2.7.4" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#logical-type"><i class="fa fa-check"></i><b>2.7.4</b> Logical type</a></li>
<li class="chapter" data-level="2.7.5" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#special-values"><i class="fa fa-check"></i><b>2.7.5</b> Special values</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2.8-manage-r-code-as-scripts-.r-files.html"><a href="2.8-manage-r-code-as-scripts-.r-files.html"><i class="fa fa-check"></i><b>2.8</b> Manage R code as scripts (.r files)</a></li>
<li class="chapter" data-level="2.9" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html"><i class="fa fa-check"></i><b>2.9</b> Manage and use R packages</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#your-r-library"><i class="fa fa-check"></i><b>2.9.1</b> Your R library</a></li>
<li class="chapter" data-level="2.9.2" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-using-the-r-gui"><i class="fa fa-check"></i><b>2.9.2</b> Installing packages using the R GUI</a></li>
<li class="chapter" data-level="2.9.3" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-in-rstudio"><i class="fa fa-check"></i><b>2.9.3</b> Installing packages in RStudio</a></li>
<li class="chapter" data-level="2.9.4" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-using-the-r-console"><i class="fa fa-check"></i><b>2.9.4</b> Installing packages using the R console</a></li>
<li class="chapter" data-level="2.9.5" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#working-with-packages-in-r"><i class="fa fa-check"></i><b>2.9.5</b> Working with packages in R</a></li>
<li class="chapter" data-level="2.9.6" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#package-dependencies"><i class="fa fa-check"></i><b>2.9.6</b> Package dependencies</a></li>
<li class="chapter" data-level="2.9.7" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#citing-packages"><i class="fa fa-check"></i><b>2.9.7</b> Citing packages</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html"><i class="fa fa-check"></i><b>2.10</b> R documentation</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#documentation-help-files"><i class="fa fa-check"></i><b>2.10.1</b> Documentation (help) files</a></li>
<li class="chapter" data-level="2.10.2" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#r-vignettes"><i class="fa fa-check"></i><b>2.10.2</b> R vignettes</a></li>
<li class="chapter" data-level="2.10.3" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#official-r-project-resources"><i class="fa fa-check"></i><b>2.10.3</b> Official R Project resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#unofficial-online-resources"><i class="fa fa-check"></i><b>2.10.4</b> Unofficial online resources</a></li>
<li class="chapter" data-level="2.10.5" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#r-books"><i class="fa fa-check"></i><b>2.10.5</b> R books</a></li>
<li class="chapter" data-level="2.10.6" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#two-reminders"><i class="fa fa-check"></i><b>2.10.6</b> Two reminders</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-mod-03.html"><a href="3-mod-03.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html"><i class="fa fa-check"></i><b>3.1</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-preliminaries"><i class="fa fa-check"></i><b>3.1.1</b> Importing data: preliminaries</a></li>
<li class="chapter" data-level="3.1.2" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-from-text-files-with-read.csv-and-read.table"><i class="fa fa-check"></i><b>3.1.2</b> Importing data from text files with <code>read.csv()</code> and <code>read.table()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-from-saved-workspaces"><i class="fa fa-check"></i><b>3.1.3</b> Importing data from saved workspaces</a></li>
<li class="chapter" data-level="3.1.4" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-special-cases"><i class="fa fa-check"></i><b>3.1.4</b> Importing data: special cases:</a></li>
<li class="chapter" data-level="3.1.5" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#export-data-from-r"><i class="fa fa-check"></i><b>3.1.5</b> Export data from R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html"><i class="fa fa-check"></i><b>3.2</b> Making values in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#producing-arbitrary-values-with-c"><i class="fa fa-check"></i><b>3.2.1</b> Producing arbitrary values with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#generating-regular-values"><i class="fa fa-check"></i><b>3.2.2</b> Generating regular values</a></li>
<li class="chapter" data-level="3.2.3" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#generating-random-values"><i class="fa fa-check"></i><b>3.2.3</b> Generating random values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html"><i class="fa fa-check"></i><b>3.3</b> Selecting data with <code>[]</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html#mod-03-brackets"><i class="fa fa-check"></i><b>3.3.1</b> Basics of brackets</a></li>
<li class="chapter" data-level="3.3.2" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html#extracting-and-selecting-data-with-logical-tests"><i class="fa fa-check"></i><b>3.3.2</b> Extracting and selecting data with logical tests</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html"><i class="fa fa-check"></i><b>3.4</b> Managing dates and characters</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html#temporal-data-and-dates"><i class="fa fa-check"></i><b>3.4.1</b> Temporal data and dates</a></li>
<li class="chapter" data-level="3.4.2" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html#character-data-text"><i class="fa fa-check"></i><b>3.4.2</b> Character data (text)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html"><i class="fa fa-check"></i><b>3.5</b> Data frame management</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#data-frame-structure"><i class="fa fa-check"></i><b>3.5.1</b> Data frame structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#common-data-frame-operations"><i class="fa fa-check"></i><b>3.5.2</b> Common data frame operations</a></li>
<li class="chapter" data-level="3.5.3" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#other-data-frame-operations"><i class="fa fa-check"></i><b>3.5.3</b> Other data frame operations</a></li>
<li class="chapter" data-level="3.5.4" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#mod-03-reshape"><i class="fa fa-check"></i><b>3.5.4</b> Reshaping data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-mod-04.html"><a href="4-mod-04.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html"><i class="fa fa-check"></i><b>4.1</b> Descriptive and summary statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#basic-summary-statistics"><i class="fa fa-check"></i><b>4.1.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="4.1.2" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#summarizing-data-with-the-apply-family"><i class="fa fa-check"></i><b>4.1.2</b> Summarizing data with the <code>apply()</code> family</a></li>
<li class="chapter" data-level="4.1.3" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#mod-04-tabagg"><i class="fa fa-check"></i><b>4.1.3</b> Tabulation and aggregation</a></li>
<li class="chapter" data-level="4.1.4" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#aggregation-aka-pivot-tables"><i class="fa fa-check"></i><b>4.1.4</b> Aggregation (aka: pivot tables)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html"><i class="fa fa-check"></i><b>4.2</b> Visualizing data distributions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#boxplots-aka-box-and-whisker-plots"><i class="fa fa-check"></i><b>4.2.1</b> Boxplots (aka: box-and-whisker plots)</a></li>
<li class="chapter" data-level="4.2.2" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#histograms"><i class="fa fa-check"></i><b>4.2.2</b> Histograms</a></li>
<li class="chapter" data-level="4.2.3" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#kernel-density-plots"><i class="fa fa-check"></i><b>4.2.3</b> Kernel density plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#empirical-cumulative-distribution-plots-ecdf"><i class="fa fa-check"></i><b>4.2.4</b> Empirical cumulative distribution plots (ECDF)</a></li>
<li class="chapter" data-level="4.2.5" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#quantile-quantile-qq-plots"><i class="fa fa-check"></i><b>4.2.5</b> Quantile-quantile (QQ) plots</a></li>
<li class="chapter" data-level="4.2.6" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#how-should-i-plot-my-data"><i class="fa fa-check"></i><b>4.2.6</b> How should I plot my data?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html"><i class="fa fa-check"></i><b>4.3</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#probability-distributions"><i class="fa fa-check"></i><b>4.3.1</b> Probability distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>4.3.2</b> Probability distributions in R</a></li>
<li class="chapter" data-level="4.3.3" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#discrete-distributions"><i class="fa fa-check"></i><b>4.3.3</b> Discrete distributions</a></li>
<li class="chapter" data-level="4.3.4" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#continuous-distributions"><i class="fa fa-check"></i><b>4.3.4</b> Continuous distributions</a></li>
<li class="chapter" data-level="4.3.5" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#distributions-summary"><i class="fa fa-check"></i><b>4.3.5</b> Distributions summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html"><i class="fa fa-check"></i><b>4.4</b> Fitting and testing distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#estimating-distributional-parameters"><i class="fa fa-check"></i><b>4.4.1</b> Estimating distributional parameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#graphical-methods-for-examining-distributions"><i class="fa fa-check"></i><b>4.4.2</b> Graphical methods for examining distributions</a></li>
<li class="chapter" data-level="4.4.3" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#formal-tests-for-distributions"><i class="fa fa-check"></i><b>4.4.3</b> Formal tests for distributions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html"><i class="fa fa-check"></i><b>4.5</b> Data transformations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#why-transform"><i class="fa fa-check"></i><b>4.5.1</b> Why transform?</a></li>
<li class="chapter" data-level="4.5.2" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#transforms-vs.-link-functions"><i class="fa fa-check"></i><b>4.5.2</b> Transforms vs. link functions</a></li>
<li class="chapter" data-level="4.5.3" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#log-transformation"><i class="fa fa-check"></i><b>4.5.3</b> Log transformation</a></li>
<li class="chapter" data-level="4.5.4" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#rank-transformation"><i class="fa fa-check"></i><b>4.5.4</b> Rank transformation</a></li>
<li class="chapter" data-level="4.5.5" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#other-transforms-less-common"><i class="fa fa-check"></i><b>4.5.5</b> Other transforms (less common)</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html"><i class="fa fa-check"></i><b>4.6</b> Multivariate data exploration</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#scatterplots-for-two-variables"><i class="fa fa-check"></i><b>4.6.1</b> Scatterplots for two variables</a></li>
<li class="chapter" data-level="4.6.2" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#mod-04-smat"><i class="fa fa-check"></i><b>4.6.2</b> Scatterplot matrices for many variables</a></li>
<li class="chapter" data-level="4.6.3" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#lattice-plots-for-hierarchical-data"><i class="fa fa-check"></i><b>4.6.3</b> Lattice plots for hierarchical data</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html"><i class="fa fa-check"></i><b>4.7</b> Ordination (brief introduction)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>4.7.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="4.7.2" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#nonmetric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>4.7.2</b> Nonmetric multidimensional scaling (NMDS)</a></li>
<li class="chapter" data-level="4.7.3" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#plotting-ordinations"><i class="fa fa-check"></i><b>4.7.3</b> Plotting ordinations</a></li>
<li class="chapter" data-level="4.7.4" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#ordination-wrap-up-for-now"><i class="fa fa-check"></i><b>4.7.4</b> Ordination wrap-up (for now)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html"><i class="fa fa-check"></i><b>4.8</b> Common statistical problems</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#outliers-and-erroneous-values"><i class="fa fa-check"></i><b>4.8.1</b> Outliers and erroneous values</a></li>
<li class="chapter" data-level="4.8.2" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#autocorrelation"><i class="fa fa-check"></i><b>4.8.2</b> Autocorrelation</a></li>
<li class="chapter" data-level="4.8.3" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#mod-04-multicol"><i class="fa fa-check"></i><b>4.8.3</b> Collinearity</a></li>
<li class="chapter" data-level="4.8.4" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#missing-data"><i class="fa fa-check"></i><b>4.8.4</b> Missing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-mod-05.html"><a href="5-mod-05.html"><i class="fa fa-check"></i><b>5</b> Generalized linear models (GLM)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html"><i class="fa fa-check"></i><b>5.1</b> Prelude with linear models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#assumptions-of-linear-models"><i class="fa fa-check"></i><b>5.1.1</b> Assumptions of linear models</a></li>
<li class="chapter" data-level="5.1.2" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#linear-regression-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Linear regression in R</a></li>
<li class="chapter" data-level="5.1.3" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="5.1.4" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#mod-05-anova"><i class="fa fa-check"></i><b>5.1.4</b> ANOVA and ANCOVA with <code>lm()</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#variations-on-linear-models"><i class="fa fa-check"></i><b>5.1.5</b> Variations on linear models</a></li>
<li class="chapter" data-level="5.1.6" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#example-linear-regression-workflow"><i class="fa fa-check"></i><b>5.1.6</b> Example linear regression workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html"><i class="fa fa-check"></i><b>5.2</b> GLM basics</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#example-glms"><i class="fa fa-check"></i><b>5.2.1</b> Example GLMS</a></li>
<li class="chapter" data-level="5.2.2" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#glm-families"><i class="fa fa-check"></i><b>5.2.2</b> GLM families</a></li>
<li class="chapter" data-level="5.2.3" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#glm-link-functions"><i class="fa fa-check"></i><b>5.2.3</b> GLM link functions</a></li>
<li class="chapter" data-level="5.2.4" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#deviance-and-other-glm-diagnostics"><i class="fa fa-check"></i><b>5.2.4</b> Deviance and other GLM diagnostics</a></li>
<li class="chapter" data-level="5.2.5" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#to-pseudo-r2-or-not-to-pseudo-r2"><i class="fa fa-check"></i><b>5.2.5</b> To pseudo-<em>R</em><sup>2</sup> or not to pseudo-<em>R</em><sup>2</sup>?</a></li>
<li class="chapter" data-level="5.2.6" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#common-glms"><i class="fa fa-check"></i><b>5.2.6</b> Common GLMs</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html"><i class="fa fa-check"></i><b>5.3</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html#mod-05-loglin-examp"><i class="fa fa-check"></i><b>5.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.3.2" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html#example-with-real-data"><i class="fa fa-check"></i><b>5.3.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html"><i class="fa fa-check"></i><b>5.4</b> Poisson GLM for counts</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html#example-with-simulated-data"><i class="fa fa-check"></i><b>5.4.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.4.2" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html#example-with-real-data-1"><i class="fa fa-check"></i><b>5.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html"><i class="fa fa-check"></i><b>5.5</b> Quasi-Poisson and negative binomial GLM</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html#example-with-simulated-data-1"><i class="fa fa-check"></i><b>5.5.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.5.2" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html#example-with-real-data-2"><i class="fa fa-check"></i><b>5.5.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html"><i class="fa fa-check"></i><b>5.6</b> Logistic regression for binary outcomes</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#example-with-simulated-data-2"><i class="fa fa-check"></i><b>5.6.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.6.2" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#example-with-real-data-3"><i class="fa fa-check"></i><b>5.6.2</b> Example with real data</a></li>
<li class="chapter" data-level="5.6.3" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#mod-05-auc"><i class="fa fa-check"></i><b>5.6.3</b> Logistic GLM diagnostics: AUC and ROC</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html"><i class="fa fa-check"></i><b>5.7</b> Binomial GLM for proportional data</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html#binomial-glm"><i class="fa fa-check"></i><b>5.7.1</b> Binomial GLM</a></li>
<li class="chapter" data-level="5.7.2" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html#example-with-simulated-data-3"><i class="fa fa-check"></i><b>5.7.2</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="5.8-mod-05-gamma.html"><a href="5.8-mod-05-gamma.html"><i class="fa fa-check"></i><b>5.8</b> Gamma models for overdispersed data</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="5.8-mod-05-gamma.html"><a href="5.8-mod-05-gamma.html#example-with-simulated-data-4"><i class="fa fa-check"></i><b>5.8.1</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html"><i class="fa fa-check"></i><b>5.9</b> Beyond GLM: Overview of GAM and GEE</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html#mod-05-gam"><i class="fa fa-check"></i><b>5.9.1</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="5.9.2" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html#mod-05-gee"><i class="fa fa-check"></i><b>5.9.2</b> Generalized estimating equations (GEE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-mod-06.html"><a href="6-mod-06.html"><i class="fa fa-check"></i><b>6</b> Nonlinear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-background.html"><a href="6.1-background.html"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-mod-06-intro.html"><a href="6.2-mod-06-intro.html"><i class="fa fa-check"></i><b>6.2</b> Nonlinear least squares (NLS)</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html"><i class="fa fa-check"></i><b>6.3</b> Michaelis-Menten curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#mod-06-micmen-sim"><i class="fa fa-check"></i><b>6.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="6.3.2" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#example-with-real-data-4"><i class="fa fa-check"></i><b>6.3.2</b> Example with real data</a></li>
<li class="chapter" data-level="6.3.3" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#alternative-strategies-for-the-analysis"><i class="fa fa-check"></i><b>6.3.3</b> Alternative strategies for the analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html"><i class="fa fa-check"></i><b>6.4</b> Biological growth curves</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html#gompertz-and-von-bertalanffy-curves"><i class="fa fa-check"></i><b>6.4.1</b> Gompertz and von Bertalanffy curves</a></li>
<li class="chapter" data-level="6.4.2" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html#example-with-real-data-5"><i class="fa fa-check"></i><b>6.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6.5-dose-response-curves.html"><a href="6.5-dose-response-curves.html"><i class="fa fa-check"></i><b>6.5</b> Dose response curves</a></li>
<li class="chapter" data-level="6.6" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html"><i class="fa fa-check"></i><b>6.6</b> Alternatives to NLS</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#generalized-nonlinear-models"><i class="fa fa-check"></i><b>6.6.1</b> Generalized nonlinear models</a></li>
<li class="chapter" data-level="6.6.2" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#quantile-regression"><i class="fa fa-check"></i><b>6.6.2</b> Quantile regression</a></li>
<li class="chapter" data-level="6.6.3" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#mod-06-gam"><i class="fa fa-check"></i><b>6.6.3</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="6.6.4" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>6.6.4</b> Classification and regression trees (CART)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-mod-07.html"><a href="7-mod-07.html"><i class="fa fa-check"></i><b>7</b> Mixed models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-prelude-glm.html"><a href="7.1-prelude-glm.html"><i class="fa fa-check"></i><b>7.1</b> Prelude (GLM)</a></li>
<li class="chapter" data-level="7.2" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html"><i class="fa fa-check"></i><b>7.2</b> Linear mixed models (LMM)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#formal-definition-and-example"><i class="fa fa-check"></i><b>7.2.1</b> Formal definition and example</a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#example-with-simulated-data-5"><i class="fa fa-check"></i><b>7.2.2</b> Example with simulated data</a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#p-values-in-lmm"><i class="fa fa-check"></i><b>7.2.3</b> <em>P</em>-values in LMM</a></li>
<li class="chapter" data-level="7.2.4" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#specifying-random-effects"><i class="fa fa-check"></i><b>7.2.4</b> Specifying random effects</a></li>
<li class="chapter" data-level="7.2.5" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#lmm-example-with-real-data"><i class="fa fa-check"></i><b>7.2.5</b> LMM example with real data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html"><i class="fa fa-check"></i><b>7.3</b> Generalized linear mixed models (GLMM)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#definition-1"><i class="fa fa-check"></i><b>7.3.1</b> Definition</a></li>
<li class="chapter" data-level="7.3.2" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#glmm-on-simulated-data"><i class="fa fa-check"></i><b>7.3.2</b> GLMM on simulated data</a></li>
<li class="chapter" data-level="7.3.3" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#glmm-on-real-data"><i class="fa fa-check"></i><b>7.3.3</b> GLMM on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html"><i class="fa fa-check"></i><b>7.4</b> Nonlinear mixed models (NLME)</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#definition-and-background"><i class="fa fa-check"></i><b>7.4.1</b> Definition and background</a></li>
<li class="chapter" data-level="7.4.2" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#nlme-on-simulated-data"><i class="fa fa-check"></i><b>7.4.2</b> NLME on simulated data</a></li>
<li class="chapter" data-level="7.4.3" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#nlme-on-real-data"><i class="fa fa-check"></i><b>7.4.3</b> NLME on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7.5-mod-07-gamm.html"><a href="7.5-mod-07-gamm.html"><i class="fa fa-check"></i><b>7.5</b> (Generalized) additive mixed models (AMM/GAMM)</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7.5-mod-07-gamm.html"><a href="7.5-mod-07-gamm.html#example-gamm-with-real-data"><i class="fa fa-check"></i><b>7.5.1</b> Example GAMM with real data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-mod-08.html"><a href="8-mod-08.html"><i class="fa fa-check"></i><b>8</b> Multivariate data analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html"><i class="fa fa-check"></i><b>8.1</b> Multivariate data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html#univariate-vs.-multivariate-data"><i class="fa fa-check"></i><b>8.1.1</b> Univariate vs. multivariate data</a></li>
<li class="chapter" data-level="8.1.2" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html#components-of-multivariate-data"><i class="fa fa-check"></i><b>8.1.2</b> Components of multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html"><i class="fa fa-check"></i><b>8.2</b> Distance metrics: biological (dis)similarity</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html#euclidean-distance"><i class="fa fa-check"></i><b>8.2.1</b> Euclidean distance</a></li>
<li class="chapter" data-level="8.2.2" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html#bray-curtis-and-other-distance-metrics"><i class="fa fa-check"></i><b>8.2.2</b> Bray-Curtis and other distance metrics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8.3-clustering.html"><a href="8.3-clustering.html"><i class="fa fa-check"></i><b>8.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8.3-clustering.html"><a href="8.3-clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>8.3.1</b> <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="8.3.2" data-path="8.3-clustering.html"><a href="8.3-clustering.html#hierarchical-agglomerative-clustering"><i class="fa fa-check"></i><b>8.3.2</b> Hierarchical agglomerative clustering</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html"><i class="fa fa-check"></i><b>8.4</b> Analyzing dissimilarity</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html#mantel-tests-distance-vs.-distance"><i class="fa fa-check"></i><b>8.4.1</b> Mantel tests: distance vs. distance</a></li>
<li class="chapter" data-level="8.4.2" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html#comparing-dissimilarity-between-groups"><i class="fa fa-check"></i><b>8.4.2</b> Comparing dissimilarity between groups</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html"><i class="fa fa-check"></i><b>8.5</b> Ordination</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#principal-components-analysis-pca-1"><i class="fa fa-check"></i><b>8.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="8.5.2" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#nmds-and-other-ordination-methods"><i class="fa fa-check"></i><b>8.5.2</b> NMDS and other ordination methods</a></li>
<li class="chapter" data-level="8.5.3" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#other-ordination-techniques"><i class="fa fa-check"></i><b>8.5.3</b> Other ordination techniques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-mod-09.html"><a href="9-mod-09.html"><i class="fa fa-check"></i><b>9</b> Planning your analysis (what test?)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9.1-how-to-use-this-guide.html"><a href="9.1-how-to-use-this-guide.html"><i class="fa fa-check"></i><b>9.1</b> How to use this guide</a></li>
<li class="chapter" data-level="9.2" data-path="9.2-what-question-are-you-trying-to-answer.html"><a href="9.2-what-question-are-you-trying-to-answer.html"><i class="fa fa-check"></i><b>9.2</b> What question are you trying to answer?</a></li>
<li class="chapter" data-level="9.3" data-path="9.3-testing-for-a-difference-in-mean-or-location.html"><a href="9.3-testing-for-a-difference-in-mean-or-location.html"><i class="fa fa-check"></i><b>9.3</b> Testing for a difference in mean or location</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="9.3-testing-for-a-difference-in-mean-or-location.html"><a href="9.3-testing-for-a-difference-in-mean-or-location.html#additional-considerations"><i class="fa fa-check"></i><b>9.3.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><a href="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><i class="fa fa-check"></i><b>9.4</b> Testing for a continuous relationship between two or more variables</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><a href="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html#additional-considerations-1"><i class="fa fa-check"></i><b>9.4.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9.5-classifying-observations.html"><a href="9.5-classifying-observations.html"><i class="fa fa-check"></i><b>9.5</b> Classifying observations</a></li>
<li class="chapter" data-level="9.6" data-path="9.6-conclusions.html"><a href="9.6-conclusions.html"><i class="fa fa-check"></i><b>9.6</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literature-cited.html"><a href="literature-cited.html"><i class="fa fa-check"></i>Literature Cited</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-05-poisson" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Poisson GLM for counts</h2>
<p>This is one of several sections exploring some common GLM applications. For most of these applications we will work through two examples. First, an analysis of simulated data, and second, an analysis of a real dataset. Simulating a dataset suitable for an analysis is an excellent way to learn about the analysis method, because it helps you see the relationship between the data-generating process and the analysis.</p>
<p>This module explores GLMs for <strong>count</strong> data. Count data are exactly what they sound like: values resulting from counting things. Count data take the form of non-negative integers. Non-negative integers, however, are not necessarily count data. For example, values can be rounded to the nearest integer, but they will not be counts.</p>
<p>Count data are usually well-modeled by a kind of GLM called <strong>Poisson regression</strong>. The “Poisson” part comes from the <strong>Poisson distribution</strong>, which describes counts and events that occur at a constant rate. The “regression” part of the name comes from the fact that the technique involves a linear relationship between the predictors and some function of the response.</p>
<p>In the <a href="5.5-mod-05-quasi.html#mod-05-quasi">next section</a> we will explore another class of models for count data that do <em>not</em> follow the Poisson distribution. These models, the <strong>quasi-Poisson</strong> and <strong>negative binomial</strong> GLMs, have an extra term that accounts for overdispersion.</p>
<p><strong>Poisson regression</strong> describes a GLM with a Poisson family and log link function. As with other GLMs, we do not fit an equation for the response values directly. Instead, we fit a linear model for the log of the expected value, and assume that the actual observed counts follow a Poisson distribution. To see what this means in practice, let’s simulate some data that might be modeled by Poisson regression.</p>
<div id="example-with-simulated-data" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Example with simulated data</h3>
<p>In this example Poisson GLM workflow we will simulate some data, analyze it, and interpret the results.</p>
<div class="sourceCode" id="cb1195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1195-1"><a href="5.4-mod-05-poisson.html#cb1195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random number seed for reproducibility</span></span>
<span id="cb1195-2"><a href="5.4-mod-05-poisson.html#cb1195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1195-3"><a href="5.4-mod-05-poisson.html#cb1195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1195-4"><a href="5.4-mod-05-poisson.html#cb1195-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample size</span></span>
<span id="cb1195-5"><a href="5.4-mod-05-poisson.html#cb1195-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1195-6"><a href="5.4-mod-05-poisson.html#cb1195-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1195-7"><a href="5.4-mod-05-poisson.html#cb1195-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficients</span></span>
<span id="cb1195-8"><a href="5.4-mod-05-poisson.html#cb1195-8" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb1195-9"><a href="5.4-mod-05-poisson.html#cb1195-9" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb1195-10"><a href="5.4-mod-05-poisson.html#cb1195-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1195-11"><a href="5.4-mod-05-poisson.html#cb1195-11" aria-hidden="true" tabindex="-1"></a><span class="co"># x values</span></span>
<span id="cb1195-12"><a href="5.4-mod-05-poisson.html#cb1195-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb1195-13"><a href="5.4-mod-05-poisson.html#cb1195-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1195-14"><a href="5.4-mod-05-poisson.html#cb1195-14" aria-hidden="true" tabindex="-1"></a><span class="co"># linear predictor</span></span>
<span id="cb1195-15"><a href="5.4-mod-05-poisson.html#cb1195-15" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> x</span>
<span id="cb1195-16"><a href="5.4-mod-05-poisson.html#cb1195-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1195-17"><a href="5.4-mod-05-poisson.html#cb1195-17" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse link function</span></span>
<span id="cb1195-18"><a href="5.4-mod-05-poisson.html#cb1195-18" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(eta)</span>
<span id="cb1195-19"><a href="5.4-mod-05-poisson.html#cb1195-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1195-20"><a href="5.4-mod-05-poisson.html#cb1195-20" aria-hidden="true" tabindex="-1"></a><span class="co"># response variable</span></span>
<span id="cb1195-21"><a href="5.4-mod-05-poisson.html#cb1195-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda)</span>
<span id="cb1195-22"><a href="5.4-mod-05-poisson.html#cb1195-22" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb1195-23"><a href="5.4-mod-05-poisson.html#cb1195-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-490-1.png" width="576" /></p>
<p>The relationship between <em>Y</em> and <em>X</em> looks linear, but because we are clever biologists, we know that linear models are not appropriate for two reasons. First, linear models predict continuous responses, and counts are not continuous (they are discrete). Second, linear models can predict negative responses, and counts cannot be negative. So, we will try Poisson regression because the Poisson distribution is so good at handling counts.</p>
<div class="sourceCode" id="cb1196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1196-1"><a href="5.4-mod-05-poisson.html#cb1196-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y<span class="sc">~</span>x, <span class="at">data=</span>dat, <span class="at">family=</span>poisson)</span>
<span id="cb1196-2"><a href="5.4-mod-05-poisson.html#cb1196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ x, family = poisson, data = dat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.06284  -0.46194  -0.06797   0.39314   2.18201  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.9258     0.1447   6.397 1.59e-10 ***
## x             0.2089     0.0183  11.415  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 194.34  on 49  degrees of freedom
## Residual deviance:  37.16  on 48  degrees of freedom
## AIC: 241.37
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The estimated parameters are very close to the correct values! The model also explains a lot of the variation in <em>Y</em>, as seen by the pseudo-<em>R</em><sup>2</sup> of &gt; 0.8.</p>
<div class="sourceCode" id="cb1198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1198-1"><a href="5.4-mod-05-poisson.html#cb1198-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span>mod1<span class="sc">$</span>deviance<span class="sc">/</span>mod1<span class="sc">$</span>null.deviance</span></code></pre></div>
<pre><code>## [1] 0.8087827</code></pre>
<p>The next step is to plot predicted values and the original data. If you have visited any of the other modules in this course, you should be familiar with the process by now. Even if you feel comfortable generating model predictions, there are some wrinkles to be aware of when working with non-normal models. We’re going to present predictions in several ways, to illustrate the relationship between the GLM and the data.</p>
<p>First, let’s present the 95% prediction interval (PI). The PI is an interval in which 95% of values should fall. It is necessarily larger than the 95% confidence interval (CI), which is the interval where the expected value should fall. Both intervals have their uses; just be clear about which one you are using.</p>
<p>Notice that we do not request <code>se.fit=TRUE</code> in the commands below, because it is not needed to get the PI of the Poisson distribution. This is because for the Poisson distribution the expected value, mean, and variance are all the same value (i.e., <span class="math inline">\(\lambda=\mu=\sigma^2\)</span>).</p>
<div class="sourceCode" id="cb1200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1200-1"><a href="5.4-mod-05-poisson.html#cb1200-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1200-2"><a href="5.4-mod-05-poisson.html#cb1200-2" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>x), <span class="fu">max</span>(dat<span class="sc">$</span>x), <span class="at">length=</span>n)</span>
<span id="cb1200-3"><a href="5.4-mod-05-poisson.html#cb1200-3" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, </span>
<span id="cb1200-4"><a href="5.4-mod-05-poisson.html#cb1200-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>px),</span>
<span id="cb1200-5"><a href="5.4-mod-05-poisson.html#cb1200-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb1200-6"><a href="5.4-mod-05-poisson.html#cb1200-6" aria-hidden="true" tabindex="-1"></a>mn1 <span class="ot">&lt;-</span> pred1</span>
<span id="cb1200-7"><a href="5.4-mod-05-poisson.html#cb1200-7" aria-hidden="true" tabindex="-1"></a>lo1 <span class="ot">&lt;-</span> <span class="fu">qpois</span>(<span class="fl">0.025</span>, mn1)</span>
<span id="cb1200-8"><a href="5.4-mod-05-poisson.html#cb1200-8" aria-hidden="true" tabindex="-1"></a>up1 <span class="ot">&lt;-</span> <span class="fu">qpois</span>(<span class="fl">0.975</span>, mn1)</span>
<span id="cb1200-9"><a href="5.4-mod-05-poisson.html#cb1200-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1200-10"><a href="5.4-mod-05-poisson.html#cb1200-10" aria-hidden="true" tabindex="-1"></a><span class="co"># make the plot:</span></span>
<span id="cb1200-11"><a href="5.4-mod-05-poisson.html#cb1200-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1200-12"><a href="5.4-mod-05-poisson.html#cb1200-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb1200-13"><a href="5.4-mod-05-poisson.html#cb1200-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1200-14"><a href="5.4-mod-05-poisson.html#cb1200-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1200-15"><a href="5.4-mod-05-poisson.html#cb1200-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1200-16"><a href="5.4-mod-05-poisson.html#cb1200-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-493-1.png" width="576" /></p>
<p>Notice anything odd? The 95% prediction limits increase in discrete steps rather than as smooth curves. This is because we calculated them as quantiles from the Poisson distribution, which can only take on integer values. This means that the PI can only be bounded by integer values. The plotted PI is correct, but looks odd because we are used to seeing smooth curves. It also looks odd because it includes most (if not all) values, which CI do not do.</p>
<p>The second method is a more traditional 95% CI. Unlike the PI, the CI shows the uncertainty associated with the expected value. This means that the relationship between the PI and CI is similar to the relationship between the SD and SE.</p>
<div class="sourceCode" id="cb1201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1201-1"><a href="5.4-mod-05-poisson.html#cb1201-1" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, </span>
<span id="cb1201-2"><a href="5.4-mod-05-poisson.html#cb1201-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>px),</span>
<span id="cb1201-3"><a href="5.4-mod-05-poisson.html#cb1201-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">&quot;response&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1201-4"><a href="5.4-mod-05-poisson.html#cb1201-4" aria-hidden="true" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> pred2<span class="sc">$</span>fit</span>
<span id="cb1201-5"><a href="5.4-mod-05-poisson.html#cb1201-5" aria-hidden="true" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> mn2 <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>pred2<span class="sc">$</span>se.fit</span>
<span id="cb1201-6"><a href="5.4-mod-05-poisson.html#cb1201-6" aria-hidden="true" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> mn2 <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>pred2<span class="sc">$</span>se.fit</span>
<span id="cb1201-7"><a href="5.4-mod-05-poisson.html#cb1201-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1201-8"><a href="5.4-mod-05-poisson.html#cb1201-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1201-9"><a href="5.4-mod-05-poisson.html#cb1201-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb1201-10"><a href="5.4-mod-05-poisson.html#cb1201-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1201-11"><a href="5.4-mod-05-poisson.html#cb1201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1201-12"><a href="5.4-mod-05-poisson.html#cb1201-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1201-13"><a href="5.4-mod-05-poisson.html#cb1201-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-494-1.png" width="576" /></p>
<p>Given that the Poisson distribution is defined by a single parameter that is both the mean and variance, it is worth wondering what the SE estimated by <code>se.fit=TRUE</code> in the command that created <code>pred2</code> really is (after all, it is separate from the mean!). In a nutshell, it is the SE of the expected value assuming that the expected value follows a normal distribution. This assumption turns out to be appropriate for many situations. Taking advantage of the properties of the normal distribution allowed us to use <span class="math inline">\(\pm\)</span> 1.96 SE to approximate the 95% CI (verify this with <code>qnorm(c(0.025, 0.975))</code>). Alternatively, we could have used:</p>
<div class="sourceCode" id="cb1202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1202-1"><a href="5.4-mod-05-poisson.html#cb1202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not run:</span></span>
<span id="cb1202-2"><a href="5.4-mod-05-poisson.html#cb1202-2" aria-hidden="true" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, mn2, pred2<span class="sc">$</span>se.fit)</span>
<span id="cb1202-3"><a href="5.4-mod-05-poisson.html#cb1202-3" aria-hidden="true" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, mn2, pred2<span class="sc">$</span>se.fit)</span></code></pre></div>
<p>Finally, we could have also generated predictions on the link scale and transformed them to the response scale. This method is often safer than using <code>type="response</code> because the resulting predictions are <strong><em>guaranteed</em></strong> to be inside the domain of the response variable.</p>
<div class="sourceCode" id="cb1203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1203-1"><a href="5.4-mod-05-poisson.html#cb1203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># getting CI from link scale</span></span>
<span id="cb1203-2"><a href="5.4-mod-05-poisson.html#cb1203-2" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, </span>
<span id="cb1203-3"><a href="5.4-mod-05-poisson.html#cb1203-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>px),</span>
<span id="cb1203-4"><a href="5.4-mod-05-poisson.html#cb1203-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1203-5"><a href="5.4-mod-05-poisson.html#cb1203-5" aria-hidden="true" tabindex="-1"></a>mn3 <span class="ot">&lt;-</span> pred3<span class="sc">$</span>fit</span>
<span id="cb1203-6"><a href="5.4-mod-05-poisson.html#cb1203-6" aria-hidden="true" tabindex="-1"></a>lo3 <span class="ot">&lt;-</span> mn3 <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>pred3<span class="sc">$</span>se.fit</span>
<span id="cb1203-7"><a href="5.4-mod-05-poisson.html#cb1203-7" aria-hidden="true" tabindex="-1"></a>up3 <span class="ot">&lt;-</span> mn3 <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>pred3<span class="sc">$</span>se.fit</span>
<span id="cb1203-8"><a href="5.4-mod-05-poisson.html#cb1203-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1203-9"><a href="5.4-mod-05-poisson.html#cb1203-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use inverse link function from model object</span></span>
<span id="cb1203-10"><a href="5.4-mod-05-poisson.html#cb1203-10" aria-hidden="true" tabindex="-1"></a>mn3 <span class="ot">&lt;-</span> mod1<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(mn3)</span>
<span id="cb1203-11"><a href="5.4-mod-05-poisson.html#cb1203-11" aria-hidden="true" tabindex="-1"></a>lo3 <span class="ot">&lt;-</span> mod1<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(lo3)</span>
<span id="cb1203-12"><a href="5.4-mod-05-poisson.html#cb1203-12" aria-hidden="true" tabindex="-1"></a>up3 <span class="ot">&lt;-</span> mod1<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(up3)</span>
<span id="cb1203-13"><a href="5.4-mod-05-poisson.html#cb1203-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1203-14"><a href="5.4-mod-05-poisson.html#cb1203-14" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb1203-15"><a href="5.4-mod-05-poisson.html#cb1203-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1203-16"><a href="5.4-mod-05-poisson.html#cb1203-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb1203-17"><a href="5.4-mod-05-poisson.html#cb1203-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1203-18"><a href="5.4-mod-05-poisson.html#cb1203-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1203-19"><a href="5.4-mod-05-poisson.html#cb1203-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1203-20"><a href="5.4-mod-05-poisson.html#cb1203-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-496-1.png" width="576" /></p>
</div>
<div id="example-with-real-data-1" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Example with real data</h3>
<p>The study of statistical patterns in biodiversity, abundance, and ecological function across large spatial scales is called <strong>macroecology</strong>. Rather than study individual species and sites, macroecologists integrate data across many studies and databases to search for broadly applicable patterns. <span class="citation">Faurby et al. (<a href="#ref-faurby2018" role="doc-biblioref">2018</a>)</span> compiled basic biogeographic, conservation, and life history data for &gt;5800 species of mammals and published them as the database PHYLACINE. We will use the data from PHYLACINE to explore the relationship between mammal species richness and geography in the western hemisphere. The figure below shows the species richness data at 2075 systematically placed points in mainland North America and South America.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/05_08.jpg" /></p>
<p>The dataset <a href="https://greenquanteco.github.io/mammal_data_2021-09-08.csv">mammal_data_2021-09-08.csv</a> contains mammal species richness at about 2000 locations throughout North and South America. These points were defined by longitude and latitude in a regular grid that covered both continents. The PHYLACINE database was then queried to determine which species’ ranges overlapped each point. The result is a data frame with the species richness of each point related to its geographic coordinates<a href="literature-cited.html#fn58" class="footnote-ref" id="fnref58"><sup>58</sup></a>.</p>
<p>First, download the data and put it in your R home directory. We’ll do some data exploration before jumping into the analysis.</p>
<div class="sourceCode" id="cb1204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1204-1"><a href="5.4-mod-05-poisson.html#cb1204-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;mammal_data_2021-09-08.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb1204-2"><a href="5.4-mod-05-poisson.html#cb1204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##   X      long       lat rich
## 1 1 -72.50909 -52.49019   58
## 2 2 -70.99915 -52.49019   56
## 3 3 -73.26407 -51.18254   55
## 4 4 -71.75412 -51.18254   31
## 5 5 -70.24417 -51.18254   24
## 6 6 -74.01904 -49.87489   43</code></pre>
<div class="sourceCode" id="cb1206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1206-1"><a href="5.4-mod-05-poisson.html#cb1206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb1206-2"><a href="5.4-mod-05-poisson.html#cb1206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>rich)</span>
<span id="cb1206-3"><a href="5.4-mod-05-poisson.html#cb1206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>lat)</span>
<span id="cb1206-4"><a href="5.4-mod-05-poisson.html#cb1206-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>lat, dat<span class="sc">$</span>rich)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-497-1.png" width="864" /></p>
<p>At first glance, it looks like mammal species richness peaks near the equator (0 = equator, + = north latitude, and - = south latitude). It also looks like the response to latitude is the same whether going north or south. So, let’s use the absolute value of latitude instead. While we’re at it, let’s try out a log-transform on richness. This makes sense because richness (1) appears highly right-skewed; and (2) must be nonnegative.</p>
<div class="sourceCode" id="cb1207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1207-1"><a href="5.4-mod-05-poisson.html#cb1207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform:</span></span>
<span id="cb1207-2"><a href="5.4-mod-05-poisson.html#cb1207-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>xlat <span class="ot">&lt;-</span> <span class="fu">abs</span>(dat<span class="sc">$</span>lat)</span>
<span id="cb1207-3"><a href="5.4-mod-05-poisson.html#cb1207-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>logrich <span class="ot">&lt;-</span> <span class="fu">log</span>(dat<span class="sc">$</span>rich)</span>
<span id="cb1207-4"><a href="5.4-mod-05-poisson.html#cb1207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1207-5"><a href="5.4-mod-05-poisson.html#cb1207-5" aria-hidden="true" tabindex="-1"></a><span class="co"># look again:</span></span>
<span id="cb1207-6"><a href="5.4-mod-05-poisson.html#cb1207-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb1207-7"><a href="5.4-mod-05-poisson.html#cb1207-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>logrich)</span>
<span id="cb1207-8"><a href="5.4-mod-05-poisson.html#cb1207-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>xlat)</span>
<span id="cb1207-9"><a href="5.4-mod-05-poisson.html#cb1207-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>xlat, dat<span class="sc">$</span>logrich)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-498-1.png" width="864" /></p>
<p>The rightmost plot shows that there is a linear relationship between the log-transformed response variable, which represents counts, and the explanatory variable. This means we should try modeling this relationship with a GLM, with a Poisson family and log link function. The Poisson distribution is because the data are counts. The log link is used because it is the canonical link function for the Poisson family.</p>
<div class="sourceCode" id="cb1208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1208-1"><a href="5.4-mod-05-poisson.html#cb1208-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(rich<span class="sc">~</span>xlat, <span class="at">data=</span>dat, <span class="at">family=</span>poisson)</span>
<span id="cb1208-2"><a href="5.4-mod-05-poisson.html#cb1208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1208-3"><a href="5.4-mod-05-poisson.html#cb1208-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check model terms:</span></span>
<span id="cb1208-4"><a href="5.4-mod-05-poisson.html#cb1208-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = rich ~ xlat, family = poisson, data = dat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -11.2645   -1.4664    0.0785    1.4371    8.4076  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  5.2859143  0.0038991  1355.7   &lt;2e-16 ***
## xlat        -0.0282742  0.0001219  -231.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 69333  on 2074  degrees of freedom
## Residual deviance: 11653  on 2073  degrees of freedom
## AIC: 24186
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb1210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1210-1"><a href="5.4-mod-05-poisson.html#cb1210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pseudo R squared:</span></span>
<span id="cb1210-2"><a href="5.4-mod-05-poisson.html#cb1210-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span>mod1<span class="sc">$</span>deviance<span class="sc">/</span>mod1<span class="sc">$</span>null.deviance</span></code></pre></div>
<pre><code>## [1] 0.8319267</code></pre>
<p>As before, we want to present the data with the predictions of the model, and the 95% CI of the predictions. As before, we’ll explore different ways of calculating and presenting uncertainty about the predictions. First, we’ll use the Poisson distribution to get the 95% prediction interval (the interval where 95% of values should fall). Then, we’ll use the normal approximation to get the 95% confidence interval of <span class="math inline">\(\lambda\)</span> (i.e., the interval where we are 95% certain that the true <span class="math inline">\(\lambda\)</span> falls).</p>
<div class="sourceCode" id="cb1212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1212-1"><a href="5.4-mod-05-poisson.html#cb1212-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1212-2"><a href="5.4-mod-05-poisson.html#cb1212-2" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>xlat), <span class="fu">max</span>(dat<span class="sc">$</span>xlat), <span class="at">length=</span>n)</span>
<span id="cb1212-3"><a href="5.4-mod-05-poisson.html#cb1212-3" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">xlat=</span>px)</span>
<span id="cb1212-4"><a href="5.4-mod-05-poisson.html#cb1212-4" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, </span>
<span id="cb1212-5"><a href="5.4-mod-05-poisson.html#cb1212-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">newdata=</span><span class="fu">data.frame</span>(dx),</span>
<span id="cb1212-6"><a href="5.4-mod-05-poisson.html#cb1212-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">&quot;response&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1212-7"><a href="5.4-mod-05-poisson.html#cb1212-7" aria-hidden="true" tabindex="-1"></a>mn1 <span class="ot">&lt;-</span> pred1<span class="sc">$</span>fit</span>
<span id="cb1212-8"><a href="5.4-mod-05-poisson.html#cb1212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1212-9"><a href="5.4-mod-05-poisson.html#cb1212-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson prediction interval:</span></span>
<span id="cb1212-10"><a href="5.4-mod-05-poisson.html#cb1212-10" aria-hidden="true" tabindex="-1"></a>lo1 <span class="ot">&lt;-</span> <span class="fu">qpois</span>(<span class="fl">0.025</span>, mn1)</span>
<span id="cb1212-11"><a href="5.4-mod-05-poisson.html#cb1212-11" aria-hidden="true" tabindex="-1"></a>up1 <span class="ot">&lt;-</span> <span class="fu">qpois</span>(<span class="fl">0.975</span>, mn1)</span>
<span id="cb1212-12"><a href="5.4-mod-05-poisson.html#cb1212-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1212-13"><a href="5.4-mod-05-poisson.html#cb1212-13" aria-hidden="true" tabindex="-1"></a><span class="co"># normal approximation confidence interval:</span></span>
<span id="cb1212-14"><a href="5.4-mod-05-poisson.html#cb1212-14" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, </span>
<span id="cb1212-15"><a href="5.4-mod-05-poisson.html#cb1212-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">newdata=</span><span class="fu">data.frame</span>(dx),</span>
<span id="cb1212-16"><a href="5.4-mod-05-poisson.html#cb1212-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">&quot;link&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1212-17"><a href="5.4-mod-05-poisson.html#cb1212-17" aria-hidden="true" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> pred2<span class="sc">$</span>fit</span>
<span id="cb1212-18"><a href="5.4-mod-05-poisson.html#cb1212-18" aria-hidden="true" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, mn2, pred2<span class="sc">$</span>se.fit)</span>
<span id="cb1212-19"><a href="5.4-mod-05-poisson.html#cb1212-19" aria-hidden="true" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, mn2, pred2<span class="sc">$</span>se.fit)</span>
<span id="cb1212-20"><a href="5.4-mod-05-poisson.html#cb1212-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1212-21"><a href="5.4-mod-05-poisson.html#cb1212-21" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse link function</span></span>
<span id="cb1212-22"><a href="5.4-mod-05-poisson.html#cb1212-22" aria-hidden="true" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> mod1<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(mn2)</span>
<span id="cb1212-23"><a href="5.4-mod-05-poisson.html#cb1212-23" aria-hidden="true" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> mod1<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(lo2)</span>
<span id="cb1212-24"><a href="5.4-mod-05-poisson.html#cb1212-24" aria-hidden="true" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> mod1<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(up2)</span>
<span id="cb1212-25"><a href="5.4-mod-05-poisson.html#cb1212-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1212-26"><a href="5.4-mod-05-poisson.html#cb1212-26" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.main=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb1212-27"><a href="5.4-mod-05-poisson.html#cb1212-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>xlat, dat<span class="sc">$</span>rich,</span>
<span id="cb1212-28"><a href="5.4-mod-05-poisson.html#cb1212-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Poisson 95% PI&quot;</span>,</span>
<span id="cb1212-29"><a href="5.4-mod-05-poisson.html#cb1212-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Absolute latitude (deg.)&quot;</span>,</span>
<span id="cb1212-30"><a href="5.4-mod-05-poisson.html#cb1212-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Species richness (R)&quot;</span>)</span>
<span id="cb1212-31"><a href="5.4-mod-05-poisson.html#cb1212-31" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1212-32"><a href="5.4-mod-05-poisson.html#cb1212-32" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1212-33"><a href="5.4-mod-05-poisson.html#cb1212-33" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb1212-34"><a href="5.4-mod-05-poisson.html#cb1212-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>xlat, dat<span class="sc">$</span>rich,</span>
<span id="cb1212-35"><a href="5.4-mod-05-poisson.html#cb1212-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Normal approx. 95% CI&quot;</span>,</span>
<span id="cb1212-36"><a href="5.4-mod-05-poisson.html#cb1212-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Absolute latitude (deg.)&quot;</span>,</span>
<span id="cb1212-37"><a href="5.4-mod-05-poisson.html#cb1212-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Species richness (R)&quot;</span>)</span>
<span id="cb1212-38"><a href="5.4-mod-05-poisson.html#cb1212-38" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, lo2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1212-39"><a href="5.4-mod-05-poisson.html#cb1212-39" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, up2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1212-40"><a href="5.4-mod-05-poisson.html#cb1212-40" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px, mn1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-500-1.png" width="864" /></p>
<p>The expected value <span class="math inline">\(\lambda\)</span> is the same for both uncertainty estimations. As expected, the PI is wider than the CI. Why is the CI so narrow? Remember that the SE is proportional to the inverse square root of the sample size (<span class="math inline">\(SE\left(x\right)=\sigma/\sqrt{n}\)</span>). The <em>n</em> of this model was very large, 2075 (try <code>nrow(dat)</code>). A model fit with smaller <em>n</em> would have a wider CI. We can see this for ourselves by refitting the model with fewer observations.</p>
<div class="sourceCode" id="cb1213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1213-1"><a href="5.4-mod-05-poisson.html#cb1213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of x values for CI</span></span>
<span id="cb1213-2"><a href="5.4-mod-05-poisson.html#cb1213-2" aria-hidden="true" tabindex="-1"></a>n.pred <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1213-3"><a href="5.4-mod-05-poisson.html#cb1213-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1213-4"><a href="5.4-mod-05-poisson.html#cb1213-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations in each simulation</span></span>
<span id="cb1213-5"><a href="5.4-mod-05-poisson.html#cb1213-5" aria-hidden="true" tabindex="-1"></a>use.n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span><span class="sc">*</span><span class="dv">10</span></span>
<span id="cb1213-6"><a href="5.4-mod-05-poisson.html#cb1213-6" aria-hidden="true" tabindex="-1"></a>n.sims <span class="ot">&lt;-</span> <span class="fu">length</span>(use.n)</span>
<span id="cb1213-7"><a href="5.4-mod-05-poisson.html#cb1213-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1213-8"><a href="5.4-mod-05-poisson.html#cb1213-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lists to hold data, models, and predicted values/CI</span></span>
<span id="cb1213-9"><a href="5.4-mod-05-poisson.html#cb1213-9" aria-hidden="true" tabindex="-1"></a>mod.list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, n.sims)</span>
<span id="cb1213-10"><a href="5.4-mod-05-poisson.html#cb1213-10" aria-hidden="true" tabindex="-1"></a>dat.list <span class="ot">&lt;-</span> mod.list</span>
<span id="cb1213-11"><a href="5.4-mod-05-poisson.html#cb1213-11" aria-hidden="true" tabindex="-1"></a>pred.list <span class="ot">&lt;-</span> mod.list</span>
<span id="cb1213-12"><a href="5.4-mod-05-poisson.html#cb1213-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1213-13"><a href="5.4-mod-05-poisson.html#cb1213-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models and calculate predictions in a loop</span></span>
<span id="cb1213-14"><a href="5.4-mod-05-poisson.html#cb1213-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sims){</span>
<span id="cb1213-15"><a href="5.4-mod-05-poisson.html#cb1213-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># randomly select rows from full dataset</span></span>
<span id="cb1213-16"><a href="5.4-mod-05-poisson.html#cb1213-16" aria-hidden="true" tabindex="-1"></a>    use.rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat), use.n[i])</span>
<span id="cb1213-17"><a href="5.4-mod-05-poisson.html#cb1213-17" aria-hidden="true" tabindex="-1"></a>    curr.d <span class="ot">&lt;-</span> dat[use.rows,]</span>
<span id="cb1213-18"><a href="5.4-mod-05-poisson.html#cb1213-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1213-19"><a href="5.4-mod-05-poisson.html#cb1213-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fit model to current subset of data</span></span>
<span id="cb1213-20"><a href="5.4-mod-05-poisson.html#cb1213-20" aria-hidden="true" tabindex="-1"></a>    curr.m <span class="ot">&lt;-</span> <span class="fu">glm</span>(rich<span class="sc">~</span>xlat, <span class="at">data=</span>curr.d, <span class="at">family=</span>poisson)</span>
<span id="cb1213-21"><a href="5.4-mod-05-poisson.html#cb1213-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1213-22"><a href="5.4-mod-05-poisson.html#cb1213-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate predictions on current model</span></span>
<span id="cb1213-23"><a href="5.4-mod-05-poisson.html#cb1213-23" aria-hidden="true" tabindex="-1"></a>    curr.px <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(curr.d<span class="sc">$</span>xlat), </span>
<span id="cb1213-24"><a href="5.4-mod-05-poisson.html#cb1213-24" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(curr.d<span class="sc">$</span>xlat),</span>
<span id="cb1213-25"><a href="5.4-mod-05-poisson.html#cb1213-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length=</span>n.pred)</span>
<span id="cb1213-26"><a href="5.4-mod-05-poisson.html#cb1213-26" aria-hidden="true" tabindex="-1"></a>    curr.pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(curr.m,</span>
<span id="cb1213-27"><a href="5.4-mod-05-poisson.html#cb1213-27" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">data.frame</span>(<span class="at">xlat=</span>px),</span>
<span id="cb1213-28"><a href="5.4-mod-05-poisson.html#cb1213-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">&quot;link&quot;</span>,</span>
<span id="cb1213-29"><a href="5.4-mod-05-poisson.html#cb1213-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb1213-30"><a href="5.4-mod-05-poisson.html#cb1213-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># store mean, upper, and lower conf. limits in a matrix</span></span>
<span id="cb1213-31"><a href="5.4-mod-05-poisson.html#cb1213-31" aria-hidden="true" tabindex="-1"></a>    curr.ci <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span>n.pred, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb1213-32"><a href="5.4-mod-05-poisson.html#cb1213-32" aria-hidden="true" tabindex="-1"></a>    curr.ci[,<span class="dv">1</span>] <span class="ot">&lt;-</span> curr.pr<span class="sc">$</span>fit</span>
<span id="cb1213-33"><a href="5.4-mod-05-poisson.html#cb1213-33" aria-hidden="true" tabindex="-1"></a>    curr.ci[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, curr.ci[,<span class="dv">1</span>], curr.pr<span class="sc">$</span>se.fit)</span>
<span id="cb1213-34"><a href="5.4-mod-05-poisson.html#cb1213-34" aria-hidden="true" tabindex="-1"></a>    curr.ci[,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, curr.ci[,<span class="dv">1</span>], curr.pr<span class="sc">$</span>se.fit)</span>
<span id="cb1213-35"><a href="5.4-mod-05-poisson.html#cb1213-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1213-36"><a href="5.4-mod-05-poisson.html#cb1213-36" aria-hidden="true" tabindex="-1"></a>    curr.ci[,<span class="dv">1</span>] <span class="ot">&lt;-</span> curr.m<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(curr.ci[,<span class="dv">1</span>])</span>
<span id="cb1213-37"><a href="5.4-mod-05-poisson.html#cb1213-37" aria-hidden="true" tabindex="-1"></a>    curr.ci[,<span class="dv">2</span>] <span class="ot">&lt;-</span> curr.m<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(curr.ci[,<span class="dv">2</span>])</span>
<span id="cb1213-38"><a href="5.4-mod-05-poisson.html#cb1213-38" aria-hidden="true" tabindex="-1"></a>    curr.ci[,<span class="dv">3</span>] <span class="ot">&lt;-</span> curr.m<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(curr.ci[,<span class="dv">3</span>])</span>
<span id="cb1213-39"><a href="5.4-mod-05-poisson.html#cb1213-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1213-40"><a href="5.4-mod-05-poisson.html#cb1213-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># save everything to the lists</span></span>
<span id="cb1213-41"><a href="5.4-mod-05-poisson.html#cb1213-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (note double brackets for accessing elements of a list)</span></span>
<span id="cb1213-42"><a href="5.4-mod-05-poisson.html#cb1213-42" aria-hidden="true" tabindex="-1"></a>    mod.list[[i]] <span class="ot">&lt;-</span> curr.m</span>
<span id="cb1213-43"><a href="5.4-mod-05-poisson.html#cb1213-43" aria-hidden="true" tabindex="-1"></a>    dat.list[[i]] <span class="ot">&lt;-</span> curr.d</span>
<span id="cb1213-44"><a href="5.4-mod-05-poisson.html#cb1213-44" aria-hidden="true" tabindex="-1"></a>    pred.list[[i]] <span class="ot">&lt;-</span> curr.ci   </span>
<span id="cb1213-45"><a href="5.4-mod-05-poisson.html#cb1213-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Inspect the outputs to see what the simulations did. Now let’s plot the predicted values and CI for the models fitted to subsets of the data.</p>
<div class="sourceCode" id="cb1214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1214-1"><a href="5.4-mod-05-poisson.html#cb1214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">5.1</span>),</span>
<span id="cb1214-2"><a href="5.4-mod-05-poisson.html#cb1214-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb1214-3"><a href="5.4-mod-05-poisson.html#cb1214-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb1214-4"><a href="5.4-mod-05-poisson.html#cb1214-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sims){</span>
<span id="cb1214-5"><a href="5.4-mod-05-poisson.html#cb1214-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(dat.list[[i]]<span class="sc">$</span>xlat, dat.list[[i]]<span class="sc">$</span>rich,</span>
<span id="cb1214-6"><a href="5.4-mod-05-poisson.html#cb1214-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>),</span>
<span id="cb1214-7"><a href="5.4-mod-05-poisson.html#cb1214-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;Abs. latitude&quot;</span>,</span>
<span id="cb1214-8"><a href="5.4-mod-05-poisson.html#cb1214-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">&quot;Species richness&quot;</span>)</span>
<span id="cb1214-9"><a href="5.4-mod-05-poisson.html#cb1214-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(px, pred.list[[i]][,<span class="dv">2</span>],</span>
<span id="cb1214-10"><a href="5.4-mod-05-poisson.html#cb1214-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1214-11"><a href="5.4-mod-05-poisson.html#cb1214-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(px, pred.list[[i]][,<span class="dv">3</span>],</span>
<span id="cb1214-12"><a href="5.4-mod-05-poisson.html#cb1214-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1214-13"><a href="5.4-mod-05-poisson.html#cb1214-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(px, pred.list[[i]][,<span class="dv">1</span>],</span>
<span id="cb1214-14"><a href="5.4-mod-05-poisson.html#cb1214-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb1214-15"><a href="5.4-mod-05-poisson.html#cb1214-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;n =&quot;</span>, use.n[i]), <span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb1214-16"><a href="5.4-mod-05-poisson.html#cb1214-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-502-1.png" width="864" /></p>
<p>The simulations show that the 95% CI of <span class="math inline">\(\lambda\)</span> narrows down very quickly as sample size increases from 10 to 60. No wonder we can’t even see the interval when the model is fit with 2075 observations!</p>
<p>Just as linear regression can be extended to multiple linear regression, Poisson regression can be extended with additional predictor variables. Remember how earlier we lumped the northern and southern hemispheres together by taking the absolute value of latitude? Let’s see if treating the hemispheres separately can improve the model fit.</p>
<p>First, make a factor that will identify the hemisphere of each observation.</p>
<div class="sourceCode" id="cb1215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1215-1"><a href="5.4-mod-05-poisson.html#cb1215-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>hemi <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>lat <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;south&quot;</span>, <span class="st">&quot;north&quot;</span>)</span></code></pre></div>
<p>Next, refit the model with the new variable. We’ll test whether latitude and hemisphere interact. In other words, we’ll see whether the relationship between latitude and species richness varies by hemisphere.</p>
<div class="sourceCode" id="cb1216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1216-1"><a href="5.4-mod-05-poisson.html#cb1216-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(rich<span class="sc">~</span>xlat<span class="sc">*</span>hemi, <span class="at">data=</span>dat, <span class="at">family=</span>poisson)</span>
<span id="cb1216-2"><a href="5.4-mod-05-poisson.html#cb1216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># check model terms:</span></span>
<span id="cb1216-3"><a href="5.4-mod-05-poisson.html#cb1216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = rich ~ xlat * hemi, family = poisson, data = dat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -10.4317   -1.5948   -0.0442    1.3691    9.5437  
## 
## Coefficients:
##                  Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)     5.3418617  0.0063816  837.073   &lt;2e-16 ***
## xlat           -0.0287144  0.0001573 -182.532   &lt;2e-16 ***
## hemisouth      -0.0163170  0.0085718   -1.904    0.057 .  
## xlat:hemisouth -0.0057775  0.0003667  -15.757   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 69333  on 2074  degrees of freedom
## Residual deviance: 10964  on 2071  degrees of freedom
## AIC: 23501
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Sure enough, the interaction appears significant. The coefficients tell us that in the baseline group (northern hemisphere), <span class="math inline">\(\log(R)\)</span> decreases by 0.0287 for every extra degree of latitude away from the equator. In the southern hemisphere, the effect is stronger: for every additional degree of latitude, <span class="math inline">\(\log(R)\)</span> decreases by <span class="math inline">\((-0.0287) + (-0.0058) = 0.0345\)</span>. The coefficient for the interaction <code>xlat:hemisouth</code> is the effect on the slope (<code>xlat</code>) of being in a group other than the baseline. The fact that the effect of <code>hemisouth</code> was nonsignificant just means that the intercept of the relationship for the southern hemisphere is not significantly different than the intercept of the relationship for the northern hemisphere (can you think of a biological reason why this should be the case?).</p>
<p>Did the additional term improve the model? Not much. Recall that the model without the interaction had a pseudo-<em>R</em><sup>2</sup> of about 0.832. Still, the new model appears to be an improvement because of its much smaller AIC.</p>
<div class="sourceCode" id="cb1218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1218-1"><a href="5.4-mod-05-poisson.html#cb1218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pseudo R squared:</span></span>
<span id="cb1218-2"><a href="5.4-mod-05-poisson.html#cb1218-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span>mod2<span class="sc">$</span>deviance<span class="sc">/</span>mod2<span class="sc">$</span>null.deviance</span></code></pre></div>
<pre><code>## [1] 0.8418692</code></pre>
<div class="sourceCode" id="cb1220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1220-1"><a href="5.4-mod-05-poisson.html#cb1220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1, mod2)</span></code></pre></div>
<pre><code>##      df      AIC
## mod1  2 24186.10
## mod2  4 23500.75</code></pre>
<p>We can confirm that model 2 is a better fit using a <strong>likelihood ratio test (LR test)</strong>. The easiest way is with function <code>lrtest()</code> in package <code>lmtest</code>. A LR test tests the null hypothesis that the ratio of the likelihood functions of two models is equal to 1 (or, that the natural log of this ratio is different than 0). LR tests can be used to compare GLMs that are nested: the more complicated model can be converted into the simpler model by constraining some of its parameters. In our example, model 2 can be converted into model 1 by setting the coefficients for hemisphere and latitude × hemisphere to 0. Thus, model 1 is nested within model 2. If models are not nested, then the LR test will not be valid.</p>
<div class="sourceCode" id="cb1222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1222-1"><a href="5.4-mod-05-poisson.html#cb1222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## 
## Attaching package: &#39;lmtest&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     ip</code></pre>
<div class="sourceCode" id="cb1228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1228-1"><a href="5.4-mod-05-poisson.html#cb1228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(mod1, mod2)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: rich ~ xlat
## Model 2: rich ~ xlat * hemi
##   #Df LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   2 -12091                         
## 2   4 -11746  2 689.35  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The fact that the LR test was significant shows that the fit of model 2 is significantly better than that of model 1, after penalizing for the number of parameters.</p>
<p>As always, let’s calculate the model predictions and present them with the original data. We’ll skip presenting the 95% CI, because it was so small in the previous example and won’t tell us much. In the code below we need to define predictor variables in the range actually seen for each factor.</p>
<div class="sourceCode" id="cb1230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1230-1"><a href="5.4-mod-05-poisson.html#cb1230-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1230-2"><a href="5.4-mod-05-poisson.html#cb1230-2" aria-hidden="true" tabindex="-1"></a>flag <span class="ot">&lt;-</span> <span class="fu">which</span>(dat<span class="sc">$</span>hemi<span class="sc">==</span><span class="st">&quot;south&quot;</span>)</span>
<span id="cb1230-3"><a href="5.4-mod-05-poisson.html#cb1230-3" aria-hidden="true" tabindex="-1"></a>px1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1230-4"><a href="5.4-mod-05-poisson.html#cb1230-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">hemi=</span><span class="st">&quot;south&quot;</span>,</span>
<span id="cb1230-5"><a href="5.4-mod-05-poisson.html#cb1230-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlat=</span><span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>xlat[flag]),</span>
<span id="cb1230-6"><a href="5.4-mod-05-poisson.html#cb1230-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(dat<span class="sc">$</span>xlat[flag]), <span class="at">length=</span>n))</span>
<span id="cb1230-7"><a href="5.4-mod-05-poisson.html#cb1230-7" aria-hidden="true" tabindex="-1"></a>px2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1230-8"><a href="5.4-mod-05-poisson.html#cb1230-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hemi=</span><span class="st">&quot;north&quot;</span>,</span>
<span id="cb1230-9"><a href="5.4-mod-05-poisson.html#cb1230-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlat=</span><span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>xlat[<span class="sc">-</span>flag]),</span>
<span id="cb1230-10"><a href="5.4-mod-05-poisson.html#cb1230-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(dat<span class="sc">$</span>xlat[<span class="sc">-</span>flag]), <span class="at">length=</span>n))</span>
<span id="cb1230-11"><a href="5.4-mod-05-poisson.html#cb1230-11" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">rbind</span>(px1, px2)</span>
<span id="cb1230-12"><a href="5.4-mod-05-poisson.html#cb1230-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1230-13"><a href="5.4-mod-05-poisson.html#cb1230-13" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, </span>
<span id="cb1230-14"><a href="5.4-mod-05-poisson.html#cb1230-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">newdata=</span><span class="fu">data.frame</span>(dx),</span>
<span id="cb1230-15"><a href="5.4-mod-05-poisson.html#cb1230-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">&quot;link&quot;</span>)</span>
<span id="cb1230-16"><a href="5.4-mod-05-poisson.html#cb1230-16" aria-hidden="true" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> mod2<span class="sc">$</span>family<span class="sc">$</span><span class="fu">linkinv</span>(pred2)</span>
<span id="cb1230-17"><a href="5.4-mod-05-poisson.html#cb1230-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1230-18"><a href="5.4-mod-05-poisson.html#cb1230-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>,</span>
<span id="cb1230-19"><a href="5.4-mod-05-poisson.html#cb1230-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1230-20"><a href="5.4-mod-05-poisson.html#cb1230-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb1230-21"><a href="5.4-mod-05-poisson.html#cb1230-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>xlat, dat<span class="sc">$</span>rich, <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb1230-22"><a href="5.4-mod-05-poisson.html#cb1230-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">ifelse</span>(dat<span class="sc">$</span>hemi <span class="sc">==</span> <span class="st">&quot;south&quot;</span>, <span class="st">&quot;#FF000020&quot;</span>, <span class="st">&quot;#0000FF20&quot;</span>),</span>
<span id="cb1230-23"><a href="5.4-mod-05-poisson.html#cb1230-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Absolute latitude (deg.)&quot;</span>,</span>
<span id="cb1230-24"><a href="5.4-mod-05-poisson.html#cb1230-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Species richness (R)&quot;</span>)</span>
<span id="cb1230-25"><a href="5.4-mod-05-poisson.html#cb1230-25" aria-hidden="true" tabindex="-1"></a>flag1 <span class="ot">&lt;-</span> <span class="fu">which</span>(dx<span class="sc">$</span>hemi <span class="sc">==</span> <span class="st">&quot;south&quot;</span>)</span>
<span id="cb1230-26"><a href="5.4-mod-05-poisson.html#cb1230-26" aria-hidden="true" tabindex="-1"></a>flag2 <span class="ot">&lt;-</span> <span class="fu">which</span>(dx<span class="sc">$</span>hemi <span class="sc">!=</span> <span class="st">&quot;south&quot;</span>)</span>
<span id="cb1230-27"><a href="5.4-mod-05-poisson.html#cb1230-27" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px1<span class="sc">$</span>xlat, mn2[flag1], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb1230-28"><a href="5.4-mod-05-poisson.html#cb1230-28" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(px2<span class="sc">$</span>xlat, mn2[flag2], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb1230-29"><a href="5.4-mod-05-poisson.html#cb1230-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb1230-30"><a href="5.4-mod-05-poisson.html#cb1230-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Northern hemisphere&quot;</span>, <span class="st">&quot;Southern hemisphere&quot;</span>),</span>
<span id="cb1230-31"><a href="5.4-mod-05-poisson.html#cb1230-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-507-1.png" width="576" /></p>
<p>The figure below above that species richness falls off with distance from the equator slightly faster in the southern hemisphere than in the northern hemisphere.</p>
</div>
</div>
<h3>Literature Cited</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-faurby2018" class="csl-entry">
Faurby, S., M. Davis, R. Ø. Pedersen, S. D. Schowanek, A. Antonelli, and J.-C. Svenning. 2018. <a href="https://doi.org/10.1002/ecy.2443"><span>PHYLACINE</span> 1.2: The phylogenetic atlas of mammal macroecology</a>. Ecology 99:2626.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="5.3-mod-05-loglin.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="5.5-mod-05-quasi.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
