<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.4 Nonlinear mixed models (NLME) | Applied Biological Data Analysis</title>
  <meta name="description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7.4 Nonlinear mixed models (NLME) | Applied Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://greenquanteco.github.io/index.html" />
  <meta property="og:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />
  <meta property="og:description" content="Helping biologists to become more informed users of R and statistical methods." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.4 Nonlinear mixed models (NLME) | Applied Biological Data Analysis" />
  
  <meta name="twitter:description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="twitter:image" content="https://greenquanteco.github.io/index.html/C:/Users/ngreen62/OneDrive - Kennesaw State University/ksu/website/lab_logo_02.jpg" />

<meta name="author" content="Nick Green, Kennesaw State University" />


<meta name="date" content="2022-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="7.3-mod-07-glmm.html"/>
<link rel="next" href="7.5-mod-07-gamm.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="license-and-permissions.html"><a href="license-and-permissions.html"><i class="fa fa-check"></i>License and permissions</a></li>
<li class="chapter" data-level="" data-path="course-description.html"><a href="course-description.html"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="course-objectives.html"><a href="course-objectives.html"><i class="fa fa-check"></i>Course objectives</a></li>
<li class="chapter" data-level="" data-path="course-requirements.html"><a href="course-requirements.html"><i class="fa fa-check"></i>Course requirements</a></li>
<li class="chapter" data-level="" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i>Recommended reading</a></li>
<li class="chapter" data-level="" data-path="course-organization.html"><a href="course-organization.html"><i class="fa fa-check"></i>Course organization</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-mod-01.html"><a href="1-mod-01.html"><i class="fa fa-check"></i><b>1</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-overview.html"><a href="1.1-overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html"><i class="fa fa-check"></i><b>1.2</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html#the-scientific-method"><i class="fa fa-check"></i><b>1.2.1</b> The scientific method</a></li>
<li class="chapter" data-level="1.2.2" data-path="1.2-statistics-in-modern-biology.html"><a href="1.2-statistics-in-modern-biology.html#example-data-analysis"><i class="fa fa-check"></i><b>1.2.2</b> Example data analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html"><i class="fa fa-check"></i><b>1.3</b> Misuses of statistics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#proving-the-trivial-and-meaningless-hypotheses"><i class="fa fa-check"></i><b>1.3.1</b> “Proving” the trivial and meaningless hypotheses</a></li>
<li class="chapter" data-level="1.3.2" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#inappropriate-methods"><i class="fa fa-check"></i><b>1.3.2</b> Inappropriate methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#p-hacking-and-data-dredging"><i class="fa fa-check"></i><b>1.3.3</b> <em>P</em>-hacking and data dredging</a></li>
<li class="chapter" data-level="1.3.4" data-path="1.3-misuses-of-statistics.html"><a href="1.3-misuses-of-statistics.html#inadequate-sample-sizes-and-pseudoreplication"><i class="fa fa-check"></i><b>1.3.4</b> Inadequate sample sizes and pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><i class="fa fa-check"></i><b>1.4</b> <em>P</em>-values and null hypothesis significance testing (NHST)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#definition"><i class="fa fa-check"></i><b>1.4.1</b> Definition</a></li>
<li class="chapter" data-level="1.4.2" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#history-and-status-of-p-values"><i class="fa fa-check"></i><b>1.4.2</b> History and status of <em>P</em>-values</a></li>
<li class="chapter" data-level="1.4.3" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#where-p-values-come-from"><i class="fa fa-check"></i><b>1.4.3</b> Where <em>P</em>-values come from</a></li>
<li class="chapter" data-level="1.4.4" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#what-p-values-mean-and-do-not-mean"><i class="fa fa-check"></i><b>1.4.4</b> What <em>P</em>-values mean and do not mean</a></li>
<li class="chapter" data-level="1.4.5" data-path="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html"><a href="1.4-p-values-and-null-hypothesis-significance-testing-nhst.html#do-you-need-a-p-value"><i class="fa fa-check"></i><b>1.4.5</b> Do you need a <em>P</em>-value?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html"><i class="fa fa-check"></i><b>1.5</b> Alternatives to NHST</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.1</b> Bayesian inference</a></li>
<li class="chapter" data-level="1.5.2" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#information-theoretic-methods"><i class="fa fa-check"></i><b>1.5.2</b> Information-theoretic methods</a></li>
<li class="chapter" data-level="1.5.3" data-path="1.5-alternatives-to-nhst.html"><a href="1.5-alternatives-to-nhst.html#machine-learning"><i class="fa fa-check"></i><b>1.5.3</b> Machine learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-mod-02.html"><a href="2-mod-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html"><i class="fa fa-check"></i><b>2.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#advantages-of-r"><i class="fa fa-check"></i><b>2.1.2</b> Advantages of R</a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#disadvantages-of-r"><i class="fa fa-check"></i><b>2.1.3</b> Disadvantages of R</a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-getting-started-with-r.html"><a href="2.1-getting-started-with-r.html#base-r-and-vs.-tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Base R and (vs.?) <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-download-and-install-r-and-rstudio.html"><a href="2.2-download-and-install-r-and-rstudio.html"><i class="fa fa-check"></i><b>2.2</b> Download and install R (and RStudio)</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-using-r.html"><a href="2.3-using-r.html"><i class="fa fa-check"></i><b>2.3</b> Using R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-the-base-r-gui"><i class="fa fa-check"></i><b>2.3.1</b> Using the base R GUI</a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-r-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Using R in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="2.3-using-r.html"><a href="2.3-using-r.html#using-r-with-other-programs"><i class="fa fa-check"></i><b>2.3.3</b> Using R with other programs</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html"><i class="fa fa-check"></i><b>2.4</b> A first R session</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#import-data"><i class="fa fa-check"></i><b>2.4.1</b> Import data</a></li>
<li class="chapter" data-level="2.4.2" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#explore-and-visualize-data"><i class="fa fa-check"></i><b>2.4.2</b> Explore and visualize data</a></li>
<li class="chapter" data-level="2.4.3" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#transform-data"><i class="fa fa-check"></i><b>2.4.3</b> Transform data</a></li>
<li class="chapter" data-level="2.4.4" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#analyze-data"><i class="fa fa-check"></i><b>2.4.4</b> Analyze data</a></li>
<li class="chapter" data-level="2.4.5" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#write-out-results"><i class="fa fa-check"></i><b>2.4.5</b> Write out results</a></li>
<li class="chapter" data-level="2.4.6" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#save-your-work"><i class="fa fa-check"></i><b>2.4.6</b> Save your work?</a></li>
<li class="chapter" data-level="2.4.7" data-path="2.4-mod-02-first.html"><a href="2.4-mod-02-first.html#whats-next"><i class="fa fa-check"></i><b>2.4.7</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html"><i class="fa fa-check"></i><b>2.5</b> Write and execute commands in the R console</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#r-commandsbasics"><i class="fa fa-check"></i><b>2.5.1</b> R commands–basics</a></li>
<li class="chapter" data-level="2.5.2" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#elements-of-r-code"><i class="fa fa-check"></i><b>2.5.2</b> Elements of R code</a></li>
<li class="chapter" data-level="2.5.3" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#the-r-workspace"><i class="fa fa-check"></i><b>2.5.3</b> The R workspace</a></li>
<li class="chapter" data-level="2.5.4" data-path="2.5-write-and-execute-commands-in-the-r-console.html"><a href="2.5-write-and-execute-commands-in-the-r-console.html#r-code-basics-assignment-and-operators"><i class="fa fa-check"></i><b>2.5.4</b> R code basics: assignment and operators</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html"><i class="fa fa-check"></i><b>2.6</b> Basic R data structures</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#data-frames"><i class="fa fa-check"></i><b>2.6.2</b> Data frames</a></li>
<li class="chapter" data-level="2.6.3" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.6.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.6.4" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#lists"><i class="fa fa-check"></i><b>2.6.4</b> Lists</a></li>
<li class="chapter" data-level="2.6.5" data-path="2.6-mod-02-struct.html"><a href="2.6-mod-02-struct.html#s4-objects"><i class="fa fa-check"></i><b>2.6.5</b> S4 objects</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html"><i class="fa fa-check"></i><b>2.7</b> R data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#character-type"><i class="fa fa-check"></i><b>2.7.1</b> Character type</a></li>
<li class="chapter" data-level="2.7.2" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#numeric-type"><i class="fa fa-check"></i><b>2.7.2</b> Numeric type</a></li>
<li class="chapter" data-level="2.7.3" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#integer-type"><i class="fa fa-check"></i><b>2.7.3</b> Integer type</a></li>
<li class="chapter" data-level="2.7.4" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#logical-type"><i class="fa fa-check"></i><b>2.7.4</b> Logical type</a></li>
<li class="chapter" data-level="2.7.5" data-path="2.7-r-data-types.html"><a href="2.7-r-data-types.html#special-values"><i class="fa fa-check"></i><b>2.7.5</b> Special values</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2.8-manage-r-code-as-scripts-.r-files.html"><a href="2.8-manage-r-code-as-scripts-.r-files.html"><i class="fa fa-check"></i><b>2.8</b> Manage R code as scripts (.r files)</a></li>
<li class="chapter" data-level="2.9" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html"><i class="fa fa-check"></i><b>2.9</b> Manage and use R packages</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#your-r-library"><i class="fa fa-check"></i><b>2.9.1</b> Your R library</a></li>
<li class="chapter" data-level="2.9.2" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-using-the-r-gui"><i class="fa fa-check"></i><b>2.9.2</b> Installing packages using the R GUI</a></li>
<li class="chapter" data-level="2.9.3" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-in-rstudio"><i class="fa fa-check"></i><b>2.9.3</b> Installing packages in RStudio</a></li>
<li class="chapter" data-level="2.9.4" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#installing-packages-using-the-r-console"><i class="fa fa-check"></i><b>2.9.4</b> Installing packages using the R console</a></li>
<li class="chapter" data-level="2.9.5" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#working-with-packages-in-r"><i class="fa fa-check"></i><b>2.9.5</b> Working with packages in R</a></li>
<li class="chapter" data-level="2.9.6" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#package-dependencies"><i class="fa fa-check"></i><b>2.9.6</b> Package dependencies</a></li>
<li class="chapter" data-level="2.9.7" data-path="2.9-manage-and-use-r-packages.html"><a href="2.9-manage-and-use-r-packages.html#citing-packages"><i class="fa fa-check"></i><b>2.9.7</b> Citing packages</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html"><i class="fa fa-check"></i><b>2.10</b> R documentation</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#documentation-help-files"><i class="fa fa-check"></i><b>2.10.1</b> Documentation (help) files</a></li>
<li class="chapter" data-level="2.10.2" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#r-vignettes"><i class="fa fa-check"></i><b>2.10.2</b> R vignettes</a></li>
<li class="chapter" data-level="2.10.3" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#official-r-project-resources"><i class="fa fa-check"></i><b>2.10.3</b> Official R Project resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#unofficial-online-resources"><i class="fa fa-check"></i><b>2.10.4</b> Unofficial online resources</a></li>
<li class="chapter" data-level="2.10.5" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#r-books"><i class="fa fa-check"></i><b>2.10.5</b> R books</a></li>
<li class="chapter" data-level="2.10.6" data-path="2.10-r-documentation.html"><a href="2.10-r-documentation.html#two-reminders"><i class="fa fa-check"></i><b>2.10.6</b> Two reminders</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-mod-03.html"><a href="3-mod-03.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html"><i class="fa fa-check"></i><b>3.1</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-preliminaries"><i class="fa fa-check"></i><b>3.1.1</b> Importing data: preliminaries</a></li>
<li class="chapter" data-level="3.1.2" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-from-text-files-with-read.csv-and-read.table"><i class="fa fa-check"></i><b>3.1.2</b> Importing data from text files with <code>read.csv()</code> and <code>read.table()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-from-saved-workspaces"><i class="fa fa-check"></i><b>3.1.3</b> Importing data from saved workspaces</a></li>
<li class="chapter" data-level="3.1.4" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#importing-data-special-cases"><i class="fa fa-check"></i><b>3.1.4</b> Importing data: special cases:</a></li>
<li class="chapter" data-level="3.1.5" data-path="3.1-mod-03-inout.html"><a href="3.1-mod-03-inout.html#export-data-from-r"><i class="fa fa-check"></i><b>3.1.5</b> Export data from R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html"><i class="fa fa-check"></i><b>3.2</b> Making values in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#producing-arbitrary-values-with-c"><i class="fa fa-check"></i><b>3.2.1</b> Producing arbitrary values with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#generating-regular-values"><i class="fa fa-check"></i><b>3.2.2</b> Generating regular values</a></li>
<li class="chapter" data-level="3.2.3" data-path="3.2-making-values-in-r.html"><a href="3.2-making-values-in-r.html#generating-random-values"><i class="fa fa-check"></i><b>3.2.3</b> Generating random values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html"><i class="fa fa-check"></i><b>3.3</b> Selecting data with <code>[]</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html#mod-03-brackets"><i class="fa fa-check"></i><b>3.3.1</b> Basics of brackets</a></li>
<li class="chapter" data-level="3.3.2" data-path="3.3-selecting-data-with.html"><a href="3.3-selecting-data-with.html#extracting-and-selecting-data-with-logical-tests"><i class="fa fa-check"></i><b>3.3.2</b> Extracting and selecting data with logical tests</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html"><i class="fa fa-check"></i><b>3.4</b> Managing dates and characters</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html#temporal-data-and-dates"><i class="fa fa-check"></i><b>3.4.1</b> Temporal data and dates</a></li>
<li class="chapter" data-level="3.4.2" data-path="3.4-managing-dates-and-characters.html"><a href="3.4-managing-dates-and-characters.html#character-data-text"><i class="fa fa-check"></i><b>3.4.2</b> Character data (text)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html"><i class="fa fa-check"></i><b>3.5</b> Data frame management</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#data-frame-structure"><i class="fa fa-check"></i><b>3.5.1</b> Data frame structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#common-data-frame-operations"><i class="fa fa-check"></i><b>3.5.2</b> Common data frame operations</a></li>
<li class="chapter" data-level="3.5.3" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#other-data-frame-operations"><i class="fa fa-check"></i><b>3.5.3</b> Other data frame operations</a></li>
<li class="chapter" data-level="3.5.4" data-path="3.5-mod-03-dataframe.html"><a href="3.5-mod-03-dataframe.html#mod-03-reshape"><i class="fa fa-check"></i><b>3.5.4</b> Reshaping data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-mod-04.html"><a href="4-mod-04.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html"><i class="fa fa-check"></i><b>4.1</b> Descriptive and summary statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#basic-summary-statistics"><i class="fa fa-check"></i><b>4.1.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="4.1.2" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#summarizing-data-with-the-apply-family"><i class="fa fa-check"></i><b>4.1.2</b> Summarizing data with the <code>apply()</code> family</a></li>
<li class="chapter" data-level="4.1.3" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#mod-04-tabagg"><i class="fa fa-check"></i><b>4.1.3</b> Tabulation and aggregation</a></li>
<li class="chapter" data-level="4.1.4" data-path="4.1-descriptive-and-summary-statistics.html"><a href="4.1-descriptive-and-summary-statistics.html#aggregation-aka-pivot-tables"><i class="fa fa-check"></i><b>4.1.4</b> Aggregation (aka: pivot tables)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html"><i class="fa fa-check"></i><b>4.2</b> Visualizing data distributions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#boxplots-aka-box-and-whisker-plots"><i class="fa fa-check"></i><b>4.2.1</b> Boxplots (aka: box-and-whisker plots)</a></li>
<li class="chapter" data-level="4.2.2" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#histograms"><i class="fa fa-check"></i><b>4.2.2</b> Histograms</a></li>
<li class="chapter" data-level="4.2.3" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#kernel-density-plots"><i class="fa fa-check"></i><b>4.2.3</b> Kernel density plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#empirical-cumulative-distribution-plots-ecdf"><i class="fa fa-check"></i><b>4.2.4</b> Empirical cumulative distribution plots (ECDF)</a></li>
<li class="chapter" data-level="4.2.5" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#quantile-quantile-qq-plots"><i class="fa fa-check"></i><b>4.2.5</b> Quantile-quantile (QQ) plots</a></li>
<li class="chapter" data-level="4.2.6" data-path="4.2-mod-04-vis.html"><a href="4.2-mod-04-vis.html#how-should-i-plot-my-data"><i class="fa fa-check"></i><b>4.2.6</b> How should I plot my data?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html"><i class="fa fa-check"></i><b>4.3</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#probability-distributions"><i class="fa fa-check"></i><b>4.3.1</b> Probability distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>4.3.2</b> Probability distributions in R</a></li>
<li class="chapter" data-level="4.3.3" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#discrete-distributions"><i class="fa fa-check"></i><b>4.3.3</b> Discrete distributions</a></li>
<li class="chapter" data-level="4.3.4" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#continuous-distributions"><i class="fa fa-check"></i><b>4.3.4</b> Continuous distributions</a></li>
<li class="chapter" data-level="4.3.5" data-path="4.3-mod-04-dists1.html"><a href="4.3-mod-04-dists1.html#distributions-summary"><i class="fa fa-check"></i><b>4.3.5</b> Distributions summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html"><i class="fa fa-check"></i><b>4.4</b> Fitting and testing distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#estimating-distributional-parameters"><i class="fa fa-check"></i><b>4.4.1</b> Estimating distributional parameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#graphical-methods-for-examining-distributions"><i class="fa fa-check"></i><b>4.4.2</b> Graphical methods for examining distributions</a></li>
<li class="chapter" data-level="4.4.3" data-path="4.4-mod-04-dists2.html"><a href="4.4-mod-04-dists2.html#formal-tests-for-distributions"><i class="fa fa-check"></i><b>4.4.3</b> Formal tests for distributions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html"><i class="fa fa-check"></i><b>4.5</b> Data transformations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#why-transform"><i class="fa fa-check"></i><b>4.5.1</b> Why transform?</a></li>
<li class="chapter" data-level="4.5.2" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#transforms-vs.-link-functions"><i class="fa fa-check"></i><b>4.5.2</b> Transforms vs. link functions</a></li>
<li class="chapter" data-level="4.5.3" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#log-transformation"><i class="fa fa-check"></i><b>4.5.3</b> Log transformation</a></li>
<li class="chapter" data-level="4.5.4" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#rank-transformation"><i class="fa fa-check"></i><b>4.5.4</b> Rank transformation</a></li>
<li class="chapter" data-level="4.5.5" data-path="4.5-mod-04-trans.html"><a href="4.5-mod-04-trans.html#other-transforms-less-common"><i class="fa fa-check"></i><b>4.5.5</b> Other transforms (less common)</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html"><i class="fa fa-check"></i><b>4.6</b> Multivariate data exploration</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#scatterplots-for-two-variables"><i class="fa fa-check"></i><b>4.6.1</b> Scatterplots for two variables</a></li>
<li class="chapter" data-level="4.6.2" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#mod-04-smat"><i class="fa fa-check"></i><b>4.6.2</b> Scatterplot matrices for many variables</a></li>
<li class="chapter" data-level="4.6.3" data-path="4.6-multivariate-data-exploration.html"><a href="4.6-multivariate-data-exploration.html#lattice-plots-for-hierarchical-data"><i class="fa fa-check"></i><b>4.6.3</b> Lattice plots for hierarchical data</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html"><i class="fa fa-check"></i><b>4.7</b> Ordination (brief introduction)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>4.7.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="4.7.2" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#nonmetric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>4.7.2</b> Nonmetric multidimensional scaling (NMDS)</a></li>
<li class="chapter" data-level="4.7.3" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#plotting-ordinations"><i class="fa fa-check"></i><b>4.7.3</b> Plotting ordinations</a></li>
<li class="chapter" data-level="4.7.4" data-path="4.7-ordination-brief-introduction.html"><a href="4.7-ordination-brief-introduction.html#ordination-wrap-up-for-now"><i class="fa fa-check"></i><b>4.7.4</b> Ordination wrap-up (for now)</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html"><i class="fa fa-check"></i><b>4.8</b> Common statistical problems</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#outliers-and-erroneous-values"><i class="fa fa-check"></i><b>4.8.1</b> Outliers and erroneous values</a></li>
<li class="chapter" data-level="4.8.2" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#autocorrelation"><i class="fa fa-check"></i><b>4.8.2</b> Autocorrelation</a></li>
<li class="chapter" data-level="4.8.3" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#mod-04-multicol"><i class="fa fa-check"></i><b>4.8.3</b> Collinearity</a></li>
<li class="chapter" data-level="4.8.4" data-path="4.8-mod-04-prob.html"><a href="4.8-mod-04-prob.html#missing-data"><i class="fa fa-check"></i><b>4.8.4</b> Missing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-mod-05.html"><a href="5-mod-05.html"><i class="fa fa-check"></i><b>5</b> Generalized linear models (GLM)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html"><i class="fa fa-check"></i><b>5.1</b> Prelude with linear models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#assumptions-of-linear-models"><i class="fa fa-check"></i><b>5.1.1</b> Assumptions of linear models</a></li>
<li class="chapter" data-level="5.1.2" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#linear-regression-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Linear regression in R</a></li>
<li class="chapter" data-level="5.1.3" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="5.1.4" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#mod-05-anova"><i class="fa fa-check"></i><b>5.1.4</b> ANOVA and ANCOVA with <code>lm()</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#variations-on-linear-models"><i class="fa fa-check"></i><b>5.1.5</b> Variations on linear models</a></li>
<li class="chapter" data-level="5.1.6" data-path="5.1-mod-05-lm.html"><a href="5.1-mod-05-lm.html#example-linear-regression-workflow"><i class="fa fa-check"></i><b>5.1.6</b> Example linear regression workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html"><i class="fa fa-check"></i><b>5.2</b> GLM basics</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#example-glms"><i class="fa fa-check"></i><b>5.2.1</b> Example GLMS</a></li>
<li class="chapter" data-level="5.2.2" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#glm-families"><i class="fa fa-check"></i><b>5.2.2</b> GLM families</a></li>
<li class="chapter" data-level="5.2.3" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#glm-link-functions"><i class="fa fa-check"></i><b>5.2.3</b> GLM link functions</a></li>
<li class="chapter" data-level="5.2.4" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#deviance-and-other-glm-diagnostics"><i class="fa fa-check"></i><b>5.2.4</b> Deviance and other GLM diagnostics</a></li>
<li class="chapter" data-level="5.2.5" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#to-pseudo-r2-or-not-to-pseudo-r2"><i class="fa fa-check"></i><b>5.2.5</b> To pseudo-<em>R</em><sup>2</sup> or not to pseudo-<em>R</em><sup>2</sup>?</a></li>
<li class="chapter" data-level="5.2.6" data-path="5.2-mod-05-basic.html"><a href="5.2-mod-05-basic.html#common-glms"><i class="fa fa-check"></i><b>5.2.6</b> Common GLMs</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html"><i class="fa fa-check"></i><b>5.3</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html#mod-05-loglin-examp"><i class="fa fa-check"></i><b>5.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.3.2" data-path="5.3-mod-05-loglin.html"><a href="5.3-mod-05-loglin.html#example-with-real-data"><i class="fa fa-check"></i><b>5.3.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html"><i class="fa fa-check"></i><b>5.4</b> Poisson GLM for counts</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html#example-with-simulated-data"><i class="fa fa-check"></i><b>5.4.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.4.2" data-path="5.4-mod-05-poisson.html"><a href="5.4-mod-05-poisson.html#example-with-real-data-1"><i class="fa fa-check"></i><b>5.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html"><i class="fa fa-check"></i><b>5.5</b> Quasi-Poisson and negative binomial GLM</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html#example-with-simulated-data-1"><i class="fa fa-check"></i><b>5.5.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.5.2" data-path="5.5-mod-05-quasi.html"><a href="5.5-mod-05-quasi.html#example-with-real-data-2"><i class="fa fa-check"></i><b>5.5.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html"><i class="fa fa-check"></i><b>5.6</b> Logistic regression for binary outcomes</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#example-with-simulated-data-2"><i class="fa fa-check"></i><b>5.6.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="5.6.2" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#example-with-real-data-3"><i class="fa fa-check"></i><b>5.6.2</b> Example with real data</a></li>
<li class="chapter" data-level="5.6.3" data-path="5.6-mod-05-logistic.html"><a href="5.6-mod-05-logistic.html#mod-05-auc"><i class="fa fa-check"></i><b>5.6.3</b> Logistic GLM diagnostics: AUC and ROC</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html"><i class="fa fa-check"></i><b>5.7</b> Binomial GLM for proportional data</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html#binomial-glm"><i class="fa fa-check"></i><b>5.7.1</b> Binomial GLM</a></li>
<li class="chapter" data-level="5.7.2" data-path="5.7-mod-05-binom.html"><a href="5.7-mod-05-binom.html#example-with-simulated-data-3"><i class="fa fa-check"></i><b>5.7.2</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="5.8-mod-05-gamma.html"><a href="5.8-mod-05-gamma.html"><i class="fa fa-check"></i><b>5.8</b> Gamma models for overdispersed data</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="5.8-mod-05-gamma.html"><a href="5.8-mod-05-gamma.html#example-with-simulated-data-4"><i class="fa fa-check"></i><b>5.8.1</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html"><i class="fa fa-check"></i><b>5.9</b> Beyond GLM: Overview of GAM and GEE</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html#mod-05-gam"><i class="fa fa-check"></i><b>5.9.1</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="5.9.2" data-path="5.9-mod-05-beyond.html"><a href="5.9-mod-05-beyond.html#mod-05-gee"><i class="fa fa-check"></i><b>5.9.2</b> Generalized estimating equations (GEE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-mod-06.html"><a href="6-mod-06.html"><i class="fa fa-check"></i><b>6</b> Nonlinear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-background.html"><a href="6.1-background.html"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-mod-06-intro.html"><a href="6.2-mod-06-intro.html"><i class="fa fa-check"></i><b>6.2</b> Nonlinear least squares (NLS)</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html"><i class="fa fa-check"></i><b>6.3</b> Michaelis-Menten curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#mod-06-micmen-sim"><i class="fa fa-check"></i><b>6.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="6.3.2" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#example-with-real-data-4"><i class="fa fa-check"></i><b>6.3.2</b> Example with real data</a></li>
<li class="chapter" data-level="6.3.3" data-path="6.3-mod-06-micmen.html"><a href="6.3-mod-06-micmen.html#alternative-strategies-for-the-analysis"><i class="fa fa-check"></i><b>6.3.3</b> Alternative strategies for the analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html"><i class="fa fa-check"></i><b>6.4</b> Biological growth curves</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html#gompertz-and-von-bertalanffy-curves"><i class="fa fa-check"></i><b>6.4.1</b> Gompertz and von Bertalanffy curves</a></li>
<li class="chapter" data-level="6.4.2" data-path="6.4-mod-06-grow.html"><a href="6.4-mod-06-grow.html#example-with-real-data-5"><i class="fa fa-check"></i><b>6.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6.5-dose-response-curves.html"><a href="6.5-dose-response-curves.html"><i class="fa fa-check"></i><b>6.5</b> Dose response curves</a></li>
<li class="chapter" data-level="6.6" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html"><i class="fa fa-check"></i><b>6.6</b> Alternatives to NLS</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#generalized-nonlinear-models"><i class="fa fa-check"></i><b>6.6.1</b> Generalized nonlinear models</a></li>
<li class="chapter" data-level="6.6.2" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#quantile-regression"><i class="fa fa-check"></i><b>6.6.2</b> Quantile regression</a></li>
<li class="chapter" data-level="6.6.3" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#mod-06-gam"><i class="fa fa-check"></i><b>6.6.3</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="6.6.4" data-path="6.6-alternatives-to-nls.html"><a href="6.6-alternatives-to-nls.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>6.6.4</b> Classification and regression trees (CART)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-mod-07.html"><a href="7-mod-07.html"><i class="fa fa-check"></i><b>7</b> Mixed models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-prelude-glm.html"><a href="7.1-prelude-glm.html"><i class="fa fa-check"></i><b>7.1</b> Prelude (GLM)</a></li>
<li class="chapter" data-level="7.2" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html"><i class="fa fa-check"></i><b>7.2</b> Linear mixed models (LMM)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#formal-definition-and-example"><i class="fa fa-check"></i><b>7.2.1</b> Formal definition and example</a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#example-with-simulated-data-5"><i class="fa fa-check"></i><b>7.2.2</b> Example with simulated data</a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#p-values-in-lmm"><i class="fa fa-check"></i><b>7.2.3</b> <em>P</em>-values in LMM</a></li>
<li class="chapter" data-level="7.2.4" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#specifying-random-effects"><i class="fa fa-check"></i><b>7.2.4</b> Specifying random effects</a></li>
<li class="chapter" data-level="7.2.5" data-path="7.2-mod-07-lmm.html"><a href="7.2-mod-07-lmm.html#lmm-example-with-real-data"><i class="fa fa-check"></i><b>7.2.5</b> LMM example with real data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html"><i class="fa fa-check"></i><b>7.3</b> Generalized linear mixed models (GLMM)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#definition-1"><i class="fa fa-check"></i><b>7.3.1</b> Definition</a></li>
<li class="chapter" data-level="7.3.2" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#glmm-on-simulated-data"><i class="fa fa-check"></i><b>7.3.2</b> GLMM on simulated data</a></li>
<li class="chapter" data-level="7.3.3" data-path="7.3-mod-07-glmm.html"><a href="7.3-mod-07-glmm.html#glmm-on-real-data"><i class="fa fa-check"></i><b>7.3.3</b> GLMM on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html"><i class="fa fa-check"></i><b>7.4</b> Nonlinear mixed models (NLME)</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#definition-and-background"><i class="fa fa-check"></i><b>7.4.1</b> Definition and background</a></li>
<li class="chapter" data-level="7.4.2" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#nlme-on-simulated-data"><i class="fa fa-check"></i><b>7.4.2</b> NLME on simulated data</a></li>
<li class="chapter" data-level="7.4.3" data-path="7.4-mod-07-nlme.html"><a href="7.4-mod-07-nlme.html#nlme-on-real-data"><i class="fa fa-check"></i><b>7.4.3</b> NLME on real data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7.5-mod-07-gamm.html"><a href="7.5-mod-07-gamm.html"><i class="fa fa-check"></i><b>7.5</b> (Generalized) additive mixed models (AMM/GAMM)</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7.5-mod-07-gamm.html"><a href="7.5-mod-07-gamm.html#example-gamm-with-real-data"><i class="fa fa-check"></i><b>7.5.1</b> Example GAMM with real data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-mod-08.html"><a href="8-mod-08.html"><i class="fa fa-check"></i><b>8</b> Multivariate data analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html"><i class="fa fa-check"></i><b>8.1</b> Multivariate data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html#univariate-vs.-multivariate-data"><i class="fa fa-check"></i><b>8.1.1</b> Univariate vs. multivariate data</a></li>
<li class="chapter" data-level="8.1.2" data-path="8.1-multivariate-data.html"><a href="8.1-multivariate-data.html#components-of-multivariate-data"><i class="fa fa-check"></i><b>8.1.2</b> Components of multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html"><i class="fa fa-check"></i><b>8.2</b> Distance metrics: biological (dis)similarity</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html#euclidean-distance"><i class="fa fa-check"></i><b>8.2.1</b> Euclidean distance</a></li>
<li class="chapter" data-level="8.2.2" data-path="8.2-mod-08-dist.html"><a href="8.2-mod-08-dist.html#bray-curtis-and-other-distance-metrics"><i class="fa fa-check"></i><b>8.2.2</b> Bray-Curtis and other distance metrics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8.3-clustering.html"><a href="8.3-clustering.html"><i class="fa fa-check"></i><b>8.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8.3-clustering.html"><a href="8.3-clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>8.3.1</b> <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="8.3.2" data-path="8.3-clustering.html"><a href="8.3-clustering.html#hierarchical-agglomerative-clustering"><i class="fa fa-check"></i><b>8.3.2</b> Hierarchical agglomerative clustering</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html"><i class="fa fa-check"></i><b>8.4</b> Analyzing dissimilarity</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html#mantel-tests-distance-vs.-distance"><i class="fa fa-check"></i><b>8.4.1</b> Mantel tests: distance vs. distance</a></li>
<li class="chapter" data-level="8.4.2" data-path="8.4-mod-08-sims.html"><a href="8.4-mod-08-sims.html#comparing-dissimilarity-between-groups"><i class="fa fa-check"></i><b>8.4.2</b> Comparing dissimilarity between groups</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html"><i class="fa fa-check"></i><b>8.5</b> Ordination</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#principal-components-analysis-pca-1"><i class="fa fa-check"></i><b>8.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="8.5.2" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#nmds-and-other-ordination-methods"><i class="fa fa-check"></i><b>8.5.2</b> NMDS and other ordination methods</a></li>
<li class="chapter" data-level="8.5.3" data-path="8.5-mod-08-ord.html"><a href="8.5-mod-08-ord.html#other-ordination-techniques"><i class="fa fa-check"></i><b>8.5.3</b> Other ordination techniques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-mod-09.html"><a href="9-mod-09.html"><i class="fa fa-check"></i><b>9</b> Planning your analysis (what test?)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9.1-how-to-use-this-guide.html"><a href="9.1-how-to-use-this-guide.html"><i class="fa fa-check"></i><b>9.1</b> How to use this guide</a></li>
<li class="chapter" data-level="9.2" data-path="9.2-what-question-are-you-trying-to-answer.html"><a href="9.2-what-question-are-you-trying-to-answer.html"><i class="fa fa-check"></i><b>9.2</b> What question are you trying to answer?</a></li>
<li class="chapter" data-level="9.3" data-path="9.3-testing-for-a-difference-in-mean-or-location.html"><a href="9.3-testing-for-a-difference-in-mean-or-location.html"><i class="fa fa-check"></i><b>9.3</b> Testing for a difference in mean or location</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="9.3-testing-for-a-difference-in-mean-or-location.html"><a href="9.3-testing-for-a-difference-in-mean-or-location.html#additional-considerations"><i class="fa fa-check"></i><b>9.3.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><a href="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><i class="fa fa-check"></i><b>9.4</b> Testing for a continuous relationship between two or more variables</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html"><a href="9.4-testing-for-a-continuous-relationship-between-two-or-more-variables.html#additional-considerations-1"><i class="fa fa-check"></i><b>9.4.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9.5-classifying-observations.html"><a href="9.5-classifying-observations.html"><i class="fa fa-check"></i><b>9.5</b> Classifying observations</a></li>
<li class="chapter" data-level="9.6" data-path="9.6-conclusions.html"><a href="9.6-conclusions.html"><i class="fa fa-check"></i><b>9.6</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literature-cited.html"><a href="literature-cited.html"><i class="fa fa-check"></i>Literature Cited</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-07-nlme" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Nonlinear mixed models (NLME)</h2>
<div id="definition-and-background" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Definition and background</h3>
<p><strong>Nonlinear mixed effects models (NLME)</strong> extend the nonlinear model (NLS) to allow parameters to vary randomly by a factor. In an LMM or GLMM, the parameters that could vary randomly were the intercept and slope (or other coefficients). Because NLS models don’t always have intercepts and slopes, the random effects can potentially apply to any parameter in the model. For example, a mixed effects Michaelis-Menten model might have an asymptote, Michaelis constant, or both that vary randomly between levels of a factor:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-682-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>As you might expect, fitting NLME can be tricky: it combines all of the <a href="6-mod-06.html#mod-06">difficulties with nonlinear models</a> with those of mixed models! One of the most commonly used options is the <code>nlmer()</code> function from the <code>lme4</code> package. For complicated models you may want to consider using Bayesian inference with JAGS because of the added flexibility afforded by the Markov chain Monte Carlo (MCMC) paradigm.</p>
</div>
<div id="nlme-on-simulated-data" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> NLME on simulated data</h3>
<p>Let’s simulate data that might have come from an enzyme kinetics study. We’ll model reaction rate <em>y</em> as a function of concentration <em>x</em> for some family of substrates. NLME might be a better choice than NLS for such a problem because the selection of substrates is only a sampling of the potential substrates, and the researcher is interested in how reaction rate might vary with concentration for other, untested substrates.</p>
<div class="sourceCode" id="cb1532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1532-1"><a href="7.4-mod-07-nlme.html#cb1532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1532-2"><a href="7.4-mod-07-nlme.html#cb1532-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-3"><a href="7.4-mod-07-nlme.html#cb1532-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data structure: number of substates (nlev)</span></span>
<span id="cb1532-4"><a href="7.4-mod-07-nlme.html#cb1532-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and replicates per concentration</span></span>
<span id="cb1532-5"><a href="7.4-mod-07-nlme.html#cb1532-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and substrate (nrep)</span></span>
<span id="cb1532-6"><a href="7.4-mod-07-nlme.html#cb1532-6" aria-hidden="true" tabindex="-1"></a>nlev <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb1532-7"><a href="7.4-mod-07-nlme.html#cb1532-7" aria-hidden="true" tabindex="-1"></a>nrep <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1532-8"><a href="7.4-mod-07-nlme.html#cb1532-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-9"><a href="7.4-mod-07-nlme.html#cb1532-9" aria-hidden="true" tabindex="-1"></a><span class="co"># concentrations:</span></span>
<span id="cb1532-10"><a href="7.4-mod-07-nlme.html#cb1532-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by=</span><span class="fl">0.5</span>)</span>
<span id="cb1532-11"><a href="7.4-mod-07-nlme.html#cb1532-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-12"><a href="7.4-mod-07-nlme.html#cb1532-12" aria-hidden="true" tabindex="-1"></a><span class="co"># hyperparameters for a and b</span></span>
<span id="cb1532-13"><a href="7.4-mod-07-nlme.html#cb1532-13" aria-hidden="true" tabindex="-1"></a>avec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nlev, <span class="dv">129</span>, <span class="dv">12</span>)</span>
<span id="cb1532-14"><a href="7.4-mod-07-nlme.html#cb1532-14" aria-hidden="true" tabindex="-1"></a>bvec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nlev, <span class="dv">22</span>, <span class="dv">12</span>)</span>
<span id="cb1532-15"><a href="7.4-mod-07-nlme.html#cb1532-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-16"><a href="7.4-mod-07-nlme.html#cb1532-16" aria-hidden="true" tabindex="-1"></a><span class="co"># assemble dataframe of predictors and parameters</span></span>
<span id="cb1532-17"><a href="7.4-mod-07-nlme.html#cb1532-17" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">subs=</span><span class="dv">1</span><span class="sc">:</span>nlev, <span class="at">conc=</span>x, <span class="at">rep=</span><span class="dv">1</span><span class="sc">:</span>nrep)</span>
<span id="cb1532-18"><a href="7.4-mod-07-nlme.html#cb1532-18" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>a <span class="ot">&lt;-</span> avec[dat<span class="sc">$</span>subs]</span>
<span id="cb1532-19"><a href="7.4-mod-07-nlme.html#cb1532-19" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>b <span class="ot">&lt;-</span> bvec[dat<span class="sc">$</span>subs]</span>
<span id="cb1532-20"><a href="7.4-mod-07-nlme.html#cb1532-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-21"><a href="7.4-mod-07-nlme.html#cb1532-21" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate expected value</span></span>
<span id="cb1532-22"><a href="7.4-mod-07-nlme.html#cb1532-22" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>mu <span class="ot">&lt;-</span> (dat<span class="sc">$</span>a<span class="sc">*</span>dat<span class="sc">$</span>conc)<span class="sc">/</span>(dat<span class="sc">$</span>b<span class="sc">+</span>dat<span class="sc">$</span>conc)</span>
<span id="cb1532-23"><a href="7.4-mod-07-nlme.html#cb1532-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-24"><a href="7.4-mod-07-nlme.html#cb1532-24" aria-hidden="true" tabindex="-1"></a><span class="co"># residual SD and residuals</span></span>
<span id="cb1532-25"><a href="7.4-mod-07-nlme.html#cb1532-25" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1532-26"><a href="7.4-mod-07-nlme.html#cb1532-26" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(dat), dat<span class="sc">$</span>mu, sigma)</span>
<span id="cb1532-27"><a href="7.4-mod-07-nlme.html#cb1532-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-28"><a href="7.4-mod-07-nlme.html#cb1532-28" aria-hidden="true" tabindex="-1"></a><span class="co"># can&#39;t have negative values</span></span>
<span id="cb1532-29"><a href="7.4-mod-07-nlme.html#cb1532-29" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, dat<span class="sc">$</span>y)</span>
<span id="cb1532-30"><a href="7.4-mod-07-nlme.html#cb1532-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1532-31"><a href="7.4-mod-07-nlme.html#cb1532-31" aria-hidden="true" tabindex="-1"></a><span class="co"># add colors for plotting</span></span>
<span id="cb1532-32"><a href="7.4-mod-07-nlme.html#cb1532-32" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(nlev)</span>
<span id="cb1532-33"><a href="7.4-mod-07-nlme.html#cb1532-33" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>col <span class="ot">&lt;-</span> cols[dat<span class="sc">$</span>subs]</span></code></pre></div>
<p>Make a quick plot of expected value in each group (substrate):</p>
<p><img src="_main_files/figure-html/unnamed-chunk-684-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We can also see the actual data:</p>
<div class="sourceCode" id="cb1533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1533-1"><a href="7.4-mod-07-nlme.html#cb1533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(dat<span class="sc">$</span>conc), dat<span class="sc">$</span>y, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>dat<span class="sc">$</span>col)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-685-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Faced with these data, we might suspect that the <em>y</em> variable (reaction rate) could be modeled by a Michaelis-Menten (MM) function. However, we might also suspect that there is a lot of variation due to substrate that is not accounted for by a garden variety MM model. If we are not interested in these substrates in particular, but only as representatives of all substrates, then a mixed model is called for. What is not clear is whether the asymptote, Michaelis constant, or both should be random. Fortunately, it is straightforward to test all three variations.</p>
<p>To use <code>nlmer()</code>, you need to specify the model in 3 parts: response, function, and random effects. The parts are separated by tildes (<code>~</code>). Unlike <code>nls()</code>, where the model formula can be provided directly, the model formula in <code>nlmer()</code> must be a function that takes in a predictor and uses named parameters to produce a numeric output. The self-start functions we saw in the <a href="6.3-mod-06-micmen.html#mod-06-micmen">NLS unit</a> can be used for this, but unlike in <code>nls()</code> you <em>always</em> need to provide starting values. The starting values can be estimated or guessed at by inspecting the scatterplot and thinking about the meaning of each parameter (<a href="6.3-mod-06-micmen.html#mod-06-micmen-sim">example</a>). Fortunately, the random effects syntax works in much the same way as it does in <code>lmer()</code>.</p>
<div class="sourceCode" id="cb1534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1534-1"><a href="7.4-mod-07-nlme.html#cb1534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1534-2"><a href="7.4-mod-07-nlme.html#cb1534-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1534-3"><a href="7.4-mod-07-nlme.html#cb1534-3" aria-hidden="true" tabindex="-1"></a><span class="co"># named vector of starting values</span></span>
<span id="cb1534-4"><a href="7.4-mod-07-nlme.html#cb1534-4" aria-hidden="true" tabindex="-1"></a>startvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a=</span><span class="dv">120</span>, <span class="at">b=</span><span class="dv">25</span>)</span>
<span id="cb1534-5"><a href="7.4-mod-07-nlme.html#cb1534-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1534-6"><a href="7.4-mod-07-nlme.html#cb1534-6" aria-hidden="true" tabindex="-1"></a><span class="co"># model 1: random asymptote</span></span>
<span id="cb1534-7"><a href="7.4-mod-07-nlme.html#cb1534-7" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(y<span class="sc">~</span><span class="fu">SSmicmen</span>(conc, a, b)<span class="sc">~</span>a<span class="sc">|</span>subs,</span>
<span id="cb1534-8"><a href="7.4-mod-07-nlme.html#cb1534-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span>
<span id="cb1534-9"><a href="7.4-mod-07-nlme.html#cb1534-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1534-10"><a href="7.4-mod-07-nlme.html#cb1534-10" aria-hidden="true" tabindex="-1"></a><span class="co"># model 2: random Michaelis constant</span></span>
<span id="cb1534-11"><a href="7.4-mod-07-nlme.html#cb1534-11" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(y<span class="sc">~</span><span class="fu">SSmicmen</span>(conc, a, b)<span class="sc">~</span>b<span class="sc">|</span>subs,</span>
<span id="cb1534-12"><a href="7.4-mod-07-nlme.html#cb1534-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span>
<span id="cb1534-13"><a href="7.4-mod-07-nlme.html#cb1534-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1534-14"><a href="7.4-mod-07-nlme.html#cb1534-14" aria-hidden="true" tabindex="-1"></a><span class="co"># model 3: random both parameters</span></span>
<span id="cb1534-15"><a href="7.4-mod-07-nlme.html#cb1534-15" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(y<span class="sc">~</span><span class="fu">SSmicmen</span>(conc, a, b)<span class="sc">~</span>(a<span class="sc">|</span>subs)<span class="sc">+</span>(b<span class="sc">|</span>subs),</span>
<span id="cb1534-16"><a href="7.4-mod-07-nlme.html#cb1534-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span></code></pre></div>
<p>The parameter estimates of all three models are close to the true values. We can compare the fit of the models using AIC and find that model 3 has the best fit. This should not be surprising because model 3 is the correct one.</p>
<div class="sourceCode" id="cb1535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1535-1"><a href="7.4-mod-07-nlme.html#cb1535-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1, mod2, mod3)</span></code></pre></div>
<pre><code>##      df      AIC
## mod1  4 1563.909
## mod2  4 1573.510
## mod3  5 1561.939</code></pre>
<p>Unfortunately, generating predictions for <code>nlmer()</code> models is not straightforward<a href="literature-cited.html#fn75" class="footnote-ref" id="fnref75"><sup>75</sup></a>. So, let’s use a different method of model fitting: Markov chain Monte Carlo (MCMC). You’ll need a separate program, JAGS <span class="citation">(<a href="#ref-plummer2003jags" role="doc-biblioref">Plummer 2003</a>)</span>, and the R packages rjags <span class="citation">(<a href="#ref-plummer2021" role="doc-biblioref">Plummer 2021</a>)</span> and R2jags <span class="citation">(<a href="#ref-su2021" role="doc-biblioref">Su and Masanao Yajima 2021</a>)</span>. The general procedure for using JAGS is to first write the model to a text file using <code>sink()</code>, then call JAGS from within R. JAGS will then read the text file and fit the model. The code block below will write the model file to your current R working directory.</p>
<div class="sourceCode" id="cb1537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1537-1"><a href="7.4-mod-07-nlme.html#cb1537-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write model file</span></span>
<span id="cb1537-2"><a href="7.4-mod-07-nlme.html#cb1537-2" aria-hidden="true" tabindex="-1"></a>mod.name <span class="ot">&lt;-</span> <span class="st">&quot;nlme_mod03.txt&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb1538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1538-1"><a href="7.4-mod-07-nlme.html#cb1538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sink</span>(mod.name)</span>
<span id="cb1538-2"><a href="7.4-mod-07-nlme.html#cb1538-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb1538-3"><a href="7.4-mod-07-nlme.html#cb1538-3" aria-hidden="true" tabindex="-1"></a><span class="st">    model{</span></span>
<span id="cb1538-4"><a href="7.4-mod-07-nlme.html#cb1538-4" aria-hidden="true" tabindex="-1"></a><span class="st">        # priors</span></span>
<span id="cb1538-5"><a href="7.4-mod-07-nlme.html#cb1538-5" aria-hidden="true" tabindex="-1"></a><span class="st">        ## hyperparameters</span></span>
<span id="cb1538-6"><a href="7.4-mod-07-nlme.html#cb1538-6" aria-hidden="true" tabindex="-1"></a><span class="st">        mu.a ~ dunif(1, 200)</span></span>
<span id="cb1538-7"><a href="7.4-mod-07-nlme.html#cb1538-7" aria-hidden="true" tabindex="-1"></a><span class="st">        sd.a ~ dunif(1, 20)</span></span>
<span id="cb1538-8"><a href="7.4-mod-07-nlme.html#cb1538-8" aria-hidden="true" tabindex="-1"></a><span class="st">        mu.b ~ dunif(1, 200)</span></span>
<span id="cb1538-9"><a href="7.4-mod-07-nlme.html#cb1538-9" aria-hidden="true" tabindex="-1"></a><span class="st">        sd.b ~ dunif(1, 20)</span></span>
<span id="cb1538-10"><a href="7.4-mod-07-nlme.html#cb1538-10" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb1538-11"><a href="7.4-mod-07-nlme.html#cb1538-11" aria-hidden="true" tabindex="-1"></a><span class="st">        ## precision of a and b</span></span>
<span id="cb1538-12"><a href="7.4-mod-07-nlme.html#cb1538-12" aria-hidden="true" tabindex="-1"></a><span class="st">        tau.a &lt;- 1/(sd.a * sd.a)</span></span>
<span id="cb1538-13"><a href="7.4-mod-07-nlme.html#cb1538-13" aria-hidden="true" tabindex="-1"></a><span class="st">        tau.b &lt;- 1/(sd.b * sd.b)</span></span>
<span id="cb1538-14"><a href="7.4-mod-07-nlme.html#cb1538-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1538-15"><a href="7.4-mod-07-nlme.html#cb1538-15" aria-hidden="true" tabindex="-1"></a><span class="st">        ## parameters</span></span>
<span id="cb1538-16"><a href="7.4-mod-07-nlme.html#cb1538-16" aria-hidden="true" tabindex="-1"></a><span class="st">        for(i in 1:nlev){</span></span>
<span id="cb1538-17"><a href="7.4-mod-07-nlme.html#cb1538-17" aria-hidden="true" tabindex="-1"></a><span class="st">            a.vec[i]~dnorm(mu.a, tau.a)</span></span>
<span id="cb1538-18"><a href="7.4-mod-07-nlme.html#cb1538-18" aria-hidden="true" tabindex="-1"></a><span class="st">            b.vec[i]~dnorm(mu.b, tau.b)</span></span>
<span id="cb1538-19"><a href="7.4-mod-07-nlme.html#cb1538-19" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb1538-20"><a href="7.4-mod-07-nlme.html#cb1538-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1538-21"><a href="7.4-mod-07-nlme.html#cb1538-21" aria-hidden="true" tabindex="-1"></a><span class="st">        ## residual SD and precision (tau)</span></span>
<span id="cb1538-22"><a href="7.4-mod-07-nlme.html#cb1538-22" aria-hidden="true" tabindex="-1"></a><span class="st">        sigma ~ dunif(0, 1e4)</span></span>
<span id="cb1538-23"><a href="7.4-mod-07-nlme.html#cb1538-23" aria-hidden="true" tabindex="-1"></a><span class="st">        tau.y &lt;- 1 / (sigma * sigma)</span></span>
<span id="cb1538-24"><a href="7.4-mod-07-nlme.html#cb1538-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1538-25"><a href="7.4-mod-07-nlme.html#cb1538-25" aria-hidden="true" tabindex="-1"></a><span class="st">        # likelihood</span></span>
<span id="cb1538-26"><a href="7.4-mod-07-nlme.html#cb1538-26" aria-hidden="true" tabindex="-1"></a><span class="st">        for(i in 1:N){</span></span>
<span id="cb1538-27"><a href="7.4-mod-07-nlme.html#cb1538-27" aria-hidden="true" tabindex="-1"></a><span class="st">            y[i] ~ dnorm(eta[i], tau.y)</span></span>
<span id="cb1538-28"><a href="7.4-mod-07-nlme.html#cb1538-28" aria-hidden="true" tabindex="-1"></a><span class="st">            eta[i] &lt;- (a.vec[levs[i]] *</span></span>
<span id="cb1538-29"><a href="7.4-mod-07-nlme.html#cb1538-29" aria-hidden="true" tabindex="-1"></a><span class="st">                x[i])/(b.vec[levs[i]]+x[i])</span></span>
<span id="cb1538-30"><a href="7.4-mod-07-nlme.html#cb1538-30" aria-hidden="true" tabindex="-1"></a><span class="st">        }# i for N</span></span>
<span id="cb1538-31"><a href="7.4-mod-07-nlme.html#cb1538-31" aria-hidden="true" tabindex="-1"></a><span class="st">    }#model</span></span>
<span id="cb1538-32"><a href="7.4-mod-07-nlme.html#cb1538-32" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>, <span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb1538-33"><a href="7.4-mod-07-nlme.html#cb1538-33" aria-hidden="true" tabindex="-1"></a><span class="fu">sink</span>()</span></code></pre></div>
<p>Next, package the data up for JAGS. Any value or set of values used in the model must be included by name in a list.</p>
<div class="sourceCode" id="cb1539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1539-1"><a href="7.4-mod-07-nlme.html#cb1539-1" aria-hidden="true" tabindex="-1"></a><span class="co"># package data for JAGS</span></span>
<span id="cb1539-2"><a href="7.4-mod-07-nlme.html#cb1539-2" aria-hidden="true" tabindex="-1"></a>in.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">y=</span>dat<span class="sc">$</span>y,</span>
<span id="cb1539-3"><a href="7.4-mod-07-nlme.html#cb1539-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">x=</span>dat<span class="sc">$</span>conc,</span>
<span id="cb1539-4"><a href="7.4-mod-07-nlme.html#cb1539-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">levs=</span>dat<span class="sc">$</span>subs,</span>
<span id="cb1539-5"><a href="7.4-mod-07-nlme.html#cb1539-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">N=</span><span class="fu">nrow</span>(dat),</span>
<span id="cb1539-6"><a href="7.4-mod-07-nlme.html#cb1539-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">nlev=</span>nlev</span>
<span id="cb1539-7"><a href="7.4-mod-07-nlme.html#cb1539-7" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div>
<p>Any value that is not fixed (i.e., part of the input data) must be supplied with an initial value. It doesn’t matter much what this value is, as long as it is within the proper domain of the variable. For example, initial values for the <span class="math inline">\(\lambda\)</span> parameter of a Poisson distribution must be <span class="math inline">\(\ge\)</span> 0. The initial values must be stored in a list that has one element for each MCMC chain. I prefer to define a function that generates initial values automatically, in case I ever want to change the number of chains.</p>
<div class="sourceCode" id="cb1540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1540-1"><a href="7.4-mod-07-nlme.html#cb1540-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define initial values for MCMC chains</span></span>
<span id="cb1540-2"><a href="7.4-mod-07-nlme.html#cb1540-2" aria-hidden="true" tabindex="-1"></a>init.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(nc){</span>
<span id="cb1540-3"><a href="7.4-mod-07-nlme.html#cb1540-3" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="at">length=</span>nc)</span>
<span id="cb1540-4"><a href="7.4-mod-07-nlme.html#cb1540-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nc){</span>
<span id="cb1540-5"><a href="7.4-mod-07-nlme.html#cb1540-5" aria-hidden="true" tabindex="-1"></a>        res[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1540-6"><a href="7.4-mod-07-nlme.html#cb1540-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mu.a=</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">200</span>),            </span>
<span id="cb1540-7"><a href="7.4-mod-07-nlme.html#cb1540-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd.a=</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">20</span>),</span>
<span id="cb1540-8"><a href="7.4-mod-07-nlme.html#cb1540-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mu.b=</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">200</span>),            </span>
<span id="cb1540-9"><a href="7.4-mod-07-nlme.html#cb1540-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd.b=</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">20</span>), </span>
<span id="cb1540-10"><a href="7.4-mod-07-nlme.html#cb1540-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">a.vec=</span><span class="fu">runif</span>(nlev, <span class="dv">1</span>, <span class="dv">200</span>),</span>
<span id="cb1540-11"><a href="7.4-mod-07-nlme.html#cb1540-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">b.vec=</span><span class="fu">runif</span>(nlev, <span class="dv">1</span>, <span class="dv">20</span>),</span>
<span id="cb1540-12"><a href="7.4-mod-07-nlme.html#cb1540-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">sigma=</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">20</span>))</span>
<span id="cb1540-13"><a href="7.4-mod-07-nlme.html#cb1540-13" aria-hidden="true" tabindex="-1"></a>    }<span class="co">#i</span></span>
<span id="cb1540-14"><a href="7.4-mod-07-nlme.html#cb1540-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb1540-15"><a href="7.4-mod-07-nlme.html#cb1540-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Finally, set some parameters that control how JAGS will run. For actual inference, use a number of iterations <span class="math inline">\(\ge\)</span> 100,000 (<code>n.iter</code>) and a burn-in length (<code>n.burn</code>) of about 20% of the total number of iterations. A large thinning interval (<code>n.thin</code>) is needed to mitigate autocorrelation of the MCMC chains; 100 is commonly used. These values are probably larger than needed for JAGS, but not larger than needed for OpenBUGS or WinBUGS<a href="literature-cited.html#fn76" class="footnote-ref" id="fnref76"><sup>76</sup></a>. The final size of your posterior samples—i.e., the number of draws from the posterior distribution that can be used for inference—is equal to:</p>
<p><span class="math display">\[n_{post}=n_{chains}\left(\frac{n_{iter}-n_{burn}}{n_{thin}}\right)\]</span></p>
<p>Set the last few parameters and send the model to JAGS:</p>
<div class="sourceCode" id="cb1541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1541-1"><a href="7.4-mod-07-nlme.html#cb1541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb1541-2"><a href="7.4-mod-07-nlme.html#cb1541-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb1541-3"><a href="7.4-mod-07-nlme.html#cb1541-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1541-4"><a href="7.4-mod-07-nlme.html#cb1541-4" aria-hidden="true" tabindex="-1"></a>nchains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1541-5"><a href="7.4-mod-07-nlme.html#cb1541-5" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">init.fun</span>(nchains)</span>
<span id="cb1541-6"><a href="7.4-mod-07-nlme.html#cb1541-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1541-7"><a href="7.4-mod-07-nlme.html#cb1541-7" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to monitor</span></span>
<span id="cb1541-8"><a href="7.4-mod-07-nlme.html#cb1541-8" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mu.a&quot;</span>, <span class="st">&quot;sd.a&quot;</span>, <span class="st">&quot;mu.b&quot;</span>, <span class="st">&quot;sd.b&quot;</span>, <span class="st">&quot;sigma&quot;</span>,</span>
<span id="cb1541-9"><a href="7.4-mod-07-nlme.html#cb1541-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;a.vec&quot;</span>, <span class="st">&quot;b.vec&quot;</span>)</span>
<span id="cb1541-10"><a href="7.4-mod-07-nlme.html#cb1541-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1541-11"><a href="7.4-mod-07-nlme.html#cb1541-11" aria-hidden="true" tabindex="-1"></a><span class="co"># MCMC parameters</span></span>
<span id="cb1541-12"><a href="7.4-mod-07-nlme.html#cb1541-12" aria-hidden="true" tabindex="-1"></a>n.iter <span class="ot">&lt;-</span> <span class="fl">5e3</span></span>
<span id="cb1541-13"><a href="7.4-mod-07-nlme.html#cb1541-13" aria-hidden="true" tabindex="-1"></a>n.burnin <span class="ot">&lt;-</span> <span class="fl">1e2</span></span>
<span id="cb1541-14"><a href="7.4-mod-07-nlme.html#cb1541-14" aria-hidden="true" tabindex="-1"></a>n.thin <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1541-15"><a href="7.4-mod-07-nlme.html#cb1541-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1541-16"><a href="7.4-mod-07-nlme.html#cb1541-16" aria-hidden="true" tabindex="-1"></a>mod3j <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>in.data, <span class="at">inits=</span>inits,</span>
<span id="cb1541-17"><a href="7.4-mod-07-nlme.html#cb1541-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">parameters.to.save=</span>params,</span>
<span id="cb1541-18"><a href="7.4-mod-07-nlme.html#cb1541-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">model.file=</span>mod.name,</span>
<span id="cb1541-19"><a href="7.4-mod-07-nlme.html#cb1541-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.chains=</span>nchains, <span class="at">n.iter=</span>n.iter,</span>
<span id="cb1541-20"><a href="7.4-mod-07-nlme.html#cb1541-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.burnin=</span>n.burnin, <span class="at">n.thin=</span>n.thin)<span class="co">#jags</span></span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 216
##    Unobserved stochastic nodes: 21
##    Total graph size: 909
## 
## Initializing model
## 
## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |*                                                 |   2%
  |                                                        
  |**                                                |   4%
  |                                                        
  |***                                               |   6%
  |                                                        
  |****                                              |   8%
  |                                                        
  |*****                                             |  10%
  |                                                        
  |******                                            |  12%
  |                                                        
  |*******                                           |  14%
  |                                                        
  |********                                          |  16%
  |                                                        
  |*********                                         |  18%
  |                                                        
  |**********                                        |  20%
  |                                                        
  |***********                                       |  22%
  |                                                        
  |************                                      |  24%
  |                                                        
  |*************                                     |  27%
  |                                                        
  |**************                                    |  29%
  |                                                        
  |***************                                   |  31%
  |                                                        
  |****************                                  |  33%
  |                                                        
  |*****************                                 |  35%
  |                                                        
  |******************                                |  37%
  |                                                        
  |*******************                               |  39%
  |                                                        
  |********************                              |  41%
  |                                                        
  |*********************                             |  43%
  |                                                        
  |**********************                            |  45%
  |                                                        
  |***********************                           |  47%
  |                                                        
  |************************                          |  49%
  |                                                        
  |**************************                        |  51%
  |                                                        
  |***************************                       |  53%
  |                                                        
  |****************************                      |  55%
  |                                                        
  |*****************************                     |  57%
  |                                                        
  |******************************                    |  59%
  |                                                        
  |*******************************                   |  61%
  |                                                        
  |********************************                  |  63%
  |                                                        
  |*********************************                 |  65%
  |                                                        
  |**********************************                |  67%
  |                                                        
  |***********************************               |  69%
  |                                                        
  |************************************              |  71%
  |                                                        
  |*************************************             |  73%
  |                                                        
  |**************************************            |  76%
  |                                                        
  |***************************************           |  78%
  |                                                        
  |****************************************          |  80%
  |                                                        
  |*****************************************         |  82%
  |                                                        
  |******************************************        |  84%
  |                                                        
  |*******************************************       |  86%
  |                                                        
  |********************************************      |  88%
  |                                                        
  |*********************************************     |  90%
  |                                                        
  |**********************************************    |  92%
  |                                                        
  |***********************************************   |  94%
  |                                                        
  |************************************************  |  96%
  |                                                        
  |************************************************* |  98%
  |                                                        
  |**************************************************| 100%</code></pre>
<p>The most important part of the output is here obtained by printing the model object to the console:</p>
<div class="sourceCode" id="cb1543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1543-1"><a href="7.4-mod-07-nlme.html#cb1543-1" aria-hidden="true" tabindex="-1"></a>mod3j</span></code></pre></div>
<pre><code>## Inference for Bugs model at &quot;nlme_mod03.txt&quot;, fit using jags,
##  3 chains, each with 5000 iterations (first 100 discarded), n.thin = 100
##  n.sims = 147 iterations saved
##           mu.vect sd.vect     2.5%      25%      50%      75%    97.5%  Rhat
## a.vec[1]  128.513   6.888  116.049  123.847  128.003  133.146  142.769 0.995
## a.vec[2]  124.844   7.369  112.265  119.553  123.998  129.427  141.065 1.027
## a.vec[3]  131.011   8.392  117.081  125.895  129.974  135.282  149.705 1.002
## a.vec[4]  128.561   7.784  114.009  123.471  128.797  133.397  143.299 1.018
## a.vec[5]  130.787   8.030  116.861  125.303  129.991  135.742  146.610 1.034
## a.vec[6]  141.115   7.310  128.492  136.745  139.739  145.799  157.006 1.030
## a.vec[7]  157.374   8.199  142.347  152.461  156.953  161.871  173.935 1.023
## a.vec[8]  112.327   9.903   94.144  105.211  111.992  118.570  132.351 0.999
## b.vec[1]   17.655   3.048   12.552   15.310   17.434   19.692   23.174 0.998
## b.vec[2]   17.503   3.452   12.110   14.843   17.549   19.415   24.899 1.045
## b.vec[3]   30.481   5.581   21.453   27.065   29.868   33.323   43.953 1.004
## b.vec[4]   25.801   4.611   18.427   22.587   25.446   28.601   35.398 0.993
## b.vec[5]   22.084   3.786   15.758   19.649   21.693   24.311   29.921 1.026
## b.vec[6]   22.279   3.304   17.169   19.847   21.889   24.332   29.111 1.015
## b.vec[7]   23.264   3.522   17.293   20.870   22.635   25.248   30.658 1.036
## b.vec[8]   38.488   8.071   25.234   32.215   37.642   44.289   55.795 1.007
## mu.a      131.686   5.700  120.606  128.297  131.977  135.282  143.156 0.999
## mu.b       24.845   3.978   18.438   22.266   24.084   27.565   32.609 1.018
## sd.a       14.226   3.392    7.310   11.971   14.170   16.999   19.760 1.064
## sd.b        9.087   3.613    3.604    6.349    8.695   11.196   17.040 1.037
## sigma       8.244   0.411    7.515    7.919    8.222    8.496    9.086 1.017
## deviance 1523.397   6.499 1513.634 1518.874 1522.689 1526.226 1537.916 1.080
##          n.eff
## a.vec[1]   150
## a.vec[2]    75
## a.vec[3]   150
## a.vec[4]   150
## a.vec[5]    68
## a.vec[6]   150
## a.vec[7]   140
## a.vec[8]   150
## b.vec[1]   150
## b.vec[2]    58
## b.vec[3]   150
## b.vec[4]   150
## b.vec[5]    67
## b.vec[6]   140
## b.vec[7]    76
## b.vec[8]   120
## mu.a       150
## mu.b       150
## sd.a        83
## sd.b        75
## sigma      150
## deviance    35
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 20.2 and DIC = 1543.5
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<p>Unlike <code>lmer()</code>, <code>glmer()</code>, and <code>nlmer()</code>, an MCMC output automatically contains estimates of the region in which value of each parameter is likely to fall. However, instead of being called “confidence intervals” (CI), these intervals are called <strong>credible intervals (CRI)</strong>. The difference between a CI and a CRI is in how they are calculated. CI are calculated using the estimated mean, SE, and properties of the normal distribution. CRI, on the other hand, are simply quantiles of the posterior distribution of the parameter. This means that CRI are inherently Bayesian and only defined in Bayesian inference; CI are frequentist and used in non-Bayesian context. CRI have the distinct advantage of not assuming anything about the appropriate distribution for the parameter.</p>
<p>Other outputs of MCMC can be used to calculate model predictions and their 95% CRI. Let’s use the posterior draws to calculate model predictions. The posteriors are stored in several ways within the JAGS output. For generating predictions and CRI, we should use the values in the <code>sims.matrix</code> part of the output, which have already been permuted (this reduces bias in the predictions).</p>
<div class="sourceCode" id="cb1545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1545-1"><a href="7.4-mod-07-nlme.html#cb1545-1" aria-hidden="true" tabindex="-1"></a>po <span class="ot">&lt;-</span> mod3j<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.matrix</span>
<span id="cb1545-2"><a href="7.4-mod-07-nlme.html#cb1545-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="fu">nrow</span>(po)</span>
<span id="cb1545-3"><a href="7.4-mod-07-nlme.html#cb1545-3" aria-hidden="true" tabindex="-1"></a>a.cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;a.vec&quot;</span>, <span class="fu">colnames</span>(po))</span>
<span id="cb1545-4"><a href="7.4-mod-07-nlme.html#cb1545-4" aria-hidden="true" tabindex="-1"></a>b.cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;b.vec&quot;</span>, <span class="fu">colnames</span>(po))</span>
<span id="cb1545-5"><a href="7.4-mod-07-nlme.html#cb1545-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1545-6"><a href="7.4-mod-07-nlme.html#cb1545-6" aria-hidden="true" tabindex="-1"></a>pn <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1545-7"><a href="7.4-mod-07-nlme.html#cb1545-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>conc), <span class="fu">max</span>(dat<span class="sc">$</span>conc), <span class="at">length=</span>pn)</span>
<span id="cb1545-8"><a href="7.4-mod-07-nlme.html#cb1545-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1545-9"><a href="7.4-mod-07-nlme.html#cb1545-9" aria-hidden="true" tabindex="-1"></a><span class="co"># version 1: full random effects</span></span>
<span id="cb1545-10"><a href="7.4-mod-07-nlme.html#cb1545-10" aria-hidden="true" tabindex="-1"></a>dx1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">subs=</span><span class="dv">1</span><span class="sc">:</span>nlev, <span class="at">conc=</span>x)</span>
<span id="cb1545-11"><a href="7.4-mod-07-nlme.html#cb1545-11" aria-hidden="true" tabindex="-1"></a>dy1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(dx1), <span class="at">ncol=</span>nsim)</span>
<span id="cb1545-12"><a href="7.4-mod-07-nlme.html#cb1545-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dx1)){</span>
<span id="cb1545-13"><a href="7.4-mod-07-nlme.html#cb1545-13" aria-hidden="true" tabindex="-1"></a>    ilev <span class="ot">&lt;-</span> dx1<span class="sc">$</span>subs[i]</span>
<span id="cb1545-14"><a href="7.4-mod-07-nlme.html#cb1545-14" aria-hidden="true" tabindex="-1"></a>    use.ac <span class="ot">&lt;-</span> a.cols[ilev]</span>
<span id="cb1545-15"><a href="7.4-mod-07-nlme.html#cb1545-15" aria-hidden="true" tabindex="-1"></a>    use.bc <span class="ot">&lt;-</span> b.cols[ilev]</span>
<span id="cb1545-16"><a href="7.4-mod-07-nlme.html#cb1545-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb1545-17"><a href="7.4-mod-07-nlme.html#cb1545-17" aria-hidden="true" tabindex="-1"></a>        use.a <span class="ot">&lt;-</span> po[j, use.ac]</span>
<span id="cb1545-18"><a href="7.4-mod-07-nlme.html#cb1545-18" aria-hidden="true" tabindex="-1"></a>        use.b <span class="ot">&lt;-</span> po[j, use.bc]</span>
<span id="cb1545-19"><a href="7.4-mod-07-nlme.html#cb1545-19" aria-hidden="true" tabindex="-1"></a>        dy1[i,j] <span class="ot">&lt;-</span> (use.a<span class="sc">*</span>dx1<span class="sc">$</span>conc[i])<span class="sc">/</span>(use.b<span class="sc">+</span>dx1<span class="sc">$</span>conc[i])</span>
<span id="cb1545-20"><a href="7.4-mod-07-nlme.html#cb1545-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1545-21"><a href="7.4-mod-07-nlme.html#cb1545-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1545-22"><a href="7.4-mod-07-nlme.html#cb1545-22" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>lo <span class="ot">&lt;-</span> <span class="fu">apply</span>(dy1, <span class="dv">1</span>, quantile, <span class="fl">0.025</span>)</span>
<span id="cb1545-23"><a href="7.4-mod-07-nlme.html#cb1545-23" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>mn <span class="ot">&lt;-</span> <span class="fu">apply</span>(dy1, <span class="dv">1</span>, quantile, <span class="fl">0.5</span>)</span>
<span id="cb1545-24"><a href="7.4-mod-07-nlme.html#cb1545-24" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>up <span class="ot">&lt;-</span> <span class="fu">apply</span>(dy1, <span class="dv">1</span>, quantile, <span class="fl">0.975</span>)</span>
<span id="cb1545-25"><a href="7.4-mod-07-nlme.html#cb1545-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1545-26"><a href="7.4-mod-07-nlme.html#cb1545-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1545-27"><a href="7.4-mod-07-nlme.html#cb1545-27" aria-hidden="true" tabindex="-1"></a><span class="co"># version 2: no random effects</span></span>
<span id="cb1545-28"><a href="7.4-mod-07-nlme.html#cb1545-28" aria-hidden="true" tabindex="-1"></a>dx2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">conc=</span>x)</span>
<span id="cb1545-29"><a href="7.4-mod-07-nlme.html#cb1545-29" aria-hidden="true" tabindex="-1"></a>dy2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(dx2), <span class="at">ncol=</span><span class="fu">nrow</span>(po))</span>
<span id="cb1545-30"><a href="7.4-mod-07-nlme.html#cb1545-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dx2)){</span>
<span id="cb1545-31"><a href="7.4-mod-07-nlme.html#cb1545-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb1545-32"><a href="7.4-mod-07-nlme.html#cb1545-32" aria-hidden="true" tabindex="-1"></a>        dy2[i,j] <span class="ot">&lt;-</span> po[j,<span class="st">&quot;mu.a&quot;</span>]<span class="sc">*</span>dx2<span class="sc">$</span>conc[i]<span class="sc">/</span>(po[j,<span class="st">&quot;mu.b&quot;</span>]<span class="sc">+</span>dx2<span class="sc">$</span>conc[i])</span>
<span id="cb1545-33"><a href="7.4-mod-07-nlme.html#cb1545-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1545-34"><a href="7.4-mod-07-nlme.html#cb1545-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1545-35"><a href="7.4-mod-07-nlme.html#cb1545-35" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>lo <span class="ot">&lt;-</span> <span class="fu">apply</span>(dy2, <span class="dv">1</span>, quantile, <span class="fl">0.025</span>)</span>
<span id="cb1545-36"><a href="7.4-mod-07-nlme.html#cb1545-36" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>mn <span class="ot">&lt;-</span> <span class="fu">apply</span>(dy2, <span class="dv">1</span>, quantile, <span class="fl">0.5</span>)</span>
<span id="cb1545-37"><a href="7.4-mod-07-nlme.html#cb1545-37" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>up <span class="ot">&lt;-</span> <span class="fu">apply</span>(dy2, <span class="dv">1</span>, quantile, <span class="fl">0.975</span>)</span></code></pre></div>
<p>Now make the plot:</p>
<div class="sourceCode" id="cb1546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1546-1"><a href="7.4-mod-07-nlme.html#cb1546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dx2<span class="sc">$</span>conc, dx2<span class="sc">$</span>mn, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1546-2"><a href="7.4-mod-07-nlme.html#cb1546-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Concentration (units)&quot;</span>,</span>
<span id="cb1546-3"><a href="7.4-mod-07-nlme.html#cb1546-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Reaction rate (units)&quot;</span>,</span>
<span id="cb1546-4"><a href="7.4-mod-07-nlme.html#cb1546-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>))</span>
<span id="cb1546-5"><a href="7.4-mod-07-nlme.html#cb1546-5" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x=</span><span class="fu">c</span>(dx2<span class="sc">$</span>conc, <span class="fu">rev</span>(dx2<span class="sc">$</span>conc)),</span>
<span id="cb1546-6"><a href="7.4-mod-07-nlme.html#cb1546-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="fu">c</span>(dx2<span class="sc">$</span>lo, <span class="fu">rev</span>(dx2<span class="sc">$</span>up)),</span>
<span id="cb1546-7"><a href="7.4-mod-07-nlme.html#cb1546-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="st">&quot;lightpink&quot;</span>)</span>
<span id="cb1546-8"><a href="7.4-mod-07-nlme.html#cb1546-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dx2<span class="sc">$</span>conc, dx2<span class="sc">$</span>mn, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red2&quot;</span>)</span>
<span id="cb1546-9"><a href="7.4-mod-07-nlme.html#cb1546-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nlev){</span>
<span id="cb1546-10"><a href="7.4-mod-07-nlme.html#cb1546-10" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> <span class="fu">which</span>(dx1<span class="sc">$</span>subs<span class="sc">==</span>i)</span>
<span id="cb1546-11"><a href="7.4-mod-07-nlme.html#cb1546-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(dx1<span class="sc">$</span>conc[flag], dx1<span class="sc">$</span>mn[flag],</span>
<span id="cb1546-12"><a href="7.4-mod-07-nlme.html#cb1546-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;grey40&quot;</span>)</span>
<span id="cb1546-13"><a href="7.4-mod-07-nlme.html#cb1546-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-695-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The plot shows the curves for individual substrates as thin lines, and the overall prediction with 95% CRI as a red line and shaded area. The highlighted curve and CRI is the expectation for any level of the random effect factor not in the original dataset. In other words, it is what the model predicts given the variability in the levels of the random factor that have already been observed. The ability to make robust predictions about unobserved levels of the random factor is one of the biggest advantages of mixed models.</p>
</div>
<div id="nlme-on-real-data" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> NLME on real data</h3>
<p><span class="citation">Kirchman et al. (<a href="#ref-kirchman2009microbial" role="doc-biblioref">2009</a>)</span> investigated the role of temperature and organic carbon availability on growth and secondary production by heterotrophic bacteria in the oceans. Heterotrophic bacteria are key components of marine food webs and can exert enormous control over ecosystem cycling of nutrients. The figure below shows the place of heterotrophic bacteria in the marine “microbial loop” that relates dissolved CO2 and dissolved organic carbon (DOC) <span class="citation">(<a href="#ref-kirchman2009microbial" role="doc-biblioref">Kirchman et al. 2009</a>)</span>.</p>
<p><img src="C:/Users/ngreen62/OneDrive%20-%20Kennesaw%20State%20University/biol%206490/_stat/fig/07_02.jpg" /></p>
<p>To better understand how these bacteria affect ocean ecosystems, the authors examined bacterial growth (d<sup>-1</sup>) and productivity (mmol C m<sup>-2</sup> d<sup>-1</sup>) varied with latitude (<span class="math inline">\(^\circ\)</span>N or <span class="math inline">\(^\circ\)</span>S), nutrient availability (<span class="math inline">\(\mu\)</span>M C), and mean annual temperature (<span class="math inline">\(^\circ\)</span>C). We will re-examine part of their dataset to practice using nonlinear mixed effects models. The data are stored in this <a href="https://greenquanteco.github.io/kirchman_data_2021-10-21.csv">text file</a>. Download this file and save it to your R working directory.</p>
<div class="sourceCode" id="cb1547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1547-1"><a href="7.4-mod-07-nlme.html#cb1547-1" aria-hidden="true" tabindex="-1"></a>in.name <span class="ot">&lt;-</span> <span class="st">&quot;kirchman_data_2021-10-21.csv&quot;</span></span>
<span id="cb1547-2"><a href="7.4-mod-07-nlme.html#cb1547-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(in.name, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>As usual, we start by exploring the distributions of the variables and a basic scatterplot.</p>
<div class="sourceCode" id="cb1548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1548-1"><a href="7.4-mod-07-nlme.html#cb1548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb1548-2"><a href="7.4-mod-07-nlme.html#cb1548-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>temp)</span>
<span id="cb1548-3"><a href="7.4-mod-07-nlme.html#cb1548-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>prod)</span>
<span id="cb1548-4"><a href="7.4-mod-07-nlme.html#cb1548-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>temp, dat<span class="sc">$</span>prod)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-697-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The figure suggests that the response variable, productivity (<code>prod</code>), is right-skewed. So, it might benefit from a log transform. The scatterplot backs this up—notice the “dust bunny” in the lower right. It’s not clear whether or not the predictor variable temperature (<code>temp</code>) needs to be transformed. Let’s leave it alone for now.</p>
<p>Make a log-transformed version of productivity and a new set of exploratory figures. We’ll use <span class="math inline">\(log_{10}\)</span> to save ourselves some trouble later.</p>
<div class="sourceCode" id="cb1549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1549-1"><a href="7.4-mod-07-nlme.html#cb1549-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>logy <span class="ot">&lt;-</span> <span class="fu">log10</span>(dat<span class="sc">$</span>prod)</span>
<span id="cb1549-2"><a href="7.4-mod-07-nlme.html#cb1549-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1549-3"><a href="7.4-mod-07-nlme.html#cb1549-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb1549-4"><a href="7.4-mod-07-nlme.html#cb1549-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>temp)</span>
<span id="cb1549-5"><a href="7.4-mod-07-nlme.html#cb1549-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>logy)</span>
<span id="cb1549-6"><a href="7.4-mod-07-nlme.html#cb1549-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>temp, dat<span class="sc">$</span>logy)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-698-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>There appears to be a nonlinear relationship between log-transformed productivity and temperature. The values start small and increase quickly until about 2 <span class="math inline">\(^\circ\)</span>C, after which the productivity levels off. Can you think of a biological interpretation of this curve shape?</p>
<p>There seem to be some distinct clumps in the scatterplot which might correspond to the grouping variable sea. Let’s add some colors to the dataset and then to the plot. Just for fun, let’s make a color ramp from colder to warmer sites.</p>
<div class="sourceCode" id="cb1550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1550-1"><a href="7.4-mod-07-nlme.html#cb1550-1" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(temp<span class="sc">~</span>sea, <span class="at">data=</span>dat, median)</span>
<span id="cb1550-2"><a href="7.4-mod-07-nlme.html#cb1550-2" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> agg[<span class="fu">order</span>(agg<span class="sc">$</span>temp),]</span>
<span id="cb1550-3"><a href="7.4-mod-07-nlme.html#cb1550-3" aria-hidden="true" tabindex="-1"></a>nsea <span class="ot">&lt;-</span> <span class="fu">nrow</span>(agg)</span>
<span id="cb1550-4"><a href="7.4-mod-07-nlme.html#cb1550-4" aria-hidden="true" tabindex="-1"></a>seas <span class="ot">&lt;-</span> agg<span class="sc">$</span>sea</span>
<span id="cb1550-5"><a href="7.4-mod-07-nlme.html#cb1550-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1550-6"><a href="7.4-mod-07-nlme.html#cb1550-6" aria-hidden="true" tabindex="-1"></a><span class="co"># color ramp from colder (blue) to warmer (red)</span></span>
<span id="cb1550-7"><a href="7.4-mod-07-nlme.html#cb1550-7" aria-hidden="true" tabindex="-1"></a>col.fun <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb1550-8"><a href="7.4-mod-07-nlme.html#cb1550-8" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">col.fun</span>(nsea)</span>
<span id="cb1550-9"><a href="7.4-mod-07-nlme.html#cb1550-9" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>col <span class="ot">&lt;-</span> cols</span>
<span id="cb1550-10"><a href="7.4-mod-07-nlme.html#cb1550-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1550-11"><a href="7.4-mod-07-nlme.html#cb1550-11" aria-hidden="true" tabindex="-1"></a>matchx <span class="ot">&lt;-</span> <span class="fu">match</span>(dat<span class="sc">$</span>sea, agg<span class="sc">$</span>sea)</span>
<span id="cb1550-12"><a href="7.4-mod-07-nlme.html#cb1550-12" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>col <span class="ot">&lt;-</span> agg<span class="sc">$</span>col[matchx]</span>
<span id="cb1550-13"><a href="7.4-mod-07-nlme.html#cb1550-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1550-14"><a href="7.4-mod-07-nlme.html#cb1550-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb1550-15"><a href="7.4-mod-07-nlme.html#cb1550-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>temp, dat<span class="sc">$</span>logy,</span>
<span id="cb1550-16"><a href="7.4-mod-07-nlme.html#cb1550-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>dat<span class="sc">$</span>col, <span class="at">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb1550-17"><a href="7.4-mod-07-nlme.html#cb1550-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span>seas,</span>
<span id="cb1550-18"><a href="7.4-mod-07-nlme.html#cb1550-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-699-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As nice as the color ramp effect is, the seas are still hard to tell apart. Let’s add some shapes as well.</p>
<div class="sourceCode" id="cb1551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1551-1"><a href="7.4-mod-07-nlme.html#cb1551-1" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>shp <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">17</span></span>
<span id="cb1551-2"><a href="7.4-mod-07-nlme.html#cb1551-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>shp <span class="ot">&lt;-</span> agg<span class="sc">$</span>shp[matchx]</span>
<span id="cb1551-3"><a href="7.4-mod-07-nlme.html#cb1551-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1551-4"><a href="7.4-mod-07-nlme.html#cb1551-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb1551-5"><a href="7.4-mod-07-nlme.html#cb1551-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>temp, dat<span class="sc">$</span>logy,</span>
<span id="cb1551-6"><a href="7.4-mod-07-nlme.html#cb1551-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span>dat<span class="sc">$</span>shp, <span class="at">col=</span>dat<span class="sc">$</span>col, <span class="at">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb1551-7"><a href="7.4-mod-07-nlme.html#cb1551-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span>seas,</span>
<span id="cb1551-8"><a href="7.4-mod-07-nlme.html#cb1551-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span>agg<span class="sc">$</span>shp, <span class="at">col=</span>cols, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-700-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>There appears to be an effect of temperature and possibly of sea. Biologically, the bacteria within a sea are probably more similar to each other than they are to bacteria in other seas. So, we should expect there to be some effect of sea just based on genetic relatedness or some other kind of similarity. However, we want a model that is applicable to all seas, not just the 6 in this dataset. For example, this dataset is missing the Indian Ocean, the Mediterranean, the Caribbean, the Sea of Japan, and many others. So, we need a nonlinear <em>mixed model</em>. We don’t know exactly what curve to use, so we’ll try a few. The table below shows the equations for each model.</p>
<table>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Function</th>
<th>Fixed effects</th>
<th>Random effects</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Monod, random <em>a</em></td>
<td><span class="math inline">\(\mu_i=\frac{a_jx_i}{b+x_i}\)</span></td>
<td><span class="math inline">\(a_j \sim Normal\left(\mu_a,\sigma_a^2\right)\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Monod, random <em>b</em></td>
<td><span class="math inline">\(\mu_i=\frac{ax_i}{b_j+x_i}\)</span></td>
<td><span class="math inline">\(b_j \sim Normal\left(\mu_b,\sigma_b^2\right)\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Monod, random <em>a</em> and <em>b</em></td>
<td><span class="math inline">\(\mu_i=\frac{a_jx_i}{b_j+x_i}\)</span></td>
<td><span class="math inline">\(a_j \sim Normal\left(\mu_a,\sigma_a^2\right)\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><span class="math inline">\(b_j \sim Normal\left(\mu_b,\sigma_b^2\right)\)</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td>Holling type III, random <em>a</em></td>
<td><span class="math inline">\(\mu_i=\frac{a_jx_i^2}{b^2+x_i^2}\)</span></td>
<td><span class="math inline">\(a_j \sim Normal\left(\mu_a,\sigma_a^2\right)\)</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>Holling type III, random <em>b</em></td>
<td><span class="math inline">\(\mu_i=\frac{ax_i^2}{b_j^2+x_i^2}\)</span></td>
<td><span class="math inline">\(b_j \sim Normal\left(\mu_b,\sigma_b^2\right)\)</span></td>
</tr>
<tr class="odd">
<td>6</td>
<td>Holling type III, random <em>a</em> and <em>b</em></td>
<td><span class="math inline">\(\mu_i=\frac{a_jx_i^2}{b^2+x_i^2}\)</span></td>
<td><span class="math inline">\(a_j \sim Normal\left(\mu_a,\sigma_a^2\right)\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><span class="math inline">\(b_j \sim Normal\left(\mu_b,\sigma_b^2\right)\)</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>Monomolecular, random <em>a</em></td>
<td><span class="math inline">\(\mu_i=a_j\left(1-e^{-bx}\right)\)</span></td>
<td><span class="math inline">\(a_j \sim Normal\left(\mu_a,\sigma_a^2\right)\)</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>Monomolecular, random <em>b</em></td>
<td><span class="math inline">\(\mu_i=a\left(1-e^{-b_jx}\right)\)</span></td>
<td><span class="math inline">\(b_j \sim Normal\left(\mu_b,\sigma_b^2\right)\)</span></td>
</tr>
<tr class="odd">
<td>9</td>
<td>Monomolecular, random <em>a</em> and <em>b</em></td>
<td><span class="math inline">\(\mu_i=a_j\left(1-e^{-b_jx}\right)\)</span></td>
<td><span class="math inline">\(a_j \sim Normal\left(\mu_a,\sigma_a^2\right)\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><span class="math inline">\(b_j \sim Normal\left(\mu_b,\sigma_b^2\right)\)</span></td>
</tr>
</tbody>
</table>
<p>Fitting the <strong>Monod (aka: Michaelis-Menten)</strong> model with mixed effects is simple, because there is a self-start version of the function designed for nonlinear modeling (we’ve used it before). We just need to remember to supply reasonable starting values.</p>
<div class="sourceCode" id="cb1552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1552-1"><a href="7.4-mod-07-nlme.html#cb1552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1552-2"><a href="7.4-mod-07-nlme.html#cb1552-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Monod (aka: Michaelis-Menten) with</span></span>
<span id="cb1552-3"><a href="7.4-mod-07-nlme.html#cb1552-3" aria-hidden="true" tabindex="-1"></a><span class="co"># different random structures</span></span>
<span id="cb1552-4"><a href="7.4-mod-07-nlme.html#cb1552-4" aria-hidden="true" tabindex="-1"></a>startvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a=</span><span class="fl">1.3</span>, <span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb1552-5"><a href="7.4-mod-07-nlme.html#cb1552-5" aria-hidden="true" tabindex="-1"></a>mod01 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">SSmicmen</span>(temp, a, b)<span class="sc">~</span>a<span class="sc">|</span>sea,</span>
<span id="cb1552-6"><a href="7.4-mod-07-nlme.html#cb1552-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span>
<span id="cb1552-7"><a href="7.4-mod-07-nlme.html#cb1552-7" aria-hidden="true" tabindex="-1"></a>mod02 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">SSmicmen</span>(temp, a, b)<span class="sc">~</span>b<span class="sc">|</span>sea,</span>
<span id="cb1552-8"><a href="7.4-mod-07-nlme.html#cb1552-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span>
<span id="cb1552-9"><a href="7.4-mod-07-nlme.html#cb1552-9" aria-hidden="true" tabindex="-1"></a>mod03 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">SSmicmen</span>(temp, a, b)<span class="sc">~</span>(a<span class="sc">|</span>sea)<span class="sc">+</span>(b<span class="sc">|</span>sea),</span>
<span id="cb1552-10"><a href="7.4-mod-07-nlme.html#cb1552-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span></code></pre></div>
<p>The other two curves are less simple to fit because there is no self-start model available. In <code>nlmer()</code>, the fixed part of the model needs to be provided as a special type of function that takes in input values and parameter values, and outputs a vector of response values. Additionally, the function needs to have some internal attributes that let <code>nlmer()</code> evaluate its likelihood function and how the likelihood function changes. The procedure below seems to work well.</p>
<div class="sourceCode" id="cb1553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1553-1"><a href="7.4-mod-07-nlme.html#cb1553-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Holling type III (Bolker 2008 p. 92)</span></span>
<span id="cb1553-2"><a href="7.4-mod-07-nlme.html#cb1553-2" aria-hidden="true" tabindex="-1"></a>startvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a=</span><span class="fl">1.3</span>, <span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb1553-3"><a href="7.4-mod-07-nlme.html#cb1553-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1553-4"><a href="7.4-mod-07-nlme.html#cb1553-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define model as function</span></span>
<span id="cb1553-5"><a href="7.4-mod-07-nlme.html#cb1553-5" aria-hidden="true" tabindex="-1"></a>holl <span class="ot">&lt;-</span> <span class="er">~</span>(a<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(b<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1553-6"><a href="7.4-mod-07-nlme.html#cb1553-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1553-7"><a href="7.4-mod-07-nlme.html#cb1553-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare version of function for nlmer()</span></span>
<span id="cb1553-8"><a href="7.4-mod-07-nlme.html#cb1553-8" aria-hidden="true" tabindex="-1"></a>hollfun <span class="ot">&lt;-</span> <span class="fu">deriv</span>(holl, <span class="at">namevec=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb1553-9"><a href="7.4-mod-07-nlme.html#cb1553-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">function.arg=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))</span>
<span id="cb1553-10"><a href="7.4-mod-07-nlme.html#cb1553-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1553-11"><a href="7.4-mod-07-nlme.html#cb1553-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb1553-12"><a href="7.4-mod-07-nlme.html#cb1553-12" aria-hidden="true" tabindex="-1"></a>mod04 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">hollfun</span>(temp, a, b)<span class="sc">~</span>a<span class="sc">|</span>sea,</span>
<span id="cb1553-13"><a href="7.4-mod-07-nlme.html#cb1553-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span>
<span id="cb1553-14"><a href="7.4-mod-07-nlme.html#cb1553-14" aria-hidden="true" tabindex="-1"></a>mod05 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">hollfun</span>(temp, a, b)<span class="sc">~</span>b<span class="sc">|</span>sea,</span>
<span id="cb1553-15"><a href="7.4-mod-07-nlme.html#cb1553-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span></code></pre></div>
<pre><code>## Warning in (function (fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, :
## failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in optwrap(control$optimizer[[1]], devfun, rho$pp$theta, lower =
## rho$lower, : convergence code 4 from Nelder_Mead: failure to converge in 10000
## evaluations</code></pre>
<pre><code>## Error in fn(nM$xeval()): prss{Update} failed to converge in &#39;maxit&#39; iterations</code></pre>
<div class="sourceCode" id="cb1557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1557-1"><a href="7.4-mod-07-nlme.html#cb1557-1" aria-hidden="true" tabindex="-1"></a>mod06 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">hollfun</span>(temp, a, b)<span class="sc">~</span>(a<span class="sc">|</span>sea)<span class="sc">+</span>(b<span class="sc">|</span>sea),</span>
<span id="cb1557-2"><a href="7.4-mod-07-nlme.html#cb1557-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span></code></pre></div>
<pre><code>## Error in fn(nM$xeval()): prss{Update} failed to converge in &#39;maxit&#39; iterations</code></pre>
<div class="sourceCode" id="cb1559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1559-1"><a href="7.4-mod-07-nlme.html#cb1559-1" aria-hidden="true" tabindex="-1"></a><span class="co"># monomolecular (Bolker p. 95)</span></span>
<span id="cb1559-2"><a href="7.4-mod-07-nlme.html#cb1559-2" aria-hidden="true" tabindex="-1"></a><span class="co"># special case of von Bertalanffy curve</span></span>
<span id="cb1559-3"><a href="7.4-mod-07-nlme.html#cb1559-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1559-4"><a href="7.4-mod-07-nlme.html#cb1559-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define model as function</span></span>
<span id="cb1559-5"><a href="7.4-mod-07-nlme.html#cb1559-5" aria-hidden="true" tabindex="-1"></a>mono <span class="ot">&lt;-</span> <span class="er">~</span>a<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">*</span>x))</span>
<span id="cb1559-6"><a href="7.4-mod-07-nlme.html#cb1559-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1559-7"><a href="7.4-mod-07-nlme.html#cb1559-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare version of function for nlmer()</span></span>
<span id="cb1559-8"><a href="7.4-mod-07-nlme.html#cb1559-8" aria-hidden="true" tabindex="-1"></a>monofun <span class="ot">&lt;-</span> <span class="fu">deriv</span>(mono, <span class="at">namevec=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), </span>
<span id="cb1559-9"><a href="7.4-mod-07-nlme.html#cb1559-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">function.arg=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))</span>
<span id="cb1559-10"><a href="7.4-mod-07-nlme.html#cb1559-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1559-11"><a href="7.4-mod-07-nlme.html#cb1559-11" aria-hidden="true" tabindex="-1"></a>mod07 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">monofun</span>(temp, a, b)<span class="sc">~</span>a<span class="sc">|</span>sea,</span>
<span id="cb1559-12"><a href="7.4-mod-07-nlme.html#cb1559-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span>
<span id="cb1559-13"><a href="7.4-mod-07-nlme.html#cb1559-13" aria-hidden="true" tabindex="-1"></a>mod08 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">monofun</span>(temp, a, b)<span class="sc">~</span>b<span class="sc">|</span>sea,</span>
<span id="cb1559-14"><a href="7.4-mod-07-nlme.html#cb1559-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span>
<span id="cb1559-15"><a href="7.4-mod-07-nlme.html#cb1559-15" aria-hidden="true" tabindex="-1"></a>mod09 <span class="ot">&lt;-</span> <span class="fu">nlmer</span>(logy<span class="sc">~</span><span class="fu">monofun</span>(temp, a, b)<span class="sc">~</span>(a<span class="sc">|</span>sea)<span class="sc">+</span>(b<span class="sc">|</span>sea),</span>
<span id="cb1559-16"><a href="7.4-mod-07-nlme.html#cb1559-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>dat, <span class="at">start=</span>startvec)</span></code></pre></div>
<p>R was not able to find solutions for models 5 and 6, so we can discard those. Let’s examine the outputs of the models that did fit. First, we can use AIC to get a sense of which models might have worked best:</p>
<div class="sourceCode" id="cb1560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1560-1"><a href="7.4-mod-07-nlme.html#cb1560-1" aria-hidden="true" tabindex="-1"></a>aic.df <span class="ot">&lt;-</span> <span class="fu">AIC</span>(mod01, mod02, mod03, mod04, mod07, mod08, mod09)</span>
<span id="cb1560-2"><a href="7.4-mod-07-nlme.html#cb1560-2" aria-hidden="true" tabindex="-1"></a>aic.df<span class="sc">$</span>delta <span class="ot">&lt;-</span> aic.df<span class="sc">$</span>AIC <span class="sc">-</span> <span class="fu">min</span>(aic.df<span class="sc">$</span>AIC)</span>
<span id="cb1560-3"><a href="7.4-mod-07-nlme.html#cb1560-3" aria-hidden="true" tabindex="-1"></a>aic.df<span class="sc">$</span>wt <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>aic.df<span class="sc">$</span>delta)</span>
<span id="cb1560-4"><a href="7.4-mod-07-nlme.html#cb1560-4" aria-hidden="true" tabindex="-1"></a>aic.df<span class="sc">$</span>wt <span class="ot">&lt;-</span> aic.df<span class="sc">$</span>wt<span class="sc">/</span><span class="fu">sum</span>(aic.df<span class="sc">$</span>wt)</span>
<span id="cb1560-5"><a href="7.4-mod-07-nlme.html#cb1560-5" aria-hidden="true" tabindex="-1"></a>aic.df <span class="ot">&lt;-</span> aic.df[<span class="fu">order</span>(<span class="sc">-</span>aic.df<span class="sc">$</span>wt),]</span>
<span id="cb1560-6"><a href="7.4-mod-07-nlme.html#cb1560-6" aria-hidden="true" tabindex="-1"></a>aic.df</span></code></pre></div>
<pre><code>##       df      AIC      delta           wt
## mod08  4 105.4030   0.000000 6.545609e-01
## mod09  5 107.4030   1.999977 2.408023e-01
## mod07  4 109.0699   3.666938 1.046368e-01
## mod04  4 156.6238  51.220848 4.937240e-12
## mod01  4 164.5428  59.139802 9.416842e-14
## mod03  5 166.5428  61.139802 3.464263e-14
## mod02  4 376.3158 270.912825 9.726972e-60</code></pre>
<p>The AICs suggest that model 8 is the best-fitting. This was the monomolecular curve with the growth constant (<em>b</em>) varying by sea. The Monod functions were the worst fitting (by AIC); and the only Holling curve that fit was somewhere in the middle.
Let’s generate and plot model predictions as usual. We’ll have to calculate the predictions manually because the <code>predict()</code> method for <code>nlmer()</code> objects is not well documented.</p>
<div class="sourceCode" id="cb1562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1562-1"><a href="7.4-mod-07-nlme.html#cb1562-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of points and x values</span></span>
<span id="cb1562-2"><a href="7.4-mod-07-nlme.html#cb1562-2" aria-hidden="true" tabindex="-1"></a>pn <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1562-3"><a href="7.4-mod-07-nlme.html#cb1562-3" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(dat<span class="sc">$</span>temp), <span class="fu">max</span>(dat<span class="sc">$</span>temp), <span class="at">length=</span>pn)</span>
<span id="cb1562-4"><a href="7.4-mod-07-nlme.html#cb1562-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1562-5"><a href="7.4-mod-07-nlme.html#cb1562-5" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions by level (sea)</span></span>
<span id="cb1562-6"><a href="7.4-mod-07-nlme.html#cb1562-6" aria-hidden="true" tabindex="-1"></a>dx1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sea=</span>seas, <span class="at">temp=</span>px)</span>
<span id="cb1562-7"><a href="7.4-mod-07-nlme.html#cb1562-7" aria-hidden="true" tabindex="-1"></a>dx1 <span class="ot">&lt;-</span> dx1[<span class="fu">order</span>(dx1<span class="sc">$</span>sea, dx1<span class="sc">$</span>temp),]</span>
<span id="cb1562-8"><a href="7.4-mod-07-nlme.html#cb1562-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1562-9"><a href="7.4-mod-07-nlme.html#cb1562-9" aria-hidden="true" tabindex="-1"></a><span class="do">## coefficients table (including random b)</span></span>
<span id="cb1562-10"><a href="7.4-mod-07-nlme.html#cb1562-10" aria-hidden="true" tabindex="-1"></a>cofs <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod08)<span class="sc">$</span>sea</span>
<span id="cb1562-11"><a href="7.4-mod-07-nlme.html#cb1562-11" aria-hidden="true" tabindex="-1"></a>matchx <span class="ot">&lt;-</span> <span class="fu">match</span>(dx1<span class="sc">$</span>sea, <span class="fu">rownames</span>(cofs))</span>
<span id="cb1562-12"><a href="7.4-mod-07-nlme.html#cb1562-12" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>a <span class="ot">&lt;-</span> cofs<span class="sc">$</span>a[matchx]</span>
<span id="cb1562-13"><a href="7.4-mod-07-nlme.html#cb1562-13" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>b <span class="ot">&lt;-</span> cofs<span class="sc">$</span>b[matchx]</span>
<span id="cb1562-14"><a href="7.4-mod-07-nlme.html#cb1562-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1562-15"><a href="7.4-mod-07-nlme.html#cb1562-15" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate predictions</span></span>
<span id="cb1562-16"><a href="7.4-mod-07-nlme.html#cb1562-16" aria-hidden="true" tabindex="-1"></a>dx1<span class="sc">$</span>y <span class="ot">&lt;-</span> dx1<span class="sc">$</span>a<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>dx1<span class="sc">$</span>b<span class="sc">*</span>dx1<span class="sc">$</span>temp))</span>
<span id="cb1562-17"><a href="7.4-mod-07-nlme.html#cb1562-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1562-18"><a href="7.4-mod-07-nlme.html#cb1562-18" aria-hidden="true" tabindex="-1"></a><span class="co"># prediction of overall mean (applicable to other seas)</span></span>
<span id="cb1562-19"><a href="7.4-mod-07-nlme.html#cb1562-19" aria-hidden="true" tabindex="-1"></a>dx2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">temp=</span>px)</span>
<span id="cb1562-20"><a href="7.4-mod-07-nlme.html#cb1562-20" aria-hidden="true" tabindex="-1"></a>fixe <span class="ot">&lt;-</span> <span class="fu">fixef</span>(mod08)</span>
<span id="cb1562-21"><a href="7.4-mod-07-nlme.html#cb1562-21" aria-hidden="true" tabindex="-1"></a>dx2<span class="sc">$</span>y <span class="ot">&lt;-</span> fixe[<span class="st">&quot;a&quot;</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>fixe[<span class="st">&quot;b&quot;</span>]<span class="sc">*</span>dx2<span class="sc">$</span>temp))</span></code></pre></div>
<p>Now we can assemble a few pieces and make our nice plot.</p>
<div class="sourceCode" id="cb1563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1563-1"><a href="7.4-mod-07-nlme.html#cb1563-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 40% opacity (alpha) to the colors for</span></span>
<span id="cb1563-2"><a href="7.4-mod-07-nlme.html#cb1563-2" aria-hidden="true" tabindex="-1"></a><span class="co"># clearer plot (pun intended)</span></span>
<span id="cb1563-3"><a href="7.4-mod-07-nlme.html#cb1563-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>col2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dat<span class="sc">$</span>col, <span class="st">&quot;40&quot;</span>)</span>
<span id="cb1563-4"><a href="7.4-mod-07-nlme.html#cb1563-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-5"><a href="7.4-mod-07-nlme.html#cb1563-5" aria-hidden="true" tabindex="-1"></a><span class="co"># nicer version of names for legend</span></span>
<span id="cb1563-6"><a href="7.4-mod-07-nlme.html#cb1563-6" aria-hidden="true" tabindex="-1"></a>leg.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1563-7"><a href="7.4-mod-07-nlme.html#cb1563-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Ross Sea&quot;</span>, <span class="st">&quot;Western Arctic&quot;</span>,</span>
<span id="cb1563-8"><a href="7.4-mod-07-nlme.html#cb1563-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Subarctic Pacific&quot;</span>, <span class="st">&quot;North Atlantic&quot;</span>,</span>
<span id="cb1563-9"><a href="7.4-mod-07-nlme.html#cb1563-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Arabian Sea&quot;</span>, <span class="st">&quot;Equatorial Pacific&quot;</span>)</span>
<span id="cb1563-10"><a href="7.4-mod-07-nlme.html#cb1563-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-11"><a href="7.4-mod-07-nlme.html#cb1563-11" aria-hidden="true" tabindex="-1"></a><span class="co"># graphical parameters for attractive plot</span></span>
<span id="cb1563-12"><a href="7.4-mod-07-nlme.html#cb1563-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb1563-13"><a href="7.4-mod-07-nlme.html#cb1563-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb1563-14"><a href="7.4-mod-07-nlme.html#cb1563-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.3</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>)</span>
<span id="cb1563-15"><a href="7.4-mod-07-nlme.html#cb1563-15" aria-hidden="true" tabindex="-1"></a><span class="co"># set up plot area</span></span>
<span id="cb1563-16"><a href="7.4-mod-07-nlme.html#cb1563-16" aria-hidden="true" tabindex="-1"></a><span class="do">## note expression() used for proper axis labels</span></span>
<span id="cb1563-17"><a href="7.4-mod-07-nlme.html#cb1563-17" aria-hidden="true" tabindex="-1"></a><span class="do">## and y axis suppressed (yaxt=&quot;n&quot;) so a better </span></span>
<span id="cb1563-18"><a href="7.4-mod-07-nlme.html#cb1563-18" aria-hidden="true" tabindex="-1"></a><span class="do">## y axis can be added manually</span></span>
<span id="cb1563-19"><a href="7.4-mod-07-nlme.html#cb1563-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>temp, dat<span class="sc">$</span>logy, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1563-20"><a href="7.4-mod-07-nlme.html#cb1563-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb1563-21"><a href="7.4-mod-07-nlme.html#cb1563-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="fu">expression</span>(Productivity<span class="sc">~</span>(mmol<span class="sc">~</span>C<span class="sc">~</span>m<span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}<span class="sc">~</span>d<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})),</span>
<span id="cb1563-22"><a href="7.4-mod-07-nlme.html#cb1563-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb1563-23"><a href="7.4-mod-07-nlme.html#cb1563-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">2</span>))</span>
<span id="cb1563-24"><a href="7.4-mod-07-nlme.html#cb1563-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-25"><a href="7.4-mod-07-nlme.html#cb1563-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add sea-specific lines in a loop</span></span>
<span id="cb1563-26"><a href="7.4-mod-07-nlme.html#cb1563-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsea){</span>
<span id="cb1563-27"><a href="7.4-mod-07-nlme.html#cb1563-27" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> <span class="fu">which</span>(dx1<span class="sc">$</span>sea <span class="sc">==</span> seas[i])</span>
<span id="cb1563-28"><a href="7.4-mod-07-nlme.html#cb1563-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(dx1<span class="sc">$</span>temp[flag], dx1<span class="sc">$</span>y[flag],</span>
<span id="cb1563-29"><a href="7.4-mod-07-nlme.html#cb1563-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;grey60&quot;</span>)</span>
<span id="cb1563-30"><a href="7.4-mod-07-nlme.html#cb1563-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1563-31"><a href="7.4-mod-07-nlme.html#cb1563-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-32"><a href="7.4-mod-07-nlme.html#cb1563-32" aria-hidden="true" tabindex="-1"></a><span class="co"># add fixed effect line</span></span>
<span id="cb1563-33"><a href="7.4-mod-07-nlme.html#cb1563-33" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dx2<span class="sc">$</span>temp, dx2<span class="sc">$</span>y, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb1563-34"><a href="7.4-mod-07-nlme.html#cb1563-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-35"><a href="7.4-mod-07-nlme.html#cb1563-35" aria-hidden="true" tabindex="-1"></a><span class="co"># original data, with semi-transparent colors</span></span>
<span id="cb1563-36"><a href="7.4-mod-07-nlme.html#cb1563-36" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dat<span class="sc">$</span>temp, dat<span class="sc">$</span>logy,</span>
<span id="cb1563-37"><a href="7.4-mod-07-nlme.html#cb1563-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span>dat<span class="sc">$</span>shp, <span class="at">col=</span>dat<span class="sc">$</span>col2, <span class="at">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb1563-38"><a href="7.4-mod-07-nlme.html#cb1563-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-39"><a href="7.4-mod-07-nlme.html#cb1563-39" aria-hidden="true" tabindex="-1"></a><span class="co"># fancy y axis with logarithmic tick marks</span></span>
<span id="cb1563-40"><a href="7.4-mod-07-nlme.html#cb1563-40" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="at">by=</span><span class="dv">1</span>),</span>
<span id="cb1563-41"><a href="7.4-mod-07-nlme.html#cb1563-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>))</span>
<span id="cb1563-42"><a href="7.4-mod-07-nlme.html#cb1563-42" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span><span class="sc">*</span><span class="dv">10</span>)),</span>
<span id="cb1563-43"><a href="7.4-mod-07-nlme.html#cb1563-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="cn">NA</span>, <span class="at">tcl=</span><span class="sc">-</span><span class="fl">0.25</span>)</span>
<span id="cb1563-44"><a href="7.4-mod-07-nlme.html#cb1563-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-45"><a href="7.4-mod-07-nlme.html#cb1563-45" aria-hidden="true" tabindex="-1"></a><span class="co"># legend</span></span>
<span id="cb1563-46"><a href="7.4-mod-07-nlme.html#cb1563-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span>leg.labs, <span class="at">pch=</span>agg<span class="sc">$</span>shp,</span>
<span id="cb1563-47"><a href="7.4-mod-07-nlme.html#cb1563-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">paste0</span>(cols, <span class="st">&quot;40&quot;</span>), <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-705-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<h3>Literature Cited</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-kirchman2009microbial" class="csl-entry">
Kirchman, D. L., X. A. G. Morán, and H. Ducklow. 2009. Microbial growth in the polar oceans—role of temperature and potential impact of climate change. Nature <span>R</span>eviews <span>M</span>icrobiology 7:451–459.
</div>
<div id="ref-plummer2003jags" class="csl-entry">
Plummer, M. 2003. <span>JAGS</span>: A program for analysis of <span>B</span>ayesian graphical models using <span>G</span>ibbs sampling. Pages 1–10 Proceedings of the 3rd international workshop on distributed statistical computing. Vienna, Austria.
</div>
<div id="ref-plummer2021" class="csl-entry">
Plummer, M. 2021. <a href="https://CRAN.R-project.org/package=rjags"><span class="nocase">r</span>jags: <span>B</span>ayesian graphical models using <span>MCMC</span></a>.
</div>
<div id="ref-su2021" class="csl-entry">
Su, Y.-S., and Masanao Yajima. 2021. <a href="https://CRAN.R-project.org/package=R2jags"><span>R2</span>jags: Using <span>R</span> to run ’<span>JAGS</span>’</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7.3-mod-07-glmm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="7.5-mod-07-gamm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
