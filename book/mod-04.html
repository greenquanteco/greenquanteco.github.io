<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 4 Exploratory data analysis 1: Data description and summarization | Applied Biological Data Analysis: Statistics and R for Biologists</title>
  <meta name="description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 4 Exploratory data analysis 1: Data description and summarization | Applied Biological Data Analysis: Statistics and R for Biologists" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://greenquanteco.github.io/book/lab_logo_02.jpg" />
  <meta property="og:description" content="Helping biologists to become more informed users of R and statistical methods." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 4 Exploratory data analysis 1: Data description and summarization | Applied Biological Data Analysis: Statistics and R for Biologists" />
  
  <meta name="twitter:description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="twitter:image" content="https://greenquanteco.github.io/book/lab_logo_02.jpg" />

<meta name="author" content="Nick Green, Kennesaw State University" />


<meta name="date" content="2022-08-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="fav.ico" type="image/x-icon" />
<link rel="prev" href="mod-03.html"/>
<link rel="next" href="mod-05.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied biological data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-permissions"><i class="fa fa-check"></i>License and permissions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i>Course objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-requirements"><i class="fa fa-check"></i>Course requirements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-reading"><i class="fa fa-check"></i>Recommended reading</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-organization"><i class="fa fa-check"></i>Course organization</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="mod-01.html"><a href="mod-01.html"><i class="fa fa-check"></i><b>1</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="mod-01.html"><a href="mod-01.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="mod-01.html"><a href="mod-01.html#statistics-in-modern-biology"><i class="fa fa-check"></i><b>1.2</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="mod-01.html"><a href="mod-01.html#the-scientific-method"><i class="fa fa-check"></i><b>1.2.1</b> The scientific method</a></li>
<li class="chapter" data-level="1.2.2" data-path="mod-01.html"><a href="mod-01.html#example-data-analysis"><i class="fa fa-check"></i><b>1.2.2</b> Example data analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="mod-01.html"><a href="mod-01.html#misuses-of-statistics"><i class="fa fa-check"></i><b>1.3</b> Misuses of statistics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="mod-01.html"><a href="mod-01.html#proving-the-trivial-and-meaningless-hypotheses"><i class="fa fa-check"></i><b>1.3.1</b> “Proving” the trivial and meaningless hypotheses</a></li>
<li class="chapter" data-level="1.3.2" data-path="mod-01.html"><a href="mod-01.html#inappropriate-methods"><i class="fa fa-check"></i><b>1.3.2</b> Inappropriate methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="mod-01.html"><a href="mod-01.html#p-hacking-and-data-dredging"><i class="fa fa-check"></i><b>1.3.3</b> <em>P</em>-hacking and data dredging</a></li>
<li class="chapter" data-level="1.3.4" data-path="mod-01.html"><a href="mod-01.html#inadequate-sample-sizes-and-pseudoreplication"><i class="fa fa-check"></i><b>1.3.4</b> Inadequate sample sizes and pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="mod-01.html"><a href="mod-01.html#mod-01-nhst"><i class="fa fa-check"></i><b>1.4</b> <em>P</em>-values and null hypothesis significance testing (NHST)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="mod-01.html"><a href="mod-01.html#definition"><i class="fa fa-check"></i><b>1.4.1</b> Definition</a></li>
<li class="chapter" data-level="1.4.2" data-path="mod-01.html"><a href="mod-01.html#aside-another-way-to-frame-null-hypotheses"><i class="fa fa-check"></i><b>1.4.2</b> Aside: Another way to frame null hypotheses</a></li>
<li class="chapter" data-level="1.4.3" data-path="mod-01.html"><a href="mod-01.html#history-and-status-of-p-values"><i class="fa fa-check"></i><b>1.4.3</b> History and status of <em>P</em>-values</a></li>
<li class="chapter" data-level="1.4.4" data-path="mod-01.html"><a href="mod-01.html#where-p-values-come-from"><i class="fa fa-check"></i><b>1.4.4</b> Where <em>P</em>-values come from</a></li>
<li class="chapter" data-level="1.4.5" data-path="mod-01.html"><a href="mod-01.html#what-p-values-mean-and-do-not-mean"><i class="fa fa-check"></i><b>1.4.5</b> What <em>P</em>-values mean and do not mean</a></li>
<li class="chapter" data-level="1.4.6" data-path="mod-01.html"><a href="mod-01.html#do-you-need-a-p-value"><i class="fa fa-check"></i><b>1.4.6</b> Do you need a <em>P</em>-value?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="mod-01.html"><a href="mod-01.html#alternatives-to-nhst"><i class="fa fa-check"></i><b>1.5</b> Alternatives to NHST</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="mod-01.html"><a href="mod-01.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.1</b> Bayesian inference</a></li>
<li class="chapter" data-level="1.5.2" data-path="mod-01.html"><a href="mod-01.html#information-theoretic-methods"><i class="fa fa-check"></i><b>1.5.2</b> Information-theoretic methods</a></li>
<li class="chapter" data-level="1.5.3" data-path="mod-01.html"><a href="mod-01.html#machine-learning"><i class="fa fa-check"></i><b>1.5.3</b> Machine learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mod-02.html"><a href="mod-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-02.html"><a href="mod-02.html#getting-started-with-r"><i class="fa fa-check"></i><b>2.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="mod-02.html"><a href="mod-02.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="mod-02.html"><a href="mod-02.html#advantages-of-r"><i class="fa fa-check"></i><b>2.1.2</b> Advantages of R</a></li>
<li class="chapter" data-level="2.1.3" data-path="mod-02.html"><a href="mod-02.html#disadvantages-of-r"><i class="fa fa-check"></i><b>2.1.3</b> Disadvantages of R</a></li>
<li class="chapter" data-level="2.1.4" data-path="mod-02.html"><a href="mod-02.html#base-r-and-vs.-tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Base R and (vs.?) <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="mod-02.html"><a href="mod-02.html#download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> Download and install R (and RStudio)</a></li>
<li class="chapter" data-level="2.3" data-path="mod-02.html"><a href="mod-02.html#using-r"><i class="fa fa-check"></i><b>2.3</b> Using R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="mod-02.html"><a href="mod-02.html#using-the-base-r-gui"><i class="fa fa-check"></i><b>2.3.1</b> Using the base R GUI</a></li>
<li class="chapter" data-level="2.3.2" data-path="mod-02.html"><a href="mod-02.html#using-r-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Using R in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="mod-02.html"><a href="mod-02.html#using-r-with-other-programs"><i class="fa fa-check"></i><b>2.3.3</b> Using R with other programs</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="mod-02.html"><a href="mod-02.html#mod-02-first"><i class="fa fa-check"></i><b>2.4</b> A first R session</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="mod-02.html"><a href="mod-02.html#import-data"><i class="fa fa-check"></i><b>2.4.1</b> Import data</a></li>
<li class="chapter" data-level="2.4.2" data-path="mod-02.html"><a href="mod-02.html#explore-and-visualize-data"><i class="fa fa-check"></i><b>2.4.2</b> Explore and visualize data</a></li>
<li class="chapter" data-level="2.4.3" data-path="mod-02.html"><a href="mod-02.html#transform-data"><i class="fa fa-check"></i><b>2.4.3</b> Transform data</a></li>
<li class="chapter" data-level="2.4.4" data-path="mod-02.html"><a href="mod-02.html#analyze-data"><i class="fa fa-check"></i><b>2.4.4</b> Analyze data</a></li>
<li class="chapter" data-level="2.4.5" data-path="mod-02.html"><a href="mod-02.html#write-out-results"><i class="fa fa-check"></i><b>2.4.5</b> Write out results</a></li>
<li class="chapter" data-level="2.4.6" data-path="mod-02.html"><a href="mod-02.html#save-your-work"><i class="fa fa-check"></i><b>2.4.6</b> Save your work?</a></li>
<li class="chapter" data-level="2.4.7" data-path="mod-02.html"><a href="mod-02.html#whats-next"><i class="fa fa-check"></i><b>2.4.7</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="mod-02.html"><a href="mod-02.html#write-and-execute-commands-in-the-r-console"><i class="fa fa-check"></i><b>2.5</b> Write and execute commands in the R console</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="mod-02.html"><a href="mod-02.html#r-commandsbasics"><i class="fa fa-check"></i><b>2.5.1</b> R commands–basics</a></li>
<li class="chapter" data-level="2.5.2" data-path="mod-02.html"><a href="mod-02.html#elements-of-r-code"><i class="fa fa-check"></i><b>2.5.2</b> Elements of R code</a></li>
<li class="chapter" data-level="2.5.3" data-path="mod-02.html"><a href="mod-02.html#the-r-workspace"><i class="fa fa-check"></i><b>2.5.3</b> The R workspace</a></li>
<li class="chapter" data-level="2.5.4" data-path="mod-02.html"><a href="mod-02.html#r-code-basics-assignment-and-operators"><i class="fa fa-check"></i><b>2.5.4</b> R code basics: assignment and operators</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="mod-02.html"><a href="mod-02.html#mod-02-struct"><i class="fa fa-check"></i><b>2.6</b> Basic R data structures</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-02.html"><a href="mod-02.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-02.html"><a href="mod-02.html#data-frames"><i class="fa fa-check"></i><b>2.6.2</b> Data frames</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-02.html"><a href="mod-02.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.6.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-02.html"><a href="mod-02.html#lists"><i class="fa fa-check"></i><b>2.6.4</b> Lists</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-02.html"><a href="mod-02.html#s3-s4-and-other-paradigms"><i class="fa fa-check"></i><b>2.6.5</b> S3, S4, and other paradigms</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-02.html"><a href="mod-02.html#r-data-types"><i class="fa fa-check"></i><b>2.7</b> R data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="mod-02.html"><a href="mod-02.html#character-type"><i class="fa fa-check"></i><b>2.7.1</b> Character type</a></li>
<li class="chapter" data-level="2.7.2" data-path="mod-02.html"><a href="mod-02.html#numeric-type"><i class="fa fa-check"></i><b>2.7.2</b> Numeric type</a></li>
<li class="chapter" data-level="2.7.3" data-path="mod-02.html"><a href="mod-02.html#integer-type"><i class="fa fa-check"></i><b>2.7.3</b> Integer type</a></li>
<li class="chapter" data-level="2.7.4" data-path="mod-02.html"><a href="mod-02.html#logical-type"><i class="fa fa-check"></i><b>2.7.4</b> Logical type</a></li>
<li class="chapter" data-level="2.7.5" data-path="mod-02.html"><a href="mod-02.html#special-values"><i class="fa fa-check"></i><b>2.7.5</b> Special values</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="mod-02.html"><a href="mod-02.html#manage-r-code-as-scripts-.r-files"><i class="fa fa-check"></i><b>2.8</b> Manage R code as scripts (.r files)</a></li>
<li class="chapter" data-level="2.9" data-path="mod-02.html"><a href="mod-02.html#manage-and-use-r-packages"><i class="fa fa-check"></i><b>2.9</b> Manage and use R packages</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-02.html"><a href="mod-02.html#your-r-library"><i class="fa fa-check"></i><b>2.9.1</b> Your R library</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-02.html"><a href="mod-02.html#installing-packages-using-the-r-gui"><i class="fa fa-check"></i><b>2.9.2</b> Installing packages using the R GUI</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-02.html"><a href="mod-02.html#installing-packages-in-rstudio"><i class="fa fa-check"></i><b>2.9.3</b> Installing packages in RStudio</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-02.html"><a href="mod-02.html#installing-packages-using-the-r-console"><i class="fa fa-check"></i><b>2.9.4</b> Installing packages using the R console</a></li>
<li class="chapter" data-level="2.9.5" data-path="mod-02.html"><a href="mod-02.html#working-with-packages-in-r"><i class="fa fa-check"></i><b>2.9.5</b> Working with packages in R</a></li>
<li class="chapter" data-level="2.9.6" data-path="mod-02.html"><a href="mod-02.html#package-dependencies"><i class="fa fa-check"></i><b>2.9.6</b> Package dependencies</a></li>
<li class="chapter" data-level="2.9.7" data-path="mod-02.html"><a href="mod-02.html#citing-packages"><i class="fa fa-check"></i><b>2.9.7</b> Citing packages</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="mod-02.html"><a href="mod-02.html#r-documentation"><i class="fa fa-check"></i><b>2.10</b> R documentation</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="mod-02.html"><a href="mod-02.html#documentation-help-files"><i class="fa fa-check"></i><b>2.10.1</b> Documentation (help) files</a></li>
<li class="chapter" data-level="2.10.2" data-path="mod-02.html"><a href="mod-02.html#r-vignettes"><i class="fa fa-check"></i><b>2.10.2</b> R vignettes</a></li>
<li class="chapter" data-level="2.10.3" data-path="mod-02.html"><a href="mod-02.html#official-r-project-resources"><i class="fa fa-check"></i><b>2.10.3</b> Official R Project resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="mod-02.html"><a href="mod-02.html#unofficial-online-resources"><i class="fa fa-check"></i><b>2.10.4</b> Unofficial online resources</a></li>
<li class="chapter" data-level="2.10.5" data-path="mod-02.html"><a href="mod-02.html#r-books"><i class="fa fa-check"></i><b>2.10.5</b> R books</a></li>
<li class="chapter" data-level="2.10.6" data-path="mod-02.html"><a href="mod-02.html#two-reminders"><i class="fa fa-check"></i><b>2.10.6</b> Two reminders</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-03.html"><a href="mod-03.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-03.html"><a href="mod-03.html#mod-03-inout"><i class="fa fa-check"></i><b>3.1</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="mod-03.html"><a href="mod-03.html#importing-data-preliminaries"><i class="fa fa-check"></i><b>3.1.1</b> Importing data: preliminaries</a></li>
<li class="chapter" data-level="3.1.2" data-path="mod-03.html"><a href="mod-03.html#importing-data-from-text-files-with-read.csv-and-read.table"><i class="fa fa-check"></i><b>3.1.2</b> Importing data from text files with <code>read.csv()</code> and <code>read.table()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="mod-03.html"><a href="mod-03.html#importing-data-from-saved-workspaces"><i class="fa fa-check"></i><b>3.1.3</b> Importing data from saved workspaces</a></li>
<li class="chapter" data-level="3.1.4" data-path="mod-03.html"><a href="mod-03.html#importing-data-special-cases"><i class="fa fa-check"></i><b>3.1.4</b> Importing data: special cases:</a></li>
<li class="chapter" data-level="3.1.5" data-path="mod-03.html"><a href="mod-03.html#export-data-from-r"><i class="fa fa-check"></i><b>3.1.5</b> Export data from R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="mod-03.html"><a href="mod-03.html#making-values-in-r"><i class="fa fa-check"></i><b>3.2</b> Making values in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="mod-03.html"><a href="mod-03.html#producing-arbitrary-values-with-c"><i class="fa fa-check"></i><b>3.2.1</b> Producing arbitrary values with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="mod-03.html"><a href="mod-03.html#generating-regular-values"><i class="fa fa-check"></i><b>3.2.2</b> Generating regular values</a></li>
<li class="chapter" data-level="3.2.3" data-path="mod-03.html"><a href="mod-03.html#generating-random-values"><i class="fa fa-check"></i><b>3.2.3</b> Generating random values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="mod-03.html"><a href="mod-03.html#selecting-data-with"><i class="fa fa-check"></i><b>3.3</b> Selecting data with <code>[]</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="mod-03.html"><a href="mod-03.html#mod-03-brackets"><i class="fa fa-check"></i><b>3.3.1</b> Basics of brackets</a></li>
<li class="chapter" data-level="3.3.2" data-path="mod-03.html"><a href="mod-03.html#extracting-and-selecting-data-with-logical-tests"><i class="fa fa-check"></i><b>3.3.2</b> Extracting and selecting data with logical tests</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="mod-03.html"><a href="mod-03.html#managing-dates-and-characters"><i class="fa fa-check"></i><b>3.4</b> Managing dates and characters</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="mod-03.html"><a href="mod-03.html#temporal-data-and-dates"><i class="fa fa-check"></i><b>3.4.1</b> Temporal data and dates</a></li>
<li class="chapter" data-level="3.4.2" data-path="mod-03.html"><a href="mod-03.html#character-data-text"><i class="fa fa-check"></i><b>3.4.2</b> Character data (text)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="mod-03.html"><a href="mod-03.html#mod-03-dataframe"><i class="fa fa-check"></i><b>3.5</b> Data frame management</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="mod-03.html"><a href="mod-03.html#data-frame-structure"><i class="fa fa-check"></i><b>3.5.1</b> Data frame structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="mod-03.html"><a href="mod-03.html#common-data-frame-operations"><i class="fa fa-check"></i><b>3.5.2</b> Common data frame operations</a></li>
<li class="chapter" data-level="3.5.3" data-path="mod-03.html"><a href="mod-03.html#other-data-frame-operations"><i class="fa fa-check"></i><b>3.5.3</b> Other data frame operations</a></li>
<li class="chapter" data-level="3.5.4" data-path="mod-03.html"><a href="mod-03.html#mod-03-reshape"><i class="fa fa-check"></i><b>3.5.4</b> Reshaping data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-04.html"><a href="mod-04.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis 1: Data description and summarization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-04.html"><a href="mod-04.html#motivation"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="mod-04.html"><a href="mod-04.html#descriptive-and-summary-statistics"><i class="fa fa-check"></i><b>4.2</b> Descriptive and summary statistics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="mod-04.html"><a href="mod-04.html#basic-summary-statistics"><i class="fa fa-check"></i><b>4.2.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="4.2.2" data-path="mod-04.html"><a href="mod-04.html#mod-04-agg"><i class="fa fa-check"></i><b>4.2.2</b> Summarizing by groups (AKA: pivot tables)</a></li>
<li class="chapter" data-level="4.2.3" data-path="mod-04.html"><a href="mod-04.html#summarizing-data-with-the-apply-family"><i class="fa fa-check"></i><b>4.2.3</b> Summarizing data with the <code>apply()</code> family</a></li>
<li class="chapter" data-level="4.2.4" data-path="mod-04.html"><a href="mod-04.html#mod-04-tab"><i class="fa fa-check"></i><b>4.2.4</b> Tabulation (frequency tables)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mod-04.html"><a href="mod-04.html#mod-04-vis"><i class="fa fa-check"></i><b>4.3</b> Visualizing single variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="mod-04.html"><a href="mod-04.html#boxplots-aka-box-and-whisker-plots"><i class="fa fa-check"></i><b>4.3.1</b> Boxplots (aka: box-and-whisker plots)</a></li>
<li class="chapter" data-level="4.3.2" data-path="mod-04.html"><a href="mod-04.html#histograms"><i class="fa fa-check"></i><b>4.3.2</b> Histograms</a></li>
<li class="chapter" data-level="4.3.3" data-path="mod-04.html"><a href="mod-04.html#mod04-pdfplots"><i class="fa fa-check"></i><b>4.3.3</b> Kernel density plots</a></li>
<li class="chapter" data-level="4.3.4" data-path="mod-04.html"><a href="mod-04.html#empirical-cumulative-density-function-ecdf-plots"><i class="fa fa-check"></i><b>4.3.4</b> Empirical cumulative density function (ECDF) plots</a></li>
<li class="chapter" data-level="4.3.5" data-path="mod-04.html"><a href="mod-04.html#quantile-quantile-qq-plots"><i class="fa fa-check"></i><b>4.3.5</b> Quantile-quantile (QQ) plots</a></li>
<li class="chapter" data-level="4.3.6" data-path="mod-04.html"><a href="mod-04.html#how-should-i-plot-my-data"><i class="fa fa-check"></i><b>4.3.6</b> How should I plot my data?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-05.html"><a href="mod-05.html"><i class="fa fa-check"></i><b>5</b> Exploratory data analysis 2: Probability distributions for biology</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-05.html"><a href="mod-05.html#mod-05-dists1"><i class="fa fa-check"></i><b>5.1</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mod-05.html"><a href="mod-05.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>5.1.1</b> Probability distributions in R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mod-05.html"><a href="mod-05.html#mod-05-discrete"><i class="fa fa-check"></i><b>5.2</b> Discrete distributions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mod-05.html"><a href="mod-05.html#bernoulli-distribution"><i class="fa fa-check"></i><b>5.2.1</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="5.2.2" data-path="mod-05.html"><a href="mod-05.html#binomial-distribution"><i class="fa fa-check"></i><b>5.2.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="5.2.3" data-path="mod-05.html"><a href="mod-05.html#poisson-distribution"><i class="fa fa-check"></i><b>5.2.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="5.2.4" data-path="mod-05.html"><a href="mod-05.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>5.2.4</b> Negative binomial distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="mod-05.html"><a href="mod-05.html#geometric-distribution"><i class="fa fa-check"></i><b>5.2.5</b> Geometric distribution</a></li>
<li class="chapter" data-level="5.2.6" data-path="mod-05.html"><a href="mod-05.html#beta-binomial-distribution"><i class="fa fa-check"></i><b>5.2.6</b> Beta-binomial distribution</a></li>
<li class="chapter" data-level="5.2.7" data-path="mod-05.html"><a href="mod-05.html#multinomial-distribution"><i class="fa fa-check"></i><b>5.2.7</b> Multinomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mod-05.html"><a href="mod-05.html#mod-05-condists"><i class="fa fa-check"></i><b>5.3</b> Continuous distributions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="mod-05.html"><a href="mod-05.html#uniform-distribution"><i class="fa fa-check"></i><b>5.3.1</b> Uniform distribution</a></li>
<li class="chapter" data-level="5.3.2" data-path="mod-05.html"><a href="mod-05.html#mod-05-norm"><i class="fa fa-check"></i><b>5.3.2</b> Normal distribution</a></li>
<li class="chapter" data-level="5.3.3" data-path="mod-05.html"><a href="mod-05.html#lognormal-distribution"><i class="fa fa-check"></i><b>5.3.3</b> Lognormal distribution</a></li>
<li class="chapter" data-level="5.3.4" data-path="mod-05.html"><a href="mod-05.html#gamma-distribution"><i class="fa fa-check"></i><b>5.3.4</b> Gamma distribution</a></li>
<li class="chapter" data-level="5.3.5" data-path="mod-05.html"><a href="mod-05.html#beta-distribution"><i class="fa fa-check"></i><b>5.3.5</b> Beta distribution</a></li>
<li class="chapter" data-level="5.3.6" data-path="mod-05.html"><a href="mod-05.html#dirichlet-distribution"><i class="fa fa-check"></i><b>5.3.6</b> Dirichlet distribution</a></li>
<li class="chapter" data-level="5.3.7" data-path="mod-05.html"><a href="mod-05.html#exponential-distribution"><i class="fa fa-check"></i><b>5.3.7</b> Exponential distribution</a></li>
<li class="chapter" data-level="5.3.8" data-path="mod-05.html"><a href="mod-05.html#triangular-distribution"><i class="fa fa-check"></i><b>5.3.8</b> Triangular distribution</a></li>
<li class="chapter" data-level="5.3.9" data-path="mod-05.html"><a href="mod-05.html#distributions-summary"><i class="fa fa-check"></i><b>5.3.9</b> Distributions summary</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="mod-05.html"><a href="mod-05.html#mod-05-dists2"><i class="fa fa-check"></i><b>5.4</b> Fitting and testing distributions</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="mod-05.html"><a href="mod-05.html#estimating-distributional-parameters"><i class="fa fa-check"></i><b>5.4.1</b> Estimating distributional parameters</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="mod-05.html"><a href="mod-05.html#graphical-methods-for-examining-distributions"><i class="fa fa-check"></i><b>5.5</b> Graphical methods for examining distributions</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-05.html"><a href="mod-05.html#comparing-distributions-with-pdf-or-pmf-plots"><i class="fa fa-check"></i><b>5.5.1</b> Comparing distributions with PDF or PMF plots</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-05.html"><a href="mod-05.html#comparing-distributions-using-cdf-and-ecdf"><i class="fa fa-check"></i><b>5.5.2</b> Comparing distributions using CDF and ECDF</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-05.html"><a href="mod-05.html#comparing-distributions-using-qq-plots"><i class="fa fa-check"></i><b>5.5.3</b> Comparing distributions using QQ plots</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-05.html"><a href="mod-05.html#formal-tests-for-distributions"><i class="fa fa-check"></i><b>5.6</b> Formal tests for distributions</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-05.html"><a href="mod-05.html#tests-for-normality"><i class="fa fa-check"></i><b>5.6.1</b> Tests for normality</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-05.html"><a href="mod-05.html#kolmogorov-smirnov-tests"><i class="fa fa-check"></i><b>5.6.2</b> Kolmogorov-Smirnov tests</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-05.html"><a href="mod-05.html#mod-05-trans"><i class="fa fa-check"></i><b>5.7</b> Data transformations</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mod-05.html"><a href="mod-05.html#why-transform"><i class="fa fa-check"></i><b>5.7.1</b> Why transform?</a></li>
<li class="chapter" data-level="5.7.2" data-path="mod-05.html"><a href="mod-05.html#transforms-vs.-link-functions"><i class="fa fa-check"></i><b>5.7.2</b> Transforms vs. link functions</a></li>
<li class="chapter" data-level="5.7.3" data-path="mod-05.html"><a href="mod-05.html#common-transformations"><i class="fa fa-check"></i><b>5.7.3</b> Common transformations</a></li>
<li class="chapter" data-level="5.7.4" data-path="mod-05.html"><a href="mod-05.html#uncommon-transformations"><i class="fa fa-check"></i><b>5.7.4</b> Uncommon transformations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-06.html"><a href="mod-06.html"><i class="fa fa-check"></i><b>6</b> Exploratory data analysis 3: Multivariate data exploration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-06.html"><a href="mod-06.html#scatterplots-for-2-continuous-variables"><i class="fa fa-check"></i><b>6.1</b> Scatterplots for 2 continuous variables</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="mod-06.html"><a href="mod-06.html#r-plotting-basics"><i class="fa fa-check"></i><b>6.1.1</b> R plotting basics</a></li>
<li class="chapter" data-level="6.1.2" data-path="mod-06.html"><a href="mod-06.html#graphical-parameters-and-advanced-plots-with-par"><i class="fa fa-check"></i><b>6.1.2</b> Graphical parameters and advanced plots with <code>par()</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="mod-06.html"><a href="mod-06.html#really-advanced-plotting"><i class="fa fa-check"></i><b>6.1.3</b> Really advanced plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="mod-06.html"><a href="mod-06.html#mod-06-smat"><i class="fa fa-check"></i><b>6.2</b> Scatterplot matrices for many variables</a></li>
<li class="chapter" data-level="6.3" data-path="mod-06.html"><a href="mod-06.html#lattice-plots-for-hierarchical-data"><i class="fa fa-check"></i><b>6.3</b> Lattice plots for hierarchical data</a></li>
<li class="chapter" data-level="6.4" data-path="mod-06.html"><a href="mod-06.html#continuous-variables-by-group"><i class="fa fa-check"></i><b>6.4</b> Continuous variables by group</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="mod-06.html"><a href="mod-06.html#boxplots"><i class="fa fa-check"></i><b>6.4.1</b> Boxplots</a></li>
<li class="chapter" data-level="6.4.2" data-path="mod-06.html"><a href="mod-06.html#barplots"><i class="fa fa-check"></i><b>6.4.2</b> Barplots</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mod-06.html"><a href="mod-06.html#ordination-brief-introduction"><i class="fa fa-check"></i><b>6.5</b> Ordination (brief introduction)</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-06.html"><a href="mod-06.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>6.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-06.html"><a href="mod-06.html#nonmetric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>6.5.2</b> Nonmetric multidimensional scaling (NMDS)</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-06.html"><a href="mod-06.html#plotting-ordinations"><i class="fa fa-check"></i><b>6.5.3</b> Plotting ordinations</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-06.html"><a href="mod-06.html#ordination-wrap-up-for-now"><i class="fa fa-check"></i><b>6.5.4</b> Ordination wrap-up (for now)</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="mod-06.html"><a href="mod-06.html#principles-for-good-data-graphics"><i class="fa fa-check"></i><b>6.6</b> Principles for good data graphics</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="mod-06.html"><a href="mod-06.html#maximize-the-data-to-ink-ratio"><i class="fa fa-check"></i><b>6.6.1</b> Maximize the data-to-ink ratio</a></li>
<li class="chapter" data-level="6.6.2" data-path="mod-06.html"><a href="mod-06.html#use-labels-not-symbols"><i class="fa fa-check"></i><b>6.6.2</b> Use labels, not symbols</a></li>
<li class="chapter" data-level="6.6.3" data-path="mod-06.html"><a href="mod-06.html#be-consistent"><i class="fa fa-check"></i><b>6.6.3</b> Be consistent</a></li>
<li class="chapter" data-level="6.6.4" data-path="mod-06.html"><a href="mod-06.html#consider-legibility"><i class="fa fa-check"></i><b>6.6.4</b> Consider legibility</a></li>
<li class="chapter" data-level="6.6.5" data-path="mod-06.html"><a href="mod-06.html#set-yourself-up-for-success"><i class="fa fa-check"></i><b>6.6.5</b> Set yourself up for success</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mod-07.html"><a href="mod-07.html"><i class="fa fa-check"></i><b>7</b> Common statistical problems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-07.html"><a href="mod-07.html#outliers-and-erroneous-values"><i class="fa fa-check"></i><b>7.1</b> Outliers and erroneous values</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="mod-07.html"><a href="mod-07.html#detecting-outliers"><i class="fa fa-check"></i><b>7.1.1</b> Detecting outliers</a></li>
<li class="chapter" data-level="7.1.2" data-path="mod-07.html"><a href="mod-07.html#dealing-with-outliers"><i class="fa fa-check"></i><b>7.1.2</b> Dealing with outliers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="mod-07.html"><a href="mod-07.html#autocorrelation"><i class="fa fa-check"></i><b>7.2</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-07.html"><a href="mod-07.html#graphical-methods-to-identify-autocorrelation"><i class="fa fa-check"></i><b>7.2.1</b> Graphical methods to identify autocorrelation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-07.html"><a href="mod-07.html#mantel-tests-for-autocorrelation"><i class="fa fa-check"></i><b>7.2.2</b> Mantel tests for autocorrelation</a></li>
<li class="chapter" data-level="7.2.3" data-path="mod-07.html"><a href="mod-07.html#dealing-with-autocorrelation"><i class="fa fa-check"></i><b>7.2.3</b> Dealing with autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-07.html"><a href="mod-07.html#mod-07-multicol"><i class="fa fa-check"></i><b>7.3</b> Collinearity</a></li>
<li class="chapter" data-level="7.4" data-path="mod-07.html"><a href="mod-07.html#missing-data"><i class="fa fa-check"></i><b>7.4</b> Missing data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mod-07.html"><a href="mod-07.html#option-1-ignore-missing-data"><i class="fa fa-check"></i><b>7.4.1</b> Option 1: Ignore missing data</a></li>
<li class="chapter" data-level="7.4.2" data-path="mod-07.html"><a href="mod-07.html#option-2-interpolate-or-impute-missing-data"><i class="fa fa-check"></i><b>7.4.2</b> Option 2: Interpolate or impute missing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-08.html"><a href="mod-08.html"><i class="fa fa-check"></i><b>8</b> Planning your analysis (what test?)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-08.html"><a href="mod-08.html#how-to-use-this-guide"><i class="fa fa-check"></i><b>8.1</b> How to use this guide</a></li>
<li class="chapter" data-level="8.2" data-path="mod-08.html"><a href="mod-08.html#what-question-are-you-trying-to-answer"><i class="fa fa-check"></i><b>8.2</b> What question are you trying to answer?</a></li>
<li class="chapter" data-level="8.3" data-path="mod-08.html"><a href="mod-08.html#testing-for-a-difference-in-mean-or-location"><i class="fa fa-check"></i><b>8.3</b> Testing for a difference in mean or location</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mod-08.html"><a href="mod-08.html#additional-considerations"><i class="fa fa-check"></i><b>8.3.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mod-08.html"><a href="mod-08.html#testing-for-a-continuous-relationship-between-two-or-more-variables"><i class="fa fa-check"></i><b>8.4</b> Testing for a continuous relationship between two or more variables</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="mod-08.html"><a href="mod-08.html#additional-considerations-1"><i class="fa fa-check"></i><b>8.4.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mod-08.html"><a href="mod-08.html#independence-between-categories"><i class="fa fa-check"></i><b>8.5</b> Independence between categories</a></li>
<li class="chapter" data-level="8.6" data-path="mod-08.html"><a href="mod-08.html#classifying-observations"><i class="fa fa-check"></i><b>8.6</b> Classifying observations</a></li>
<li class="chapter" data-level="8.7" data-path="mod-08.html"><a href="mod-08.html#conclusions"><i class="fa fa-check"></i><b>8.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-09.html"><a href="mod-09.html"><i class="fa fa-check"></i><b>9</b> Generalized linear models (GLM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-09.html"><a href="mod-09.html#mod-09-lm"><i class="fa fa-check"></i><b>9.1</b> Prelude with linear models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="mod-09.html"><a href="mod-09.html#assumptions-of-linear-models"><i class="fa fa-check"></i><b>9.1.1</b> Assumptions of linear models</a></li>
<li class="chapter" data-level="9.1.2" data-path="mod-09.html"><a href="mod-09.html#linear-regression-in-r"><i class="fa fa-check"></i><b>9.1.2</b> Linear regression in R</a></li>
<li class="chapter" data-level="9.1.3" data-path="mod-09.html"><a href="mod-09.html#multiple-linear-regression"><i class="fa fa-check"></i><b>9.1.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="9.1.4" data-path="mod-09.html"><a href="mod-09.html#mod-09-anova"><i class="fa fa-check"></i><b>9.1.4</b> ANOVA and ANCOVA with <code>lm()</code></a></li>
<li class="chapter" data-level="9.1.5" data-path="mod-09.html"><a href="mod-09.html#variations-on-linear-models"><i class="fa fa-check"></i><b>9.1.5</b> Variations on linear models</a></li>
<li class="chapter" data-level="9.1.6" data-path="mod-09.html"><a href="mod-09.html#example-linear-regression-workflow"><i class="fa fa-check"></i><b>9.1.6</b> Example linear regression workflow</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="mod-09.html"><a href="mod-09.html#mod-09-basic"><i class="fa fa-check"></i><b>9.2</b> GLM basics</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mod-09.html"><a href="mod-09.html#example-glms"><i class="fa fa-check"></i><b>9.2.1</b> Example GLMS</a></li>
<li class="chapter" data-level="9.2.2" data-path="mod-09.html"><a href="mod-09.html#glm-families"><i class="fa fa-check"></i><b>9.2.2</b> GLM families</a></li>
<li class="chapter" data-level="9.2.3" data-path="mod-09.html"><a href="mod-09.html#glm-link-functions"><i class="fa fa-check"></i><b>9.2.3</b> GLM link functions</a></li>
<li class="chapter" data-level="9.2.4" data-path="mod-09.html"><a href="mod-09.html#deviance-and-other-glm-diagnostics"><i class="fa fa-check"></i><b>9.2.4</b> Deviance and other GLM diagnostics</a></li>
<li class="chapter" data-level="9.2.5" data-path="mod-09.html"><a href="mod-09.html#to-pseudo-r2-or-not-to-pseudo-r2"><i class="fa fa-check"></i><b>9.2.5</b> To pseudo-<em>R</em><sup>2</sup> or not to pseudo-<em>R</em><sup>2</sup>?</a></li>
<li class="chapter" data-level="9.2.6" data-path="mod-09.html"><a href="mod-09.html#common-glms"><i class="fa fa-check"></i><b>9.2.6</b> Common GLMs</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mod-09.html"><a href="mod-09.html#mod-09-loglin"><i class="fa fa-check"></i><b>9.3</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mod-09.html"><a href="mod-09.html#mod-09-loglin-examp"><i class="fa fa-check"></i><b>9.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="9.3.2" data-path="mod-09.html"><a href="mod-09.html#example-with-real-data"><i class="fa fa-check"></i><b>9.3.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mod-09.html"><a href="mod-09.html#mod-09-poisson"><i class="fa fa-check"></i><b>9.4</b> Poisson GLM for counts</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mod-09.html"><a href="mod-09.html#example-with-simulated-data"><i class="fa fa-check"></i><b>9.4.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="9.4.2" data-path="mod-09.html"><a href="mod-09.html#example-with-real-data-1"><i class="fa fa-check"></i><b>9.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mod-09.html"><a href="mod-09.html#mod-09-quasi"><i class="fa fa-check"></i><b>9.5</b> Quasi-Poisson and negative binomial GLM</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-09.html"><a href="mod-09.html#example-with-simulated-data-1"><i class="fa fa-check"></i><b>9.5.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-09.html"><a href="mod-09.html#example-with-real-data-2"><i class="fa fa-check"></i><b>9.5.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mod-09.html"><a href="mod-09.html#mod-09-logistic"><i class="fa fa-check"></i><b>9.6</b> Logistic regression for binary outcomes</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mod-09.html"><a href="mod-09.html#example-with-simulated-data-2"><i class="fa fa-check"></i><b>9.6.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="9.6.2" data-path="mod-09.html"><a href="mod-09.html#example-with-real-data-3"><i class="fa fa-check"></i><b>9.6.2</b> Example with real data</a></li>
<li class="chapter" data-level="9.6.3" data-path="mod-09.html"><a href="mod-09.html#mod-09-auc"><i class="fa fa-check"></i><b>9.6.3</b> Logistic GLM diagnostics: AUC and ROC</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mod-09.html"><a href="mod-09.html#mod-09-binom"><i class="fa fa-check"></i><b>9.7</b> Binomial GLM for proportional data</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="mod-09.html"><a href="mod-09.html#binomial-glm"><i class="fa fa-check"></i><b>9.7.1</b> Binomial GLM</a></li>
<li class="chapter" data-level="9.7.2" data-path="mod-09.html"><a href="mod-09.html#example-with-simulated-data-3"><i class="fa fa-check"></i><b>9.7.2</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="mod-09.html"><a href="mod-09.html#mod-09-gamma"><i class="fa fa-check"></i><b>9.8</b> Gamma models for overdispersed data</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="mod-09.html"><a href="mod-09.html#example-with-simulated-data-4"><i class="fa fa-check"></i><b>9.8.1</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="mod-09.html"><a href="mod-09.html#mod-09-beyond"><i class="fa fa-check"></i><b>9.9</b> Beyond GLM: Overview of GAM and GEE</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="mod-09.html"><a href="mod-09.html#mod-09-gam"><i class="fa fa-check"></i><b>9.9.1</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="9.9.2" data-path="mod-09.html"><a href="mod-09.html#mod-09-gee"><i class="fa fa-check"></i><b>9.9.2</b> Generalized estimating equations (GEE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-09.html"><a href="mod-09.html#mod-10"><i class="fa fa-check"></i><b>10</b> Nonlinear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-10.html"><a href="mod-10.html"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="mod-10.html"><a href="mod-10.html#mod-10-intro"><i class="fa fa-check"></i><b>10.2</b> Nonlinear least squares (NLS)</a></li>
<li class="chapter" data-level="10.3" data-path="mod-10.html"><a href="mod-10.html#mod-10-micmen"><i class="fa fa-check"></i><b>10.3</b> Michaelis-Menten curves</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="mod-10.html"><a href="mod-10.html#mod-10-micmen-sim"><i class="fa fa-check"></i><b>10.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="10.3.2" data-path="mod-10.html"><a href="mod-10.html#example-with-real-data-4"><i class="fa fa-check"></i><b>10.3.2</b> Example with real data</a></li>
<li class="chapter" data-level="10.3.3" data-path="mod-10.html"><a href="mod-10.html#alternative-strategies-for-the-analysis"><i class="fa fa-check"></i><b>10.3.3</b> Alternative strategies for the analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="mod-10.html"><a href="mod-10.html#mod-10-grow"><i class="fa fa-check"></i><b>10.4</b> Biological growth curves</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="mod-10.html"><a href="mod-10.html#gompertz-and-von-bertalanffy-curves"><i class="fa fa-check"></i><b>10.4.1</b> Gompertz and von Bertalanffy curves</a></li>
<li class="chapter" data-level="10.4.2" data-path="mod-10.html"><a href="mod-10.html#example-with-real-data-5"><i class="fa fa-check"></i><b>10.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="mod-10.html"><a href="mod-10.html#dose-response-curves"><i class="fa fa-check"></i><b>10.5</b> Dose response curves</a></li>
<li class="chapter" data-level="10.6" data-path="mod-10.html"><a href="mod-10.html#alternatives-to-nls"><i class="fa fa-check"></i><b>10.6</b> Alternatives to NLS</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="mod-10.html"><a href="mod-10.html#generalized-nonlinear-models"><i class="fa fa-check"></i><b>10.6.1</b> Generalized nonlinear models</a></li>
<li class="chapter" data-level="10.6.2" data-path="mod-10.html"><a href="mod-10.html#quantile-regression"><i class="fa fa-check"></i><b>10.6.2</b> Quantile regression</a></li>
<li class="chapter" data-level="10.6.3" data-path="mod-10.html"><a href="mod-10.html#mod-10-gam"><i class="fa fa-check"></i><b>10.6.3</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="10.6.4" data-path="mod-10.html"><a href="mod-10.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>10.6.4</b> Classification and regression trees (CART)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-11.html"><a href="mod-11.html"><i class="fa fa-check"></i><b>11</b> Mixed models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-11.html"><a href="mod-11.html#prelude-glm"><i class="fa fa-check"></i><b>11.1</b> Prelude (GLM)</a></li>
<li class="chapter" data-level="11.2" data-path="mod-11.html"><a href="mod-11.html#mod-11-lmm"><i class="fa fa-check"></i><b>11.2</b> Linear mixed models (LMM)</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="mod-11.html"><a href="mod-11.html#formal-definition-and-example"><i class="fa fa-check"></i><b>11.2.1</b> Formal definition and example</a></li>
<li class="chapter" data-level="11.2.2" data-path="mod-11.html"><a href="mod-11.html#example-with-simulated-data-5"><i class="fa fa-check"></i><b>11.2.2</b> Example with simulated data</a></li>
<li class="chapter" data-level="11.2.3" data-path="mod-11.html"><a href="mod-11.html#p-values-in-lmm"><i class="fa fa-check"></i><b>11.2.3</b> <em>P</em>-values in LMM</a></li>
<li class="chapter" data-level="11.2.4" data-path="mod-11.html"><a href="mod-11.html#specifying-random-effects"><i class="fa fa-check"></i><b>11.2.4</b> Specifying random effects</a></li>
<li class="chapter" data-level="11.2.5" data-path="mod-11.html"><a href="mod-11.html#lmm-example-with-real-data"><i class="fa fa-check"></i><b>11.2.5</b> LMM example with real data</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="mod-11.html"><a href="mod-11.html#mod-11-glmm"><i class="fa fa-check"></i><b>11.3</b> Generalized linear mixed models (GLMM)</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="mod-11.html"><a href="mod-11.html#definition-1"><i class="fa fa-check"></i><b>11.3.1</b> Definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="mod-11.html"><a href="mod-11.html#glmm-on-simulated-data"><i class="fa fa-check"></i><b>11.3.2</b> GLMM on simulated data</a></li>
<li class="chapter" data-level="11.3.3" data-path="mod-11.html"><a href="mod-11.html#glmm-on-real-data"><i class="fa fa-check"></i><b>11.3.3</b> GLMM on real data</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="mod-11.html"><a href="mod-11.html#mod-11-nlme"><i class="fa fa-check"></i><b>11.4</b> Nonlinear mixed models (NLME)</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="mod-11.html"><a href="mod-11.html#definition-and-background"><i class="fa fa-check"></i><b>11.4.1</b> Definition and background</a></li>
<li class="chapter" data-level="11.4.2" data-path="mod-11.html"><a href="mod-11.html#nlme-on-simulated-data"><i class="fa fa-check"></i><b>11.4.2</b> NLME on simulated data</a></li>
<li class="chapter" data-level="11.4.3" data-path="mod-11.html"><a href="mod-11.html#nlme-on-real-data"><i class="fa fa-check"></i><b>11.4.3</b> NLME on real data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="mod-11.html"><a href="mod-11.html#mod-11-gamm"><i class="fa fa-check"></i><b>11.5</b> (Generalized) additive mixed models (AMM/GAMM)</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="mod-11.html"><a href="mod-11.html#example-gamm-with-real-data"><i class="fa fa-check"></i><b>11.5.1</b> Example GAMM with real data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-12.html"><a href="mod-12.html"><i class="fa fa-check"></i><b>12</b> Multivariate data analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-12.html"><a href="mod-12.html#multivariate-data"><i class="fa fa-check"></i><b>12.1</b> Multivariate data</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="mod-12.html"><a href="mod-12.html#univariate-vs.-multivariate-data"><i class="fa fa-check"></i><b>12.1.1</b> Univariate vs. multivariate data</a></li>
<li class="chapter" data-level="12.1.2" data-path="mod-12.html"><a href="mod-12.html#components-of-multivariate-data"><i class="fa fa-check"></i><b>12.1.2</b> Components of multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="mod-12.html"><a href="mod-12.html#mod-12-dist"><i class="fa fa-check"></i><b>12.2</b> Distance metrics: biological (dis)similarity</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-12.html"><a href="mod-12.html#euclidean-distance"><i class="fa fa-check"></i><b>12.2.1</b> Euclidean distance</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-12.html"><a href="mod-12.html#bray-curtis-and-other-distance-metrics"><i class="fa fa-check"></i><b>12.2.2</b> Bray-Curtis and other distance metrics</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-12.html"><a href="mod-12.html#clustering"><i class="fa fa-check"></i><b>12.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="mod-12.html"><a href="mod-12.html#k-means-clustering"><i class="fa fa-check"></i><b>12.3.1</b> <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="12.3.2" data-path="mod-12.html"><a href="mod-12.html#hierarchical-agglomerative-clustering"><i class="fa fa-check"></i><b>12.3.2</b> Hierarchical agglomerative clustering</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="mod-12.html"><a href="mod-12.html#mod-12-sims"><i class="fa fa-check"></i><b>12.4</b> Analyzing dissimilarity</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="mod-12.html"><a href="mod-12.html#mantel-tests-distance-vs.-distance"><i class="fa fa-check"></i><b>12.4.1</b> Mantel tests: distance vs. distance</a></li>
<li class="chapter" data-level="12.4.2" data-path="mod-12.html"><a href="mod-12.html#comparing-dissimilarity-between-groups"><i class="fa fa-check"></i><b>12.4.2</b> Comparing dissimilarity between groups</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="mod-12.html"><a href="mod-12.html#mod-12-ord"><i class="fa fa-check"></i><b>12.5</b> Ordination</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="mod-12.html"><a href="mod-12.html#principal-components-analysis-pca-1"><i class="fa fa-check"></i><b>12.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="12.5.2" data-path="mod-12.html"><a href="mod-12.html#nmds-and-other-ordination-methods"><i class="fa fa-check"></i><b>12.5.2</b> NMDS and other ordination methods</a></li>
<li class="chapter" data-level="12.5.3" data-path="mod-12.html"><a href="mod-12.html#other-ordination-techniques"><i class="fa fa-check"></i><b>12.5.3</b> Other ordination techniques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="literature-cited.html"><a href="literature-cited.html"><i class="fa fa-check"></i>Literature Cited</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Biological Data Analysis: Statistics and R for Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-04" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Module 4</span> Exploratory data analysis 1: Data description and summarization<a href="mod-04.html#mod-04" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Sometimes you have to “pre-analyze” your data before you can really analyze it.
This is usually called <strong>exploratory data analysis (EDA)</strong>.
Exploratory data analysis can reveal unexpected patterns (or problems) in your dataset.
This module and the next two will demonstrate some common exploratory processes in R.
Along the way we will explore how to summarize data, common data distributions and how to fit them to your data, and how to manage your data to avoid common statistical pitfalls.</p>
<p>The exploratory data analysis unit of this course is split into three modules:</p>
<ul>
<li><a href="mod-04.html#mod-04">Module 4</a> (this module) covers basic descriptive statistics and visualization for single variables.</li>
<li><a href="mod-05.html#mod-05">Module 5</a> covers common probability distributions encountered by biologists, and how to find the right distribution to analyze your data.</li>
<li><a href="mod-06.html#mod-06">Module 6</a> covers methods for exploring two or more variables at once.</li>
</ul>
<div id="motivation" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Motivation<a href="mod-04.html#motivation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the main questions that biologists have after collecting data is, “<em>What statistical test do I use?</em>” Ignoring the fact that they should have thought about that <strong>before</strong> collecting data, the answer to that question depends on the answers to two other questions:</p>
<ol style="list-style-type: decimal">
<li>What question are you trying to answer?</li>
<li>What kind of data do you have?</li>
</ol>
<p>The first question is up to you as a biologist.
The second question is more in the realm of statistics, and is the question that exploratory data analysis is the process for answering.</p>
<p>Common objectives in exploratory data analysis include:</p>
<ul>
<li>Describing the central tendency and variability of variables</li>
<li>Identifying potential outliers</li>
<li>Identifying how variables are distributed</li>
<li>Testing whether data meet the assumptions of statistical tests</li>
<li>Checking for common issues such as autocorrelation, collinearity, and missingness.</li>
<li>Searching for patterns in your data that may or may not be related to your main analysis.</li>
</ul>
<p>How much exploratory data analysis is needed varies from to project to project.
At a minimum, you should be checking to see that your data meet the assumptions of your analysis.
Failure to verify that your main analysis is justified can lead to huge problems down the line.
<span class="citation">Zuur et al. (<a href="#ref-zuur2010" role="doc-biblioref">2010</a>)</span> reviewed a host of common data exploration methods and motivations; although aimed at ecologists, most biologists would benefit from reading their paper.</p>
<p>The exploratory data analysis part of the course is split into three parts:</p>
<ul>
<li>In Module 4 (this section), we will explore some common ways to summarize data and present those summaries.</li>
<li>In <a href="mod-05.html#mod-05">Module 5</a>, we will formally introduce <strong>probability distributions</strong> and how to pick the right distribution for your data.</li>
<li>In <a href="mod-06.html#mod-06">Module 6</a>, we will learn methods for multivariate data exploration, and introduce some basics of plotting in R.</li>
</ul>
</div>
<div id="descriptive-and-summary-statistics" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Descriptive and summary statistics<a href="mod-04.html#descriptive-and-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="basic-summary-statistics" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Basic summary statistics<a href="mod-04.html#basic-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the first steps in exploratory data analysis is understanding how values in a variable are spread out (aka: distributed), and what a “typical” value is.
Biologists use a few common <strong>summary statistics</strong>, or <strong>descriptive statistics</strong>, to describe individual variables.</p>
<div id="central-tendency" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Central tendency<a href="mod-04.html#central-tendency" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>central tendency</strong> of a variable is a value that represents a “typical” value from that set of values.
Central tendency is usually expressed in one of three ways:</p>
<ul>
<li><p><strong>Mean</strong>: the sum of values divided by the number of values.
This value is also called the “<strong>arithmetic mean</strong>”.
Answers the question, “<em>What value would all values be if they were the same</em>?”.
When people say “mean” or “average”, this usually what they are referring to.
The mean is useful because it is one of the defining features of the <strong>normal distribution</strong>, a foundational concept in modern statistics.</p></li>
<li><p><strong>Median</strong>: the middle value, which is greater than half of the values and less than the other half of the values.
Also known as the 50<sup>th</sup> percentile or 0.5 quantile.</p></li>
<li><p><strong>Mode</strong>: the most common value.</p></li>
</ul>
<p>For many datasets, the mean and median will be approximately the same.
Data that are skewed will have a median different from their mean.
Biologists typically summarize data using the mean, but median can be appropriate in some situations–especially when data are not normally distributed.</p>
<div id="mean" class="section level5 hasAnchor" number="4.2.1.1.1">
<h5><span class="header-section-number">4.2.1.1.1</span> Mean<a href="mod-04.html#mean" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The <strong>arithmetic mean</strong> or just <strong>mean</strong> is the value that all values would be if they were all the same.
The mean of a distribution is often abbreviated with the Greek letter <span class="math inline">\(\mu\)</span> (“mu”).
It is calculated as the sum of all values in <em>x</em> divided by the number of values <em>n</em>: <span class="math display">\[\mu\left(x\right)=\frac{\sum_{i=1}^{n}x}{n}\]</span> The mean is useful because it is part of the definition of the normal distribution, a very important concept in modern statistics.
You can get the mean of a variable in R using the function <code>mean()</code>:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="mod-04.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random normal dist. with mean = 5 and sd = 1</span></span>
<span id="cb457-2"><a href="mod-04.html#cb457-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb457-3"><a href="mod-04.html#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 5.11826</code></pre>
<p>Like many summarization functions in R, <code>mean()</code> does not automatically handle missing values (<code>NA</code>).
If your dataset contains missing values, you need to set the argument <code>na.rm=TRUE</code>.
This can seem like an annoying bug, but it’s actually a feature.
By returning <code>NA</code> when the data contain missing values, R is helping you track down where missing values are coming from (and thus, why your code may not be working at some later point).</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="mod-04.html#cb459-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="cn">NA</span>)</span>
<span id="cb459-2"><a href="mod-04.html#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="mod-04.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 3.333333</code></pre>
<p>While most poeple only ever use the arithmetic mean, there are other means.
The <strong>geometric mean</strong> is defined as the <em>n</em>-th root of the product of all values:</p>
<p><span class="math display">\[\mu_{geom}\left(x\right)=\sqrt[n]{\prod_{i=1}^{n}x}\]</span></p>
<p>Or equivalently, the Euler’s constant <em>e</em> raised to the power of the mean of the values on the log<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a> scale:</p>
<p><span class="math display">\[\mu_{geom}\left(x\right)=exp\left(\frac{1}{n}\sum_{i=1}^{n}\log{\left(x\right)}\right)\]</span></p>
<p>The geometric mean is sometimes used for values that are meant to be multiplied together, such as growth rates.
Another application is in comparative morphology, where the geometric mean of a set of anatomical measurements is used as a sort of overall measure of body size against which individual measurements can be relativized.
For example, a morphologist might calculate the geometric mean of 15 skull measurements to arrive at the size of a “hypervolume” which represents skull size.
Because of the way that it is defined, the geometric mean is only defined for positive real values.</p>
<p>There is no base function for geometric mean, but it’s easy to get by combining base functions.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="mod-04.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lognormal with logmean 2 and logsd=0.5</span></span>
<span id="cb463-2"><a href="mod-04.html#cb463-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.5</span>)</span>
<span id="cb463-3"><a href="mod-04.html#cb463-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-4"><a href="mod-04.html#cb463-4" aria-hidden="true" tabindex="-1"></a><span class="co"># custom function for geometric mean:</span></span>
<span id="cb463-5"><a href="mod-04.html#cb463-5" aria-hidden="true" tabindex="-1"></a>geomean <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(x)))}</span>
<span id="cb463-6"><a href="mod-04.html#cb463-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-7"><a href="mod-04.html#cb463-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geomean</span>(x)</span></code></pre></div>
<pre><code>## [1] 12.77861</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="mod-04.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another way:</span></span>
<span id="cb465-2"><a href="mod-04.html#cb465-2" aria-hidden="true" tabindex="-1"></a>geomean2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">prod</span>(x)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x))}</span>
<span id="cb465-3"><a href="mod-04.html#cb465-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geomean2</span>(x)</span></code></pre></div>
<pre><code>## [1] 12.77861</code></pre>
<p>The <strong>harmonic mean</strong> is less common than the arithmetic or geometric means.
It is used when an average rate is needed.
It is calculated as the reciprocal of the arithmetic mean of reciprocals of the values:</p>
<p><span class="math display">\[\mu_{harm}\left(x\right)=\left(\frac{1}{n}\sum_{i=1}^{n}x^{-1}\right)^{-1}\]</span></p>
<p>An example use case for the harmonic mean is as follows: a migrating bird travels from Atlanta to Knoxville, Tennessee (250 km) at an average speed of 60 km/h, and then from Knoxville to Lexington, Kentucky (230 km) at an average speed of 52 km/h.
Its average speed on the trip is not the arithmetic mean of the speeds, but the harmonic mean: <span class="math display">\[\mu_{harm}\left(v\right)=\frac{Total\ distance}{Total\ time}=\frac{2}{\frac{1}{60}+\frac{1}{52}}\approx55.7\ km/h\]</span></p>
<p>I’m not aware of a base function for harmonic means, but it is easy to get:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="mod-04.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only defined for postive real values</span></span>
<span id="cb467-2"><a href="mod-04.html#cb467-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">20</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb467-3"><a href="mod-04.html#cb467-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-4"><a href="mod-04.html#cb467-4" aria-hidden="true" tabindex="-1"></a><span class="co"># custom function to get harmonic mean</span></span>
<span id="cb467-5"><a href="mod-04.html#cb467-5" aria-hidden="true" tabindex="-1"></a>har.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="dv">1</span><span class="sc">/</span>(<span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>x))}</span>
<span id="cb467-6"><a href="mod-04.html#cb467-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-7"><a href="mod-04.html#cb467-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compare mean, geometric mean, and harmonic mean:</span></span>
<span id="cb467-8"><a href="mod-04.html#cb467-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(a)</span>
<span id="cb467-9"><a href="mod-04.html#cb467-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 32.40134</span></span>
<span id="cb467-10"><a href="mod-04.html#cb467-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geomean</span>(a)</span>
<span id="cb467-11"><a href="mod-04.html#cb467-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 20.07604</span></span>
<span id="cb467-12"><a href="mod-04.html#cb467-12" aria-hidden="true" tabindex="-1"></a><span class="fu">har.mean</span>(a)</span>
<span id="cb467-13"><a href="mod-04.html#cb467-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7.422123</span></span></code></pre></div>
<p>Interestingly, for any set of values with at least 2 unique values the following inequality will always be true:</p>
<p><span class="math display">\[\mu_{arith}\left(x\right)&gt;\mu_{geom}\left(x\right)&gt;\mu_{harm}\left(x\right)\]</span></p>
</div>
<div id="weighted-means" class="section level5 hasAnchor" number="4.2.1.1.2">
<h5><span class="header-section-number">4.2.1.1.2</span> Weighted means<a href="mod-04.html#weighted-means" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sometimes we need to count some observations more than others.
The <strong>weight</strong> of an observation is the amount that it contributes to a statistic or analysis.
A weighted mean is useful when some observations represent more data or experimental units.
For example, when trying to calculate the mean mass of elephants across multiple populations, it might make sense to calculate the mean of the population-level means, but weight the population means by the number of elephants measured in each population.
This would be done because the populations with more measurements represent more data, and thus give us greater confidence about what the true mean might be.</p>
<p>The R function for the weighted mean takes a set of values <code>x</code> and weights <code>w</code>.
The weights must add up to 1.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="mod-04.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make some values</span></span>
<span id="cb468-2"><a href="mod-04.html#cb468-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb468-3"><a href="mod-04.html#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="co"># weights</span></span>
<span id="cb468-4"><a href="mod-04.html#cb468-4" aria-hidden="true" tabindex="-1"></a>wts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)<span class="sc">/</span><span class="dv">14</span></span>
<span id="cb468-5"><a href="mod-04.html#cb468-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compare mean to weighted mean</span></span>
<span id="cb468-6"><a href="mod-04.html#cb468-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb468-7"><a href="mod-04.html#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6.5</span></span>
<span id="cb468-8"><a href="mod-04.html#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(x, wts)</span>
<span id="cb468-9"><a href="mod-04.html#cb468-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 11.14286</span></span></code></pre></div>
</div>
<div id="median" class="section level5 hasAnchor" number="4.2.1.1.3">
<h5><span class="header-section-number">4.2.1.1.3</span> Median<a href="mod-04.html#median" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The <strong>median</strong> is the central value of a set of values.
If you were to rank the values from smallest to largest, the median would be the value in the middle (or, if there were an even number of values, the median would be the mean of the two central values).
The median is also known as the 50<sup>th</sup> percentile, or 0.5 quantile.
The median is sometimes a more useful measure of central tendency than the mean when data are strongly skewed.</p>
<p>A classic use case is personal income.
In 2020, the median household income was about $67000.
It’s hard to find exact numbers, but at one point in 2020 Jeff Bezos had made about $13 billion since 2019.
This implies that in a room with 99 “average” Americans and 1 Jeff Bezos, the <em>mean</em> income was about $130 million.
Is that a good representation of what most households made?
Of course not.
The median would be about $67000.</p>
<p>The easiest way to get the median in R is with the <code>median()</code> function.
You can also use <code>quantile()</code> with argument <code>probs</code> (the second argument) set to 0.5.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="mod-04.html#cb469-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb469-2"><a href="mod-04.html#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(x)</span>
<span id="cb469-3"><a href="mod-04.html#cb469-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1006929</span></span>
<span id="cb469-4"><a href="mod-04.html#cb469-4" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(x, <span class="fl">0.5</span>)</span>
<span id="cb469-5"><a href="mod-04.html#cb469-5" aria-hidden="true" tabindex="-1"></a><span class="do">##       50% </span></span>
<span id="cb469-6"><a href="mod-04.html#cb469-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.1006929</span></span></code></pre></div>
</div>
<div id="mode" class="section level5 hasAnchor" number="4.2.1.1.4">
<h5><span class="header-section-number">4.2.1.1.4</span> Mode<a href="mod-04.html#mode" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The <strong>mode</strong> is the most common value in a set of values.
For many distributions, the mode will be the same as, or close to, the mean and median.
There is no base function to get the mode, but it can be obtained by combining base functions.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="mod-04.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb470-2"><a href="mod-04.html#cb470-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb470-3"><a href="mod-04.html#cb470-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-4"><a href="mod-04.html#cb470-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simple function for mode</span></span>
<span id="cb470-5"><a href="mod-04.html#cb470-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Will return &gt;1 result if &gt;1 mode.</span></span>
<span id="cb470-6"><a href="mod-04.html#cb470-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Capitalized because already a function called &quot;mode&quot; that</span></span>
<span id="cb470-7"><a href="mod-04.html#cb470-7" aria-hidden="true" tabindex="-1"></a><span class="co"># does something else and don&#39;t want to overwrite it</span></span>
<span id="cb470-8"><a href="mod-04.html#cb470-8" aria-hidden="true" tabindex="-1"></a>Mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb470-9"><a href="mod-04.html#cb470-9" aria-hidden="true" tabindex="-1"></a>    un <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb470-10"><a href="mod-04.html#cb470-10" aria-hidden="true" tabindex="-1"></a>    ta <span class="ot">&lt;-</span> <span class="fu">table</span>(x)</span>
<span id="cb470-11"><a href="mod-04.html#cb470-11" aria-hidden="true" tabindex="-1"></a>    mx <span class="ot">&lt;-</span> <span class="fu">max</span>(ta)</span>
<span id="cb470-12"><a href="mod-04.html#cb470-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(un[<span class="fu">which</span>(ta<span class="sc">==</span>mx)])</span>
<span id="cb470-13"><a href="mod-04.html#cb470-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb470-14"><a href="mod-04.html#cb470-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Mode</span>(a)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="mod-04.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># illustration with 2 modes:</span></span>
<span id="cb472-2"><a href="mod-04.html#cb472-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb472-3"><a href="mod-04.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Mode</span>(b)</span></code></pre></div>
<pre><code>## [1] 3 4</code></pre>
<p>Another way to get the mode is to find peaks on a probability density plot.
We’ll discuss these plots <a href="mod-04.html#mod04-pdfplots">later</a>, but for now, a density plot shows how likely different values are a distribution.
This method might be more useful when there are many values, or the values have a great deal of precision, making it hard to find a mode by counting up occurrences.</p>
<p>In the example below, the distribution has a peak around <span class="math inline">\(x=12.01\)</span>.
This means that the mode is about 12.01, which is very close to the mean and median as well as the true mean used to generate the distribution.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="mod-04.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb474-2"><a href="mod-04.html#cb474-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>, <span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb474-3"><a href="mod-04.html#cb474-3" aria-hidden="true" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">density</span>(a)</span>
<span id="cb474-4"><a href="mod-04.html#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(den)</span>
<span id="cb474-5"><a href="mod-04.html#cb474-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(den<span class="sc">$</span>x[<span class="fu">which.max</span>(den<span class="sc">$</span>y)], <span class="fu">max</span>(den<span class="sc">$</span>y),</span>
<span id="cb474-6"><a href="mod-04.html#cb474-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-298-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="mod-04.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to estimate mode</span></span>
<span id="cb475-2"><a href="mod-04.html#cb475-2" aria-hidden="true" tabindex="-1"></a>Mode2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb475-3"><a href="mod-04.html#cb475-3" aria-hidden="true" tabindex="-1"></a>    de <span class="ot">&lt;-</span> <span class="fu">density</span>(x)</span>
<span id="cb475-4"><a href="mod-04.html#cb475-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(de<span class="sc">$</span>x[<span class="fu">which.max</span>(de<span class="sc">$</span>y)])</span>
<span id="cb475-5"><a href="mod-04.html#cb475-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb475-6"><a href="mod-04.html#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Mode2</span>(a)</span></code></pre></div>
<pre><code>## [1] 12.0136</code></pre>
<p>The function we made, <code>Mode2()</code>, works well enough if there is only one mode.
But, many real life distributions have &gt;1 mode.
Such distributions are called <strong>bimodal</strong> if they have 2 modes, or <strong>multimodal</strong> if they have 3 or more.
A classic example of bimodality is grades in college courses: it is very common to have many Bs, and many Ds, but not many Fs, Cs, or As.</p>
<p>If your data appear to have &gt;1 mode, you can estimate them by finding points where the slope of the density plot changes sign.
The code below is inelegant but it works.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="mod-04.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb477-2"><a href="mod-04.html#cb477-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e2</span>, <span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb477-3"><a href="mod-04.html#cb477-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e2</span>, <span class="dv">20</span>, <span class="dv">2</span>)</span>
<span id="cb477-4"><a href="mod-04.html#cb477-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(a1, a2)</span>
<span id="cb477-5"><a href="mod-04.html#cb477-5" aria-hidden="true" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">density</span>(a)</span>
<span id="cb477-6"><a href="mod-04.html#cb477-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-7"><a href="mod-04.html#cb477-7" aria-hidden="true" tabindex="-1"></a><span class="co"># shows bimodal distribution:</span></span>
<span id="cb477-8"><a href="mod-04.html#cb477-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(den)</span>
<span id="cb477-9"><a href="mod-04.html#cb477-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-10"><a href="mod-04.html#cb477-10" aria-hidden="true" tabindex="-1"></a><span class="co"># function to find peaks on density plot</span></span>
<span id="cb477-11"><a href="mod-04.html#cb477-11" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e., where slope changes from positive to negative</span></span>
<span id="cb477-12"><a href="mod-04.html#cb477-12" aria-hidden="true" tabindex="-1"></a>Mode3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb477-13"><a href="mod-04.html#cb477-13" aria-hidden="true" tabindex="-1"></a>    de <span class="ot">&lt;-</span> <span class="fu">density</span>(x)</span>
<span id="cb477-14"><a href="mod-04.html#cb477-14" aria-hidden="true" tabindex="-1"></a>    dif <span class="ot">&lt;-</span> <span class="fu">diff</span>(de<span class="sc">$</span>y)</span>
<span id="cb477-15"><a href="mod-04.html#cb477-15" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(dif))</span>
<span id="cb477-16"><a href="mod-04.html#cb477-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(dif)){</span>
<span id="cb477-17"><a href="mod-04.html#cb477-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(dif[i<span class="dv">-1</span>] <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> dif[i] <span class="sc">&lt;</span> <span class="dv">0</span>){flag[i] <span class="ot">&lt;-</span> <span class="dv">1</span>}</span>
<span id="cb477-18"><a href="mod-04.html#cb477-18" aria-hidden="true" tabindex="-1"></a>    }<span class="co">#i    </span></span>
<span id="cb477-19"><a href="mod-04.html#cb477-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(de<span class="sc">$</span>x[<span class="fu">which</span>(flag<span class="sc">==</span><span class="dv">1</span>)])</span>
<span id="cb477-20"><a href="mod-04.html#cb477-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb477-21"><a href="mod-04.html#cb477-21" aria-hidden="true" tabindex="-1"></a><span class="fu">Mode3</span>(a)</span></code></pre></div>
<pre><code>## [1] 12.03519 19.55226</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="mod-04.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">Mode3</span>(a), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-299-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="variability" class="section level4 hasAnchor" number="4.2.1.2">
<h4><span class="header-section-number">4.2.1.2</span> Variability<a href="mod-04.html#variability" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="variance-and-its-relatives" class="section level5 hasAnchor" number="4.2.1.2.1">
<h5><span class="header-section-number">4.2.1.2.1</span> Variance and its relatives<a href="mod-04.html#variance-and-its-relatives" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The classical way to express the variability in a dataset is as the <strong>variance</strong>.
Variance is usually denoted as <span class="math inline">\(\sigma^2\)</span> (“sigma squared”) or <em>Var</em>.
The variance is defined as the expected (mean) squared deviation from the mean:</p>
<p><span class="math display">\[\sigma^2\left(x\right)=\frac{1}{n}\sum_{i=1}^{n}\left(x_i-\mu\right)^2\]</span></p>
<p>Like the mean <span class="math inline">\(\mu\)</span>, the variance <span class="math inline">\(\sigma^2\)</span> is part of the definition of the normal distribution and so it shows up a lot in statistics.
The differences between each value <span class="math inline">\(x_i\)</span> and the mean are squared for two reasons: first, so that positive and negative deviations do not cancel out (because the square of any real number is positive); and second, so that greater deviations count more than small deviations.
The main drawback of the variance is that it is in squared units of the original values.
For example, the variance of a set of measurements taken in cm will be in units of cm<sup>2</sup>.
For this reason, the variance is often expressed as its square root, the <strong>standard deviation (SD)</strong>.
The SD is usually denoted <span class="math inline">\(\sigma\)</span> (“sigma”) and is defined as:</p>
<p><span class="math display">\[\sigma\left(x\right)=\sqrt{\sigma^2\left(x\right)}\]</span></p>
<p>Because the SD is the square root of the variance, it is in the same units as the original measurements (and thus, the mean).
This makes SD easier to interpret than the variance.</p>
<p>The <strong>coefficient of variation (CV)</strong> is the ratio of the SD to the mean.
Some people prefer CV to SD because it allows comparisons between variables with very different means or SD.
CV can be expressed as ratios or as percentages.
Whichever you use, just be clear about what you did.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="mod-04.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb480-2"><a href="mod-04.html#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="co"># different SD, same CV:</span></span>
<span id="cb480-3"><a href="mod-04.html#cb480-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb480-4"><a href="mod-04.html#cb480-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="dv">10</span>)</span>
<span id="cb480-5"><a href="mod-04.html#cb480-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-6"><a href="mod-04.html#cb480-6" aria-hidden="true" tabindex="-1"></a><span class="co"># function for CV:</span></span>
<span id="cb480-7"><a href="mod-04.html#cb480-7" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">pct=</span><span class="cn">TRUE</span>){</span>
<span id="cb480-8"><a href="mod-04.html#cb480-8" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb480-9"><a href="mod-04.html#cb480-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(pct){</span>
<span id="cb480-10"><a href="mod-04.html#cb480-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="dv">100</span><span class="sc">*</span>res)</span>
<span id="cb480-11"><a href="mod-04.html#cb480-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb480-12"><a href="mod-04.html#cb480-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(res)</span>
<span id="cb480-13"><a href="mod-04.html#cb480-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb480-14"><a href="mod-04.html#cb480-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb480-15"><a href="mod-04.html#cb480-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-16"><a href="mod-04.html#cb480-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(a)</span>
<span id="cb480-17"><a href="mod-04.html#cb480-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.98339</span></span>
<span id="cb480-18"><a href="mod-04.html#cb480-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cv</span>(a)        <span class="co"># as percent</span></span>
<span id="cb480-19"><a href="mod-04.html#cb480-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 49.1881</span></span>
<span id="cb480-20"><a href="mod-04.html#cb480-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cv</span>(a, <span class="cn">FALSE</span>) <span class="co"># as ratio</span></span>
<span id="cb480-21"><a href="mod-04.html#cb480-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.491881</span></span>
<span id="cb480-22"><a href="mod-04.html#cb480-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-23"><a href="mod-04.html#cb480-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(b)</span>
<span id="cb480-24"><a href="mod-04.html#cb480-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 10.09674</span></span>
<span id="cb480-25"><a href="mod-04.html#cb480-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cv</span>(b)        <span class="co"># as percent</span></span>
<span id="cb480-26"><a href="mod-04.html#cb480-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 49.43409</span></span>
<span id="cb480-27"><a href="mod-04.html#cb480-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cv</span>(b, <span class="cn">FALSE</span>) <span class="co"># as ratio</span></span>
<span id="cb480-28"><a href="mod-04.html#cb480-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.4943409</span></span></code></pre></div>
<p>Another statistic related to the variance is the <strong>standard error (SE)</strong>, sometimes also called the “standard error of the mean (SEM)”.
There is no built-in function for <strong>standard error (SE)</strong> so it must be calculated using the sample size (function <code>length()</code>).
Note that you should <a href="mod-01.html#mod01-se">almost never compute and report SE</a> because SD is more appropriate in almost every situation.
The SE is a statement of uncertainty about a <em>mean</em>, whereas SD is a statement about variability among values.</p>
<p>If you insist on calculating SE, here is how:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="mod-04.html#cb481-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb481-2"><a href="mod-04.html#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(a)</span>
<span id="cb481-3"><a href="mod-04.html#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8029621</span></span>
<span id="cb481-4"><a href="mod-04.html#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(a)</span>
<span id="cb481-5"><a href="mod-04.html#cb481-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8960815</span></span>
<span id="cb481-6"><a href="mod-04.html#cb481-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">var</span>(a)) <span class="co"># equivalent to sd(a)</span></span>
<span id="cb481-7"><a href="mod-04.html#cb481-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8960815</span></span>
<span id="cb481-8"><a href="mod-04.html#cb481-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-9"><a href="mod-04.html#cb481-9" aria-hidden="true" tabindex="-1"></a><span class="co"># standard error of the mean</span></span>
<span id="cb481-10"><a href="mod-04.html#cb481-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(a)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(a))</span>
<span id="cb481-11"><a href="mod-04.html#cb481-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1267251</span></span></code></pre></div>
<p>Again, you almost certainly should <strong><em>not</em></strong> calculate a SE.</p>
<p>An alternative statistic called <strong>median absolute deviation (MAD)</strong> expresses variation as <em>absolute</em> deviations from the median rather than <em>squared</em> deviations from the mean.
The MAD is useful when data do not follow a normal distribution, or any of the many bell-shaped distributions.
The MAD is also considered more robust to outliers than the SD.
“Robust” in this context means “not as influenced by outliers”.
The MAD is similar to the interquartile range (see below).</p>
<p>The MAD can be obtained with the R function <code>mad()</code>.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="mod-04.html#cb482-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb482-2"><a href="mod-04.html#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mad</span>(x)</span>
<span id="cb482-3"><a href="mod-04.html#cb482-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 92.2208</span></span>
<span id="cb482-4"><a href="mod-04.html#cb482-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-5"><a href="mod-04.html#cb482-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to:</span></span>
<span id="cb482-6"><a href="mod-04.html#cb482-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span>
<span id="cb482-7"><a href="mod-04.html#cb482-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 143.226</span></span></code></pre></div>
</div>
<div id="quantiles-and-ranges" class="section level5 hasAnchor" number="4.2.1.2.2">
<h5><span class="header-section-number">4.2.1.2.2</span> Quantiles and ranges<a href="mod-04.html#quantiles-and-ranges" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Function <code>range()</code> reports the minimum and maximum values in a vector.
Like many of the functions for descriptive statistics, this function does not handle missing (<code>NA</code>) values by default.
The argument <code>na.rm=TRUE</code> must be set if there are missing values.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="mod-04.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(iris<span class="sc">$</span>Petal.Length)</span>
<span id="cb483-2"><a href="mod-04.html#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.0 6.9</span></span>
<span id="cb483-3"><a href="mod-04.html#cb483-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-4"><a href="mod-04.html#cb483-4" aria-hidden="true" tabindex="-1"></a><span class="co"># illustration of working with missing values</span></span>
<span id="cb483-5"><a href="mod-04.html#cb483-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>), <span class="cn">NA</span>)</span>
<span id="cb483-6"><a href="mod-04.html#cb483-6" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(x)</span>
<span id="cb483-7"><a href="mod-04.html#cb483-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NA NA</span></span>
<span id="cb483-8"><a href="mod-04.html#cb483-8" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb483-9"><a href="mod-04.html#cb483-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -2.256535  1.714763</span></span></code></pre></div>
<p><strong>Quantiles</strong> of data are calculated using the function <code>quantile()</code>.
A quantile is a value in a distribution or sample such that some specified proportion of observations are less than or equal to that value.
For example, the 0.5 quantile is the value such that half of values are less than or equal to that value.
Quantiles are usually expressed either as proportions in [0, 1] or as percentiles in [0, 100].
R uses proportions, but you can always multiply by 100 to get percentiles.</p>
<p>Special quantiles are also available as their own functions: minimum <code>min()</code>, median <code>median()</code>, maximum <code>max()</code>, and interquartile range <code>IQR()</code>.
Remember that argument <code>na.rm</code> is needed for many of these functions if there are missing values!</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="mod-04.html#cb484-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb484-2"><a href="mod-04.html#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 20th percentile (aka: 1st quintile)</span></span>
<span id="cb484-3"><a href="mod-04.html#cb484-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(a, <span class="at">probs=</span><span class="fl">0.2</span>) </span>
<span id="cb484-4"><a href="mod-04.html#cb484-4" aria-hidden="true" tabindex="-1"></a><span class="do">##        20% </span></span>
<span id="cb484-5"><a href="mod-04.html#cb484-5" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.6203262</span></span>
<span id="cb484-6"><a href="mod-04.html#cb484-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 75th percentile (aka: 3rd quartile)</span></span>
<span id="cb484-7"><a href="mod-04.html#cb484-7" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(a, <span class="at">probs=</span><span class="fl">0.75</span>) </span>
<span id="cb484-8"><a href="mod-04.html#cb484-8" aria-hidden="true" tabindex="-1"></a><span class="do">##       75% </span></span>
<span id="cb484-9"><a href="mod-04.html#cb484-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.6651086</span></span>
<span id="cb484-10"><a href="mod-04.html#cb484-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.5 and 97.5 percentiles</span></span>
<span id="cb484-11"><a href="mod-04.html#cb484-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e. 95% CI of a normal distribution)</span></span>
<span id="cb484-12"><a href="mod-04.html#cb484-12" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(a, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) </span>
<span id="cb484-13"><a href="mod-04.html#cb484-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      2.5%     97.5% </span></span>
<span id="cb484-14"><a href="mod-04.html#cb484-14" aria-hidden="true" tabindex="-1"></a><span class="do">## -1.663476  1.706863</span></span>
<span id="cb484-15"><a href="mod-04.html#cb484-15" aria-hidden="true" tabindex="-1"></a><span class="co"># minimum, or 0th percentile</span></span>
<span id="cb484-16"><a href="mod-04.html#cb484-16" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(a) </span>
<span id="cb484-17"><a href="mod-04.html#cb484-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -1.948787</span></span>
<span id="cb484-18"><a href="mod-04.html#cb484-18" aria-hidden="true" tabindex="-1"></a><span class="co"># maximum, or 100th percentile</span></span>
<span id="cb484-19"><a href="mod-04.html#cb484-19" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(a)</span>
<span id="cb484-20"><a href="mod-04.html#cb484-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.281967</span></span>
<span id="cb484-21"><a href="mod-04.html#cb484-21" aria-hidden="true" tabindex="-1"></a><span class="co"># interquartile range (75th – 25th percentile) </span></span>
<span id="cb484-22"><a href="mod-04.html#cb484-22" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(a) </span>
<span id="cb484-23"><a href="mod-04.html#cb484-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.220554</span></span>
<span id="cb484-24"><a href="mod-04.html#cb484-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-25"><a href="mod-04.html#cb484-25" aria-hidden="true" tabindex="-1"></a><span class="co"># demonstration of na.rm</span></span>
<span id="cb484-26"><a href="mod-04.html#cb484-26" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(a, <span class="cn">NA</span>)</span>
<span id="cb484-27"><a href="mod-04.html#cb484-27" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(b)</span>
<span id="cb484-28"><a href="mod-04.html#cb484-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NA</span></span>
<span id="cb484-29"><a href="mod-04.html#cb484-29" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(b,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb484-30"><a href="mod-04.html#cb484-30" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -1.948787</span></span></code></pre></div>
<p>If you are using the median to summarize a set of values, it is probably more appropriate to report their variability using the interquartile range (IQR) rather than the SD.
This will likely come up with data that are right-skewed.
Such data are often normally distributed on the log scale, but log-scale summary statistics aren’t very useful for a reader.
Notice in the figure below how the mean and median differ.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-304-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="useful-functions-in-r" class="section level5 hasAnchor" number="4.2.1.2.3">
<h5><span class="header-section-number">4.2.1.2.3</span> Useful functions in R<a href="mod-04.html#useful-functions-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>You can get a quick numerical summary of a vector or a dataset with <code>summary()</code>.
The examples below use the built-in dataset <code>iris</code>.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="mod-04.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="mod-04.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris<span class="sc">$</span>Petal.Length)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   1.600   4.350   3.758   5.100   6.900</code></pre>
</div>
</div>
</div>
<div id="mod-04-agg" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Summarizing by groups (AKA: pivot tables)<a href="mod-04.html#mod-04-agg" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="aggregate-and-tapply" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> <code>aggregate()</code> and <code>tapply()</code><a href="mod-04.html#aggregate-and-tapply" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One of the most common data operations is <strong>aggregation</strong>, or <strong>summarization by groups</strong>.
In Excel, this is done using <strong>Pivot Tables</strong>.
In R, the functions <code>aggregate()</code> and <code>tapply()</code> are used for pivot table-like functionality.
The <code>tidyverse</code> equivalent for <code>aggregate()</code> and <code>tapply()</code> is <code>dplyr::summarise()</code>.
All of these can be much more powerful than an Excel pivot table (below).</p>
<p><img src="04_01.jpg" width="100%" style="display: block; margin: auto;" /></p>
<div id="aggregate" class="section level5 hasAnchor" number="4.2.2.1.1">
<h5><span class="header-section-number">4.2.2.1.1</span> <code>aggregate()</code><a href="mod-04.html#aggregate" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The most important inputs to <code>aggregate()</code> are the data to be summarized, the variable or variables that define the groups, and the function by which to summarize.
The examples below shows how to calculate the mean petal length for each species in the <code>iris</code> dataset.
If the variable to be summarized and the grouping variables are in the same data frame (which is usually the case), you can use the formula interface to <code>aggregate()</code>; otherwise, use the <code>by=</code> interface.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="mod-04.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example using by=</span></span>
<span id="cb489-2"><a href="mod-04.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb489-3"><a href="mod-04.html#cb489-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">by=</span><span class="fu">list</span>(iris<span class="sc">$</span>Species),</span>
<span id="cb489-4"><a href="mod-04.html#cb489-4" aria-hidden="true" tabindex="-1"></a>          mean)</span></code></pre></div>
<pre><code>##      Group.1     x
## 1     setosa 1.462
## 2 versicolor 4.260
## 3  virginica 5.552</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="mod-04.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># better method using formula</span></span>
<span id="cb491-2"><a href="mod-04.html#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb491-3"><a href="mod-04.html#cb491-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>iris,</span>
<span id="cb491-4"><a href="mod-04.html#cb491-4" aria-hidden="true" tabindex="-1"></a>          mean)</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa        1.462
## 2 versicolor        4.260
## 3  virginica        5.552</code></pre>
<p>The formula interface is cleaner and easier than the <code>by=</code> interface (first example), and has the key advantage that it automatically passes variable names to the result.
If you use <code>by=</code> you may want to rename the columns in the result.</p>
<p>In my own code I prefer to name my aggregation tables <code>agg</code>, with additional parts like <code>agg1</code>, <code>agg.fish</code>, and so on if needed.
Function <code>aggregate()</code> produces a data frame with a column for each grouping variable (<code>Group.1</code>, <code>Group.2</code> and so on) and a single column <code>x</code> containing the summarized values.
We can use this property to construct tables that summarize by more than one variable.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="mod-04.html#cb493-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb493-2"><a href="mod-04.html#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add another grouping variable</span></span>
<span id="cb493-3"><a href="mod-04.html#cb493-3" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb493-4"><a href="mod-04.html#cb493-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-5"><a href="mod-04.html#cb493-5" aria-hidden="true" tabindex="-1"></a><span class="co"># by= example: notice how columns in result need to be renamed</span></span>
<span id="cb493-6"><a href="mod-04.html#cb493-6" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(x<span class="sc">$</span>Petal.Length,</span>
<span id="cb493-7"><a href="mod-04.html#cb493-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">by=</span><span class="fu">list</span>(x<span class="sc">$</span>Species, x<span class="sc">$</span>color),</span>
<span id="cb493-8"><a href="mod-04.html#cb493-8" aria-hidden="true" tabindex="-1"></a>                 mean)</span>
<span id="cb493-9"><a href="mod-04.html#cb493-9" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Group.1 Group.2     x
## 1     setosa     red 1.456
## 2 versicolor     red 4.308
## 3  virginica     red 5.564
## 4     setosa   white 1.468
## 5 versicolor   white 4.212
## 6  virginica   white 5.540</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="mod-04.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change column names</span></span>
<span id="cb495-2"><a href="mod-04.html#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;spp&quot;</span>, <span class="st">&quot;color&quot;</span>, <span class="st">&quot;mean&quot;</span>)</span>
<span id="cb495-3"><a href="mod-04.html#cb495-3" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##          spp color  mean
## 1     setosa   red 1.456
## 2 versicolor   red 4.308
## 3  virginica   red 5.564
## 4     setosa white 1.468
## 5 versicolor white 4.212
## 6  virginica white 5.540</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="mod-04.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># formula example: much easier</span></span>
<span id="cb497-2"><a href="mod-04.html#cb497-2" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species<span class="sc">+</span>color, <span class="at">data=</span>x, mean)</span>
<span id="cb497-3"><a href="mod-04.html#cb497-3" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Species color Petal.Length
## 1     setosa   red        1.456
## 2 versicolor   red        4.308
## 3  virginica   red        5.564
## 4     setosa white        1.468
## 5 versicolor white        4.212
## 6  virginica white        5.540</code></pre>
<p>Notice that in <code>agg</code> the values are sorted by the grouping variables from right to left: in this example, by <code>color</code>, then <code>Species</code>.
This is the reverse of the order in the original command.
The result of <code>aggregate()</code> is a data frame, so data within it can be rearranged using <code>order()</code>.</p>
<p>Often we want to summarize a variable by multiple functions–for example, to get a table with the mean and SD in each group.
My preferred way to do this is to use several <code>aggregate()</code> commands, and then combine the results.
The examples below shows two ways to construct a table with the mean and SD of a variable.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="mod-04.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a formula and save some typing:</span></span>
<span id="cb499-2"><a href="mod-04.html#cb499-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">formula</span>(Petal.Length<span class="sc">~</span>Species)</span>
<span id="cb499-3"><a href="mod-04.html#cb499-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-4"><a href="mod-04.html#cb499-4" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: single table using formula</span></span>
<span id="cb499-5"><a href="mod-04.html#cb499-5" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, mean)</span>
<span id="cb499-6"><a href="mod-04.html#cb499-6" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, sd)<span class="sc">$</span>Petal.Length</span>
<span id="cb499-7"><a href="mod-04.html#cb499-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="fu">which</span>(<span class="fu">names</span>(agg) <span class="sc">==</span> <span class="st">&quot;Petal.Length&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;mn&quot;</span></span>
<span id="cb499-8"><a href="mod-04.html#cb499-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-9"><a href="mod-04.html#cb499-9" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Species    mn        sd
## 1     setosa 1.462 0.1736640
## 2 versicolor 4.260 0.4699110
## 3  virginica 5.552 0.5518947</code></pre>
<p>The <code>$Petal.Length</code> on the end of <code>aggregate()</code> is important because we want only column <code>Petal.Length</code> of the output.
Without <code>$Petal.Length</code>, the result will be messy when we try to add it to <code>agg</code>.
If you ever want to do this with the <code>by=</code> method, the column of the output containing the summarized values will be named <code>x</code>.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="mod-04.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1a: single table, using by=</span></span>
<span id="cb501-2"><a href="mod-04.html#cb501-2" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(iris<span class="sc">$</span>Petal.Length, <span class="at">by=</span><span class="fu">list</span>(iris<span class="sc">$</span>Species), mean)</span>
<span id="cb501-3"><a href="mod-04.html#cb501-3" aria-hidden="true" tabindex="-1"></a><span class="do">## note use of $x:</span></span>
<span id="cb501-4"><a href="mod-04.html#cb501-4" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(iris<span class="sc">$</span>Petal.Length, <span class="at">by=</span><span class="fu">list</span>(iris<span class="sc">$</span>Species), sd)<span class="sc">$</span>x</span>
<span id="cb501-5"><a href="mod-04.html#cb501-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-6"><a href="mod-04.html#cb501-6" aria-hidden="true" tabindex="-1"></a><span class="co"># change names in result:</span></span>
<span id="cb501-7"><a href="mod-04.html#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="fu">which</span>(<span class="fu">names</span>(agg) <span class="sc">==</span> <span class="st">&quot;x&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;mn&quot;</span></span>
<span id="cb501-8"><a href="mod-04.html#cb501-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="fu">which</span>(<span class="fu">names</span>(agg) <span class="sc">==</span> <span class="st">&quot;Group.1&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;species&quot;</span></span>
<span id="cb501-9"><a href="mod-04.html#cb501-9" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      species    mn        sd
## 1     setosa 1.462 0.1736640
## 2 versicolor 4.260 0.4699110
## 3  virginica 5.552 0.5518947</code></pre>
<p>The second approach is to make several <code>aggregate()</code> tables, and combine them into a single result.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="mod-04.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: multiple tables</span></span>
<span id="cb503-2"><a href="mod-04.html#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           (note: there are lots of ways to do this)</span></span>
<span id="cb503-3"><a href="mod-04.html#cb503-3" aria-hidden="true" tabindex="-1"></a>agg.mn <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, mean)</span>
<span id="cb503-4"><a href="mod-04.html#cb503-4" aria-hidden="true" tabindex="-1"></a>agg.sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(f1, <span class="at">data=</span>x, sd)</span>
<span id="cb503-5"><a href="mod-04.html#cb503-5" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(agg.mn, <span class="at">sd=</span>agg.sd<span class="sc">$</span>Petal.Length)</span>
<span id="cb503-6"><a href="mod-04.html#cb503-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(agg)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;mn&quot;</span></span>
<span id="cb503-7"><a href="mod-04.html#cb503-7" aria-hidden="true" tabindex="-1"></a>agg</span></code></pre></div>
<pre><code>##      Species    mn        sd
## 1     setosa 1.462 0.1736640
## 2 versicolor 4.260 0.4699110
## 3  virginica 5.552 0.5518947</code></pre>
</div>
<div id="tapply" class="section level5 hasAnchor" number="4.2.2.1.2">
<h5><span class="header-section-number">4.2.2.1.2</span> <code>tapply()</code><a href="mod-04.html#tapply" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The base function <code>tapply()</code>, like <code>aggregate()</code>, summarizes a numeric variable by a grouping variable.
In fact, <code>aggregate()</code> uses <code>tapply()</code> internally.
The difference is that while <code>aggregate()</code> returns a data frame, <code>tapply()</code> returns an array with number of dimensions equal to the number of grouping variables.</p>
<p>The inputs are a vector to be summarized, a grouping variable or set of variables, and the function by which to summarize.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="mod-04.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spare copy</span></span>
<span id="cb505-2"><a href="mod-04.html#cb505-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb505-3"><a href="mod-04.html#cb505-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add some extra grouping variables</span></span>
<span id="cb505-4"><a href="mod-04.html#cb505-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb505-5"><a href="mod-04.html#cb505-5" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>treat <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb505-6"><a href="mod-04.html#cb505-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-7"><a href="mod-04.html#cb505-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tapply by 1, 2, or 3 variables:</span></span>
<span id="cb505-8"><a href="mod-04.html#cb505-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(x<span class="sc">$</span>Petal.Length, x<span class="sc">$</span>Species, mean)</span></code></pre></div>
<pre><code>##     setosa versicolor  virginica 
##      1.462      4.260      5.552</code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="mod-04.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(x<span class="sc">$</span>Petal.Length, x[,<span class="fu">c</span>(<span class="st">&quot;Species&quot;</span>, <span class="st">&quot;color&quot;</span>)], mean)</span></code></pre></div>
<pre><code>##             color
## Species        red white
##   setosa     1.456 1.468
##   versicolor 4.308 4.212
##   virginica  5.564 5.540</code></pre>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="mod-04.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(x<span class="sc">$</span>Petal.Length, x[,<span class="fu">c</span>(<span class="st">&quot;Species&quot;</span>, <span class="st">&quot;color&quot;</span>, <span class="st">&quot;treat&quot;</span>)], mean)</span></code></pre></div>
<pre><code>## , , treat = a
## 
##             color
## Species         red    white
##   setosa     1.5000 1.475000
##   versicolor 4.3875 4.033333
##   virginica  5.4250 5.712500
## 
## , , treat = b
## 
##             color
## Species           red    white
##   setosa     1.375000 1.444444
##   versicolor 4.362500 4.300000
##   virginica  5.644444 5.312500
## 
## , , treat = c
## 
##             color
## Species           red    white
##   setosa     1.487500 1.487500
##   versicolor 4.188889 4.325000
##   virginica  5.612500 5.588889</code></pre>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="mod-04.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vary the arrangement of groups:</span></span>
<span id="cb511-2"><a href="mod-04.html#cb511-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(x<span class="sc">$</span>Petal.Length, x[,<span class="fu">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;Species&quot;</span>)], mean)</span></code></pre></div>
<pre><code>##        Species
## color   setosa versicolor virginica
##   red    1.456      4.308     5.564
##   white  1.468      4.212     5.540</code></pre>
<p>Personally, I prefer <code>aggregate()</code> to <code>tapply()</code> because it is usually more convenient to have the results in a data frame.</p>
</div>
</div>
<div id="summarizing-by-arbitrary-functions" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Summarizing by arbitrary functions<a href="mod-04.html#summarizing-by-arbitrary-functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you’ve ever used Excel Pivot Tables, you will have noticed that data can only be summarized by a limited set of functions.
On the other hand, <code>aggregate()</code> (and <code>tapply()</code>, but we’ll focus on <code>aggregate()</code>) can be used with pretty much any function that takes in a vector and returns a scalar.
You can even write your own functions!
Below are some examples.
Notice in the first example that arguments to the summarizing function follow its name.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="mod-04.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first quartile (25th percentile)</span></span>
<span id="cb513-2"><a href="mod-04.html#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species, <span class="at">data=</span>iris, quantile, <span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa          1.4
## 2 versicolor          4.0
## 3  virginica          5.1</code></pre>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="mod-04.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of values</span></span>
<span id="cb515-2"><a href="mod-04.html#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species, <span class="at">data=</span>iris, length)</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa           50
## 2 versicolor           50
## 3  virginica           50</code></pre>
<p>The following examples illustrate <strong>anonymous functions</strong>: functions defined within another function and never defined in the R workspace.
The <code>x</code> in <code>function(x)</code> is taken to be the values within each group defined by the variable(s) on the right-hand side of <code>~</code> or in <code>by=</code>.
Notice that the end of such a command will need a lot of <code>)</code>, <code>}</code>, and sometimes <code>]</code>.
Using an editor with syntax highlighting is very helpful!</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="mod-04.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of missing values</span></span>
<span id="cb517-2"><a href="mod-04.html#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb517-3"><a href="mod-04.html#cb517-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>iris,</span>
<span id="cb517-4"><a href="mod-04.html#cb517-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(x)))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa            0
## 2 versicolor            0
## 3  virginica            0</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="mod-04.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of non-missing values</span></span>
<span id="cb519-2"><a href="mod-04.html#cb519-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species, </span>
<span id="cb519-3"><a href="mod-04.html#cb519-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>iris,</span>
<span id="cb519-4"><a href="mod-04.html#cb519-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa           50
## 2 versicolor           50
## 3  virginica           50</code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="mod-04.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of values &gt;= 2</span></span>
<span id="cb521-2"><a href="mod-04.html#cb521-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb521-3"><a href="mod-04.html#cb521-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>iris,</span>
<span id="cb521-4"><a href="mod-04.html#cb521-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(x <span class="sc">&gt;=</span> <span class="dv">2</span>))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa            0
## 2 versicolor           50
## 3  virginica           50</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="mod-04.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of UNIQUE values &gt;= 2</span></span>
<span id="cb523-2"><a href="mod-04.html#cb523-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species,</span>
<span id="cb523-3"><a href="mod-04.html#cb523-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>iris,</span>
<span id="cb523-4"><a href="mod-04.html#cb523-4" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">unique</span>(x[<span class="fu">which</span>(x <span class="sc">&gt;=</span> <span class="dv">2</span>)]))})</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1     setosa            0
## 2 versicolor           19
## 3  virginica           20</code></pre>
<p>Being able to use almost any function, and to define your own functions, makes <code>aggregate()</code> an immensely powerful tool to have in your R toolbox.</p>
</div>
</div>
<div id="summarizing-data-with-the-apply-family" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Summarizing data with the <code>apply()</code> family<a href="mod-04.html#summarizing-data-with-the-apply-family" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>apply()</code> family is a group of functions that operate over the <strong>dimensions</strong> of an object.
You can use the <code>apply()</code> family to summarize across rows or columns, or across elements of a list, and so on.
The function used most often is <code>apply()</code>, which works on data frames, matrices and arrays.
There are also <code>lapply()</code>, which works on lists and returns a list; <code>sapply()</code>, which operates on lists and returns the simplest object possible; and many others.
We already saw <code>tapply()</code>, which works on subsets of a data frame or array.</p>
<div id="apply-for-arrays-and-data-frames" class="section level4 hasAnchor" number="4.2.3.1">
<h4><span class="header-section-number">4.2.3.1</span> <code>apply()</code> for arrays and data frames<a href="mod-04.html#apply-for-arrays-and-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Function <code>apply()</code> works on arrays and data frames with <span class="math inline">\(\ge\)</span> 2 dimensions.
Its arguments are the object to be operated on, the margin (or dimension) on which to operate, and the operation (or function).
The first margin is rows, the second is columns, and so on.
The result of <code>apply()</code> will <em>always</em> have one fewer dimension than the input.</p>
<p>Some typical <code>apply()</code> commands are demonstrated below:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="mod-04.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test dataset with only numeric values</span></span>
<span id="cb525-2"><a href="mod-04.html#cb525-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb525-3"><a href="mod-04.html#cb525-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-4"><a href="mod-04.html#cb525-4" aria-hidden="true" tabindex="-1"></a><span class="co"># margin 1 = rows --&gt; row sums</span></span>
<span id="cb525-5"><a href="mod-04.html#cb525-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">1</span>, sum)</span></code></pre></div>
<pre><code>##   [1] 10.2  9.5  9.4  9.4 10.2 11.4  9.7 10.1  8.9  9.6 10.8 10.0  9.3  8.5 11.2
##  [16] 12.0 11.0 10.3 11.5 10.7 10.7 10.7  9.4 10.6 10.3  9.8 10.4 10.4 10.2  9.7
##  [31]  9.7 10.7 10.9 11.3  9.7  9.6 10.5 10.0  8.9 10.2 10.1  8.4  9.1 10.7 11.2
##  [46]  9.5 10.7  9.4 10.7  9.9 16.3 15.6 16.4 13.1 15.4 14.3 15.9 11.6 15.4 13.2
##  [61] 11.5 14.6 13.2 15.1 13.4 15.6 14.6 13.6 14.4 13.1 15.7 14.2 15.2 14.8 14.9
##  [76] 15.4 15.8 16.4 14.9 12.8 12.8 12.6 13.6 15.4 14.4 15.5 16.0 14.3 14.0 13.3
##  [91] 13.7 15.1 13.6 11.6 13.8 14.1 14.1 14.7 11.7 13.9 18.1 15.5 18.1 16.6 17.5
## [106] 19.3 13.6 18.3 16.8 19.4 16.8 16.3 17.4 15.2 16.1 17.2 16.8 20.4 19.5 14.7
## [121] 18.1 15.3 19.2 15.7 17.8 18.2 15.6 15.8 16.9 17.6 18.2 20.1 17.0 15.7 15.7
## [136] 19.1 17.7 16.8 15.6 17.5 17.8 17.4 15.5 18.2 18.2 17.2 15.7 16.7 17.3 15.8</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="mod-04.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co"># margin 2 = columns --&gt; column sums</span></span>
<span id="cb527-2"><a href="mod-04.html#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, sum) <span class="co"># 2 = columns</span></span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##        876.5        458.6        563.7        179.9</code></pre>
<p>The first <code>apply()</code> command above calculates the sum of values in each row (margin <code>1</code>) of its input <code>x</code>.
The second <code>apply()</code> command calculates the sum of values in each column (margin <code>2</code>).
The results are vectors whose lengths are the same as the corresponding dimension of the input (number of rows or columns).</p>
<p>The first commmand above is equivalent to:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="mod-04.html#cb529-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(x))</span>
<span id="cb529-2"><a href="mod-04.html#cb529-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)){y[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x[i,])}</span>
<span id="cb529-3"><a href="mod-04.html#cb529-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-4"><a href="mod-04.html#cb529-4" aria-hidden="true" tabindex="-1"></a><span class="co"># verify that results are the same:</span></span>
<span id="cb529-5"><a href="mod-04.html#cb529-5" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, sum) <span class="sc">==</span> y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Below are some examples of calculations you can do with the <code>apply()</code> function.
Notice that when the function to be applied takes its own arguments, those arguments are supplied following the function name, in the same order as they would be supplied to the function if used outside of <code>apply()</code>.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="mod-04.html#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="co"># column minima</span></span>
<span id="cb531-2"><a href="mod-04.html#cb531-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, min)</span>
<span id="cb531-3"><a href="mod-04.html#cb531-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb531-4"><a href="mod-04.html#cb531-4" aria-hidden="true" tabindex="-1"></a><span class="do">##          4.3          2.0          1.0          0.1</span></span>
<span id="cb531-5"><a href="mod-04.html#cb531-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-6"><a href="mod-04.html#cb531-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 75th percentile of each column</span></span>
<span id="cb531-7"><a href="mod-04.html#cb531-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, quantile, <span class="fl">0.75</span>)</span>
<span id="cb531-8"><a href="mod-04.html#cb531-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb531-9"><a href="mod-04.html#cb531-9" aria-hidden="true" tabindex="-1"></a><span class="do">##          6.4          3.3          5.1          1.8</span></span>
<span id="cb531-10"><a href="mod-04.html#cb531-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-11"><a href="mod-04.html#cb531-11" aria-hidden="true" tabindex="-1"></a><span class="co"># interquartile range of each row</span></span>
<span id="cb531-12"><a href="mod-04.html#cb531-12" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">1</span>, IQR)</span>
<span id="cb531-13"><a href="mod-04.html#cb531-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   [1] 2.800 2.375 2.550 2.300 2.850 2.900 2.575 2.625 2.175 2.400 2.950 2.500</span></span>
<span id="cb531-14"><a href="mod-04.html#cb531-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  [13] 2.375 2.475 3.500 3.500 3.200 2.775 2.925 2.925 2.575 2.825 3.050 2.350</span></span>
<span id="cb531-15"><a href="mod-04.html#cb531-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  [25] 2.275 2.250 2.500 2.750 2.750 2.325 2.275 2.675 3.225 3.425 2.375 2.700</span></span>
<span id="cb531-16"><a href="mod-04.html#cb531-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  [37] 2.975 2.850 2.325 2.650 2.825 1.800 2.475 2.525 2.600 2.325 2.875 2.450</span></span>
<span id="cb531-17"><a href="mod-04.html#cb531-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  [49] 2.925 2.625 2.525 2.200 2.700 2.325 2.600 2.375 2.225 1.650 2.600 1.850</span></span>
<span id="cb531-18"><a href="mod-04.html#cb531-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  [61] 2.125 2.000 2.600 2.525 1.600 2.300 2.150 2.250 2.900 2.175 2.225 2.100</span></span>
<span id="cb531-19"><a href="mod-04.html#cb531-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  [73] 3.000 2.650 2.325 2.350 2.850 2.750 2.325 1.850 2.150 2.100 2.050 2.900</span></span>
<span id="cb531-20"><a href="mod-04.html#cb531-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  [85] 2.100 1.925 2.500 2.825 1.900 2.175 2.425 2.375 2.200 1.750 2.200 2.025</span></span>
<span id="cb531-21"><a href="mod-04.html#cb531-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  [97] 2.075 2.275 1.375 2.075 2.975 2.775 3.425 3.150 3.175 4.075 2.300 3.925</span></span>
<span id="cb531-22"><a href="mod-04.html#cb531-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [109] 3.700 3.050 2.550 3.075 3.050 2.800 2.575 2.600 3.050 3.550 4.575 3.225</span></span>
<span id="cb531-23"><a href="mod-04.html#cb531-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [121] 3.025 2.475 4.350 2.775 2.950 3.450 2.600 2.500 3.175 3.500 3.850 3.425</span></span>
<span id="cb531-24"><a href="mod-04.html#cb531-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [133] 3.150 2.925 3.425 3.675 2.625 2.950 2.400 2.925 2.950 2.650 2.775 3.150</span></span>
<span id="cb531-25"><a href="mod-04.html#cb531-25" aria-hidden="true" tabindex="-1"></a><span class="do">## [145] 2.850 2.750 2.975 2.775 2.475 2.600</span></span></code></pre></div>
<p>Arrays with &gt;2 dimensions can have functions applied across multiple dimensions:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="mod-04.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># object with 3 rows, 2 columns, and 3 &quot;layers&quot;:</span></span>
<span id="cb532-2"><a href="mod-04.html#cb532-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>, <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb532-3"><a href="mod-04.html#cb532-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-4"><a href="mod-04.html#cb532-4" aria-hidden="true" tabindex="-1"></a><span class="co"># how many dimensions does the result have?</span></span>
<span id="cb532-5"><a href="mod-04.html#cb532-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), sum)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   21   30
## [2,]   24   33
## [3,]   27   36</code></pre>
<p>You can also write custom functions and apply them to rows or columns.
Below are some useful functions to apply.
These functions can be defined inside <code>apply()</code> or outside <code>apply()</code>.
Each of the functions below takes an input called <code>x</code>, but this is not as the <code>x</code> that is the input to <code>apply()</code>.
The <code>x</code> in <code>function(x)</code> is used inside the braces <code>{}</code> as the name for the input passed from <code>apply()</code> to the inner function.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="mod-04.html#cb534-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb534-2"><a href="mod-04.html#cb534-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-3"><a href="mod-04.html#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="co"># count values &gt; 2</span></span>
<span id="cb534-4"><a href="mod-04.html#cb534-4" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(x <span class="sc">&gt;</span> <span class="dv">2</span>))})</span>
<span id="cb534-5"><a href="mod-04.html#cb534-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb534-6"><a href="mod-04.html#cb534-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          150          149          100           23</span></span>
<span id="cb534-7"><a href="mod-04.html#cb534-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-8"><a href="mod-04.html#cb534-8" aria-hidden="true" tabindex="-1"></a><span class="co"># count missing (NA) values</span></span>
<span id="cb534-9"><a href="mod-04.html#cb534-9" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(x)))})</span>
<span id="cb534-10"><a href="mod-04.html#cb534-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb534-11"><a href="mod-04.html#cb534-11" aria-hidden="true" tabindex="-1"></a><span class="do">##            0            0            0            0</span></span>
<span id="cb534-12"><a href="mod-04.html#cb534-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-13"><a href="mod-04.html#cb534-13" aria-hidden="true" tabindex="-1"></a><span class="co"># count non-missing values</span></span>
<span id="cb534-14"><a href="mod-04.html#cb534-14" aria-hidden="true" tabindex="-1"></a>count.nonmissing <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)))}</span>
<span id="cb534-15"><a href="mod-04.html#cb534-15" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(x, <span class="dv">2</span>, count.nonmissing)</span>
<span id="cb534-16"><a href="mod-04.html#cb534-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb534-17"><a href="mod-04.html#cb534-17" aria-hidden="true" tabindex="-1"></a><span class="do">##          150          150          150          150</span></span></code></pre></div>
</div>
<div id="lapply-and-sapply-for-lists-and-other-objects" class="section level4 hasAnchor" number="4.2.3.2">
<h4><span class="header-section-number">4.2.3.2</span> <code>lapply()</code> and <code>sapply()</code> for lists and other objects<a href="mod-04.html#lapply-and-sapply-for-lists-and-other-objects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The other members of the <code>apply()</code> family that are most often used are <code>lapply()</code> and <code>sapply()</code>.</p>
<ul>
<li><code>lapply()</code>, operates on lists and returns a <em>list</em>. Short for “list apply”, and usually pronounced “el apply” (or maybe “lap-lie”).</li>
<li><code>sapply()</code> operates on many object types (including lists) and returns the simplest object possible. Short for “simplify apply”, and usually pronounced “ess apply” or “sap-lie”. Usually the goal with <code>sapply()</code> is to get a vector or matrix out of a list.</li>
</ul>
<p>The code block below makes a list called <code>mylist</code> and illustrates the use of <code>lapply()</code> and <code>sapply()</code>.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="mod-04.html#cb535-1" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dv">5</span>)</span>
<span id="cb535-2"><a href="mod-04.html#cb535-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mylist)){</span>
<span id="cb535-3"><a href="mod-04.html#cb535-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb535-4"><a href="mod-04.html#cb535-4" aria-hidden="true" tabindex="-1"></a>    mylist[[i]] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x)</span>
<span id="cb535-5"><a href="mod-04.html#cb535-5" aria-hidden="true" tabindex="-1"></a>}<span class="co">#i</span></span>
<span id="cb535-6"><a href="mod-04.html#cb535-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-7"><a href="mod-04.html#cb535-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimated mean of each element of mylist, in a list</span></span>
<span id="cb535-8"><a href="mod-04.html#cb535-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(mylist, <span class="cf">function</span>(x){x<span class="sc">$</span>estimate})</span></code></pre></div>
<pre><code>## [[1]]
## mean of x 
## 0.2532857 
## 
## [[2]]
## mean of x 
##   0.24109 
## 
## [[3]]
##  mean of x 
## 0.03012403 
## 
## [[4]]
##  mean of x 
## 0.03754321 
## 
## [[5]]
##  mean of x 
## 0.03765989</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="mod-04.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimated mean of each element, simplified to vector</span></span>
<span id="cb537-2"><a href="mod-04.html#cb537-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(mylist, <span class="cf">function</span>(x){x<span class="sc">$</span>estimate})</span></code></pre></div>
<pre><code>##  mean of x  mean of x  mean of x  mean of x  mean of x 
## 0.25328572 0.24109003 0.03012403 0.03754321 0.03765989</code></pre>
<p>The function <code>lapply()</code> can sometimes be combined with <code>do.call()</code> to produce similar outputs as <code>sapply()</code>:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="mod-04.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(c, <span class="fu">lapply</span>(mylist, <span class="cf">function</span>(x){x<span class="sc">$</span>estimate}))</span></code></pre></div>
<pre><code>##  mean of x  mean of x  mean of x  mean of x  mean of x 
## 0.25328572 0.24109003 0.03012403 0.03754321 0.03765989</code></pre>
<p>Clever use of <code>lapply()</code> and <code>sapply()</code> can save you a lot of time and typing.
Interestingly, using these functions can make base R code feel a lot like <code>tidyverse</code> code, in the sense that commands are issued as functions with much less focus on manipulating objects.</p>
</div>
</div>
<div id="mod-04-tab" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Tabulation (frequency tables)<a href="mod-04.html#mod-04-tab" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Aggregation is summarizing numeric variables by group.
The equivalent for non-numeric variables is <strong>tabulation</strong>.
A lot of tabulation is just counting.
R can do a lot of counting for you.</p>
<div id="table-to-count-occcurrences" class="section level4 hasAnchor" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> <code>table()</code> to count occcurrences<a href="mod-04.html#table-to-count-occcurrences" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>table()</code> function tallies the occurrences of each unique value in a vector.
Notice that <code>table()</code> only returns a result for the values that actually occur in the input.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="mod-04.html#cb541-1" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">50</span>,<span class="dv">10</span>)  <span class="co"># Random Poisson distribution</span></span>
<span id="cb541-2"><a href="mod-04.html#cb541-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(aa)</span></code></pre></div>
<pre><code>## aa
##  4  5  6  7  8  9 10 11 12 13 14 16 17 20 
##  1  3  3  5  7  5  9  5  3  2  4  1  1  1</code></pre>
<p>If you need a count that includes 0s for missing values, there are a few ways to do this.
My preferred solution is to use the custom function below.
This function counts how many times each value in <code>values</code> occurs in <code>input</code>.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="mod-04.html#cb543-1" aria-hidden="true" tabindex="-1"></a>table.all <span class="ot">&lt;-</span> <span class="cf">function</span>(input, values){</span>
<span id="cb543-2"><a href="mod-04.html#cb543-2" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">sapply</span>(values, </span>
<span id="cb543-3"><a href="mod-04.html#cb543-3" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(x){<span class="fu">length</span>(<span class="fu">which</span>(input <span class="sc">==</span> x))})</span>
<span id="cb543-4"><a href="mod-04.html#cb543-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(res) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(values)</span>
<span id="cb543-5"><a href="mod-04.html#cb543-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb543-6"><a href="mod-04.html#cb543-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb543-7"><a href="mod-04.html#cb543-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb543-8"><a href="mod-04.html#cb543-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use with random poisson values:</span></span>
<span id="cb543-9"><a href="mod-04.html#cb543-9" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="dv">10</span>)</span>
<span id="cb543-10"><a href="mod-04.html#cb543-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table.all</span>(x1, <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>)</span></code></pre></div>
<pre><code>##  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
##  0  0  0  0  0  1  1  4  1  1  0  5  2  2  1  0  1  0  0  0  1  0  0  0  0  0 
## 26 27 28 29 30 
##  0  0  0  0  0</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="mod-04.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to:</span></span>
<span id="cb545-2"><a href="mod-04.html#cb545-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x1)</span></code></pre></div>
<pre><code>## x1
##  5  6  7  8  9 11 12 13 14 16 20 
##  1  1  4  1  1  5  2  2  1  1  1</code></pre>
<p>If you plot a <code>table()</code> result, you get a sort of bar graph.
This is similar to what you get with a command like <code>plot(...,type = "h")</code><a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a>.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="mod-04.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(aa))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-322-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="mod-04-ftable" class="section level4 hasAnchor" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> <code>ftable()</code> for contingency tables<a href="mod-04.html#mod-04-ftable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Contingency tables</strong>, or <strong>frequency tables</strong> summarize how many observations occur in combinations of categories.
They are calculated with <code>ftable()</code>.
This function counts the number of values in each combination of different factors.
The example below uses the built-in dataset <code>iris</code> modified to have some additional factors.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="mod-04.html#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb548-2"><a href="mod-04.html#cb548-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb548-3"><a href="mod-04.html#cb548-3" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb548-4"><a href="mod-04.html#cb548-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>bloom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;early&quot;</span>, <span class="st">&quot;late&quot;</span>), <span class="fu">nrow</span>(x), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb548-5"><a href="mod-04.html#cb548-5" aria-hidden="true" tabindex="-1"></a>handed.table <span class="ot">&lt;-</span> <span class="fu">ftable</span>(x<span class="sc">$</span>color<span class="sc">~</span>x<span class="sc">$</span>bloom)</span>
<span id="cb548-6"><a href="mod-04.html#cb548-6" aria-hidden="true" tabindex="-1"></a>handed.table</span></code></pre></div>
<pre><code>##         x$color purple white
## x$bloom                     
## early               39    37
## late                36    38</code></pre>
<p>Contingency tables produced by <code>ftable()</code> can be used directly for chi-squared (<span class="math inline">\(\chi^2\)</span>) tests:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="mod-04.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(handed.table)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  handed.table
## X-squared = 0.026671, df = 1, p-value = 0.8703</code></pre>
<p>The function <code>ftable()</code> also has a formula interface, much like many statistical functions (e.g., <code>lm()</code>).
This is useful if you want more complicated tables or more combinations of categories.
Notice that the order of variables affects the structure of the resulting table.
The 6 commands below produce equivalent tables, but the results are organized differently.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="mod-04.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(Species<span class="sc">~</span>color<span class="sc">+</span>bloom, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##              Species setosa versicolor virginica
## color  bloom                                    
## purple early             17         13         9
##        late               8         12        16
## white  early             13         14        10
##        late              12         11        15</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="mod-04.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(Species<span class="sc">~</span>color<span class="sc">+</span>bloom, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##              Species setosa versicolor virginica
## color  bloom                                    
## purple early             17         13         9
##        late               8         12        16
## white  early             13         14        10
##        late              12         11        15</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="mod-04.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(Species<span class="sc">~</span>bloom<span class="sc">+</span>color, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##              Species setosa versicolor virginica
## bloom color                                     
## early purple             17         13         9
##       white              13         14        10
## late  purple              8         12        16
##       white              12         11        15</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="mod-04.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(color<span class="sc">~</span>Species<span class="sc">+</span>bloom, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##                  color purple white
## Species    bloom                   
## setosa     early           17    13
##            late             8    12
## versicolor early           13    14
##            late            12    11
## virginica  early            9    10
##            late            16    15</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="mod-04.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(color<span class="sc">~</span>bloom<span class="sc">+</span>Species, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##                  color purple white
## bloom Species                      
## early setosa               17    13
##       versicolor           13    14
##       virginica             9    10
## late  setosa                8    12
##       versicolor           12    11
##       virginica            16    15</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="mod-04.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(bloom<span class="sc">~</span>color<span class="sc">+</span>Species, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##                   bloom early late
## color  Species                    
## purple setosa              17    8
##        versicolor          13   12
##        virginica            9   16
## white  setosa              13   12
##        versicolor          14   11
##        virginica           10   15</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="mod-04.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(bloom<span class="sc">~</span>Species<span class="sc">+</span>color, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##                   bloom early late
## Species    color                  
## setosa     purple          17    8
##            white           13   12
## versicolor purple          13   12
##            white           14   11
## virginica  purple           9   16
##            white           10   15</code></pre>
<p>Variables on the left side of the <code>~</code> will be on the top of the table, and variables on the right side of the <code>~</code> will be on the left side of the table.
On each side, variables are ordered in reverse order from the table matrix outwards.
I can never remember how this works, so usually just have to tinker with the code until I get the table I want.</p>
<p>Compare the results of these commands:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="mod-04.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(Species<span class="sc">~</span>color<span class="sc">+</span>bloom, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##              Species setosa versicolor virginica
## color  bloom                                    
## purple early             17         13         9
##        late               8         12        16
## white  early             13         14        10
##        late              12         11        15</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="mod-04.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(Species<span class="sc">~</span>bloom<span class="sc">+</span>color, <span class="at">data=</span>x)</span></code></pre></div>
<pre><code>##              Species setosa versicolor virginica
## bloom color                                     
## early purple             17         13         9
##       white              13         14        10
## late  purple              8         12        16
##       white              12         11        15</code></pre>
<p>The output of <code>ftable()</code> is of class <code>ftable</code>, which <em>looks</em> like a matrix or data frame but does not function like one.
Sometimes it is necessary to convert an <code>ftable()</code> output to different class in order to pull values from it.
This can be done with base R conversion functions.
Notice that the data frame form of <code>handed.table</code> resembles the “long” data format we discussed in <a href="mod-03.html#mod-03-reshape">module 3</a>.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="mod-04.html#cb570-1" aria-hidden="true" tabindex="-1"></a>handed.table <span class="ot">&lt;-</span> <span class="fu">ftable</span>(x<span class="sc">$</span>Species<span class="sc">~</span>x<span class="sc">$</span>color)</span>
<span id="cb570-2"><a href="mod-04.html#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(handed.table)</span></code></pre></div>
<pre><code>##         x$Species
## x$color  setosa versicolor virginica
##   purple     25         25        25
##   white      25         25        25</code></pre>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="mod-04.html#cb572-1" aria-hidden="true" tabindex="-1"></a>handed.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(handed.table)</span>
<span id="cb572-2"><a href="mod-04.html#cb572-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(handed.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;species&quot;</span>, <span class="st">&quot;freq&quot;</span>)</span>
<span id="cb572-3"><a href="mod-04.html#cb572-3" aria-hidden="true" tabindex="-1"></a>handed.df</span></code></pre></div>
<pre><code>##    color    species freq
## 1 purple     setosa   25
## 2  white     setosa   25
## 3 purple versicolor   25
## 4  white versicolor   25
## 5 purple  virginica   25
## 6  white  virginica   25</code></pre>
</div>
</div>
</div>
<div id="mod-04-vis" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Visualizing single variables<a href="mod-04.html#mod-04-vis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In statistics, we think of values within a variable coming from a probability distribution.
<strong>Probability distributions</strong>, or <strong>distributions</strong> for short, are mathematical functions that describe the way that values vary randomly.
Distributions are a key idea in statistics and data analysis.
We usually consider data to be essentially random, but with the values forming predictable patterns over many observations.
The nature of those patterns is what probability distributions attempt to model.
A probability distribution does not tell us the value of any particular observation, but it does let us estimate the likelihood of observing any particular value.
The figure below demonstrates some common probability distributions: the heights of the bars reflect the likelihood of the values on the <em>x</em>-axes occuring under those distributions.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-328-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Successful data analysis requires paying attention to and thinking deeply about the way that your data are distributed.
Different kinds of biological processes, like counts, waiting times, measurements, etc., have randomness that is described by different probability distributions.
The assumption that values follow certain distributions is baked into most statistical methods.
Trying to use a method that assumes an inappropriate distribution will probably lead to invalid results.
For example, if you try to analyze count data as if they came from a continuous, unbounded distribution, your statistical model could predict nonsensical outcomes such as negative or non-integer counts.
The figure below shows this: the red shaded area are predictions of negative counts!</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx360-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Sometimes it is not always obvious what distribution your data should follow.
Some cases are relatively straight forward: counts should usually follow a Poisson or negative binomial distribution.
Other cases are less straightforward: should gene expression data be considered normally, log-normally, or some other-ly distributed?
Usually there is a clear <em>a priori</em> answer to this question that can be obtained by thinking about what kind of process gave rise to the numbers.</p>
<p>A related question to “what distribution does my data follow?” is “do my data follow this distribution?” Even if you have some expectation of how your data should be distributed, that is no guarantee that your study system cooperated.
You should always check to see if your data follow the distribution you assumed, and the distribution assumed by your statistical test.
Deciding what distribution your data follow is always somewhat subjective, and real datasets often contain some departure from expectations.
In this section we will explore some graphical techniques and heuristics for determining how data are distributed.</p>
<p>Knowing about <a href="mod-05.html#mod-05">data distributions</a> is a one thing, but <a href="mod-05.html#mod-05-dists2">figuring out which distribution best fits your data</a> is quite another.
Like much of the data analysis workflow, picking a distribution can be as much an art as it is a science.
This is because distributions of real data are often messy, or do not conform exactly to any one distribution, or may conform partly to several!
Sometimes the answer to “what distribution should I use to analyze this data?” is not clear-cut.
The figure below gives a (very) rough guide to starting to identify a response distribution.
Note that this is only a guide for where to look first, and not a definitive guide to selecting a response distribution.
Even if your choices lead you to, say, the normal distribution, you must still verify that your data conform (at least roughly) to that distribution.
Note also that this diagram does not include every distribution out there, but rather a select set of commonly encountered distributions in biology.</p>
<p><img src="09_05.jpg" width="80%" style="display: block; margin: auto;" /></p>
<div id="boxplots-aka-box-and-whisker-plots" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Boxplots (aka: box-and-whisker plots)<a href="mod-04.html#boxplots-aka-box-and-whisker-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Boxplots</strong>, or <strong>box-and-whisker plots</strong>, summarize the distribution of continuous variables.
They are often used to summarize data by a factor, making it easier to see how the distribution of a variable differs between groups.
The boxplot shows extreme values (whiskers), the first and third quartiles, and the median.</p>
<p>Boxplot of a single variable:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="mod-04.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Petal.Width)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-330-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Boxplot with some options for a nicer plot:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="mod-04.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Petal.Width,</span>
<span id="cb575-2"><a href="mod-04.html#cb575-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal width (cm)&quot;</span>,</span>
<span id="cb575-3"><a href="mod-04.html#cb575-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-331-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Boxplot across levels of a factor (note formula interface):</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="mod-04.html#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Petal.Width<span class="sc">~</span>iris<span class="sc">$</span>Species,</span>
<span id="cb576-2"><a href="mod-04.html#cb576-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Species&quot;</span>,</span>
<span id="cb576-3"><a href="mod-04.html#cb576-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal.Width (cm)&quot;</span>,</span>
<span id="cb576-4"><a href="mod-04.html#cb576-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-332-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>A highly asymmetric box-and-whisker plot can indicate that data are skewed or non-normal.</p>
<p>The base <code>boxplot()</code> function can produce summaries across multiple variables.
Essentially it treats each combination of grouping variables as a separate set of values.
There are better ways to plot group differences (e.g., for publication), but the base <code>boxplot()</code> does just fine for data exploration.</p>
<p>Boxplots can be constructed using several grouping variables.
The order of grouping variables in the formula will determine the order of boxes in the plot.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="mod-04.html#cb577-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb577-2"><a href="mod-04.html#cb577-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>) <span class="co">#made up variable</span></span>
<span id="cb577-3"><a href="mod-04.html#cb577-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-4"><a href="mod-04.html#cb577-4" aria-hidden="true" tabindex="-1"></a><span class="co"># group by species and color:</span></span>
<span id="cb577-5"><a href="mod-04.html#cb577-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Width<span class="sc">~</span>Species<span class="sc">+</span>color, <span class="at">data=</span>x,</span>
<span id="cb577-6"><a href="mod-04.html#cb577-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal width (cm)&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-333-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="mod-04.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="co"># notice difference in order of grouping:</span></span>
<span id="cb578-2"><a href="mod-04.html#cb578-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Width<span class="sc">~</span>color<span class="sc">+</span>Species, <span class="at">data=</span>x,</span>
<span id="cb578-3"><a href="mod-04.html#cb578-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Petal width (cm)&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-333-2.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="histograms" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Histograms<a href="mod-04.html#histograms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Histograms</strong> show how values of a distribution are spread across different intervals.
These intervals are sometimes called <strong>cells</strong> or <strong>bins</strong>.
A good histogram will show, approximately, the shape of a <strong>probability density function (PDF)</strong> of a <a href="mod-05.html#mod-05-condists">continuous distribution</a> or the <strong>probability mass function (PMF)</strong> of a <a href="mod-05.html#mod-05-discrete">discrete distribution</a>.
The base function <code>hist()</code> will automatically select intervals that look nice, but you can specify the intervals with argument <code>breaks</code>.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="mod-04.html#cb579-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb579-2"><a href="mod-04.html#cb579-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb579-3"><a href="mod-04.html#cb579-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 row, 2 column plot layout</span></span>
<span id="cb579-4"><a href="mod-04.html#cb579-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb579-5"><a href="mod-04.html#cb579-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb579-6"><a href="mod-04.html#cb579-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">by=</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-334-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="mod-04.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset plot layout to 1 x 1</span></span>
<span id="cb580-2"><a href="mod-04.html#cb580-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>The <em>area</em> of each bar is also proportional to the number of values in each interval.</p>
<p>R histograms can be presented as counts (<code>freq=TRUE</code>, the default), or as probability density (<code>freq=FALSE</code>).
We’ll talk more about probability density later in the <a href="mod-05.html#mod-05-dists1">next section</a>.</p>
<p>Compare these results:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="mod-04.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb581-2"><a href="mod-04.html#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb581-3"><a href="mod-04.html#cb581-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">freq=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-335-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="mod-04.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset</span></span>
<span id="cb582-2"><a href="mod-04.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Because the second histogram shows probability densities, the areas under the bars sum to 1 (this is part of the definition of a PDF).</p>
<p>A histogram can provide a visual first clue as to the shape of a distribution’s PDF or PMF.
For example, the histograms of <code>x1</code> and <code>x2</code> below suggest very different distributions:</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-336-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Notice that <code>x1</code> appears roughly normal.
It is symmetric, has a bell-shape, and is concentrated near its center.
Contrast this with <code>x2</code>.
Distribution <code>x2</code> is strongly right-skewed (i.e., lots of small values with a long positive tail), with most values near 0.
It also has no negative values (<code>range(x2)</code>).
Because of these properties we might suspect that <code>x2</code> is really a log-normal distribution.
We can check this by making a histogram of the log of <code>x2</code>:</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-337-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Other distributions might be tricky.
Consider the histograms below:</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-338-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>What a mess!
Histogram <code>x3</code> shows what is commonly referred to as a <strong>bimodal</strong> distribution.
This is a distribution with two <strong>modes</strong>, or most common values, with a gap between them.
Bimodal distributions often arise from a <strong>mixture</strong> of two distributions (in this case, two normals).
Or, they can indicate that something in the data generating process leads to diverging outcomes.
For example, in many college courses the grade distribution can be bimodal, with most students making either a B or D.</p>
<p>Histogram <code>x4</code> shows a distribution with some right skew, but not the long, tapering tail characteristic of the lognormal distribution (see <code>x2</code>, above).
The fact that the mean is near 5 and not 0 is another point against a lognormal.
But the clincher is that there are negative values, which a lognormal distribution cannot take (think about why this is).
Think for a few minutes about what distribution <code>x4</code> might be, then click the footnote to find out<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a>.</p>
</div>
<div id="mod04-pdfplots" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Kernel density plots<a href="mod-04.html#mod04-pdfplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kernel density plots are a way to empirically estimate the <strong>probability distribution function (PDF)</strong> of a distribution.
A plot of the estimated PDF is essentially a smoothed histogram.
<a href="mod-05.html#mod-05-condists">Technically</a>, it is the heights of a histogram as the bin width approaches 0.</p>
<p>The PDF tells us two things.
Practically speaking, the PDF of a distribution at a given value is related to how likely that value is to occur relative to other values.
However, that is NOT the same as the probability of that value occurring.
What the PDF really expresses is the <em>rate of change in cumulative density at a value</em>.
- The <strong>cumulative density</strong> of a distribution at some value <em>x</em> is the probability of a value <span class="math inline">\(\le\)</span> <em>x</em>.
- The <strong>cumulative density function (CDF)</strong> gives the cumulative density at <em>x</em>.</p>
<p>The PDF is defined as is the <em>slope or first derivative of the CDF</em>.
Conversely, the CDF is the integral of the PDF.
The PDF is the rate at which the probability of observing a value <span class="math inline">\(\le\)</span> <em>x</em> increases at each <em>x</em>.
Again, this is related to but not the same as the probability of that value occurring.</p>
<p><img src="04_02.jpg" width="100%" style="display: block; margin: auto;" /></p>
<p>The kernel density plot estimated by R is to the PDF what the empirical cumulative distribution function (ECDF; see below) is to the CDF.
Just like an ECDF plot presents an estimate of the true CDF, the kernel density plot presents an estimate of the true PDF.
This means that presenting a kernel density plot or an ECDF plot is largely a matter of preference because they convey the same information in different ways.</p>
<p>Note that a kernel density plot makes more sense for a <a href="mod-05.html#mod-05-condists">continuous distribution</a> than for a <a href="mod-05.html#mod-05-discrete">discrete distribution</a>.
The equivalent plot for a discrete distribution is the <strong>probability mass function (PMF)</strong> plot.
The PMF of a discrete distribution is 0 for any non-integer value.
The example below shows kernel density plots for four distributions: Normal(mean=5, SD=2), Gamma(k=3, <span class="math inline">\(\theta\)</span>=2), Uniform(min=0, max=1), and Poisson(<span class="math inline">\(\lambda\)</span>=4).
The first 3 are continuous distributions and the last is a discrete distribution.</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="mod-04.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb583-2"><a href="mod-04.html#cb583-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb583-3"><a href="mod-04.html#cb583-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb583-4"><a href="mod-04.html#cb583-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rnorm</span>(n,<span class="dv">5</span>,<span class="dv">2</span>)), <span class="at">main=</span><span class="st">&quot;Normal(5, 2)&quot;</span>)</span>
<span id="cb583-5"><a href="mod-04.html#cb583-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rgamma</span>(n, <span class="dv">3</span>, <span class="dv">2</span>)), <span class="at">main=</span><span class="st">&quot;Gamma(3, 2)&quot;</span>)</span>
<span id="cb583-6"><a href="mod-04.html#cb583-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">runif</span>(n)), <span class="at">main=</span><span class="st">&quot;Uniform(0, 1)&quot;</span>)</span>
<span id="cb583-7"><a href="mod-04.html#cb583-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rpois</span>(n,<span class="dv">4</span>)), <span class="at">main=</span><span class="st">&quot;Poisson(4)&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-339-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The estimated density functions aren’t too far off from the real functions.
But, notice that the plots for the gamma, uniform, and Poisson variables extend outside of the domains of the underlying distributions.
For example, the density for the Poisson variable extends below 0–because the Poisson distribution models counts, it is only supported for non-negative integers (you can’t count -3 fish).
You can truncate the plot using arguments <code>from</code> or <code>to</code> for density.
This is a good idea if you are exploring data that you suspect have a natural domain.
For example, lengths and times must be non-negative, so you should include <code>from=0</code> in the <code>density()</code> command.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="mod-04.html#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb584-2"><a href="mod-04.html#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rnorm</span>(n,<span class="dv">5</span>,<span class="dv">2</span>)), <span class="at">main=</span><span class="st">&quot;Normal(5, 2)&quot;</span>)</span>
<span id="cb584-3"><a href="mod-04.html#cb584-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rgamma</span>(n, <span class="dv">3</span>, <span class="dv">2</span>), <span class="at">from=</span><span class="dv">0</span>), <span class="at">main=</span><span class="st">&quot;Gamma(3, 2)&quot;</span>)</span>
<span id="cb584-4"><a href="mod-04.html#cb584-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">runif</span>(n), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>), <span class="at">main=</span><span class="st">&quot;Uniform(0, 1)&quot;</span>)</span>
<span id="cb584-5"><a href="mod-04.html#cb584-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rpois</span>(n,<span class="dv">4</span>), <span class="at">from=</span><span class="dv">0</span>), <span class="at">main=</span><span class="st">&quot;Poisson(4)&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-340-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The estimated density functions are now in their supported intervals, which is nice.
There’s one more issue with the estimates for the Poisson distribution.
Notice that the bottom right plot shows non-zero probability density for non-integer values.
This doesn’t make sense for a Poisson distribution, which can only take non-negative integer values.
What’s going on here is that the <code>density()</code> function does not know whether a distribution is supposed to be discrete or continuous.
As far as the function is concerned, the distribution is continuous and just happens to have no non-integer values.</p>
<p>If you have data that you have good reason to suspect are discrete, there is a better way than <code>density()</code> to visualize the relative likelihood of different values: the <strong>probability mass function (PMF, not PDF)</strong>.
The PMF of a discrete distribution can be calculated rather than estimated.
In the example below we use the <code>table()</code> function, which tallies up the number of times each value occurs in a vector.
We could convert the cell counts to PMF estimates by dividing by the number of observations (e.g., <code>plot(table(x1)/n))</code>.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="mod-04.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make some data</span></span>
<span id="cb585-2"><a href="mod-04.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb585-3"><a href="mod-04.html#cb585-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb585-4"><a href="mod-04.html#cb585-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">4</span>)</span>
<span id="cb585-5"><a href="mod-04.html#cb585-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">20</span>, <span class="fl">0.4</span>)</span>
<span id="cb585-6"><a href="mod-04.html#cb585-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rgeom</span>(n, <span class="fl">0.3</span>)</span>
<span id="cb585-7"><a href="mod-04.html#cb585-7" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(n, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb585-8"><a href="mod-04.html#cb585-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb585-9"><a href="mod-04.html#cb585-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot cell counts:</span></span>
<span id="cb585-10"><a href="mod-04.html#cb585-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb585-11"><a href="mod-04.html#cb585-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x1))</span>
<span id="cb585-12"><a href="mod-04.html#cb585-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x2))</span>
<span id="cb585-13"><a href="mod-04.html#cb585-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x3))</span>
<span id="cb585-14"><a href="mod-04.html#cb585-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x4))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-341-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Dividing the cell counts by the number of total observations (n) estimates the empirical PMF:</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="mod-04.html#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb586-2"><a href="mod-04.html#cb586-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x1)<span class="sc">/</span>n, <span class="at">ylab=</span><span class="st">&quot;Empirical PMF&quot;</span>)</span>
<span id="cb586-3"><a href="mod-04.html#cb586-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x2)<span class="sc">/</span>n, <span class="at">ylab=</span><span class="st">&quot;Empirical PMF&quot;</span>)</span>
<span id="cb586-4"><a href="mod-04.html#cb586-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x3)<span class="sc">/</span>n, <span class="at">ylab=</span><span class="st">&quot;Empirical PMF&quot;</span>)</span>
<span id="cb586-5"><a href="mod-04.html#cb586-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x4)<span class="sc">/</span>n, <span class="at">ylab=</span><span class="st">&quot;Empirical PMF&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-342-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>We can verify that the empirical PMFs that we calculated match the actual PMFs:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="mod-04.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to true PMF:</span></span>
<span id="cb587-2"><a href="mod-04.html#cb587-2" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x1)</span>
<span id="cb587-3"><a href="mod-04.html#cb587-3" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x2)</span>
<span id="cb587-4"><a href="mod-04.html#cb587-4" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x3)</span>
<span id="cb587-5"><a href="mod-04.html#cb587-5" aria-hidden="true" tabindex="-1"></a>v4 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x4)</span>
<span id="cb587-6"><a href="mod-04.html#cb587-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(v1, <span class="dv">4</span>)</span>
<span id="cb587-7"><a href="mod-04.html#cb587-7" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(v2, <span class="dv">20</span>, <span class="fl">0.4</span>)</span>
<span id="cb587-8"><a href="mod-04.html#cb587-8" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dgeom</span>(v3, <span class="fl">0.3</span>)</span>
<span id="cb587-9"><a href="mod-04.html#cb587-9" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(v4, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb587-10"><a href="mod-04.html#cb587-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-11"><a href="mod-04.html#cb587-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb587-12"><a href="mod-04.html#cb587-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x1)<span class="sc">/</span>n)</span>
<span id="cb587-13"><a href="mod-04.html#cb587-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb587-14"><a href="mod-04.html#cb587-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x2)<span class="sc">/</span>n)</span>
<span id="cb587-15"><a href="mod-04.html#cb587-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v2, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb587-16"><a href="mod-04.html#cb587-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x3)<span class="sc">/</span>n)</span>
<span id="cb587-17"><a href="mod-04.html#cb587-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v3, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb587-18"><a href="mod-04.html#cb587-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x4)<span class="sc">/</span>n)</span>
<span id="cb587-19"><a href="mod-04.html#cb587-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(v4, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-343-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="empirical-cumulative-density-function-ecdf-plots" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Empirical cumulative density function (ECDF) plots<a href="mod-04.html#empirical-cumulative-density-function-ecdf-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>cumulative distribution function (CDF)</strong> is the probability that a random variable will take on a value less than or equal to some value.
Formally, we say that a continuous distribution <em>X</em> will take on value <span class="math inline">\(\le\)</span> <em>x</em> with probability <span class="math inline">\(F(x)\)</span>.
The CDF is usually denoted <span class="math inline">\(F(x)\)</span>.
The figure below shows what this means.</p>
<p><img src="04_03.jpg" width="100%" style="display: block; margin: auto;" /></p>
<p>The figure shows the CDF of a normal distribution with mean = 0 and SD = 1 (i.e., the standard normal distribution. Like all CDFs, <span class="math inline">\(F(x)\)</span> increases monotonically (slope never changing sign) from 0 to 1 as <em>x</em> increases from the lower bound to the upper bound of the distribution.
In the case of the normal distribution, the bounds of <em>x</em> are [-<span class="math inline">\(\infty\)</span>, +<span class="math inline">\(\infty\)</span>].
The CDF approaches 0 as <em>x</em> decreases, and approaches 1 as <em>x</em> increases.
The red dashed lines show how to interpret the relationship between the axes.
For any value on the <em>x</em>-axis, the <em>y</em>-axis shows what proportion of values are <span class="math inline">\(\le\)</span> <em>x</em>.
For any value on the <em>y</em>-axis, the <em>x</em>-axis shows the value at the <em>y</em>-th quantile of the distribution.</p>
<p>The CDF is in a very real sense the <em>definition</em> of a probability distribution.
Every probability distribution can be identified by a unique CDF.
It doesn’t matter whether a distribution is continuous, discrete, or a mixture of both.
The figure below shows what the CDFs of a discrete or mixed distribution look like compared to that of a continuous distribution<a href="#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a>.</p>
<p><img src="04_04.jpg" width="70%" style="display: block; margin: auto;" /></p>
<p>The examples below calculate and plot ECDF plots for a uniform (left) and a normal distribution (right).</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="mod-04.html#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb588-2"><a href="mod-04.html#cb588-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb588-3"><a href="mod-04.html#cb588-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb588-4"><a href="mod-04.html#cb588-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">7</span>, <span class="dv">4</span>)</span>
<span id="cb588-5"><a href="mod-04.html#cb588-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb588-6"><a href="mod-04.html#cb588-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x1))</span>
<span id="cb588-7"><a href="mod-04.html#cb588-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x2))</span>
<span id="cb588-8"><a href="mod-04.html#cb588-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add lines at 20th percentile:</span></span>
<span id="cb588-9"><a href="mod-04.html#cb588-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb588-10"><a href="mod-04.html#cb588-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">quantile</span>(x2, <span class="fl">0.2</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-346-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The <em>y</em>-axis of an ECDF plot shows the calculated quantile of the distribution (e.g., 0.4 quantile = 40th percentile–40% of <em>x</em> are <span class="math inline">\(\le F(x)\)</span>).
The <em>x</em>-axis shows the values of the distribution.
In the left plot, we see that the slope of the ECDF plot is roughly constant.
This suggests a uniform distribution.
The plot on the right shows the S-shaped ECDF typical of a bell-shaped curve, so we might suspect a normal distribution.
The red lines on the right plot illustrate that about 20% of values are <span class="math inline">\(\le\)</span> 3.6.</p>
<p>ECDF plots can be calculated for discrete distributions as well—they just look like step functions.
Step-like ECDF plots can also appear when a continuous distribution has many more observations than unique values.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="mod-04.html#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb589-2"><a href="mod-04.html#cb589-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb589-3"><a href="mod-04.html#cb589-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">3</span>)   <span class="co"># Poisson </span></span>
<span id="cb589-4"><a href="mod-04.html#cb589-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rgeom</span>(n, <span class="fl">0.3</span>) <span class="co"># geometric </span></span>
<span id="cb589-5"><a href="mod-04.html#cb589-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb589-6"><a href="mod-04.html#cb589-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x1))</span>
<span id="cb589-7"><a href="mod-04.html#cb589-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x2))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-347-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Recall that every result in R is an object.
The output of the function <code>ecdf()</code> is actually another function that calculates the estimated CDF for a new value.
This can be very handy if you want to interpolate the ECDF to make a smoother curve.</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="mod-04.html#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">ecdf</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;ecdf&quot;     &quot;stepfun&quot;  &quot;function&quot;</code></pre>
<p>Here is how to use it.
The example below can be useful if you need to calculate the ECDF for values that are not in the original dataset, but within its domain.
In the example below, the ECDF is estimated for x = 30, which is not in the original data <code>x</code>.
Notice what happens for values in <code>x1</code> that are greater than <code>max(x)</code> and less than <code>min(x)</code>.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="mod-04.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb592-2"><a href="mod-04.html#cb592-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e2</span>, <span class="dv">20</span>, <span class="dv">5</span>)</span>
<span id="cb592-3"><a href="mod-04.html#cb592-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x) <span class="co"># define function for CDF(x)</span></span>
<span id="cb592-4"><a href="mod-04.html#cb592-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>  <span class="co"># define new x values at which to calculate CDF</span></span>
<span id="cb592-5"><a href="mod-04.html#cb592-5" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">e1</span>(x1) <span class="co"># calculate CDF at each new x</span></span>
<span id="cb592-6"><a href="mod-04.html#cb592-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb592-7"><a href="mod-04.html#cb592-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue2&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-348-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Obviously, the more data points you have, the better and smoother the estimate of the ECDF will be.
Consider the simulated example below that estimates the ECDF using different numbers of points.</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="mod-04.html#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb593-2"><a href="mod-04.html#cb593-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb593-3"><a href="mod-04.html#cb593-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb593-4"><a href="mod-04.html#cb593-4" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb593-5"><a href="mod-04.html#cb593-5" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sig)</span>
<span id="cb593-6"><a href="mod-04.html#cb593-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x4[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)]</span>
<span id="cb593-7"><a href="mod-04.html#cb593-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> x4[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)]</span>
<span id="cb593-8"><a href="mod-04.html#cb593-8" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> x4[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">1000</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)]</span>
<span id="cb593-9"><a href="mod-04.html#cb593-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-10"><a href="mod-04.html#cb593-10" aria-hidden="true" tabindex="-1"></a>xseq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb593-11"><a href="mod-04.html#cb593-11" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x1)(xseq)</span>
<span id="cb593-12"><a href="mod-04.html#cb593-12" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x2)(xseq)</span>
<span id="cb593-13"><a href="mod-04.html#cb593-13" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x3)(xseq)</span>
<span id="cb593-14"><a href="mod-04.html#cb593-14" aria-hidden="true" tabindex="-1"></a>yt <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xseq, mu, sig)</span>
<span id="cb593-15"><a href="mod-04.html#cb593-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-16"><a href="mod-04.html#cb593-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xseq, yt, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">6</span>, <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb593-17"><a href="mod-04.html#cb593-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;(E)CDF = F(x)&quot;</span>)</span>
<span id="cb593-18"><a href="mod-04.html#cb593-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xseq, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb593-19"><a href="mod-04.html#cb593-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xseq, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue2&quot;</span>)</span>
<span id="cb593-20"><a href="mod-04.html#cb593-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xseq, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb593-21"><a href="mod-04.html#cb593-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb593-22"><a href="mod-04.html#cb593-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">expression</span>(n<span class="sc">==</span><span class="dv">10</span>), <span class="fu">expression</span>(n<span class="sc">==</span><span class="dv">100</span>), </span>
<span id="cb593-23"><a href="mod-04.html#cb593-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">expression</span>(n<span class="sc">==</span><span class="dv">1000</span>), <span class="st">&quot;True CDF&quot;</span>),</span>
<span id="cb593-24"><a href="mod-04.html#cb593-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb593-25"><a href="mod-04.html#cb593-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue2&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb593-26"><a href="mod-04.html#cb593-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-349-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The estimate with 10 points (red) is a very rough fit, but serviceable.
The estimates using 100 or 1000 points are much closer to the truth (black line).</p>
</div>
<div id="quantile-quantile-qq-plots" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Quantile-quantile (QQ) plots<a href="mod-04.html#quantile-quantile-qq-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>quantile-quantile plot</strong>, or <strong>QQ plot</strong>, is a method for visualizing whether two sets of values come from the same distribution.
This is done by plotting the quantiles of one data set against the quantiles of another data set.
If the two sets come from the same distribution, then the points should fall along a straight line.
QQ plots are usually used to test whether data come from a normal distribution, but could be used with any distribution.
The key advantage of QQ plots is that the reference line is straight, and deviations from it are easy to see.
Contrast this with the reference line in an ECDF plot, whose shape varies by distribution.</p>
<p>QQ plots are generated by function <code>qqplot()</code> or <code>qqnorm()</code>.
The latter function is a shortcut for a QQ plot comparing the data to a normal distribution.
The function <code>qqline()</code> is used to add a reference line.
Typical use of <code>qqnorm()</code> and <code>qqline()</code> is shown below.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="mod-04.html#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb594-2"><a href="mod-04.html#cb594-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb594-3"><a href="mod-04.html#cb594-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">50</span>, <span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb594-4"><a href="mod-04.html#cb594-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-5"><a href="mod-04.html#cb594-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb594-6"><a href="mod-04.html#cb594-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(a)</span>
<span id="cb594-7"><a href="mod-04.html#cb594-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(a, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb594-8"><a href="mod-04.html#cb594-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(b)</span>
<span id="cb594-9"><a href="mod-04.html#cb594-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(b, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-350-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The left panel above shows that distribution a likely follows a normal distribution because the points fall mostly on the reference line.
The right panel, however, shows that distribution <code>b</code> likely does not follow a normal distribution.
This can be seen because many of the points do not fall on the line.
The arch-shaped pattern indicates that the distribution differs from the normal mainly on the tails.</p>
<p>QQ plots can be made to compare your data to any arbitrary distribution.
If your target distribution has default parameters in R (e.g., mean = 0 and SD = 1 for the normal distribution), then the method is simple:</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="mod-04.html#cb595-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">50</span>, <span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb595-2"><a href="mod-04.html#cb595-2" aria-hidden="true" tabindex="-1"></a>qqs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span></span>
<span id="cb595-3"><a href="mod-04.html#cb595-3" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(qqs)</span>
<span id="cb595-4"><a href="mod-04.html#cb595-4" aria-hidden="true" tabindex="-1"></a>qy <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, qqs)</span>
<span id="cb595-5"><a href="mod-04.html#cb595-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-6"><a href="mod-04.html#cb595-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb595-7"><a href="mod-04.html#cb595-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qx, qy,</span>
<span id="cb595-8"><a href="mod-04.html#cb595-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Theoretical quantiles&quot;</span>,</span>
<span id="cb595-9"><a href="mod-04.html#cb595-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Sample quantiles&quot;</span>)</span>
<span id="cb595-10"><a href="mod-04.html#cb595-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(qy<span class="sc">~</span>qx), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-351-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>If the target distribution does not have default parameters, or if you don’t want to use the default parameters, you can still make a QQ plot.
The example below shows two methods for comparing a suspected gamma distribution to a reference gamma distribution using QQ plots.
The parameters of the reference gamma distribution are estimated using the function <code>fitdistr()</code> from package <code>MASS</code>.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="mod-04.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb596-2"><a href="mod-04.html#cb596-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb596-3"><a href="mod-04.html#cb596-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb596-4"><a href="mod-04.html#cb596-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">100</span>, <span class="dv">4</span>, <span class="fl">0.2</span>)</span>
<span id="cb596-5"><a href="mod-04.html#cb596-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-6"><a href="mod-04.html#cb596-6" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb596-7"><a href="mod-04.html#cb596-7" aria-hidden="true" tabindex="-1"></a>qqs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span></span>
<span id="cb596-8"><a href="mod-04.html#cb596-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-9"><a href="mod-04.html#cb596-9" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: calculate QQ plot manually</span></span>
<span id="cb596-10"><a href="mod-04.html#cb596-10" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">qgamma</span>(qqs, <span class="at">shape=</span>fd<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>fd<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb596-11"><a href="mod-04.html#cb596-11" aria-hidden="true" tabindex="-1"></a>qy <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, qqs)</span>
<span id="cb596-12"><a href="mod-04.html#cb596-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qx, qy,</span>
<span id="cb596-13"><a href="mod-04.html#cb596-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Theoretical quantiles&quot;</span>,</span>
<span id="cb596-14"><a href="mod-04.html#cb596-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Sample quantiles&quot;</span>)</span>
<span id="cb596-15"><a href="mod-04.html#cb596-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(qy<span class="sc">~</span>qx), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-352-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is an alternative strategy using <code>qqplot()</code>:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="mod-04.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: use qqplot() </span></span>
<span id="cb597-2"><a href="mod-04.html#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles of reference distribution</span></span>
<span id="cb597-3"><a href="mod-04.html#cb597-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb597-4"><a href="mod-04.html#cb597-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function to draw from reference distribution</span></span>
<span id="cb597-5"><a href="mod-04.html#cb597-5" aria-hidden="true" tabindex="-1"></a>dfun <span class="ot">&lt;-</span> <span class="cf">function</span>(p){</span>
<span id="cb597-6"><a href="mod-04.html#cb597-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qgamma</span>(qqs, <span class="at">shape=</span>fd<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>fd<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb597-7"><a href="mod-04.html#cb597-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb597-8"><a href="mod-04.html#cb597-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get values at each reference quantile</span></span>
<span id="cb597-9"><a href="mod-04.html#cb597-9" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">dfun</span>(qqs)</span>
<span id="cb597-10"><a href="mod-04.html#cb597-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb597-11"><a href="mod-04.html#cb597-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb597-12"><a href="mod-04.html#cb597-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qx, x,</span>
<span id="cb597-13"><a href="mod-04.html#cb597-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Theoretical quantiles&quot;</span>,</span>
<span id="cb597-14"><a href="mod-04.html#cb597-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Sample quantiles&quot;</span>)</span>
<span id="cb597-15"><a href="mod-04.html#cb597-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(qy<span class="sc">~</span>qx), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-353-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is another example with the negative binomial distribution:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="mod-04.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb598-2"><a href="mod-04.html#cb598-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb598-3"><a href="mod-04.html#cb598-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb598-4"><a href="mod-04.html#cb598-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(n, <span class="at">mu=</span><span class="dv">5</span>, <span class="at">size=</span><span class="dv">10</span>)</span>
<span id="cb598-5"><a href="mod-04.html#cb598-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-6"><a href="mod-04.html#cb598-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get parameters of distribution</span></span>
<span id="cb598-7"><a href="mod-04.html#cb598-7" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(a, <span class="st">&quot;negative binomial&quot;</span>)</span>
<span id="cb598-8"><a href="mod-04.html#cb598-8" aria-hidden="true" tabindex="-1"></a>fd</span></code></pre></div>
<pre><code>##       size           mu     
##   118.3001950     5.2000006 
##  (394.2399860) (  0.3295018)</code></pre>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="mod-04.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles of reference distribution</span></span>
<span id="cb600-2"><a href="mod-04.html#cb600-2" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(n)</span>
<span id="cb600-3"><a href="mod-04.html#cb600-3" aria-hidden="true" tabindex="-1"></a><span class="co"># function to draw from reference distribution</span></span>
<span id="cb600-4"><a href="mod-04.html#cb600-4" aria-hidden="true" tabindex="-1"></a>dfun <span class="ot">&lt;-</span> <span class="cf">function</span>(p){</span>
<span id="cb600-5"><a href="mod-04.html#cb600-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">qnbinom</span>(p, </span>
<span id="cb600-6"><a href="mod-04.html#cb600-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size=</span>fd<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb600-7"><a href="mod-04.html#cb600-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mu=</span>fd<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb600-8"><a href="mod-04.html#cb600-8" aria-hidden="true" tabindex="-1"></a>                    }<span class="co">#function</span></span>
<span id="cb600-9"><a href="mod-04.html#cb600-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get values at each reference quantile</span></span>
<span id="cb600-10"><a href="mod-04.html#cb600-10" aria-hidden="true" tabindex="-1"></a>qy <span class="ot">&lt;-</span> <span class="fu">dfun</span>(qx)</span>
<span id="cb600-11"><a href="mod-04.html#cb600-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb600-12"><a href="mod-04.html#cb600-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb600-13"><a href="mod-04.html#cb600-13" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(qy, a,</span>
<span id="cb600-14"><a href="mod-04.html#cb600-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Theoretical quantiles&quot;</span>,</span>
<span id="cb600-15"><a href="mod-04.html#cb600-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;Sample quantiles&quot;</span>)</span>
<span id="cb600-16"><a href="mod-04.html#cb600-16" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(a, <span class="at">distribution=</span>dfun, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-354-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="how-should-i-plot-my-data" class="section level3 hasAnchor" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> How should I plot my data?<a href="mod-04.html#how-should-i-plot-my-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting and examining the distribution of your data is always a good idea.
How you plot the distributions is largely up to you.
As mentioned above, histograms, ECDF plots, and kernel density plots convey the same information.
The information is just presented in different ways.
Some people prefer one kind of distribution plot over the others.
You should use whichever plot best helps you understand the distribution.
Or, use whichever plot your supervisor tells you to use.
Consider the figure below, which plots a normal distribution with mean = 20 and SD = 5 in four different ways.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="mod-04.html#cb601-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>, <span class="dv">20</span>, <span class="dv">5</span>)</span>
<span id="cb601-2"><a href="mod-04.html#cb601-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-3"><a href="mod-04.html#cb601-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb601-4"><a href="mod-04.html#cb601-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, </span>
<span id="cb601-5"><a href="mod-04.html#cb601-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.3</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.main=</span><span class="fl">1.3</span>)</span>
<span id="cb601-6"><a href="mod-04.html#cb601-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb601-7"><a href="mod-04.html#cb601-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">main=</span><span class="st">&quot;Kernel density plot&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb601-8"><a href="mod-04.html#cb601-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x), <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb601-9"><a href="mod-04.html#cb601-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span>
<span id="cb601-10"><a href="mod-04.html#cb601-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-355-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Which way is the correct way to plot the data?
It depends:</p>
<ul>
<li>If your goal is to show how the data are spread out, use a histogram or kernel density plot.</li>
<li>If your goal is to explore quantiles of the distribution, use an ECDF plot.</li>
<li>If your goal is to compare to a specific distribution, use a QQ plot or an ECDF (with the reference distribution’s CDF superimposed).</li>
</ul>
<p>Methods for visualizing data distributions can be highly field-specific.
Usually a histogram, ECDF, or both, will be enough to get a sense of how a variable is distributed.
The goal of this visualization is usually to determine what probability distribution is most appropriate for a variable.
As we will see in the <a href="mod-05.html#mod-05">next module</a>, that can be as much a biological decision as a statistical one.</p>

</div>
</div>
</div>
<h3>Literature Cited<a href="literature-cited.html#literature-cited" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-zuur2010" class="csl-entry">
Zuur, A. F., E. N. Ieno, and C. S. Elphick. 2010. <a href="https://doi.org/10.1111/j.2041-210X.2009.00001.x">A protocol for data exploration to avoid common statistical problems</a>. Methods in ecology and evolution 1:3–14.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="42">
<li id="fn42"><p>Natural log.
Unless otherwise indicated, always assume a mathematician or statistician means natural log.<a href="mod-04.html#fnref42" class="footnote-back">↩︎</a></p></li>
<li id="fn43"><p>R users often use an ellipsis <code>...</code> as a shorthand for unshown arguments to the function, not literally three periods.
In this text, the ellipsis is a stand in for other arguments to the function that are irrelevant to the point being made.
There are some circumstances where an ellipsis is necessary to control how variables are passed from one function to another<a href="mod-04.html#fnref43" class="footnote-back">↩︎</a></p></li>
<li id="fn44"><p>Distribution <code>x4</code> is a mixture of a normal (mean = 5, SD = 2) with a uniform in [3, 20].<a href="mod-04.html#fnref44" class="footnote-back">↩︎</a></p></li>
<li id="fn45"><p>adapted from <a href="https://commons.wikimedia.org/wiki/File:Discrete_probability_distribution_illustration.svg" class="uri">https://commons.wikimedia.org/wiki/File:Discrete_probability_distribution_illustration.svg</a> (public domain)<a href="mod-04.html#fnref45" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-03.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-05.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-explore1.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["applied_biol_data_analysis_20220816.pdf", "applied_biol_data_analysis_20220816.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
