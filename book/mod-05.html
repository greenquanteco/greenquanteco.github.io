<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 5 Exploratory data analysis 2: Probability distributions for biology | Applied Biological Data Analysis: Statistics and R for Biologists</title>
  <meta name="description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 5 Exploratory data analysis 2: Probability distributions for biology | Applied Biological Data Analysis: Statistics and R for Biologists" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://greenquanteco.github.io/book/lab_logo_02.jpg" />
  <meta property="og:description" content="Helping biologists to become more informed users of R and statistical methods." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 5 Exploratory data analysis 2: Probability distributions for biology | Applied Biological Data Analysis: Statistics and R for Biologists" />
  
  <meta name="twitter:description" content="Helping biologists to become more informed users of R and statistical methods." />
  <meta name="twitter:image" content="https://greenquanteco.github.io/book/lab_logo_02.jpg" />

<meta name="author" content="Dr. Nick Green, Kennesaw State University" />


<meta name="date" content="2024-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="fav.ico" type="image/x-icon" />
<link rel="prev" href="mod-04.html"/>
<link rel="next" href="mod-06.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied biological data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#work-in-progress-warning"><i class="fa fa-check"></i>Work in progress warning!</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-permissions"><i class="fa fa-check"></i>License and permissions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i>Course objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-requirements"><i class="fa fa-check"></i>Course requirements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-reading"><i class="fa fa-check"></i>Recommended reading</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-organization"><i class="fa fa-check"></i>Course organization</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="mod-01.html"><a href="mod-01.html"><i class="fa fa-check"></i><b>1</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="mod-01.html"><a href="mod-01.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="mod-01.html"><a href="mod-01.html#statistics-in-modern-biology"><i class="fa fa-check"></i><b>1.2</b> Statistics in modern biology</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="mod-01.html"><a href="mod-01.html#the-scientific-method"><i class="fa fa-check"></i><b>1.2.1</b> The scientific method</a></li>
<li class="chapter" data-level="1.2.2" data-path="mod-01.html"><a href="mod-01.html#example-data-analysis"><i class="fa fa-check"></i><b>1.2.2</b> Example data analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="mod-01.html"><a href="mod-01.html#misuses-of-statistics"><i class="fa fa-check"></i><b>1.3</b> Misuses of statistics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="mod-01.html"><a href="mod-01.html#proving-the-trivial-and-meaningless-hypotheses"><i class="fa fa-check"></i><b>1.3.1</b> “Proving” the trivial and meaningless hypotheses</a></li>
<li class="chapter" data-level="1.3.2" data-path="mod-01.html"><a href="mod-01.html#inappropriate-methods"><i class="fa fa-check"></i><b>1.3.2</b> Inappropriate methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="mod-01.html"><a href="mod-01.html#p-hacking-and-data-dredging"><i class="fa fa-check"></i><b>1.3.3</b> <em>P</em>-hacking and data dredging</a></li>
<li class="chapter" data-level="1.3.4" data-path="mod-01.html"><a href="mod-01.html#inadequate-sample-sizes-and-pseudoreplication"><i class="fa fa-check"></i><b>1.3.4</b> Inadequate sample sizes and pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="mod-01.html"><a href="mod-01.html#mod-01-nhst"><i class="fa fa-check"></i><b>1.4</b> <em>P</em>-values and null hypothesis significance testing (NHST)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="mod-01.html"><a href="mod-01.html#definition"><i class="fa fa-check"></i><b>1.4.1</b> Definition</a></li>
<li class="chapter" data-level="1.4.2" data-path="mod-01.html"><a href="mod-01.html#aside-another-way-to-frame-null-hypotheses"><i class="fa fa-check"></i><b>1.4.2</b> Aside: Another way to frame null hypotheses</a></li>
<li class="chapter" data-level="1.4.3" data-path="mod-01.html"><a href="mod-01.html#history-and-status-of-p-values"><i class="fa fa-check"></i><b>1.4.3</b> History and status of <em>P</em>-values</a></li>
<li class="chapter" data-level="1.4.4" data-path="mod-01.html"><a href="mod-01.html#where-p-values-come-from"><i class="fa fa-check"></i><b>1.4.4</b> Where <em>P</em>-values come from</a></li>
<li class="chapter" data-level="1.4.5" data-path="mod-01.html"><a href="mod-01.html#what-p-values-mean-and-do-not-mean"><i class="fa fa-check"></i><b>1.4.5</b> What <em>P</em>-values mean and do not mean</a></li>
<li class="chapter" data-level="1.4.6" data-path="mod-01.html"><a href="mod-01.html#do-you-need-a-p-value"><i class="fa fa-check"></i><b>1.4.6</b> Do you need a <em>P</em>-value?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="mod-01.html"><a href="mod-01.html#alternatives-to-nhst"><i class="fa fa-check"></i><b>1.5</b> Alternatives to NHST</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="mod-01.html"><a href="mod-01.html#mod-01-bayes"><i class="fa fa-check"></i><b>1.5.1</b> Bayesian inference</a></li>
<li class="chapter" data-level="1.5.2" data-path="mod-01.html"><a href="mod-01.html#information-theoretic-methods"><i class="fa fa-check"></i><b>1.5.2</b> Information-theoretic methods</a></li>
<li class="chapter" data-level="1.5.3" data-path="mod-01.html"><a href="mod-01.html#machine-learning"><i class="fa fa-check"></i><b>1.5.3</b> Machine learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mod-02.html"><a href="mod-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-02.html"><a href="mod-02.html#getting-started-with-r"><i class="fa fa-check"></i><b>2.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="mod-02.html"><a href="mod-02.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="mod-02.html"><a href="mod-02.html#advantages-of-r"><i class="fa fa-check"></i><b>2.1.2</b> Advantages of R</a></li>
<li class="chapter" data-level="2.1.3" data-path="mod-02.html"><a href="mod-02.html#disadvantages-of-r"><i class="fa fa-check"></i><b>2.1.3</b> Disadvantages of R</a></li>
<li class="chapter" data-level="2.1.4" data-path="mod-02.html"><a href="mod-02.html#base-r-and-vs.-tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Base R and (vs.?) <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="mod-02.html"><a href="mod-02.html#download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> Download and install R (and RStudio)</a></li>
<li class="chapter" data-level="2.3" data-path="mod-02.html"><a href="mod-02.html#using-r"><i class="fa fa-check"></i><b>2.3</b> Using R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="mod-02.html"><a href="mod-02.html#using-the-base-r-gui"><i class="fa fa-check"></i><b>2.3.1</b> Using the base R GUI</a></li>
<li class="chapter" data-level="2.3.2" data-path="mod-02.html"><a href="mod-02.html#using-r-in-rstudio"><i class="fa fa-check"></i><b>2.3.2</b> Using R in RStudio</a></li>
<li class="chapter" data-level="2.3.3" data-path="mod-02.html"><a href="mod-02.html#using-r-with-other-programs"><i class="fa fa-check"></i><b>2.3.3</b> Using R with other programs</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="mod-02.html"><a href="mod-02.html#mod-02-first"><i class="fa fa-check"></i><b>2.4</b> A first R session</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="mod-02.html"><a href="mod-02.html#import-data"><i class="fa fa-check"></i><b>2.4.1</b> Import data</a></li>
<li class="chapter" data-level="2.4.2" data-path="mod-02.html"><a href="mod-02.html#explore-and-visualize-data"><i class="fa fa-check"></i><b>2.4.2</b> Explore and visualize data</a></li>
<li class="chapter" data-level="2.4.3" data-path="mod-02.html"><a href="mod-02.html#transform-data"><i class="fa fa-check"></i><b>2.4.3</b> Transform data</a></li>
<li class="chapter" data-level="2.4.4" data-path="mod-02.html"><a href="mod-02.html#analyze-data"><i class="fa fa-check"></i><b>2.4.4</b> Analyze data</a></li>
<li class="chapter" data-level="2.4.5" data-path="mod-02.html"><a href="mod-02.html#mod-01-elkfig"><i class="fa fa-check"></i><b>2.4.5</b> Write out results</a></li>
<li class="chapter" data-level="2.4.6" data-path="mod-02.html"><a href="mod-02.html#save-your-work"><i class="fa fa-check"></i><b>2.4.6</b> Save your work?</a></li>
<li class="chapter" data-level="2.4.7" data-path="mod-02.html"><a href="mod-02.html#whats-next"><i class="fa fa-check"></i><b>2.4.7</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="mod-02.html"><a href="mod-02.html#write-and-execute-commands-in-the-r-console"><i class="fa fa-check"></i><b>2.5</b> Write and execute commands in the R console</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="mod-02.html"><a href="mod-02.html#r-commandsbasics"><i class="fa fa-check"></i><b>2.5.1</b> R commands–basics</a></li>
<li class="chapter" data-level="2.5.2" data-path="mod-02.html"><a href="mod-02.html#elements-of-r-code"><i class="fa fa-check"></i><b>2.5.2</b> Elements of R code</a></li>
<li class="chapter" data-level="2.5.3" data-path="mod-02.html"><a href="mod-02.html#the-r-workspace"><i class="fa fa-check"></i><b>2.5.3</b> The R workspace</a></li>
<li class="chapter" data-level="2.5.4" data-path="mod-02.html"><a href="mod-02.html#r-code-basics-assignment-and-operators"><i class="fa fa-check"></i><b>2.5.4</b> R code basics: assignment and operators</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="mod-02.html"><a href="mod-02.html#mod-02-struct"><i class="fa fa-check"></i><b>2.6</b> Basic R data structures</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-02.html"><a href="mod-02.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-02.html"><a href="mod-02.html#data-frames"><i class="fa fa-check"></i><b>2.6.2</b> Data frames</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-02.html"><a href="mod-02.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.6.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-02.html"><a href="mod-02.html#lists"><i class="fa fa-check"></i><b>2.6.4</b> Lists</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-02.html"><a href="mod-02.html#s3-s4-and-other-paradigms"><i class="fa fa-check"></i><b>2.6.5</b> S3, S4, and other paradigms</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-02.html"><a href="mod-02.html#r-data-types"><i class="fa fa-check"></i><b>2.7</b> R data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="mod-02.html"><a href="mod-02.html#character-type"><i class="fa fa-check"></i><b>2.7.1</b> Character type</a></li>
<li class="chapter" data-level="2.7.2" data-path="mod-02.html"><a href="mod-02.html#numeric-type"><i class="fa fa-check"></i><b>2.7.2</b> Numeric type</a></li>
<li class="chapter" data-level="2.7.3" data-path="mod-02.html"><a href="mod-02.html#integer-type"><i class="fa fa-check"></i><b>2.7.3</b> Integer type</a></li>
<li class="chapter" data-level="2.7.4" data-path="mod-02.html"><a href="mod-02.html#logical-type"><i class="fa fa-check"></i><b>2.7.4</b> Logical type</a></li>
<li class="chapter" data-level="2.7.5" data-path="mod-02.html"><a href="mod-02.html#special-values"><i class="fa fa-check"></i><b>2.7.5</b> Special values</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="mod-02.html"><a href="mod-02.html#manage-r-code-as-scripts-.r-files"><i class="fa fa-check"></i><b>2.8</b> Manage R code as scripts (.r files)</a></li>
<li class="chapter" data-level="2.9" data-path="mod-02.html"><a href="mod-02.html#manage-and-use-r-packages"><i class="fa fa-check"></i><b>2.9</b> Manage and use R packages</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-02.html"><a href="mod-02.html#your-r-library"><i class="fa fa-check"></i><b>2.9.1</b> Your R library</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-02.html"><a href="mod-02.html#installing-packages-using-the-r-gui"><i class="fa fa-check"></i><b>2.9.2</b> Installing packages using the R GUI</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-02.html"><a href="mod-02.html#installing-packages-in-rstudio"><i class="fa fa-check"></i><b>2.9.3</b> Installing packages in RStudio</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-02.html"><a href="mod-02.html#installing-packages-using-the-r-console"><i class="fa fa-check"></i><b>2.9.4</b> Installing packages using the R console</a></li>
<li class="chapter" data-level="2.9.5" data-path="mod-02.html"><a href="mod-02.html#working-with-packages-in-r"><i class="fa fa-check"></i><b>2.9.5</b> Working with packages in R</a></li>
<li class="chapter" data-level="2.9.6" data-path="mod-02.html"><a href="mod-02.html#package-dependencies"><i class="fa fa-check"></i><b>2.9.6</b> Package dependencies</a></li>
<li class="chapter" data-level="2.9.7" data-path="mod-02.html"><a href="mod-02.html#citing-packages"><i class="fa fa-check"></i><b>2.9.7</b> Citing packages</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="mod-02.html"><a href="mod-02.html#r-documentation"><i class="fa fa-check"></i><b>2.10</b> R documentation</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="mod-02.html"><a href="mod-02.html#documentation-help-files"><i class="fa fa-check"></i><b>2.10.1</b> Documentation (help) files</a></li>
<li class="chapter" data-level="2.10.2" data-path="mod-02.html"><a href="mod-02.html#r-vignettes"><i class="fa fa-check"></i><b>2.10.2</b> R vignettes</a></li>
<li class="chapter" data-level="2.10.3" data-path="mod-02.html"><a href="mod-02.html#official-r-project-resources"><i class="fa fa-check"></i><b>2.10.3</b> Official R Project resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="mod-02.html"><a href="mod-02.html#unofficial-online-resources"><i class="fa fa-check"></i><b>2.10.4</b> Unofficial online resources</a></li>
<li class="chapter" data-level="2.10.5" data-path="mod-02.html"><a href="mod-02.html#r-books"><i class="fa fa-check"></i><b>2.10.5</b> R books</a></li>
<li class="chapter" data-level="2.10.6" data-path="mod-02.html"><a href="mod-02.html#two-reminders"><i class="fa fa-check"></i><b>2.10.6</b> Two reminders</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-03.html"><a href="mod-03.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-03.html"><a href="mod-03.html#mod-03-inout"><i class="fa fa-check"></i><b>3.1</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="mod-03.html"><a href="mod-03.html#importing-data-preliminaries"><i class="fa fa-check"></i><b>3.1.1</b> Importing data: preliminaries</a></li>
<li class="chapter" data-level="3.1.2" data-path="mod-03.html"><a href="mod-03.html#importing-data-from-text-files-with-read.csv-and-read.table"><i class="fa fa-check"></i><b>3.1.2</b> Importing data from text files with <code>read.csv()</code> and <code>read.table()</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="mod-03.html"><a href="mod-03.html#importing-data-from-saved-workspaces"><i class="fa fa-check"></i><b>3.1.3</b> Importing data from saved workspaces</a></li>
<li class="chapter" data-level="3.1.4" data-path="mod-03.html"><a href="mod-03.html#importing-data-special-cases"><i class="fa fa-check"></i><b>3.1.4</b> Importing data: special cases:</a></li>
<li class="chapter" data-level="3.1.5" data-path="mod-03.html"><a href="mod-03.html#export-data-from-r"><i class="fa fa-check"></i><b>3.1.5</b> Export data from R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="mod-03.html"><a href="mod-03.html#making-values-in-r"><i class="fa fa-check"></i><b>3.2</b> Making values in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="mod-03.html"><a href="mod-03.html#producing-arbitrary-values-with-c"><i class="fa fa-check"></i><b>3.2.1</b> Producing arbitrary values with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="mod-03.html"><a href="mod-03.html#generating-regular-values"><i class="fa fa-check"></i><b>3.2.2</b> Generating regular values</a></li>
<li class="chapter" data-level="3.2.3" data-path="mod-03.html"><a href="mod-03.html#generating-random-values"><i class="fa fa-check"></i><b>3.2.3</b> Generating random values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="mod-03.html"><a href="mod-03.html#selecting-data-with"><i class="fa fa-check"></i><b>3.3</b> Selecting data with <code>[]</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="mod-03.html"><a href="mod-03.html#mod-03-brackets"><i class="fa fa-check"></i><b>3.3.1</b> Basics of brackets</a></li>
<li class="chapter" data-level="3.3.2" data-path="mod-03.html"><a href="mod-03.html#extracting-and-selecting-data-with-logical-tests"><i class="fa fa-check"></i><b>3.3.2</b> Extracting and selecting data with logical tests</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="mod-03.html"><a href="mod-03.html#managing-dates-and-characters"><i class="fa fa-check"></i><b>3.4</b> Managing dates and characters</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="mod-03.html"><a href="mod-03.html#temporal-data-and-dates"><i class="fa fa-check"></i><b>3.4.1</b> Temporal data and dates</a></li>
<li class="chapter" data-level="3.4.2" data-path="mod-03.html"><a href="mod-03.html#character-data-text"><i class="fa fa-check"></i><b>3.4.2</b> Character data (text)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="mod-03.html"><a href="mod-03.html#mod-03-dataframe"><i class="fa fa-check"></i><b>3.5</b> Data frame management</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="mod-03.html"><a href="mod-03.html#data-frame-structure"><i class="fa fa-check"></i><b>3.5.1</b> Data frame structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="mod-03.html"><a href="mod-03.html#common-data-frame-operations"><i class="fa fa-check"></i><b>3.5.2</b> Common data frame operations</a></li>
<li class="chapter" data-level="3.5.3" data-path="mod-03.html"><a href="mod-03.html#other-data-frame-operations"><i class="fa fa-check"></i><b>3.5.3</b> Other data frame operations</a></li>
<li class="chapter" data-level="3.5.4" data-path="mod-03.html"><a href="mod-03.html#mod-03-reshape"><i class="fa fa-check"></i><b>3.5.4</b> Reshaping data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-04.html"><a href="mod-04.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis 1: Data description and summarization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-04.html"><a href="mod-04.html#motivation"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="mod-04.html"><a href="mod-04.html#descriptive-and-summary-statistics"><i class="fa fa-check"></i><b>4.2</b> Descriptive and summary statistics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="mod-04.html"><a href="mod-04.html#basic-summary-statistics"><i class="fa fa-check"></i><b>4.2.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="4.2.2" data-path="mod-04.html"><a href="mod-04.html#mod-04-agg"><i class="fa fa-check"></i><b>4.2.2</b> Summarizing by groups (AKA: pivot tables)</a></li>
<li class="chapter" data-level="4.2.3" data-path="mod-04.html"><a href="mod-04.html#summarizing-data-with-the-apply-family"><i class="fa fa-check"></i><b>4.2.3</b> Summarizing data with the <code>apply()</code> family</a></li>
<li class="chapter" data-level="4.2.4" data-path="mod-04.html"><a href="mod-04.html#mod-04-tab"><i class="fa fa-check"></i><b>4.2.4</b> Tabulation (frequency tables)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mod-04.html"><a href="mod-04.html#mod-04-vis"><i class="fa fa-check"></i><b>4.3</b> Visualizing single variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="mod-04.html"><a href="mod-04.html#boxplots-aka-box-and-whisker-plots"><i class="fa fa-check"></i><b>4.3.1</b> Boxplots (aka: box-and-whisker plots)</a></li>
<li class="chapter" data-level="4.3.2" data-path="mod-04.html"><a href="mod-04.html#histograms"><i class="fa fa-check"></i><b>4.3.2</b> Histograms</a></li>
<li class="chapter" data-level="4.3.3" data-path="mod-04.html"><a href="mod-04.html#mod04-pdfplots"><i class="fa fa-check"></i><b>4.3.3</b> Kernel density plots</a></li>
<li class="chapter" data-level="4.3.4" data-path="mod-04.html"><a href="mod-04.html#empirical-cumulative-density-function-ecdf-plots"><i class="fa fa-check"></i><b>4.3.4</b> Empirical cumulative density function (ECDF) plots</a></li>
<li class="chapter" data-level="4.3.5" data-path="mod-04.html"><a href="mod-04.html#quantile-quantile-qq-plots"><i class="fa fa-check"></i><b>4.3.5</b> Quantile-quantile (QQ) plots</a></li>
<li class="chapter" data-level="4.3.6" data-path="mod-04.html"><a href="mod-04.html#how-should-i-plot-my-data"><i class="fa fa-check"></i><b>4.3.6</b> How should I plot my data?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-05.html"><a href="mod-05.html"><i class="fa fa-check"></i><b>5</b> Exploratory data analysis 2: Probability distributions for biology</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-05.html"><a href="mod-05.html#mod-05-dists1"><i class="fa fa-check"></i><b>5.1</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mod-05.html"><a href="mod-05.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>5.1.1</b> Probability distributions in R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mod-05.html"><a href="mod-05.html#mod-05-discrete"><i class="fa fa-check"></i><b>5.2</b> Discrete distributions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mod-05.html"><a href="mod-05.html#bernoulli-distribution"><i class="fa fa-check"></i><b>5.2.1</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="5.2.2" data-path="mod-05.html"><a href="mod-05.html#mod-05-binom"><i class="fa fa-check"></i><b>5.2.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="5.2.3" data-path="mod-05.html"><a href="mod-05.html#poisson-distribution"><i class="fa fa-check"></i><b>5.2.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="5.2.4" data-path="mod-05.html"><a href="mod-05.html#mod-05-negbin"><i class="fa fa-check"></i><b>5.2.4</b> Negative binomial distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="mod-05.html"><a href="mod-05.html#mod-05-geom"><i class="fa fa-check"></i><b>5.2.5</b> Geometric distribution</a></li>
<li class="chapter" data-level="5.2.6" data-path="mod-05.html"><a href="mod-05.html#beta-binomial-distribution"><i class="fa fa-check"></i><b>5.2.6</b> Beta-binomial distribution</a></li>
<li class="chapter" data-level="5.2.7" data-path="mod-05.html"><a href="mod-05.html#multinomial-distribution"><i class="fa fa-check"></i><b>5.2.7</b> Multinomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mod-05.html"><a href="mod-05.html#mod-05-condists"><i class="fa fa-check"></i><b>5.3</b> Continuous distributions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="mod-05.html"><a href="mod-05.html#uniform-distribution"><i class="fa fa-check"></i><b>5.3.1</b> Uniform distribution</a></li>
<li class="chapter" data-level="5.3.2" data-path="mod-05.html"><a href="mod-05.html#mod-05-norm"><i class="fa fa-check"></i><b>5.3.2</b> Normal distribution</a></li>
<li class="chapter" data-level="5.3.3" data-path="mod-05.html"><a href="mod-05.html#lognormal-distribution"><i class="fa fa-check"></i><b>5.3.3</b> Lognormal distribution</a></li>
<li class="chapter" data-level="5.3.4" data-path="mod-05.html"><a href="mod-05.html#mod-05-gamma"><i class="fa fa-check"></i><b>5.3.4</b> Gamma distribution</a></li>
<li class="chapter" data-level="5.3.5" data-path="mod-05.html"><a href="mod-05.html#beta-distribution"><i class="fa fa-check"></i><b>5.3.5</b> Beta distribution</a></li>
<li class="chapter" data-level="5.3.6" data-path="mod-05.html"><a href="mod-05.html#dirichlet-distribution"><i class="fa fa-check"></i><b>5.3.6</b> Dirichlet distribution</a></li>
<li class="chapter" data-level="5.3.7" data-path="mod-05.html"><a href="mod-05.html#mod-05-expo"><i class="fa fa-check"></i><b>5.3.7</b> Exponential distribution</a></li>
<li class="chapter" data-level="5.3.8" data-path="mod-05.html"><a href="mod-05.html#triangular-distribution"><i class="fa fa-check"></i><b>5.3.8</b> Triangular distribution</a></li>
<li class="chapter" data-level="5.3.9" data-path="mod-05.html"><a href="mod-05.html#distributions-summary"><i class="fa fa-check"></i><b>5.3.9</b> Distributions summary</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="mod-05.html"><a href="mod-05.html#mod-05-dists2"><i class="fa fa-check"></i><b>5.4</b> Fitting and testing distributions</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="mod-05.html"><a href="mod-05.html#estimating-distributional-parameters"><i class="fa fa-check"></i><b>5.4.1</b> Estimating distributional parameters</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="mod-05.html"><a href="mod-05.html#graphical-methods-for-examining-distributions"><i class="fa fa-check"></i><b>5.5</b> Graphical methods for examining distributions</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-05.html"><a href="mod-05.html#comparing-distributions-with-pdf-or-pmf-plots"><i class="fa fa-check"></i><b>5.5.1</b> Comparing distributions with PDF or PMF plots</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-05.html"><a href="mod-05.html#comparing-distributions-using-cdf-and-ecdf"><i class="fa fa-check"></i><b>5.5.2</b> Comparing distributions using CDF and ECDF</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-05.html"><a href="mod-05.html#comparing-distributions-using-qq-plots"><i class="fa fa-check"></i><b>5.5.3</b> Comparing distributions using QQ plots</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-05.html"><a href="mod-05.html#formal-tests-for-distributions"><i class="fa fa-check"></i><b>5.6</b> Formal tests for distributions</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-05.html"><a href="mod-05.html#tests-for-normality"><i class="fa fa-check"></i><b>5.6.1</b> Tests for normality</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-05.html"><a href="mod-05.html#kolmogorov-smirnov-tests"><i class="fa fa-check"></i><b>5.6.2</b> Kolmogorov-Smirnov tests</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-05.html"><a href="mod-05.html#mod-05-trans"><i class="fa fa-check"></i><b>5.7</b> Data transformations</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mod-05.html"><a href="mod-05.html#why-transform"><i class="fa fa-check"></i><b>5.7.1</b> Why transform?</a></li>
<li class="chapter" data-level="5.7.2" data-path="mod-05.html"><a href="mod-05.html#transforms-vs.-link-functions"><i class="fa fa-check"></i><b>5.7.2</b> Transforms vs. link functions</a></li>
<li class="chapter" data-level="5.7.3" data-path="mod-05.html"><a href="mod-05.html#common-transformations"><i class="fa fa-check"></i><b>5.7.3</b> Common transformations</a></li>
<li class="chapter" data-level="5.7.4" data-path="mod-05.html"><a href="mod-05.html#uncommon-transformations"><i class="fa fa-check"></i><b>5.7.4</b> Uncommon transformations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-06.html"><a href="mod-06.html"><i class="fa fa-check"></i><b>6</b> Exploratory data analysis 3: Multivariate data exploration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-06.html"><a href="mod-06.html#scatterplots-for-2-continuous-variables"><i class="fa fa-check"></i><b>6.1</b> Scatterplots for 2 continuous variables</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="mod-06.html"><a href="mod-06.html#r-plotting-basics"><i class="fa fa-check"></i><b>6.1.1</b> R plotting basics</a></li>
<li class="chapter" data-level="6.1.2" data-path="mod-06.html"><a href="mod-06.html#graphical-parameters-and-advanced-plots-with-par"><i class="fa fa-check"></i><b>6.1.2</b> Graphical parameters and advanced plots with <code>par()</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="mod-06.html"><a href="mod-06.html#really-advanced-plotting"><i class="fa fa-check"></i><b>6.1.3</b> Really advanced plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="mod-06.html"><a href="mod-06.html#mod-06-smat"><i class="fa fa-check"></i><b>6.2</b> Scatterplot matrices for many variables</a></li>
<li class="chapter" data-level="6.3" data-path="mod-06.html"><a href="mod-06.html#lattice-plots-for-hierarchical-data"><i class="fa fa-check"></i><b>6.3</b> Lattice plots for hierarchical data</a></li>
<li class="chapter" data-level="6.4" data-path="mod-06.html"><a href="mod-06.html#continuous-variables-by-group"><i class="fa fa-check"></i><b>6.4</b> Continuous variables by group</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="mod-06.html"><a href="mod-06.html#boxplots"><i class="fa fa-check"></i><b>6.4.1</b> Boxplots</a></li>
<li class="chapter" data-level="6.4.2" data-path="mod-06.html"><a href="mod-06.html#barplots"><i class="fa fa-check"></i><b>6.4.2</b> Barplots</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mod-06.html"><a href="mod-06.html#ordination-brief-introduction"><i class="fa fa-check"></i><b>6.5</b> Ordination (brief introduction)</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-06.html"><a href="mod-06.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>6.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-06.html"><a href="mod-06.html#nonmetric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>6.5.2</b> Nonmetric multidimensional scaling (NMDS)</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-06.html"><a href="mod-06.html#plotting-ordinations"><i class="fa fa-check"></i><b>6.5.3</b> Plotting ordinations</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-06.html"><a href="mod-06.html#ordination-wrap-up-for-now"><i class="fa fa-check"></i><b>6.5.4</b> Ordination wrap-up (for now)</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="mod-06.html"><a href="mod-06.html#principles-for-good-data-graphics"><i class="fa fa-check"></i><b>6.6</b> Principles for good data graphics</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="mod-06.html"><a href="mod-06.html#maximize-the-data-to-ink-ratio"><i class="fa fa-check"></i><b>6.6.1</b> Maximize the data-to-ink ratio</a></li>
<li class="chapter" data-level="6.6.2" data-path="mod-06.html"><a href="mod-06.html#show-variability"><i class="fa fa-check"></i><b>6.6.2</b> Show variability</a></li>
<li class="chapter" data-level="6.6.3" data-path="mod-06.html"><a href="mod-06.html#use-labels-not-symbols"><i class="fa fa-check"></i><b>6.6.3</b> Use labels, not symbols</a></li>
<li class="chapter" data-level="6.6.4" data-path="mod-06.html"><a href="mod-06.html#be-consistent"><i class="fa fa-check"></i><b>6.6.4</b> Be consistent</a></li>
<li class="chapter" data-level="6.6.5" data-path="mod-06.html"><a href="mod-06.html#set-yourself-up-for-success"><i class="fa fa-check"></i><b>6.6.5</b> Set yourself up for success</a></li>
<li class="chapter" data-level="6.6.6" data-path="mod-06.html"><a href="mod-06.html#consider-legibility"><i class="fa fa-check"></i><b>6.6.6</b> Consider legibility</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mod-07.html"><a href="mod-07.html"><i class="fa fa-check"></i><b>7</b> Common statistical problems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-07.html"><a href="mod-07.html#outliers-and-erroneous-values"><i class="fa fa-check"></i><b>7.1</b> Outliers and erroneous values</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="mod-07.html"><a href="mod-07.html#detecting-outliers"><i class="fa fa-check"></i><b>7.1.1</b> Detecting outliers</a></li>
<li class="chapter" data-level="7.1.2" data-path="mod-07.html"><a href="mod-07.html#dealing-with-outliers"><i class="fa fa-check"></i><b>7.1.2</b> Dealing with outliers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="mod-07.html"><a href="mod-07.html#autocorrelation"><i class="fa fa-check"></i><b>7.2</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-07.html"><a href="mod-07.html#graphical-methods-to-identify-autocorrelation"><i class="fa fa-check"></i><b>7.2.1</b> Graphical methods to identify autocorrelation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-07.html"><a href="mod-07.html#mantel-tests-for-autocorrelation"><i class="fa fa-check"></i><b>7.2.2</b> Mantel tests for autocorrelation</a></li>
<li class="chapter" data-level="7.2.3" data-path="mod-07.html"><a href="mod-07.html#dealing-with-autocorrelation"><i class="fa fa-check"></i><b>7.2.3</b> Dealing with autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-07.html"><a href="mod-07.html#mod-07-multicol"><i class="fa fa-check"></i><b>7.3</b> Collinearity</a></li>
<li class="chapter" data-level="7.4" data-path="mod-07.html"><a href="mod-07.html#missing-data"><i class="fa fa-check"></i><b>7.4</b> Missing data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mod-07.html"><a href="mod-07.html#option-1-ignore-missing-data"><i class="fa fa-check"></i><b>7.4.1</b> Option 1: Ignore missing data</a></li>
<li class="chapter" data-level="7.4.2" data-path="mod-07.html"><a href="mod-07.html#option-2-interpolate-or-impute-missing-data"><i class="fa fa-check"></i><b>7.4.2</b> Option 2: Interpolate or impute missing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-08.html"><a href="mod-08.html"><i class="fa fa-check"></i><b>8</b> Planning your analysis (what test?)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-08.html"><a href="mod-08.html#how-to-use-this-guide"><i class="fa fa-check"></i><b>8.1</b> How to use this guide</a></li>
<li class="chapter" data-level="8.2" data-path="mod-08.html"><a href="mod-08.html#what-question-are-you-trying-to-answer"><i class="fa fa-check"></i><b>8.2</b> What question are you trying to answer?</a></li>
<li class="chapter" data-level="8.3" data-path="mod-08.html"><a href="mod-08.html#testing-for-a-difference-in-mean-or-location"><i class="fa fa-check"></i><b>8.3</b> Testing for a difference in mean or location</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mod-08.html"><a href="mod-08.html#additional-considerations"><i class="fa fa-check"></i><b>8.3.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mod-08.html"><a href="mod-08.html#testing-for-a-continuous-relationship-between-two-or-more-variables"><i class="fa fa-check"></i><b>8.4</b> Testing for a continuous relationship between two or more variables</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="mod-08.html"><a href="mod-08.html#additional-considerations-1"><i class="fa fa-check"></i><b>8.4.1</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mod-08.html"><a href="mod-08.html#independence-between-categories"><i class="fa fa-check"></i><b>8.5</b> Independence between categories</a></li>
<li class="chapter" data-level="8.6" data-path="mod-08.html"><a href="mod-08.html#classifying-observations"><i class="fa fa-check"></i><b>8.6</b> Classifying observations</a></li>
<li class="chapter" data-level="8.7" data-path="mod-08.html"><a href="mod-08.html#conclusions"><i class="fa fa-check"></i><b>8.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-09.html"><a href="mod-09.html"><i class="fa fa-check"></i><b>9</b> Basic statistics with R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-09.html"><a href="mod-09.html#mod-09-datasets"><i class="fa fa-check"></i><b>9.1</b> Datasets and variables</a></li>
<li class="chapter" data-level="9.2" data-path="mod-09.html"><a href="mod-09.html#mod-09-frequentist"><i class="fa fa-check"></i><b>9.2</b> Frequentist statistics</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mod-09.html"><a href="mod-09.html#mod-09-pvalues"><i class="fa fa-check"></i><b>9.2.1</b> <em>P</em>-values and NHST</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mod-09.html"><a href="mod-09.html#mod-09-whattest"><i class="fa fa-check"></i><b>9.3</b> What kind of test do you need?</a></li>
<li class="chapter" data-level="9.4" data-path="mod-09.html"><a href="mod-09.html#mod-09-tests-for-loc"><i class="fa fa-check"></i><b>9.4</b> Tests for differences in mean or location</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mod-09.html"><a href="mod-09.html#tests-for-1-group"><i class="fa fa-check"></i><b>9.4.1</b> Tests for 1 group</a></li>
<li class="chapter" data-level="9.4.2" data-path="mod-09.html"><a href="mod-09.html#tests-comparing-two-groups"><i class="fa fa-check"></i><b>9.4.2</b> Tests comparing two groups</a></li>
<li class="chapter" data-level="9.4.3" data-path="mod-09.html"><a href="mod-09.html#aside-whats-with-all-these-t-tests"><i class="fa fa-check"></i><b>9.4.3</b> Aside: what’s with all these <em>t</em>-tests?</a></li>
<li class="chapter" data-level="9.4.4" data-path="mod-09.html"><a href="mod-09.html#comparing-3-or-more-groups"><i class="fa fa-check"></i><b>9.4.4</b> Comparing 3 or more groups</a></li>
<li class="chapter" data-level="9.4.5" data-path="mod-09.html"><a href="mod-09.html#ordered-factors-and-polynomial-patterns-in-grouped-data"><i class="fa fa-check"></i><b>9.4.5</b> Ordered factors and polynomial patterns in grouped data</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mod-09.html"><a href="mod-09.html#tests-for-patterns-in-continuous-data"><i class="fa fa-check"></i><b>9.5</b> Tests for patterns in continuous data</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-09.html"><a href="mod-09.html#mod-09-correlation"><i class="fa fa-check"></i><b>9.5.1</b> Correlation</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-09.html"><a href="mod-09.html#mod-09-linear-mods"><i class="fa fa-check"></i><b>9.5.2</b> Linear models</a></li>
<li class="chapter" data-level="9.5.3" data-path="mod-09.html"><a href="mod-09.html#linear-models-wrap-up-for-now"><i class="fa fa-check"></i><b>9.5.3</b> Linear models wrap-up (for now)</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mod-09.html"><a href="mod-09.html#mod-09-contingency"><i class="fa fa-check"></i><b>9.6</b> Tests for proportions and contingency</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mod-09.html"><a href="mod-09.html#mod-09-ctables"><i class="fa fa-check"></i><b>9.6.1</b> Contingency tables</a></li>
<li class="chapter" data-level="9.6.2" data-path="mod-09.html"><a href="mod-09.html#tests-on-contingency-tables"><i class="fa fa-check"></i><b>9.6.2</b> Tests on contingency tables</a></li>
<li class="chapter" data-level="9.6.3" data-path="mod-09.html"><a href="mod-09.html#mod-09-oddsratios"><i class="fa fa-check"></i><b>9.6.3</b> Contingency tests and odds ratios</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mod-09.html"><a href="mod-09.html#mod-09-classification"><i class="fa fa-check"></i><b>9.7</b> Classification</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-10.html"><a href="mod-10.html"><i class="fa fa-check"></i><b>10</b> Generalized linear models (GLM)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-10.html"><a href="mod-10.html#mod-10-lm"><i class="fa fa-check"></i><b>10.1</b> Prelude with linear models</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="mod-10.html"><a href="mod-10.html#assumptions-of-linear-models"><i class="fa fa-check"></i><b>10.1.1</b> Assumptions of linear models</a></li>
<li class="chapter" data-level="10.1.2" data-path="mod-10.html"><a href="mod-10.html#linear-regression-in-r"><i class="fa fa-check"></i><b>10.1.2</b> Linear regression in R</a></li>
<li class="chapter" data-level="10.1.3" data-path="mod-10.html"><a href="mod-10.html#multiple-linear-regression"><i class="fa fa-check"></i><b>10.1.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="10.1.4" data-path="mod-10.html"><a href="mod-10.html#mod-10-anova"><i class="fa fa-check"></i><b>10.1.4</b> ANOVA and ANCOVA with <code>lm()</code></a></li>
<li class="chapter" data-level="10.1.5" data-path="mod-10.html"><a href="mod-10.html#variations-on-linear-models"><i class="fa fa-check"></i><b>10.1.5</b> Variations on linear models</a></li>
<li class="chapter" data-level="10.1.6" data-path="mod-10.html"><a href="mod-10.html#example-linear-regression-workflow"><i class="fa fa-check"></i><b>10.1.6</b> Example linear regression workflow</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="mod-10.html"><a href="mod-10.html#mod-10-basic"><i class="fa fa-check"></i><b>10.2</b> GLM basics</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="mod-10.html"><a href="mod-10.html#example-glms"><i class="fa fa-check"></i><b>10.2.1</b> Example GLMS</a></li>
<li class="chapter" data-level="10.2.2" data-path="mod-10.html"><a href="mod-10.html#glm-families"><i class="fa fa-check"></i><b>10.2.2</b> GLM families</a></li>
<li class="chapter" data-level="10.2.3" data-path="mod-10.html"><a href="mod-10.html#glm-link-functions"><i class="fa fa-check"></i><b>10.2.3</b> GLM link functions</a></li>
<li class="chapter" data-level="10.2.4" data-path="mod-10.html"><a href="mod-10.html#deviance-and-other-glm-diagnostics"><i class="fa fa-check"></i><b>10.2.4</b> Deviance and other GLM diagnostics</a></li>
<li class="chapter" data-level="10.2.5" data-path="mod-10.html"><a href="mod-10.html#to-pseudo-r2-or-not-to-pseudo-r2"><i class="fa fa-check"></i><b>10.2.5</b> To pseudo-<em>R</em><sup>2</sup> or not to pseudo-<em>R</em><sup>2</sup>?</a></li>
<li class="chapter" data-level="10.2.6" data-path="mod-10.html"><a href="mod-10.html#common-glms"><i class="fa fa-check"></i><b>10.2.6</b> Common GLMs</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="mod-10.html"><a href="mod-10.html#mod-10-loglin"><i class="fa fa-check"></i><b>10.3</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="mod-10.html"><a href="mod-10.html#mod-10-loglin-examp"><i class="fa fa-check"></i><b>10.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="10.3.2" data-path="mod-10.html"><a href="mod-10.html#example-with-real-data"><i class="fa fa-check"></i><b>10.3.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="mod-10.html"><a href="mod-10.html#mod-10-poisson"><i class="fa fa-check"></i><b>10.4</b> Poisson GLM for counts</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="mod-10.html"><a href="mod-10.html#example-with-simulated-data"><i class="fa fa-check"></i><b>10.4.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="10.4.2" data-path="mod-10.html"><a href="mod-10.html#example-with-real-data-1"><i class="fa fa-check"></i><b>10.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="mod-10.html"><a href="mod-10.html#mod-10-quasi"><i class="fa fa-check"></i><b>10.5</b> Quasi-Poisson and negative binomial GLM</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="mod-10.html"><a href="mod-10.html#example-with-simulated-data-1"><i class="fa fa-check"></i><b>10.5.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="10.5.2" data-path="mod-10.html"><a href="mod-10.html#example-with-real-data-2"><i class="fa fa-check"></i><b>10.5.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="mod-10.html"><a href="mod-10.html#mod-10-logistic"><i class="fa fa-check"></i><b>10.6</b> Logistic regression for binary outcomes</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="mod-10.html"><a href="mod-10.html#example-with-simulated-data-2"><i class="fa fa-check"></i><b>10.6.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="10.6.2" data-path="mod-10.html"><a href="mod-10.html#example-with-real-data-3"><i class="fa fa-check"></i><b>10.6.2</b> Example with real data</a></li>
<li class="chapter" data-level="10.6.3" data-path="mod-10.html"><a href="mod-10.html#mod-10-auc"><i class="fa fa-check"></i><b>10.6.3</b> Logistic GLM diagnostics: AUC and ROC</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="mod-10.html"><a href="mod-10.html#mod-10-binom"><i class="fa fa-check"></i><b>10.7</b> Binomial GLM for proportional data</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="mod-10.html"><a href="mod-10.html#binomial-glm"><i class="fa fa-check"></i><b>10.7.1</b> Binomial GLM</a></li>
<li class="chapter" data-level="10.7.2" data-path="mod-10.html"><a href="mod-10.html#example-with-simulated-data-3"><i class="fa fa-check"></i><b>10.7.2</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="mod-10.html"><a href="mod-10.html#mod-10-gamma"><i class="fa fa-check"></i><b>10.8</b> Gamma models for overdispersed data</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mod-10.html"><a href="mod-10.html#example-with-simulated-data-4"><i class="fa fa-check"></i><b>10.8.1</b> Example with simulated data</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="mod-10.html"><a href="mod-10.html#mod-10-beyond"><i class="fa fa-check"></i><b>10.9</b> Beyond GLM: Overview of GAM and GEE</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="mod-10.html"><a href="mod-10.html#mod-10-gam"><i class="fa fa-check"></i><b>10.9.1</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="10.9.2" data-path="mod-10.html"><a href="mod-10.html#mod-10-gee"><i class="fa fa-check"></i><b>10.9.2</b> Generalized estimating equations (GEE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-11.html"><a href="mod-11.html"><i class="fa fa-check"></i><b>11</b> Nonlinear models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-11.html"><a href="mod-11.html#background"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="mod-11.html"><a href="mod-11.html#mod-11-intro"><i class="fa fa-check"></i><b>11.2</b> Nonlinear least squares (NLS)</a></li>
<li class="chapter" data-level="11.3" data-path="mod-11.html"><a href="mod-11.html#mod-11-micmen"><i class="fa fa-check"></i><b>11.3</b> Michaelis-Menten curves</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="mod-11.html"><a href="mod-11.html#mod-11-micmen-sim"><i class="fa fa-check"></i><b>11.3.1</b> Example with simulated data</a></li>
<li class="chapter" data-level="11.3.2" data-path="mod-11.html"><a href="mod-11.html#example-with-real-data-4"><i class="fa fa-check"></i><b>11.3.2</b> Example with real data</a></li>
<li class="chapter" data-level="11.3.3" data-path="mod-11.html"><a href="mod-11.html#alternative-strategies-for-the-analysis"><i class="fa fa-check"></i><b>11.3.3</b> Alternative strategies for the analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="mod-11.html"><a href="mod-11.html#mod-11-grow"><i class="fa fa-check"></i><b>11.4</b> Biological growth curves</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="mod-11.html"><a href="mod-11.html#gompertz-and-von-bertalanffy-curves"><i class="fa fa-check"></i><b>11.4.1</b> Gompertz and von Bertalanffy curves</a></li>
<li class="chapter" data-level="11.4.2" data-path="mod-11.html"><a href="mod-11.html#example-with-real-data-5"><i class="fa fa-check"></i><b>11.4.2</b> Example with real data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="mod-11.html"><a href="mod-11.html#dose-response-curves"><i class="fa fa-check"></i><b>11.5</b> Dose response curves</a></li>
<li class="chapter" data-level="11.6" data-path="mod-11.html"><a href="mod-11.html#alternatives-to-nls"><i class="fa fa-check"></i><b>11.6</b> Alternatives to NLS</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="mod-11.html"><a href="mod-11.html#generalized-nonlinear-models"><i class="fa fa-check"></i><b>11.6.1</b> Generalized nonlinear models</a></li>
<li class="chapter" data-level="11.6.2" data-path="mod-11.html"><a href="mod-11.html#quantile-regression"><i class="fa fa-check"></i><b>11.6.2</b> Quantile regression</a></li>
<li class="chapter" data-level="11.6.3" data-path="mod-11.html"><a href="mod-11.html#mod-11-gam"><i class="fa fa-check"></i><b>11.6.3</b> Generalized additive models (GAM)</a></li>
<li class="chapter" data-level="11.6.4" data-path="mod-11.html"><a href="mod-11.html#classification-and-regression-trees-cart"><i class="fa fa-check"></i><b>11.6.4</b> Classification and regression trees (CART)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-12.html"><a href="mod-12.html"><i class="fa fa-check"></i><b>12</b> Mixed models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-12.html"><a href="mod-12.html#prelude-glm"><i class="fa fa-check"></i><b>12.1</b> Prelude (GLM)</a></li>
<li class="chapter" data-level="12.2" data-path="mod-12.html"><a href="mod-12.html#mod-12-lmm"><i class="fa fa-check"></i><b>12.2</b> Linear mixed models (LMM)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-12.html"><a href="mod-12.html#formal-definition-and-example"><i class="fa fa-check"></i><b>12.2.1</b> Formal definition and example</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-12.html"><a href="mod-12.html#example-with-simulated-data-5"><i class="fa fa-check"></i><b>12.2.2</b> Example with simulated data</a></li>
<li class="chapter" data-level="12.2.3" data-path="mod-12.html"><a href="mod-12.html#p-values-in-lmm"><i class="fa fa-check"></i><b>12.2.3</b> <em>P</em>-values in LMM</a></li>
<li class="chapter" data-level="12.2.4" data-path="mod-12.html"><a href="mod-12.html#specifying-random-effects"><i class="fa fa-check"></i><b>12.2.4</b> Specifying random effects</a></li>
<li class="chapter" data-level="12.2.5" data-path="mod-12.html"><a href="mod-12.html#lmm-example-with-real-data"><i class="fa fa-check"></i><b>12.2.5</b> LMM example with real data</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-12.html"><a href="mod-12.html#mod-12-glmm"><i class="fa fa-check"></i><b>12.3</b> Generalized linear mixed models (GLMM)</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="mod-12.html"><a href="mod-12.html#definition-1"><i class="fa fa-check"></i><b>12.3.1</b> Definition</a></li>
<li class="chapter" data-level="12.3.2" data-path="mod-12.html"><a href="mod-12.html#glmm-on-simulated-data"><i class="fa fa-check"></i><b>12.3.2</b> GLMM on simulated data</a></li>
<li class="chapter" data-level="12.3.3" data-path="mod-12.html"><a href="mod-12.html#glmm-on-real-data"><i class="fa fa-check"></i><b>12.3.3</b> GLMM on real data</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="mod-12.html"><a href="mod-12.html#mod-12-nlme"><i class="fa fa-check"></i><b>12.4</b> Nonlinear mixed models (NLME)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="mod-12.html"><a href="mod-12.html#definition-and-background"><i class="fa fa-check"></i><b>12.4.1</b> Definition and background</a></li>
<li class="chapter" data-level="12.4.2" data-path="mod-12.html"><a href="mod-12.html#nlme-on-simulated-data"><i class="fa fa-check"></i><b>12.4.2</b> NLME on simulated data</a></li>
<li class="chapter" data-level="12.4.3" data-path="mod-12.html"><a href="mod-12.html#nlme-on-real-data"><i class="fa fa-check"></i><b>12.4.3</b> NLME on real data</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="mod-12.html"><a href="mod-12.html#mod-12-gamm"><i class="fa fa-check"></i><b>12.5</b> (Generalized) additive mixed models (AMM/GAMM)</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="mod-12.html"><a href="mod-12.html#example-gamm-with-real-data"><i class="fa fa-check"></i><b>12.5.1</b> Example GAMM with real data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod-13.html"><a href="mod-13.html"><i class="fa fa-check"></i><b>13</b> Multivariate data analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mod-13.html"><a href="mod-13.html#multivariate-data"><i class="fa fa-check"></i><b>13.1</b> Multivariate data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="mod-13.html"><a href="mod-13.html#univariate-vs.-multivariate-data"><i class="fa fa-check"></i><b>13.1.1</b> Univariate vs. multivariate data</a></li>
<li class="chapter" data-level="13.1.2" data-path="mod-13.html"><a href="mod-13.html#components-of-multivariate-data"><i class="fa fa-check"></i><b>13.1.2</b> Components of multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="mod-13.html"><a href="mod-13.html#mod-13-dist"><i class="fa fa-check"></i><b>13.2</b> Distance metrics: biological (dis)similarity</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="mod-13.html"><a href="mod-13.html#euclidean-distance"><i class="fa fa-check"></i><b>13.2.1</b> Euclidean distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="mod-13.html"><a href="mod-13.html#bray-curtis-and-other-distance-metrics"><i class="fa fa-check"></i><b>13.2.2</b> Bray-Curtis and other distance metrics</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="mod-13.html"><a href="mod-13.html#clustering"><i class="fa fa-check"></i><b>13.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="mod-13.html"><a href="mod-13.html#k-means-clustering"><i class="fa fa-check"></i><b>13.3.1</b> <em>K</em>-means clustering</a></li>
<li class="chapter" data-level="13.3.2" data-path="mod-13.html"><a href="mod-13.html#hierarchical-agglomerative-clustering"><i class="fa fa-check"></i><b>13.3.2</b> Hierarchical agglomerative clustering</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="mod-13.html"><a href="mod-13.html#mod-13-sims"><i class="fa fa-check"></i><b>13.4</b> Analyzing dissimilarity</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="mod-13.html"><a href="mod-13.html#mantel-tests-distance-vs.-distance"><i class="fa fa-check"></i><b>13.4.1</b> Mantel tests: distance vs. distance</a></li>
<li class="chapter" data-level="13.4.2" data-path="mod-13.html"><a href="mod-13.html#comparing-dissimilarity-between-groups"><i class="fa fa-check"></i><b>13.4.2</b> Comparing dissimilarity between groups</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="mod-13.html"><a href="mod-13.html#mod-13-ord"><i class="fa fa-check"></i><b>13.5</b> Ordination</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="mod-13.html"><a href="mod-13.html#mod-13-pca"><i class="fa fa-check"></i><b>13.5.1</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="13.5.2" data-path="mod-13.html"><a href="mod-13.html#nmds-and-other-ordination-methods"><i class="fa fa-check"></i><b>13.5.2</b> NMDS and other ordination methods</a></li>
<li class="chapter" data-level="13.5.3" data-path="mod-13.html"><a href="mod-13.html#other-ordination-techniques"><i class="fa fa-check"></i><b>13.5.3</b> Other ordination techniques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="literature-cited.html"><a href="literature-cited.html"><i class="fa fa-check"></i>Literature Cited</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Biological Data Analysis: Statistics and R for Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-05" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Module 5</span> Exploratory data analysis 2: Probability distributions for biology<a href="mod-05.html#mod-05" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="mod-05-dists1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Statistical distributions<a href="mod-05.html#mod-05-dists1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All data contain some element of randomness. Understanding the nature and consequences of that randomness is what motivates much of modern statistics. <strong>Probability distributions</strong> are the mathematical constructs that describe randomness in statistics. This page describes some probability distributions commonly encountered in biology (and a few that aren’t common). The emphasis here is on practical understanding of what the distributions imply about data–not on the theoretical underpinnings or mathematical details. If you want or need a rigorous introduction to probability theory, this is probably not the right place.</p>
<p>Consider the figures below:</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx390-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Both scatterplots show a linear relationship between <em>X</em> and <em>Y</em>. But what is different about the plot on the right? Variation. Both plots show the same relationship (<span class="math inline">\(Y=22+1.4X\)</span>), but they differ in that the variation about the expected value (the red line) is much greater in the right plot than the left plot. Consequently, <em>X</em> appears to explain much more variation in <em>Y</em> in the left plot than in the right plot. The next figure shows that the <strong>residual variation</strong>, or difference between the expected and observed values, is much greater in the right panel. Each of these differences between the observed value of <em>Y</em> (<span class="math inline">\(Y_i\)</span>) and the expected value of <em>Y</em> (<span class="math inline">\(E(Y_i)\)</span>), or <span class="math inline">\(Y_i-E(Y_i)\)</span>, is called a <strong>residual</strong>.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-372-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Residuals are an important part of statistical analysis for two reasons. First, most statistical models make assumptions about the distribution of residuals. Second, the total magnitude of the residuals (usually expressed as sum of squared residuals) is useful for calculating many measures of how well a model fits the data. The residuals of a statistical model are the differences between the observed values and the values predicted by the model. The residual for observation <em>i</em> in variable <em>Y</em>, <span class="math inline">\(R_i\)</span>, is calculated as:</p>
<p><span class="math display">\[R_i=Y_i-E\left[Y_i\right]\]</span></p>
<p>where <span class="math inline">\(E(Y_i)\)</span> is the <strong>expected value</strong> of <span class="math inline">\(Y_i\)</span>. This means that when an observation has a greater value than predicted, the residual is positive; similarly, when an observation is smaller than expected, the residual is negative. In many statistical methods, residuals are squared so that (1) positive and negative residuals do not cancel out; and (2) larger residuals carry more weight.</p>
<p>The figures below show the distributions of residuals for the example linear regressions above. Notice that the left dataset has a much smaller distribution of residuals than the right dataset. This is because of the much tighter fit of the left dataset’s Y values to the predicted curve.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-373-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Notice also that both distributions of residuals have a similar shape, despite the difference in width. This shape is actually very important: the <strong>normal distribution</strong>. If the residuals were not distributed this way (i.e., did not follow a normal distribution), then we would be in trouble for two reasons. First, the data were generated using a normal distribution for residuals, so something would have had to have gone wrong with our statistical test; and second, the linear regression model used to analyze the data assumes that residuals are normally distributed. If they are not, then the test is not going to produce valid estimates of statistical significance or model parameters.</p>
<p>The example above is an example of the importance of thinking about statistical distributions when analyzing data. So just what is a statistical distribution? Distributions are mathematical functions that define the probabilities of random outcomes. Here <strong>random</strong> means that there is some element of chance in what we observe. This randomness is not completely unpredictable. While the outcome of specific observations might be unknowable, we can make predictions about long run frequencies or averages of lots of observations. In other words, single observations are not predictable, but the properties of sets of observations are. Such properties might include the number of times a specific outcome occurs (e.g., number of times a flipped coin comes up heads) or some summary of observations (e.g., the mean tail length of chipmunks). Another term for this kind of randomness that follows a pattern is <strong>stochastic</strong>.</p>
<p><strong>Another example: coin flips</strong></p>
<p>Consider flipping a coin. A fair coin will come up “heads” 50% of the time, and “tails” the other 50%. If you flip a coin once, the probability of getting heads is 50%. But what about if you flip the coin 10 times? How many heads should you get? 5 is a reasonable guess. The table below shows the possible outcomes to 10 coin flips:</p>
<table>
<thead>
<tr class="header">
<th align="center">Heads</th>
<th align="center">Tails</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">7</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">6</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">8</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">9</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">10</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>This table shows that 5 heads is only one of 11 possibilities! So, is the probability of 5 heads 1 in 11 (<span class="math inline">\(\approx\)</span> 0.091)? Of course not, because not all outcomes are equally likely.</p>
<p>One of the reasons statistics is so fun is that we can often use simulation to discover patterns. The R code below will simulate the effects of flipping 1 coin 10 times. Run this code a few times and see what happens.</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="mod-05.html#cb640-1" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>A typical run of results might be something like <code>4 5 5 4 3 5 6 6 5 5 4 6</code>. We can repeat this line many times and graph the results:</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="mod-05.html#cb642-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">20</span>)</span>
<span id="cb642-2"><a href="mod-05.html#cb642-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)}</span>
<span id="cb642-3"><a href="mod-05.html#cb642-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-375-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>There is actually a faster way, by requesting 20 draws of 10 flips each all at once:</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="mod-05.html#cb643-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">20</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)</span>
<span id="cb643-2"><a href="mod-05.html#cb643-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(x))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-376-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Is 5 the most likely value? What about if we get a larger sample?</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="mod-05.html#cb644-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb644-2"><a href="mod-05.html#cb644-2" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">100</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb644-3"><a href="mod-05.html#cb644-3" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">1000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb644-4"><a href="mod-05.html#cb644-4" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">10000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb644-5"><a href="mod-05.html#cb644-5" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">100000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb644-6"><a href="mod-05.html#cb644-6" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rbinom</span>(<span class="dv">1000000</span>,<span class="dv">10</span>,<span class="fl">0.5</span>))</span>
<span id="cb644-7"><a href="mod-05.html#cb644-7" tabindex="-1"></a></span>
<span id="cb644-8"><a href="mod-05.html#cb644-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb644-9"><a href="mod-05.html#cb644-9" tabindex="-1"></a><span class="fu">plot</span>(x1, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 10&quot;</span>)</span>
<span id="cb644-10"><a href="mod-05.html#cb644-10" tabindex="-1"></a><span class="fu">plot</span>(x2, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 100&quot;</span>)</span>
<span id="cb644-11"><a href="mod-05.html#cb644-11" tabindex="-1"></a><span class="fu">plot</span>(x3, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 1000&quot;</span>)</span>
<span id="cb644-12"><a href="mod-05.html#cb644-12" tabindex="-1"></a><span class="fu">plot</span>(x4, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 10000&quot;</span>)</span>
<span id="cb644-13"><a href="mod-05.html#cb644-13" tabindex="-1"></a><span class="fu">plot</span>(x5, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 100000&quot;</span>)</span>
<span id="cb644-14"><a href="mod-05.html#cb644-14" tabindex="-1"></a><span class="fu">plot</span>(x6, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;n = 1000000&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-377-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="mod-05.html#cb645-1" tabindex="-1"></a><span class="co"># reset graphical parameters</span></span>
<span id="cb645-2"><a href="mod-05.html#cb645-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>You may have guessed by now that the properties of a set of coin flips—such as what number of heads to expect—are described by some kind of mathematical idea. This idea is called a statistical distribution. This particular distribution is the <strong>binomial distribution</strong>, which describes the outcome of any random process with a binary outcome. The name “binomial” is descriptive: “bi” for two, and “nomial” for names or states. Can you think of a biological situation where the binomial distribution might apply?</p>
<p>The sections below describe some distributions commonly encountered in biology, and what kinds of processes give rise to them. It is important to be able to relate biological phenomena to statistical distributions, because the underlying nature of the randomness in some process can affect how we analyze that process statistically. Note that in this class we will focus on the practical applications of these distributions, rather than their mathematical derivations.</p>
<div id="probability-distributions-in-r" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Probability distributions in R<a href="mod-05.html#probability-distributions-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Every distribution supported in R has four functions associated with it: <code>r__()</code>, <code>q__()</code>, <code>d__()</code>, and <code>p__()</code> , where <code>__</code> is the name of the distribution (or an abbreviation). These 4 functions calculate different values defined by the distribution:</p>
<ul>
<li><code>r__()</code> draws <strong>random numbers</strong> from the distribution.</li>
<li><code>p__()</code> calculates the <strong>cumulative distribution function (CDF)</strong> at a given value. The reverse of <code>q__()</code>.</li>
<li><code>d__()</code> calculates the <strong>probability density function (PDF)</strong>; i.e., the height of the density curve, or first derivative of the CDF.</li>
<li><code>q__()</code> calculates the <strong>value at a given quantile</strong>. The reverse of <code>p__()</code>.</li>
</ul>
<p>The figure below shows these functions in relation to the PDF and CDF for a normal distribution.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-378-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mod-05-discrete" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Discrete distributions<a href="mod-05.html#mod-05-discrete" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Discrete distributions</strong> can take on integer values only. Because of this, many discrete distributions are related in some way to <strong>count data</strong>. Count data result from, well, counting things. Count data can also describe the number of times something happened.</p>
<div id="bernoulli-distribution" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Bernoulli distribution<a href="mod-05.html#bernoulli-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The simplest discrete distribution is the <strong>Bernoulli distribution</strong>. It describes the outcome of a single random event with probability <em>p</em>. Thus, the Bernoulli distribution takes the value 1 with probability <em>p</em> or the value 0 with probability <span class="math inline">\(q=(1-p)\)</span>. Any opportunity for the event to happen is also called a <strong>Bernoulli trial</strong>, and the process that it describes a <strong>Bernoulli process</strong>. The probability <em>p</em> can take on any value in the interval [0, 1].</p>
<p>For convenience we usually consider a Bernoulli distribution to take the value of 0 or 1, but really it could represent any binary outcome. For example, <em>yes vs. no</em>, <em>dead vs. alive</em>, <em>&lt; 3 vs. <span class="math inline">\(\ge\)</span> 3</em>, etc., are all outcomes that could be modeled as Bernoulli variables. By convention, the event that occurs with probability <em>p</em> is considered a <strong>success</strong> and has the numerical value 1; the even that occurs with probability 1-<em>p</em> is considered a <strong>failure</strong> and takes the numerical value 0. This is how Bernoulli variables are represented in most statistical packages, including R.</p>
<p>The Bernoulli distribution is rarely used on its own in an analysis<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a>. Instead, it’s useful to think of the Bernoulli distribution as a special case of, or a building block of, more complicated distributions such as the binomial distribution. For example, a single observation of a binomially-distributed variable could be thought of as a Bernoulli distribution.</p>
<p>The Bernoulli distribution is a special case of the binomial distribution, and so it is accessed in R using the functions associated with the binomial. With the <code>size</code> argument set to 1, the binomial distribution <em>is</em> the Bernoulli distribution.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="mod-05.html#cb646-1" tabindex="-1"></a><span class="co"># flip one fair coin</span></span>
<span id="cb646-2"><a href="mod-05.html#cb646-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="mod-05.html#cb648-1" tabindex="-1"></a><span class="co"># flip 10 fair coins</span></span>
<span id="cb648-2"><a href="mod-05.html#cb648-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 1 1 0 1 1 0 1 0 1 1</code></pre>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="mod-05.html#cb650-1" tabindex="-1"></a><span class="co"># flip 10 coins with a 70% chance of heads</span></span>
<span id="cb650-2"><a href="mod-05.html#cb650-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.7</span>)</span></code></pre></div>
<pre><code>##  [1] 0 1 1 0 1 1 0 0 0 1</code></pre>
</div>
<div id="mod-05-binom" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Binomial distribution<a href="mod-05.html#mod-05-binom" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The binomial distribution describes the <strong>number of successes</strong> in a set of independent Bernoulli trials. Each trial has probability of success <em>p</em>, and there are <em>n</em> trials. The values <em>n</em> and <em>p</em> are the <strong>parameters</strong> of the binomial distribution–the values that describe its behavior. The coin flipping example above is an example of a binomial distribution. Biological examples of binomial processes might be the number of fish that die in an experiment, or the number of plants that flower in a season.</p>
<p>Because it is so simple, thinking about the binomial distribution is a good warm up for learning about the characteristics of probability distributions. One of the most important characteristics is the <strong>expected value</strong> of the distribution. This is the value that most likely to occur, or the <strong>central tendency</strong> of values. There are several kinds of expected value, but they are all related to the most common or central value. The expected value, or mean, of a binomial distribution <em>X</em> is</p>
<p><span class="math display">\[E\left(X\right)=\mu=np\]</span></p>
<p>This is the answer to the question earlier about how many heads to expect if a fair coin is flipped 10 times:</p>
<p><span class="math display">\[E(heads)=n(flips)p(heads)\]</span></p>
<p>If a variable comes from a binomial process, we can make other inferences about it. For example, we can estimate its variance as:</p>
<p><span class="math display">\[Var\left(X\right)=\sigma^2=np(1-p)=npq\]</span></p>
<p>We can also estimate the probability of any number of successes <em>k</em> as:</p>
<p><span class="math display">\[P\left(k\right)=\left(\begin{matrix}n\\k\\\end{matrix}\right)p^k\left(1-p\right)^{n-k}\]</span></p>
<p>The first term (<em>n</em> over <em>k</em>) is known as the <strong>binomial coefficient</strong> and is calculated as:</p>
<p><span class="math display">\[\left(\begin{matrix}n\\k\\\end{matrix}\right)=\frac{n!}{k!\left(n-k\right)!}\]</span></p>
<p>This term represents the number of ways of seeing <em>k</em> successes in <em>n</em> trials. For example, a set of 4 trials could have 2 successes in 6 ways: HHTT, HTHT, THHT, HTTH, THTH, and TTHH.</p>
<p>When <em>n</em> is small, the binomial distribution can be quite skewed (i.e., asymmetric) because the distribution has a hard lower bound of 0. Note that the expression for <span class="math inline">\(P(k)\)</span> is what is calculated by function <code>dbinom()</code> below, and related to what is calculated by function <code>pbinom()</code>. For large <em>n</em>, the binomial distribution can be approximated by a normal distribution (see below) with mean = <em>np</em> and variance = <em>npq</em>.</p>
<div id="binomial-distribution-in-r" class="section level4 hasAnchor" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Binomial distribution in R<a href="mod-05.html#binomial-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>R uses a family of 4 functions to work with each probability distribution. The binomial and Bernoulli distributions are accessed using the <code>_binom</code> group of functions: <code>dbinom()</code>, <code>pbinom()</code>, <code>qbinom()</code>, and <code>rbinom()</code>. Each function calculates or returns something different about the binomial distribution:</p>
<ul>
<li><code>dbinom()</code>: Calculates probability mass function at <em>x</em> for binomial distribution given <em>n</em> and <em>p</em>. Answers the question “What is the probability of <em>x</em> successes in <em>n</em> trials with probability <em>p</em>?”</li>
<li><code>pbinom()</code>: Calculates integral of the probability mass function for a binomial distribution given <em>n</em> and <em>p</em>, from 0 up to <em>x</em>. In other words, given some binomial distribution, at what quantile of that distribution should some value fall? The reverse of <code>qbinom()</code>. Answers the question “What is the probably of at least <em>x</em> successes in <em>n</em> trials with probability <em>p</em>?”</li>
<li><code>qbinom()</code>: Calculates the value at specified quantile of a binomial distribution. Essentially the reverse of <code>pbinom()</code>.</li>
<li><code>rbinom()</code>: Draws random numbers from the binomial distribution defined by <em>n</em> and <em>p</em> (or from the Bernoulli distribution if <em>n</em> = 1).</li>
</ul>
<p>Let’s explore the binomial distribution using these functions. In the plots produced in the two examples, notice how the variance of each distribution (x1, x2, etc.) depends on both n and p. The variance in these plots is shown by the width of the distribution.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="mod-05.html#cb652-1" tabindex="-1"></a><span class="co"># N = 100, P various</span></span>
<span id="cb652-2"><a href="mod-05.html#cb652-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb652-3"><a href="mod-05.html#cb652-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb652-4"><a href="mod-05.html#cb652-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.2</span>)</span>
<span id="cb652-5"><a href="mod-05.html#cb652-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.4</span>)</span>
<span id="cb652-6"><a href="mod-05.html#cb652-6" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.6</span>)</span>
<span id="cb652-7"><a href="mod-05.html#cb652-7" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(X, N, <span class="fl">0.8</span>)</span>
<span id="cb652-8"><a href="mod-05.html#cb652-8" tabindex="-1"></a></span>
<span id="cb652-9"><a href="mod-05.html#cb652-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb652-10"><a href="mod-05.html#cb652-10" tabindex="-1"></a><span class="fu">plot</span>(X, x1, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span>
<span id="cb652-11"><a href="mod-05.html#cb652-11" tabindex="-1"></a><span class="fu">points</span>(X, x2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb652-12"><a href="mod-05.html#cb652-12" tabindex="-1"></a><span class="fu">points</span>(X, x3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb652-13"><a href="mod-05.html#cb652-13" tabindex="-1"></a><span class="fu">points</span>(X, x4, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-380-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is a plot showing the effect of varying <em>n</em>.</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="mod-05.html#cb653-1" tabindex="-1"></a><span class="co"># P = 0.5, N various</span></span>
<span id="cb653-2"><a href="mod-05.html#cb653-2" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb653-3"><a href="mod-05.html#cb653-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">20</span>, P)</span>
<span id="cb653-4"><a href="mod-05.html#cb653-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">40</span>, P)</span>
<span id="cb653-5"><a href="mod-05.html#cb653-5" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">60</span>, P)</span>
<span id="cb653-6"><a href="mod-05.html#cb653-6" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">80</span>, P)</span>
<span id="cb653-7"><a href="mod-05.html#cb653-7" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">100</span>, P)</span>
<span id="cb653-8"><a href="mod-05.html#cb653-8" tabindex="-1"></a></span>
<span id="cb653-9"><a href="mod-05.html#cb653-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x1, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span>
<span id="cb653-10"><a href="mod-05.html#cb653-10" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb653-11"><a href="mod-05.html#cb653-11" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb653-12"><a href="mod-05.html#cb653-12" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x4, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb653-13"><a href="mod-05.html#cb653-13" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, x5, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;purple&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx400-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In these plots, the height of the points is called the <strong>probability mass function (PMF)</strong>. For discrete distributions like the binomial, the PMF of any value is the probability that the distribution takes on that value. The sum of the PMF for all integers from 0 to <em>n</em> (inclusive) must be equal to 1. You can verify this by calculating the sum of any of the vectors of densities above.</p>
<p>The function <code>pbinom()</code> sums the PMF from 0 up to and including some value. In other words, it calculates the <strong>cumulative distribution function (CDF)</strong>. This answers the question “where in the distribution is value <em>x</em>?”; put another way, “at what quantile of the distribution does value <em>x</em> lie?”. Yet another way to ask this is, “What is the probability of at least <em>X</em> successes?”.</p>
<p>Consider a binomial distribution with <em>n</em> = 10 and <em>p</em> = 0.5. What is the probability that the distribution takes a value <span class="math inline">\(\le\)</span> 7? We can calculate this as the sum of the PMF for 0 through 7.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="mod-05.html#cb654-1" tabindex="-1"></a><span class="co"># plot the distribution to see it</span></span>
<span id="cb654-2"><a href="mod-05.html#cb654-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb654-3"><a href="mod-05.html#cb654-3" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb654-4"><a href="mod-05.html#cb654-4" tabindex="-1"></a>xd <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, N, P)</span>
<span id="cb654-5"><a href="mod-05.html#cb654-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, xd, <span class="at">type=</span><span class="st">&quot;h&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-381-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="mod-05.html#cb655-1" tabindex="-1"></a><span class="co"># calculate p(x&lt;=7)</span></span>
<span id="cb655-2"><a href="mod-05.html#cb655-2" tabindex="-1"></a><span class="fu">sum</span>(xd[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]) <span class="co"># indices 1:8 correspond to values 0:7</span></span></code></pre></div>
<pre><code>## [1] 0.9453125</code></pre>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="mod-05.html#cb657-1" tabindex="-1"></a><span class="co"># same value:</span></span>
<span id="cb657-2"><a href="mod-05.html#cb657-2" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">7</span>, N, P)</span></code></pre></div>
<pre><code>## [1] 0.9453125</code></pre>
<p>Or, we could want to know the probability that the distribution takes on a value &gt; 6. This would be the complement of the sum up to and including 6.</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="mod-05.html#cb659-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(xd[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])</span></code></pre></div>
<pre><code>## [1] 0.171875</code></pre>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="mod-05.html#cb661-1" tabindex="-1"></a><span class="co"># same value:</span></span>
<span id="cb661-2"><a href="mod-05.html#cb661-2" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">6</span>,N,P)</span></code></pre></div>
<pre><code>## [1] 0.171875</code></pre>
<p>If the last two calculations seem familiar, that’s because this is exactly how <em>P</em> values for statistical tests are calculated (e.g., using <code>pf()</code> to get the probability from an <em>F</em> distribution for an ANOVA).</p>
<p>The function <code>qbinom()</code> is basically the reverse of function <code>pbinom()</code>. Rather than calculate the quantile at which a value falls in the distribution, <code>qbinom()</code> calculates the value at which a quantile falls. For example, what value do we expect to find at the 60th percentile of a distribution? Put another way, how many successes should 60% of experiments have, on average? The example below shows how <code>qbinom()</code> and <code>pbinom()</code> are reversible.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="mod-05.html#cb663-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb663-2"><a href="mod-05.html#cb663-2" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb663-3"><a href="mod-05.html#cb663-3" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">6</span>, N, P)</span></code></pre></div>
<pre><code>## [1] 0.828125</code></pre>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="mod-05.html#cb665-1" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.828125</span>, N, P)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>Finally, <code>rbinom()</code> draws random values from the binomial or Bernoulli distributions. The syntax of this function can be a little confusing. The first argument, <code>n</code>, is the <em>number of random draws</em> that you want. The second argument, <code>size</code>, is the <em>number of values in each draw</em>; that is, the parameter <em>n</em> of the binomial distribution. Compare these results, all with <em>p</em> = 0.5:</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="mod-05.html#cb667-1" tabindex="-1"></a><span class="co"># 1 draw of 1 trial</span></span>
<span id="cb667-2"><a href="mod-05.html#cb667-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="mod-05.html#cb669-1" tabindex="-1"></a><span class="co"># 1 draw of 10 trials</span></span>
<span id="cb669-2"><a href="mod-05.html#cb669-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="mod-05.html#cb671-1" tabindex="-1"></a><span class="co"># 10 draws of 1 trial per draw </span></span>
<span id="cb671-2"><a href="mod-05.html#cb671-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 0 0 1 0 1 1 1 0 1 0</code></pre>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="mod-05.html#cb673-1" tabindex="-1"></a><span class="co"># 10 draws of 10 trials per draw</span></span>
<span id="cb673-2"><a href="mod-05.html#cb673-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 3 5 5 7 3 5 5 5 4 3</code></pre>
<p>Result 1 shows a Bernoulli distribution with <em>n</em> = 1. Result 2 shows a single value from a binomial distribution with <em>n</em> = 10. Result 3 shows 10 results from Bernoulli distributions. Notice that if you add up the values in result 3, you get a result like Result 2. Finally, Result 4 shows 10 draws from a binomial distribution, which itself has <em>n</em> = 10. The take home message is that the first argument to <code>rbinom()</code> is not a parameter of the binomial distribution. It is instead the number of draws from the distribution that you want. The <code>size</code> parameter is the argument that helps define the distribution.<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a></p>
</div>
</div>
<div id="poisson-distribution" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Poisson distribution<a href="mod-05.html#poisson-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>Poisson distribution</strong> is widely used in biology to model <strong>count data</strong>. If your data result from some sort of count or abundance per time interval, spatial extent, or unit of effort, then the Poisson distribution should be one of the first things to try in the analysis. The Poisson distribution has one parameter, <span class="math inline">\(\lambda\)</span> (“lambda”), which represents the <strong>expected number</strong> of objects counted in a sample (objects being trees, fish, cells, mutations, kangaroos, etc.). This parameter is also the <strong>variance</strong> of the distribution.</p>
<p>The expected value and the variance of the Poisson distribution are both <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[E\left(X\right)=Var\left(X\right)=\lambda\]</span></p>
<p>Like the binomial distribution, the Poisson distribution is discrete, meaning that it can only take on integer values. Unlike the binomial distribution, which is bounded by 0 and n, the Poisson distribution is bounded by 0 and <span class="math inline">\(+\infty\)</span>. However, values <span class="math inline">\(\gg \lambda\)</span> are highly improbable. If there is a well-defined upper bound for your count, then you might consider them to come from a <a href="mod-10.html#mod-10-binom">binomial model</a> instead of a <a href="mod-10.html#mod-10-poisson">Poisson model</a>. For example, if you are counting the number of fish in a toxicity trial that survive, the greatest possible count is the number of fish in the trial. On the other hand, if your counts have no <em>a priori</em> upper bound, then use the Poisson.</p>
<div id="poisson-distribution-in-r" class="section level4 hasAnchor" number="5.2.3.1">
<h4><span class="header-section-number">5.2.3.1</span> Poisson distribution in R<a href="mod-05.html#poisson-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Poisson distribution is accessed using the <code>_pois</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dpois()</code>: Calculates <strong>probability mass function (PMF)</strong> at <em>x</em> for Poisson distribution given <span class="math inline">\(\lambda\)</span>. Answers the question, “what is the probability of observing a count of <em>x</em> given <span class="math inline">\(\lambda\)</span>?”</li>
<li><code>ppois()</code>: Calculates CDF, or integral of PMF, from 0 up to <em>x</em> given <span class="math inline">\(\lambda\)</span>. In other words, given some Poisson distribution, at what quantile of that distribution should some value fall? The reverse of <code>qpois()</code>.</li>
<li><code>qpois()</code>: Calculates the value at specified quantile of a Poisson distribution. The reverse of <code>ppois()</code>.</li>
<li><code>rpois()</code>: Draws random numbers from the Poisson distribution defined by <span class="math inline">\(\lambda\)</span>.</li>
</ul>
<p>Something important to keep in mind about the Poisson distribution is that it only makes sense for discrete counts, not for continuous measurements that are rounded. For example, if you are measuring leaf lengths and round every length to the nearest mm, it might be tempting to use a Poisson distribution to analyze the data because all of the values are integers. But that would be incorrect, because leaf lengths could theoretically take on any positive value. Furthermore, treating rounded continuous values as discrete leads to the awkward issue that changing measurement units can change dimensionless statistics.</p>
<p>For example, the <strong>coefficient of variation (CV)</strong> is the ratio of a distribution’s SD to its mean. Thus, it is unitless and should be independent of units. The CV of a Poisson distribution <em>X</em> is:</p>
<p><span class="math display">\[CV\left(X\right)=\frac{\sqrt\lambda}{\lambda}\]</span></p>
<p>So, if you measured 20 leaves and found a mean length of 17 cm, the CV would thus be <span class="math inline">\(\approx\)</span> 0.242 or 24%. But if you convert the measurements to mm, the CV would be about 0.077, or 7.7%! (In fact, if you change <span class="math inline">\(\lambda\)</span> by some factor <em>a</em>, then the CV will be scaled by <span class="math inline">\(\sqrt a/a\)</span>).</p>
<p>The figure below shows the effect of varying <span class="math inline">\(\lambda\)</span> on a Poisson distribution.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="mod-05.html#cb675-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">40</span></span>
<span id="cb675-2"><a href="mod-05.html#cb675-2" tabindex="-1"></a>lams <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb675-3"><a href="mod-05.html#cb675-3" tabindex="-1"></a>nlams <span class="ot">&lt;-</span> <span class="fu">length</span>(lams)</span>
<span id="cb675-4"><a href="mod-05.html#cb675-4" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nlams)</span>
<span id="cb675-5"><a href="mod-05.html#cb675-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nlams){dlist[[i]] <span class="ot">&lt;-</span> <span class="fu">dpois</span>(x, lams[i])}</span>
<span id="cb675-6"><a href="mod-05.html#cb675-6" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(nlams)</span>
<span id="cb675-7"><a href="mod-05.html#cb675-7" tabindex="-1"></a></span>
<span id="cb675-8"><a href="mod-05.html#cb675-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb675-9"><a href="mod-05.html#cb675-9" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>,</span>
<span id="cb675-10"><a href="mod-05.html#cb675-10" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb675-11"><a href="mod-05.html#cb675-11" tabindex="-1"></a><span class="fu">plot</span>(x, dlist[[<span class="dv">1</span>]], <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">sapply</span>(dlist, max))),</span>
<span id="cb675-12"><a href="mod-05.html#cb675-12" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Value (x)&quot;</span>)</span>
<span id="cb675-13"><a href="mod-05.html#cb675-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nlams){</span>
<span id="cb675-14"><a href="mod-05.html#cb675-14" tabindex="-1"></a>    <span class="fu">points</span>(x, dlist[[i]], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>,</span>
<span id="cb675-15"><a href="mod-05.html#cb675-15" tabindex="-1"></a>        <span class="at">col=</span>cols[i])</span>
<span id="cb675-16"><a href="mod-05.html#cb675-16" tabindex="-1"></a>}</span>
<span id="cb675-17"><a href="mod-05.html#cb675-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span>lams,</span>
<span id="cb675-18"><a href="mod-05.html#cb675-18" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">pt.cex=</span><span class="fl">1.3</span>, <span class="at">col=</span>cols, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>,</span>
<span id="cb675-19"><a href="mod-05.html#cb675-19" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">expression</span>(lambda))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-385-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mod-05-negbin" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Negative binomial distribution<a href="mod-05.html#mod-05-negbin" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>negative binomial distribution</strong> has two common definitions. The original defintion is as the number of failures that occur in a series of Bernoulli trials until some predetermined number of successes is observed. For example, when flipping a fair coin, how many times should you expect to see tails before you observe 8 heads? This definition is, therefore, a discrete version of the <a href="mod-05.html#mod-05-gamma">gamma distribution</a>. This original definition of the negative binomial distribution is what names the negative binomial.</p>
<p>The second definition is as an alternative to the Poisson distribution when variance is not equal–and usually much greater than–the mean. Biologists tus often use the negative binomial as an <strong>overdispersed</strong> alternative to the Poisson distribution. Overdispersed means that a distribution has a variance greater than expected given other parameters. This is <em>very common</em> in biological count data. For example, a bird species might have low abundance (0 to 4) at most sites in a study, but very high abundance (30 to 40) at a handful of sites. In that case using the Poisson distribution would not be appropriate because doing so would imply that the variance <span class="math inline">\(\lambda\)</span> was greater than the mean (also <span class="math inline">\(\lambda\)</span>); in other words, that <span class="math inline">\(\lambda &gt; \lambda\)</span>.</p>
<p>The version of the negative binomial that biologists use is parameterized by its mean <span class="math inline">\(\mu\)</span> and its overdispersion <em>k</em>. This definition views the negative binomial as a Poisson distribution with parameter <span class="math inline">\(\lambda\)</span>, where <span class="math inline">\(\lambda\)</span> itself is a random variable that follows a Gamma distribution (see below). For this reason, some authors refer to the negative binomial as a <strong>Gamma-Poisson mixture distribution</strong>. A mixture distribution is exactly what it sounds like: a distribution that is formed by “mixing” or combining two distributions. Usually this manifests as having one or more parameters of one distribution vary as another distribution.</p>
<p>The overdispersion parameter <em>k</em> is called <strong>size</strong> in the R functions that work with the negative binomial. Counterintuitively, the overdispersion in a negative binomial distribution gets larger as <em>k</em> becomes smaller. This is seen in the expression for the variance of a negative binomial distribution:</p>
<p><span class="math display">\[Var\left(X\right)=\mu+\frac{\mu^2}{k}\]</span></p>
<p>As <em>k</em> becomes large, the ratio <span class="math inline">\(\mu^2/k\)</span> becomes small, and thus <span class="math inline">\(Var(x)\)</span> approaches <span class="math inline">\(\mu\)</span>. This means that a negative binomial distribution with large <em>k</em> approximates a Poisson distribution. As <em>k</em> approaches 0, the ratio <span class="math inline">\(\mu^2/k\)</span> becomes larger, and thus <span class="math inline">\(Var(x)\)</span> increases to be much larger than <span class="math inline">\(\mu\)</span>.</p>
<div id="negative-binomial-distribution-in-r" class="section level5 hasAnchor" number="5.2.4.0.1">
<h5><span class="header-section-number">5.2.4.0.1</span> Negative binomial distribution in R<a href="mod-05.html#negative-binomial-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The negative binomial distribution is accessed using the <code>_nbinom</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dnbinom()</code>: Calculates PMF at <em>x</em>. Answers the question, “what is the probability of observing a count of <em>x</em>?”</li>
<li><code>pnbinom()</code>: Calculates CDF, or integral of PMF, from 0 up to <em>x</em>. In other words, given some negative binomial distribution, at what quantile of that distribution should some value fall? The reverse of <code>qnbinom()</code>.</li>
<li><code>qnbinom()</code>: Calculates the value at specified quantile of a Poisson distribution. The reverse of <code>pnbinom()</code>.</li>
<li><code>rnbinom()</code>: Draws random numbers from the negative binomial distribution.</li>
</ul>
<p>The R functions for the negative binomial distribution can work with either parameterization (waiting time or mean with overdispersion). Some of the argument names are used for both methods. If you are working with the negative binomial distribution in R you <em>need to name your arguments to make sure you get the version of the negative binomial that you want</em>.</p>
<p>The figure below shows the effect of different overdispersion parameters. Notice that as <em>k</em> increases, the distribution looks more and more like a Poisson distribution with <span class="math inline">\(\lambda = 10\)</span>. As <em>k</em> gets smaller, the distribution gets more and more concentrated near 0, and more and more right-skewed.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="mod-05.html#cb676-1" tabindex="-1"></a>xp <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb676-2"><a href="mod-05.html#cb676-2" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(xp, <span class="dv">10</span>)</span>
<span id="cb676-3"><a href="mod-05.html#cb676-3" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="fl">0.2</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb676-4"><a href="mod-05.html#cb676-4" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb676-5"><a href="mod-05.html#cb676-5" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">1</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb676-6"><a href="mod-05.html#cb676-6" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">10</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb676-7"><a href="mod-05.html#cb676-7" tabindex="-1"></a>y6 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">50</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb676-8"><a href="mod-05.html#cb676-8" tabindex="-1"></a>y7 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xp, <span class="at">size=</span><span class="dv">100</span>, <span class="at">mu=</span><span class="dv">10</span>)</span>
<span id="cb676-9"><a href="mod-05.html#cb676-9" tabindex="-1"></a></span>
<span id="cb676-10"><a href="mod-05.html#cb676-10" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">6</span>)</span>
<span id="cb676-11"><a href="mod-05.html#cb676-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb676-12"><a href="mod-05.html#cb676-12" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>,</span>
<span id="cb676-13"><a href="mod-05.html#cb676-13" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="fl">1.3</span>, <span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb676-14"><a href="mod-05.html#cb676-14" tabindex="-1"></a><span class="fu">plot</span>(xp, y1, <span class="at">pch=</span><span class="dv">17</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>)</span>
<span id="cb676-15"><a href="mod-05.html#cb676-15" tabindex="-1"></a><span class="fu">points</span>(xp, y2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">1</span>])</span>
<span id="cb676-16"><a href="mod-05.html#cb676-16" tabindex="-1"></a><span class="fu">points</span>(xp, y3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">2</span>])</span>
<span id="cb676-17"><a href="mod-05.html#cb676-17" tabindex="-1"></a><span class="fu">points</span>(xp, y4, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">3</span>])</span>
<span id="cb676-18"><a href="mod-05.html#cb676-18" tabindex="-1"></a><span class="fu">points</span>(xp, y5, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">4</span>])</span>
<span id="cb676-19"><a href="mod-05.html#cb676-19" tabindex="-1"></a><span class="fu">points</span>(xp, y6, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">5</span>])</span>
<span id="cb676-20"><a href="mod-05.html#cb676-20" tabindex="-1"></a><span class="fu">points</span>(xp, y7, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">6</span>])</span>
<span id="cb676-21"><a href="mod-05.html#cb676-21" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb676-22"><a href="mod-05.html#cb676-22" tabindex="-1"></a><span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Poisson&quot;</span>, <span class="st">&quot;k=0.2&quot;</span>, <span class="st">&quot;k=0.5&quot;</span>, <span class="st">&quot;k=1&quot;</span>, <span class="st">&quot;k=10&quot;</span>, </span>
<span id="cb676-23"><a href="mod-05.html#cb676-23" tabindex="-1"></a><span class="st">&quot;k=50&quot;</span>, <span class="st">&quot;k=100&quot;</span>),</span>
<span id="cb676-24"><a href="mod-05.html#cb676-24" tabindex="-1"></a>     <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">17</span>, <span class="fu">rep</span>(<span class="dv">16</span>,<span class="dv">6</span>)), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, cols))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-386-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mod-05-geom" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Geometric distribution<a href="mod-05.html#mod-05-geom" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>geometric distribution</strong> describes the number of Bernoulli trials that are seen before observing a single failure. It is thus related to the <a href="mod-05.html#mod-05-binom">binomial</a> and <a href="mod-05.html#mod-05-negbin">negative binomial</a>. In fact, the geometric distribution is a special case of the negative binomial, with the number of successes = 1. The geometric distribution is the discrete version of the <a href="mod-05.html#mod-05-expo">exponential distribution</a>.</p>
<p>The geometric distribution arises in biology when modeling waiting times or life spans. For example, the number of years that an individual organism lives, if it has a constant probability of surviving each year. Or, the number of generations until a mutation in a cell line occurs, if mutations occur at a constant rate per generation.</p>
<p>Imagine a fish that has a 5% chance of dying each year; i.e., a 95% annual survival rate. How long should we expect this fish to live, on average?</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="mod-05.html#cb677-1" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb677-2"><a href="mod-05.html#cb677-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb677-3"><a href="mod-05.html#cb677-3" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">dgeom</span>(X, P)</span>
<span id="cb677-4"><a href="mod-05.html#cb677-4" tabindex="-1"></a><span class="fu">plot</span>(X,Y)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-387-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The figure shows that the probability of living to any given age falls off quickly at first, then more gradually as time goes on. What is the mean life expectancy?</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="mod-05.html#cb678-1" tabindex="-1"></a><span class="fu">qgeom</span>(<span class="fl">0.5</span>, P)</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<p>What range of life expectancies can we expect for 95% of the population?</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="mod-05.html#cb680-1" tabindex="-1"></a><span class="fu">qgeom</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), P)</span></code></pre></div>
<pre><code>## [1]  0 71</code></pre>
<p>That’s quite a wide range! What is the probability that a fish lives to be at least 30 years old? 40 years old?</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="mod-05.html#cb682-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pgeom</span>(<span class="dv">30</span>, P)</span></code></pre></div>
<pre><code>## [1] 0.2039068</code></pre>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="mod-05.html#cb684-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pgeom</span>(<span class="dv">40</span>, P)</span></code></pre></div>
<pre><code>## [1] 0.1220865</code></pre>
</div>
<div id="beta-binomial-distribution" class="section level3 hasAnchor" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> Beta-binomial distribution<a href="mod-05.html#beta-binomial-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>beta-binomial distribution</strong> is a mixture that allows for modeling binomial processes with more variation than would be expected from a garden variety binomial distribution. The beta-binomial is a binomial distribution, but with the probability parameter <em>p</em> itself varying randomly according to a beta distribution (see below). This is similar to how a negative binomial distribution can be defined as a Poisson distribution mixed with a gamma distribution (with the Poisson <span class="math inline">\(\lambda\)</span> varying as a gamma variable).</p>
<p>A beta-binomial distribution <em>X</em> is given by:</p>
<p><span class="math display">\[X \sim Bin\left(n,\ p\right)\]</span></p>
<p><span class="math display">\[p \sim Beta\left(\alpha,\beta\right)\]</span></p>
<p>The parameters of the beta distribution are positive shape parameters (see below). The parameters of the beta part of the beta-binomial distribution can make the binomial part overdispersed relative to an ordinary binomial distribution.</p>
</div>
<div id="multinomial-distribution" class="section level3 hasAnchor" number="5.2.7">
<h3><span class="header-section-number">5.2.7</span> Multinomial distribution<a href="mod-05.html#multinomial-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>multinomial distribution</strong> is a generalization of the binomial distribution to cases with more than 2 possible outcomes. For example, rolling a 6-sided die many times would yield a distribution of outcomes (1, 2, 3, 4, 5, or 6) described by the multinomial distribution. The multinomial distribution is parameterized by the number of possible outcomes <em>k</em>, the number of trials <em>n</em>, and the probabilities of each outcome <span class="math inline">\(p_1, \ldots, p_k\)</span>. The probabilities must sum to 1.</p>
<p>There are some special cases of the multinomial distribution:</p>
<ul>
<li>When <em>k</em> = 2 and <em>n</em> = 1, the multinomial distribution reduces to the Bernoulli distribution</li>
<li>When <em>k</em> = 2 and <em>n</em> &gt; 1, the multinomial distribution reduces to the binomial distribution</li>
<li>When <em>k</em> &gt; 2 and <em>n</em> = 1, the multinomial distribution is the categorical distribution.</li>
</ul>
<p>The example below shows how to work with the multinomial distribution in R.</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="mod-05.html#cb686-1" tabindex="-1"></a><span class="co"># define 2 different sets of probabilities for</span></span>
<span id="cb686-2"><a href="mod-05.html#cb686-2" tabindex="-1"></a><span class="co"># 5 different outcomes</span></span>
<span id="cb686-3"><a href="mod-05.html#cb686-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>)</span>
<span id="cb686-4"><a href="mod-05.html#cb686-4" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)</span>
<span id="cb686-5"><a href="mod-05.html#cb686-5" tabindex="-1"></a></span>
<span id="cb686-6"><a href="mod-05.html#cb686-6" tabindex="-1"></a><span class="co"># sample from the multinomial distribution</span></span>
<span id="cb686-7"><a href="mod-05.html#cb686-7" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb686-8"><a href="mod-05.html#cb686-8" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(N, N, <span class="at">prob=</span>p1)</span>
<span id="cb686-9"><a href="mod-05.html#cb686-9" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(N, N, <span class="at">prob=</span>p2)</span>
<span id="cb686-10"><a href="mod-05.html#cb686-10" tabindex="-1"></a></span>
<span id="cb686-11"><a href="mod-05.html#cb686-11" tabindex="-1"></a><span class="co"># summarize by outcome</span></span>
<span id="cb686-12"><a href="mod-05.html#cb686-12" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(r1, <span class="dv">1</span>, mean)</span>
<span id="cb686-13"><a href="mod-05.html#cb686-13" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(r2, <span class="dv">1</span>, mean)</span>
<span id="cb686-14"><a href="mod-05.html#cb686-14" tabindex="-1"></a></span>
<span id="cb686-15"><a href="mod-05.html#cb686-15" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb686-16"><a href="mod-05.html#cb686-16" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, y1, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, </span>
<span id="cb686-17"><a href="mod-05.html#cb686-17" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>))</span>
<span id="cb686-18"><a href="mod-05.html#cb686-18" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, y2, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-390-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mod-05-condists" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Continuous distributions<a href="mod-05.html#mod-05-condists" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <strong>continuous distribution</strong> can take an infinite number of values–any value within their domain. These values can come from an interval on the real number line, or the entire real number line. Contrast this to a discrete distribution, which can only take on integer values. Computing the probability of any possible outcome of a discrete distribution is relative straightforward because there are a limited number of outcomes. For example, a binomial distribution with <em>n</em> = 10 and <em>p</em> = 0.5 has only 11 possible outcomes (0, 1, 2, …, 9, or 10). The probabilities <span class="math inline">\(p(0)\)</span>, <span class="math inline">\(p(1)\)</span>, …, <span class="math inline">\(p(10)\)</span> must all sum to 1. The probability mass function (PMF) of the binomial distribution at any value is the probability of that value occurring.</p>
<p>This leads to an interesting question. How could we calculate the probability of any given outcome of a distribution with an infinite number of outcomes? If the probabilities of each individual value must all sum to 1, and there are infinitely many possible values, then doesn’t the probability of each value approach (or just be) 0? If the probability of every outcome is 0, how can the distribution take on any value?</p>
<p>To resolve this apparent contradiction, we have to take a step back and think about what distributions really mean. The first step is to realize that even if any single value has probability 0, an <em>interval</em> of values can have a non-zero probability. After all, the entire domain of a distribution has probability 1 (by definition). We can define some interval in the domain that covers half of the total probability, or one-quarter, or any arbitrary fraction. This means that for any value <em>x</em> in a distribution <em>X</em> (note lower case vs. upper case) we can calculate the probability of observing a value <span class="math inline">\(\le x\)</span>. The figure below shows this:</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-391-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The <em>y</em>-axis in the figure, <span class="math inline">\(P\left(X \le x\right)\)</span>, is called the <strong>cumulative distribution function (CDF)</strong>. This name derives from the fact that the CDF of some value <em>x</em> gives the cumulative probability of all values up to and including <em>x</em>. The CDF is sometimes labeled <span class="math inline">\(F\left(x\right)\)</span> (note the capitalized F). Another way to interpret this is that a value <em>x</em> lies at the <em>CDF(x)</em> quantile of a distribution. For example, if <em>CDF(x)</em> = 0.4, then <em>x</em> lies at the 0.4 quantile or 40th percentile of the distribution. Critically, this means that 40% of the total probability of the distribution lies at or to the left of <em>x</em>.</p>
<p>Just as with discrete distributions, the relative probability of any given value in a continuous distribution is given by the rate at which the CDF changes at that value. For discrete distributions this relative probability also happens to be the absolute probability (because <em>dx</em> = 1 in the expression below). For continuous distributions, this probability is relative. The relative probability of a value in a continuous distribution is given by the <strong>probability density function (PDF)</strong>. The PDF, <span class="math inline">\(f\left(x\right)\)</span>, is the derivative of the CDF:</p>
<p><span class="math display">\[f\left(x\right)=\frac{dF(x)}{dx}\]</span></p>
<p>This also means that the CDF is the integral of the PDF, according to the fundamental theorem of calculus:</p>
<p><span class="math display">\[F\left(x\right)=\int_{-\infty}^{x}{f\left(x\right)\ dx}\]</span></p>
<p>This might be easier to see with an example. The plots below show the PDF and CDF of a standard normal distribution (see below). Because the normal is unbounded, its PDF and CDF have the domain [<span class="math inline">\(-\infty\)</span>, <span class="math inline">\(+\infty\)</span>], but we usually truncate the plot to a range that covers most of the CDF.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-392-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>On the left, notice that the PDF peaks near <em>x</em> = 0 and tapers off quickly to either side. On the right, the slope of the CDF is greatest at <em>x</em> = 0. The value of the PDF at <em>x</em> = 0, about 0.4, is neither the probability of observing <em>x</em> = 0 nor the probability of observing <em>x</em> <span class="math inline">\(\le\)</span> 0, which is 0.5. The value <span class="math inline">\(f(0) = 0.4\)</span> is the rate of change in <span class="math inline">\(F(X)\)</span> at <em>x</em> = 0.</p>
<div id="uniform-distribution" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Uniform distribution<a href="mod-05.html#uniform-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The simplest continuous distribution is the <strong>uniform distribution</strong>. The uniform distribution is parameterized by its upper and lower bounds, usually called <em>a</em> and <em>b</em>, respectively. All values of a uniform distribution in the interval [<em>a</em>, <em>b</em>] are equally likely, and all values outside [<em>a</em>, <em>b</em>] have probability 0. The figure below shows the PDF of 3 different uniform distributions.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-393-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Notice how each distribution has a flat PDF, but that the value of the PDF decreases as the width of the uniform distribution increases. Given what you learned above about the relationship between the CDF and the PDF, can you work out why this is?</p>
<p>Like the normal distribution, there is a standard uniform distribution that is frequently used. The <strong>standard uniform</strong> is defined as <em>Uniform(0, 1)</em>: a uniform distribution in the interval [0, 1]. The uniform distribution can sometimes be abbreviated as <em>U(a,b)</em> or <em>Unif(a,b)</em> instead of <em>Uniform(a,b)</em>.</p>
<p>The mean of a uniform distribution is just the mean of its limits:</p>
<p><span class="math display">\[\mu\left(X\right)=\frac{a+b}{2}\]</span></p>
<p>The variance of a uniform distribution is:</p>
<p><span class="math display">\[\sigma^2\left(X\right)=\frac{{(b-a)}^2}{12}\]</span></p>
<div id="uniform-distribution-in-r" class="section level4 hasAnchor" number="5.3.1.1">
<h4><span class="header-section-number">5.3.1.1</span> Uniform distribution in R<a href="mod-05.html#uniform-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The uniform distribution is accessed using the <code>_unif</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dunif()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>punif()</code>: Calculates CDF, from <em>a</em> up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qunif()</code>.</li>
<li><code>qunif()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>punif()</code>.</li>
<li><code>runif()</code>: Draws random numbers from the uniform distribution.</li>
</ul>
<p>The help files for many R functions include a call to <code>runif()</code> to generate example values from the uniform distribution. This can be confusing to new users, who might interpret “runif” as “run if” (i.e., some sort of conditional statement).</p>
<p>One extremely useful application is the generation of values from the standard uniform distribution:</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="mod-05.html#cb687-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span></code></pre></div>
<p>The line above generates 20 numbers from the interval [0, 1]. These values can be used as probabilities or values of a CDF.</p>
<p>If you want to implement a new probability distribution in R, you can use <code>runif()</code> followed by the <code>q__()</code> function that you define for your new distribution to implement a random number generator for it. The example below shows how to implement a “truncated normal” distribution:</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="mod-05.html#cb688-1" tabindex="-1"></a>rtnorm <span class="ot">&lt;-</span> <span class="cf">function</span>(N, lower, upper, mu, sigma){</span>
<span id="cb688-2"><a href="mod-05.html#cb688-2" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(lower, mu, sigma)</span>
<span id="cb688-3"><a href="mod-05.html#cb688-3" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(upper, mu, sigma)</span>
<span id="cb688-4"><a href="mod-05.html#cb688-4" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, a, b)</span>
<span id="cb688-5"><a href="mod-05.html#cb688-5" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(x, mu, sigma)</span>
<span id="cb688-6"><a href="mod-05.html#cb688-6" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb688-7"><a href="mod-05.html#cb688-7" tabindex="-1"></a>}</span>
<span id="cb688-8"><a href="mod-05.html#cb688-8" tabindex="-1"></a></span>
<span id="cb688-9"><a href="mod-05.html#cb688-9" tabindex="-1"></a>use.n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb688-10"><a href="mod-05.html#cb688-10" tabindex="-1"></a>use.mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb688-11"><a href="mod-05.html#cb688-11" tabindex="-1"></a>use.sd <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb688-12"><a href="mod-05.html#cb688-12" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(use.n, use.mu, use.sd)</span>
<span id="cb688-13"><a href="mod-05.html#cb688-13" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rtnorm</span>(use.n, <span class="dv">8</span>, <span class="dv">12</span>, use.mu, use.sd)</span>
<span id="cb688-14"><a href="mod-05.html#cb688-14" tabindex="-1"></a></span>
<span id="cb688-15"><a href="mod-05.html#cb688-15" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb688-16"><a href="mod-05.html#cb688-16" tabindex="-1"></a><span class="fu">hist</span>(x1, <span class="at">main=</span><span class="st">&quot;Normal&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb688-17"><a href="mod-05.html#cb688-17" tabindex="-1"></a><span class="fu">hist</span>(x2, <span class="at">main=</span><span class="st">&quot;Truncated normal&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-395-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mod-05-norm" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Normal distribution<a href="mod-05.html#mod-05-norm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>normal distribution</strong> is probably the most important distribution in statistics. Many natural processes result in normal distributions. Consequently, most classical statistical methods (e.g., <em>t</em>-tests, ANOVA, and linear models) assume that data come from a normal distribution. The normal distribution is also sometimes called the <strong>Gaussian</strong> distribution because of the work of mathematician Carl Friedrich Gauss, although he did not discover it. The normal distribution is also sometimes called the bell curve because of the shape of its PDF. This term should be avoided because other probability distributions also have a bell shape, and because normal distributions are not always bell-shaped. The figure below shows several normal distributions with different means (<span class="math inline">\(\mu\)</span>) and standard deviations (SD, or <span class="math inline">\(\sigma\)</span>).</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-396-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Many phenomena result in normal distributions because of the <strong>Central Limit Theorem (CLT)</strong>. The CLT states that under certain conditions the sum of many random variables will approximate a normal distribution. The main condition is that the random variables will be independent and identically distributed (often abbreviated “<em>i.i.d.</em>”). In other words, the values do not depend on each other, and they all come from the same kind of distribution. The exact distribution does not matter. The example below uses the uniform distribution. The CLT also works with the mean of the random variables instead of the sum, because mean is just the sum scaled by sample size.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="mod-05.html#cb689-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb689-2"><a href="mod-05.html#cb689-2" tabindex="-1"></a>xvec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb689-3"><a href="mod-05.html#cb689-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){xvec[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">runif</span>(<span class="dv">10</span>))}</span>
<span id="cb689-4"><a href="mod-05.html#cb689-4" tabindex="-1"></a><span class="fu">hist</span>(xvec)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-397-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>It should be noted that just because a sample size is large does not mean that it is normal. For example, the R commands below produce distributions <code>x1</code> and <code>x2</code> that are in no way normal.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="mod-05.html#cb690-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb690-2"><a href="mod-05.html#cb690-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e5</span>)</span>
<span id="cb690-3"><a href="mod-05.html#cb690-3" tabindex="-1"></a><span class="fu">hist</span>(x1)</span>
<span id="cb690-4"><a href="mod-05.html#cb690-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="fl">1e5</span>), <span class="fu">rnorm</span>(<span class="fl">1e5</span>, <span class="dv">10</span>, <span class="dv">2</span>))</span>
<span id="cb690-5"><a href="mod-05.html#cb690-5" tabindex="-1"></a><span class="fu">hist</span>(x2)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-398-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The normal distribution is parameterized by its mean (<span class="math inline">\(\mu\)</span>, or “mu”) and its variance (<span class="math inline">\(\sigma^2\)</span>, “sigma squared”). Some people prefer to use the mean and standard deviation (<span class="math inline">\(\sigma\)</span>, “sigma”). This is fine because, as the symbols imply, the SD is simply the square root of the variance. Just pay attention to the notation being used. Using <span class="math inline">\(\sigma\)</span> instead of <span class="math inline">\(\sigma^2\)</span> can be convenient because <span class="math inline">\(\sigma\)</span> is in the same units as <span class="math inline">\(\mu\)</span>.</p>
<p>The <strong>standard normal distribution</strong> has <span class="math inline">\(\mu\)</span> = 0 and <span class="math inline">\(\sigma\)</span> = 1. This is often written as <em>N(0,1)</em>. These parameters are the defaults in the R functions that work with the normal distribution.</p>
<div id="normal-distribution-in-r" class="section level4 hasAnchor" number="5.3.2.1">
<h4><span class="header-section-number">5.3.2.1</span> Normal distribution in R<a href="mod-05.html#normal-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The normal distribution is accessed using the <code>_norm</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dnorm()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pnorm()</code>: Calculates CDF, from <span class="math inline">\(-\infty\)</span> up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qnorm()</code>.</li>
<li><code>qnorm()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pnorm()</code>.</li>
<li><code>rnorm()</code>: Draws random numbers from the normal distribution.</li>
</ul>
<p>The normal distribution in R is parameterized by the mean (argument <code>mean</code>) and the SD, not the variance (argument <code>sd</code>).
The figure generated below shows the effect of increasing the SD on the shape of a distribution. Greater variance (i.e., greater SD) means that the distribution is more spread out.</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="mod-05.html#cb691-1" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb691-2"><a href="mod-05.html#cb691-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb691-3"><a href="mod-05.html#cb691-3" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, <span class="dv">2</span>)</span>
<span id="cb691-4"><a href="mod-05.html#cb691-4" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, <span class="dv">5</span>)</span>
<span id="cb691-5"><a href="mod-05.html#cb691-5" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, <span class="dv">10</span>)</span>
<span id="cb691-6"><a href="mod-05.html#cb691-6" tabindex="-1"></a></span>
<span id="cb691-7"><a href="mod-05.html#cb691-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb691-8"><a href="mod-05.html#cb691-8" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb691-9"><a href="mod-05.html#cb691-9" tabindex="-1"></a><span class="fu">points</span>(x, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb691-10"><a href="mod-05.html#cb691-10" tabindex="-1"></a><span class="fu">points</span>(x, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb691-11"><a href="mod-05.html#cb691-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">2</span>),</span>
<span id="cb691-12"><a href="mod-05.html#cb691-12" tabindex="-1"></a>        <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">5</span>), <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">10</span>)),</span>
<span id="cb691-13"><a href="mod-05.html#cb691-13" tabindex="-1"></a>        <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-399-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The normal distribution has several useful properties. Generally, the mean and median are the same (if the distribution is not skewed). Approximately 68% of values fall within 1 SD of the mean, 95% of values fall within about 2 SD of the mean (technically 1.9599 SD, or <code>qnorm(0.975)</code>), and 99% of values fall within about 3 SD of the mean. So, deviations of &gt;3 SD are very rare and may signify outliers. The number of SD a value falls away from the mean is sometimes referred to as a <strong><em>z</em>-score</strong> or a <strong>sigma</strong>. <em>Z</em>-scores are calculated as:</p>
<p><span class="math display">\[z\left(x\right)=\frac{x-\mu}{\sigma}\]</span></p>
<p>Where <em>x</em> is the value, <span class="math inline">\(\mu\)</span> is the mean, and <span class="math inline">\(\sigma\)</span> is the SD.</p>
<p><em>Z</em>-scores are sometimes used when comparing variables that are normally distributed, but on very different scales. Converting the raw values to their <em>z</em>-scores is referred to as <strong>standardizing</strong> them. Standardized values are sometimes used in regression analyses in place of raw values. Many ordination methods such as principal components analysis (PCA) standardize variables automatically. <em>Z</em>-scores (or standardized values) are calculated in R using the <code>scale()</code> function:</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="mod-05.html#cb692-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">40</span>)</span>
<span id="cb692-2"><a href="mod-05.html#cb692-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb692-3"><a href="mod-05.html#cb692-3" tabindex="-1"></a><span class="fu">hist</span>(x1)</span>
<span id="cb692-4"><a href="mod-05.html#cb692-4" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">scale</span>(x1))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx420-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="lognormal-distribution" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Lognormal distribution<a href="mod-05.html#lognormal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>lognormal distribution (a.k.a.: log-normal)</strong> is, as the name implies, a distribution that is <em>normal on a logarithmic scale</em>. By convention the <strong>natural log</strong> (log<sub><em>e</em></sub>, ln, or just log) is used although you can use log<sub>10</sub> if you pay attention to what you are doing and are explicit in your write-up<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a>. The functions in R that deal with the lognormal use the natural log<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a>.</p>
<p>The lognormal distribution arises in two ways. First, it comes about from processes where quantities are <em>multiplied together rather than added</em>. For example, growth of organisms or population sizes. This is because of the way that exponentiation relates multiplication and addition. This relationship to multiplication also means that the lognormal distribution results from a version of the CLT where values are multiplied, not added. The example below shows this.</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="mod-05.html#cb693-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb693-2"><a href="mod-05.html#cb693-2" tabindex="-1"></a>xvec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb693-3"><a href="mod-05.html#cb693-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){xvec[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">runif</span>(<span class="dv">10</span>))}</span>
<span id="cb693-4"><a href="mod-05.html#cb693-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb693-5"><a href="mod-05.html#cb693-5" tabindex="-1"></a><span class="fu">hist</span>(xvec)</span>
<span id="cb693-6"><a href="mod-05.html#cb693-6" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(xvec))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-400-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The second way that the lognormal arises is more phenomenological (i.e., descriptive). Processes that result in positive values with a long tail (mostly small values with few very large values) or positive values with a variance much larger than the mean. The latter case can also be well described by the <a href="mod-05.html#mod-05-gamma">gamma distribution</a>. The classic example of a lognormal distribution is personal income: most populations will have mostly small values, but with a small proportion of extreme outliers.</p>
<p>The lognormal distribution is parameterized by a mean (<span class="math inline">\(\mu\)</span>) and variance (<span class="math inline">\(\sigma^2\)</span>), or by a mean and standard deviation (<span class="math inline">\(\sigma\)</span>). <strong><em>These parameters are on the logarithmic scale.</em></strong> Forgetting this can cause some serious headaches, especially when trying to graph your data.</p>
<p>The figure below shows various lognormal distributions with <span class="math inline">\(\mu\)</span> = 3 and different SD on a logarithmic scale (left) and a linear scale.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-401-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The figures show the effect that variance can have on the lognormal distribution. When the variance on the log scale is &lt;<span class="math inline">\(\mu\)</span>, the distribution is approximately normal on the log scale. As the variance gets larger, the distribution gets more and more right-skewed. Right-skewed means that the values are more and more concentrated near 0, and there are fewer very large values.</p>
<p>Interestingly, the mean of a log-normal distribution is not simply <span class="math inline">\(e^\mu\)</span> as one might expect. The mean of a lognormal distribution <em>X</em> on the linear scale is</p>
<p><span class="math display">\[mean\left(X\right)=e^{\left(\frac{\mu+\sigma^2}{2}\right)}\]</span></p>
<p>In this equation, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the mean and SD on the logarithmic scale. The variance on the linear scale is:</p>
<p><span class="math display">\[Var\left(X\right)=e^{2\mu+\sigma^2}\left(e^{\sigma^2}-1\right)\]</span></p>
<p>What this means is that you cannot transform the parameters of a lognormal distribution from the logarithmic to the linear scale by simply exponentiating.</p>
<div id="logormal-distribution-in-r" class="section level4 hasAnchor" number="5.3.3.1">
<h4><span class="header-section-number">5.3.3.1</span> Logormal distribution in R<a href="mod-05.html#logormal-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The lognormal distribution is accessed using the <code>_lnorm</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dlnorm()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>plnorm()</code>: Calculates CDF, from 0 up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qlnorm()</code>.</li>
<li><code>qlnorm()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>plnorm()</code>.</li>
<li><code>rlnorm()</code>: Draws random numbers from the lognormal distribution.</li>
</ul>
<p>When working with the lognormal distribution in R it is important to keep in mind that the parameters (<code>meanlog</code> and <code>sdlog</code>) of the <code>_lnorm</code> functions are on the <em>natural log scale</em>. The <code>meanlog</code> parameter is the <em>mean of the logarithm</em> of the values, not the mean of the values or the logarithm of the mean of the values. Similarly, <code>sdlog</code> is the <code>SD of the logarithm</code> of the values, not the SD of the values or the logarithm of the SD of the values. The example below shows this:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="mod-05.html#cb694-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="fl">1e4</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb694-2"><a href="mod-05.html#cb694-2" tabindex="-1"></a></span>
<span id="cb694-3"><a href="mod-05.html#cb694-3" tabindex="-1"></a><span class="co"># mean of the values vs. mean of the log(values):</span></span>
<span id="cb694-4"><a href="mod-05.html#cb694-4" tabindex="-1"></a><span class="fu">mean</span>(x1)</span></code></pre></div>
<pre><code>## [1] 12.10312</code></pre>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="mod-05.html#cb696-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">log</span>(x1))</span></code></pre></div>
<pre><code>## [1] 2.01172</code></pre>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="mod-05.html#cb698-1" tabindex="-1"></a><span class="co"># sd of the values vs. sd of the log(values):</span></span>
<span id="cb698-2"><a href="mod-05.html#cb698-2" tabindex="-1"></a><span class="fu">sd</span>(x1)</span></code></pre></div>
<pre><code>## [1] 14.81899</code></pre>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="mod-05.html#cb700-1" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">log</span>(x1))</span></code></pre></div>
<pre><code>## [1] 0.9923424</code></pre>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="mod-05.html#cb702-1" tabindex="-1"></a><span class="co"># exp(meanlog) != mean(x1)</span></span>
<span id="cb702-2"><a href="mod-05.html#cb702-2" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 7.389056</code></pre>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="mod-05.html#cb704-1" tabindex="-1"></a><span class="fu">mean</span>(x1)</span></code></pre></div>
<pre><code>## [1] 12.10312</code></pre>
</div>
</div>
<div id="mod-05-gamma" class="section level3 hasAnchor" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Gamma distribution<a href="mod-05.html#mod-05-gamma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>gamma distribution</strong> describes waiting times until a certain number of events takes place. This means it is the continuous analogue of the <a href="mod-05.html#mod-05-negbin">negative binomial distribution</a>, which describes the number of trials until some certain number of successes. The gamma distribution can also be used to describe positive data whose SD is much larger than the mean. This makes it an alternative to the lognormal distribution for right-skewed data, much like the negative binomial is an alternative to the Poisson. Example gamma distributions are shown below.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-403-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The Gamma distribution is parameterized by its <strong>shape</strong> and <strong>scale</strong>. The shape parameter <em>k</em> describes the number of events; the scale parameter <span class="math inline">\(\theta\)</span> (“theta”) describes the mean time until each event. The scale is sometimes expressed as the <strong>rate</strong>, which is the reciprocal of scale. Both versions are implemented in R, so you need to specify your arguments when working with the gamma distribution. For example, Gamma(4, 2) is the distribution of length of time in days it would take to observe 4 events if events occur on average once every two days. Equivalently, it is the time to observe 4 events if events occur at a rate of 1/2 event per day. Consequently, the mean of a gamma distribution given shape <em>k</em> and scale <span class="math inline">\(\theta\)</span> (or rate <em>r</em>) is:</p>
<p><span class="math display">\[\mu=k\theta=\frac{k}{r}\]</span></p>
<p>The variance is calculated as:</p>
<p><span class="math display">\[\sigma^2=k\theta^2=\frac{k}{r^2}\]</span></p>
<p>Like the negative binomial, the gamma distribution is often used phenomenologically; that is, used to describe a variable even if its mechanistic description (waiting times) doesn’t make sense biologically. Just as the negative binomial can be used to model count data with variance greater than the mean (i.e., an overdispersed Poisson), a gamma distribution can be used for positive data with <span class="math inline">\(\sigma \gg \mu\)</span>. I.e., the use case for the gamma is similar to that of the lognormal.</p>
<div id="gamma-distribution-in-r" class="section level4 hasAnchor" number="5.3.4.1">
<h4><span class="header-section-number">5.3.4.1</span> Gamma distribution in R<a href="mod-05.html#gamma-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The gamma distribution is accessed using the <code>_gamma</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dgamma()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pgamma()</code>: Calculates CDF, from 0 up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qgamma()</code>.</li>
<li><code>qgamma()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pgamma()</code>.</li>
<li><code>rgamma()</code>: Draws random numbers from the gamma distribution.</li>
</ul>
<p>Note that when working with the gamma distribution in R, you must supply either the <code>shape</code> and the <code>rate</code>, or the <code>shape</code> and the <code>scale</code>. Supplying <code>scale</code> and <code>rate</code> will return an error.</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="mod-05.html#cb706-1" tabindex="-1"></a><span class="co"># will work:</span></span>
<span id="cb706-2"><a href="mod-05.html#cb706-2" tabindex="-1"></a><span class="fu">rgamma</span>(<span class="dv">10</span>, <span class="at">shape=</span><span class="dv">3</span>, <span class="at">scale=</span><span class="dv">2</span>)</span>
<span id="cb706-3"><a href="mod-05.html#cb706-3" tabindex="-1"></a><span class="fu">rgamma</span>(<span class="dv">10</span>, <span class="at">shape=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="fl">0.5</span>)</span>
<span id="cb706-4"><a href="mod-05.html#cb706-4" tabindex="-1"></a></span>
<span id="cb706-5"><a href="mod-05.html#cb706-5" tabindex="-1"></a><span class="co"># will return error:</span></span>
<span id="cb706-6"><a href="mod-05.html#cb706-6" tabindex="-1"></a><span class="fu">rgamma</span>(<span class="dv">10</span>, <span class="at">scale=</span><span class="dv">2</span>, <span class="at">rate=</span><span class="fl">0.5</span>)</span></code></pre></div>
</div>
</div>
<div id="beta-distribution" class="section level3 hasAnchor" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Beta distribution<a href="mod-05.html#beta-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>beta distribution</strong> is defined on the interval [0, 1] and is parameterized by two positive shape parameters, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. For this reason, the beta distribution is often used to model the distribution of probabilities. Besides the uniform, the beta distribution is probably the most well-known continuous distribution that is bounded by an interval. The beta distribution can also be used to model any continuous variable that occurs on a bounded interval, by rescaling the variable to the interval [0, 1]. However, this may be better accomplished with a logit transformation (see the <a href="mod-05.html#mod-05-trans">section on transformations</a>).</p>
<p>The parameters of the beta distribution are a little tricky to understand, and relate to the binomial distribution. Each shape parameter is one plus the number of successes (<span class="math inline">\(\alpha\)</span>) and failures (<span class="math inline">\(\beta\)</span>) in a binomial trial. This gets a little weird when <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are &lt;1 (how can you have &lt;0 successes or failures?) but the distribution is still defined. The shape parameters can also be non-integers. The figure below shows various beta distributions. Notice how the distribution becomes U-shaped when <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> both get close to 0.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-405-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The beta distribution has mean</p>
<p><span class="math display">\[\mu=\frac{\alpha}{\alpha+\beta}\]</span></p>
<p>and variance</p>
<p><span class="math display">\[\sigma^2=\frac{\alpha\beta}{\left(\alpha+\beta\right)^2\left(\alpha+\beta+1\right)}\]</span></p>
<p>These expressions can be re-arranged to solve for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> given a mean and variance:</p>
<p><span class="math display">\[\alpha=\left(\frac{1-\mu}{\sigma^2}-\frac{1}{\mu}\right)\mu^2\]</span></p>
<p><span class="math display">\[\beta=\alpha\left(\frac{1}{\mu}-1\right)\]</span></p>
<p>This is useful if you want to use data that were reported as a mean and variance (or SD, or SE) that describe a proportion. For example, if a paper reports a survival rate estimate as 0.25 <span class="math inline">\(\pm\)</span> 0.18 SE, this implicitly suggests that the survival rate is a normally-distributed variable because a normal distribution is defined by the mean and SD (SE of a parameter estimate is equivalent to the SD of a distribution). However, this would imply that about 8% of the time, the survival rate was negative! (Verify this using R: <code>pnorm(0, 0.25, 0.18)</code>). So, you should convert these estimates to a beta distribution if you want to understand how they might vary:</p>
<p><span class="math display">\[\alpha=\left(\frac{1-0.25}{\left(0.18\right)^2}-\frac{1}{0.25}\right){0.25}^2\approx1.1968\]</span></p>
<p><span class="math display">\[\beta=1.1968\left(\frac{1}{0.25}-1\right)\approx3.5903\]</span></p>
<p>The figure below shows the two distributions, the normal in black and the beta in blue. The dashed vertical line at 0 shows that part of the normal distribution implied by the mean and SE of a survival “probability” is not possible. Converting to a beta distribution preserves the mean and variance, but probably more accurately reflects the true nature of the uncertainty about the probability. Note that this conversion cannot be done for some combinations of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>: both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> must both be positive, so if you calculate a non-positive value for either parameter then the conversion won’t work. This can sometimes happen for probabilties very close to 0 or 1 with large SE.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-406-1.png" width="576" style="display: block; margin: auto;" /></p>
<div id="beta-distribution-in-r" class="section level4 hasAnchor" number="5.3.5.1">
<h4><span class="header-section-number">5.3.5.1</span> Beta distribution in R<a href="mod-05.html#beta-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The beta distribution is accessed using the <code>_beta</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dbeta()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pbeta()</code>: Calculates CDF, from 0 up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qbeta()</code>.</li>
<li><code>qbeta()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pbeta()</code>.</li>
<li><code>rbeta()</code>: Draws random numbers from the beta distribution.</li>
</ul>
</div>
<div id="the-beta-and-the-binomial" class="section level4 hasAnchor" number="5.3.5.2">
<h4><span class="header-section-number">5.3.5.2</span> The beta and the binomial<a href="mod-05.html#the-beta-and-the-binomial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The relationship between the beta distribution and the binomial distribution should be obvious: uncertainty about the probability parameter of a binomial distribution (<em>p</em>) can be modeled using a beta distribution. In fact, this practice is so common that it has a name: the beta-binomial distribution.</p>
<p>We can take advantage of the relationship between the binomial and beta distributions to make inferences from count data. Imagine a study where biologists track the probability that fruit flies die before they are 3 weeks old. They report that 30 out of 130 flies die on or before day 21 of life. What can we estimate about the underlying distribution of 3-week survival rates?</p>
<p>First, express the values as <em>successes</em> and <em>failures</em>. Let’s consider survival to be success (<em>n</em> = 100) and mortality to be failure (<em>n</em> = 30). This suggests that the underlying probability of survival to 21 days follows a beta distribution with <span class="math inline">\(\alpha\)</span> = 101 and <span class="math inline">\(\beta\)</span> = 31. Alternatively, we could define “success” as mortality. In this case, the mortality rate would follow a beta distribution with <span class="math inline">\(\alpha\)</span> = 31 and <span class="math inline">\(\beta\)</span> = 101. In R this can be calculated and plotted as shown below. Notice how reversing <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, or reversing perspective from survival to mortality, changes the distribution to its complement:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="mod-05.html#cb707-1" tabindex="-1"></a><span class="co"># domain of probability</span></span>
<span id="cb707-2"><a href="mod-05.html#cb707-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length=</span><span class="fl">1e3</span>)</span>
<span id="cb707-3"><a href="mod-05.html#cb707-3" tabindex="-1"></a></span>
<span id="cb707-4"><a href="mod-05.html#cb707-4" tabindex="-1"></a><span class="co"># survival rate distribution</span></span>
<span id="cb707-5"><a href="mod-05.html#cb707-5" tabindex="-1"></a>y.surv <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="at">shape1=</span><span class="dv">101</span>, <span class="at">shape2=</span><span class="dv">31</span>)</span>
<span id="cb707-6"><a href="mod-05.html#cb707-6" tabindex="-1"></a>y.mort <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x, <span class="at">shape1=</span><span class="dv">31</span>, <span class="at">shape2=</span><span class="dv">101</span>)</span>
<span id="cb707-7"><a href="mod-05.html#cb707-7" tabindex="-1"></a></span>
<span id="cb707-8"><a href="mod-05.html#cb707-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb707-9"><a href="mod-05.html#cb707-9" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, </span>
<span id="cb707-10"><a href="mod-05.html#cb707-10" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.3</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>)</span>
<span id="cb707-11"><a href="mod-05.html#cb707-11" tabindex="-1"></a><span class="fu">plot</span>(x, y.surv, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb707-12"><a href="mod-05.html#cb707-12" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;P(survival)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb707-13"><a href="mod-05.html#cb707-13" tabindex="-1"></a><span class="fu">plot</span>(x, y.mort, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb707-14"><a href="mod-05.html#cb707-14" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;P(mortality)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-407-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>We could calculate this distribution in another way. Consider the number of flies that survive to come from a binomial distribution. The distribution would have <em>n</em> = 130, and <em>p</em> = 100/130 <span class="math inline">\(\approx\)</span> 0.7692. Using the properties of the binomial distribution, we could infer that the mean of the binomial distribution was</p>
<p><span class="math display">\[\mu=np=100\]</span></p>
<p>and its variance was</p>
<p><span class="math display">\[\sigma^2=\ np(1-p)\approx23.08\]</span></p>
<p>This would imply that the SD of the binomial distribution was about 4.8038, and thus the CV was about 0.048038. The CV is the ratio of the SD to the mean. We could then estimate the SD of <em>p</em> was</p>
<p><span class="math display">\[\sigma\left(p\right)=\left(0.048\right)\left(0.7692\right)\approx0.0369\]</span></p>
<p>We could then use these values, <span class="math inline">\(\mu\left(p\right)\)</span> = 0.7692 and <span class="math inline">\(\sigma\left(p\right)\)</span> = 0.0369 into the expressions for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> to obtain:</p>
<p><span class="math display">\[\alpha=\left(\frac{1-0.7692}{{(0.0369)}^2}-\frac{1}{0.7692}\right){(0.7692)}^2\approx99.23\]</span></p>
<p><span class="math display">\[\beta=99.52\left(\frac{1}{0.7692}-1\right)\approx29.77\]</span></p>
<p>These expressions get us almost the exact answers. The R code to perform these calculations is below:</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="mod-05.html#cb708-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">130</span></span>
<span id="cb708-2"><a href="mod-05.html#cb708-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">/</span><span class="dv">130</span></span>
<span id="cb708-3"><a href="mod-05.html#cb708-3" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb708-4"><a href="mod-05.html#cb708-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma2)</span>
<span id="cb708-5"><a href="mod-05.html#cb708-5" tabindex="-1"></a>cv <span class="ot">&lt;-</span> sigma<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb708-6"><a href="mod-05.html#cb708-6" tabindex="-1"></a>sdp <span class="ot">&lt;-</span> cv<span class="sc">*</span>p</span>
<span id="cb708-7"><a href="mod-05.html#cb708-7" tabindex="-1"></a>Alpha <span class="ot">&lt;-</span> (((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>(sdp<span class="sc">^</span><span class="dv">2</span>))<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>p))<span class="sc">*</span>(p<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb708-8"><a href="mod-05.html#cb708-8" tabindex="-1"></a>Beta <span class="ot">&lt;-</span> Alpha<span class="sc">*</span>((<span class="dv">1</span><span class="sc">/</span>p)<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p>We can compare the distributions using <code>dbeta</code>.</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="mod-05.html#cb709-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span><span class="sc">/</span><span class="fl">1e3</span></span>
<span id="cb709-2"><a href="mod-05.html#cb709-2" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, <span class="dv">101</span>, <span class="dv">31</span>) <span class="co"># based on counts</span></span>
<span id="cb709-3"><a href="mod-05.html#cb709-3" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, Alpha, Beta) <span class="co"># calculated from binomial</span></span>
<span id="cb709-4"><a href="mod-05.html#cb709-4" tabindex="-1"></a></span>
<span id="cb709-5"><a href="mod-05.html#cb709-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb709-6"><a href="mod-05.html#cb709-6" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">lend=</span><span class="dv">1</span>)</span>
<span id="cb709-7"><a href="mod-05.html#cb709-7" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb709-8"><a href="mod-05.html#cb709-8" tabindex="-1"></a><span class="fu">points</span>(x1, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb709-9"><a href="mod-05.html#cb709-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Count-based&quot;</span>, <span class="st">&quot;Calculated&quot;</span>),</span>
<span id="cb709-10"><a href="mod-05.html#cb709-10" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx430-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The calculated values in <code>y2</code> result in a beta distribution of probabilities very close to the correct values. The difference results from a result known as the <strong>rule of succession</strong>, first published by French mathematician Pierre-Simon LaPlace in the 18th century. Briefly, we should assign the mean probability of success in a future Bernoulli trial <span class="math inline">\(\hat{p}\)</span> as</p>
<p><span class="math display">\[\hat{p}=\frac{x+1}{n+2}\]</span></p>
<p>where <em>x</em> is the number of successes in <em>n</em> trials. In other words, for some vector <em>x</em> of successes and failures (1s and 0s) we need to add one additional 1 and one additional 0 in order to estimate underlying distribution of success rates. The R code below produces the correct result (notice the new values of <em>n</em> and <em>p</em>).</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="mod-05.html#cb710-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">132</span></span>
<span id="cb710-2"><a href="mod-05.html#cb710-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">/</span><span class="dv">132</span></span>
<span id="cb710-3"><a href="mod-05.html#cb710-3" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb710-4"><a href="mod-05.html#cb710-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma2)</span>
<span id="cb710-5"><a href="mod-05.html#cb710-5" tabindex="-1"></a>cv <span class="ot">&lt;-</span> sigma<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb710-6"><a href="mod-05.html#cb710-6" tabindex="-1"></a>sdp <span class="ot">&lt;-</span> cv<span class="sc">*</span>p</span>
<span id="cb710-7"><a href="mod-05.html#cb710-7" tabindex="-1"></a></span>
<span id="cb710-8"><a href="mod-05.html#cb710-8" tabindex="-1"></a>Alpha <span class="ot">&lt;-</span> (((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>(sdp<span class="sc">^</span><span class="dv">2</span>))<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>p))<span class="sc">*</span>(p<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb710-9"><a href="mod-05.html#cb710-9" tabindex="-1"></a>Beta <span class="ot">&lt;-</span> Alpha<span class="sc">*</span>((<span class="dv">1</span><span class="sc">/</span>p)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb710-10"><a href="mod-05.html#cb710-10" tabindex="-1"></a></span>
<span id="cb710-11"><a href="mod-05.html#cb710-11" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span><span class="sc">/</span><span class="fl">1e3</span></span>
<span id="cb710-12"><a href="mod-05.html#cb710-12" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, <span class="dv">101</span>, <span class="dv">31</span>) <span class="co"># based on counts</span></span>
<span id="cb710-13"><a href="mod-05.html#cb710-13" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x1, Alpha, Beta) <span class="co"># calculated from binomial</span></span>
<span id="cb710-14"><a href="mod-05.html#cb710-14" tabindex="-1"></a>                             <span class="co"># and rule of succession</span></span>
<span id="cb710-15"><a href="mod-05.html#cb710-15" tabindex="-1"></a></span>
<span id="cb710-16"><a href="mod-05.html#cb710-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb710-17"><a href="mod-05.html#cb710-17" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">lend=</span><span class="dv">1</span>)</span>
<span id="cb710-18"><a href="mod-05.html#cb710-18" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb710-19"><a href="mod-05.html#cb710-19" tabindex="-1"></a><span class="fu">points</span>(x1, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb710-20"><a href="mod-05.html#cb710-20" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Count-based&quot;</span>, <span class="st">&quot;Calculated&quot;</span>),</span>
<span id="cb710-21"><a href="mod-05.html#cb710-21" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-409-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="dirichlet-distribution" class="section level3 hasAnchor" number="5.3.6">
<h3><span class="header-section-number">5.3.6</span> Dirichlet distribution<a href="mod-05.html#dirichlet-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>Dirichlet distribution</strong> (pronounced “Deer-eesh-lay”) is the distribution of probabilities for multiple outcomes of a random process. This makes it the generalization of beta distribution to multiple outcomes. The values of a Dirichlet distribution must add up to 1. For example, the beta distribution models the probability of throwing heads when you flip a coin. The Dirichlet distribution describes the probability of getting 1, 2, 3, 4, 5, or 6 when you throw a 6-sided die. Just as the probabilities of heads and not-heads must add to 1, the probabilities of 1, 2, 3, 4, 5, and 6 must add up to 1.</p>
<p>The Dirichlet distribution doesn’t come up on its own very often. Usually, biologists encounter the Dirichlet distribution when performing Bayesian analysis of multinomial outcomes. The Dirichlet distribution is the “conjugate prior” of the categorical and multinomial distributions.</p>
</div>
<div id="mod-05-expo" class="section level3 hasAnchor" number="5.3.7">
<h3><span class="header-section-number">5.3.7</span> Exponential distribution<a href="mod-05.html#mod-05-expo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>exponential distribution</strong> describes the distribution of waiting times until a single event occurs, given a constant probability per unit time of that event occurring. This makes it the continuous analog of the <a href="mod-05.html#mod-05-geom">geometric distribution</a>. The exponential distribution is also a special case of the <a href="mod-05.html#mod-05-gamma">gamma distribution</a> where k = 1.</p>
<p>The exponential distribution should not be confused with the <strong>exponential family of distributions</strong>, although the exponential distribution is part of that family. The exponential family of distributions includes many whose PDF can be expressed as an exponential function (e.g., <span class="math inline">\(f\left(x\right)=e^x\)</span>). The exponential family includes the normal, exponential, gamma, beta, Poisson, and many others.</p>
<p>The exponential distribution is parameterized by a single rate parameter, <span class="math inline">\(\lambda\)</span>, which describes the number of events occurring per unit time. This means that <span class="math inline">\(\lambda\)</span> must be &gt;0. This is exactly the same as the rate parameter <em>r</em> sometimes used to describe the gamma distribution. The mean of an exponential distribution <em>X</em> is:</p>
<p><span class="math display">\[\mu\left(X\right)=\frac{1}{\lambda}\]</span></p>
<p>and the variance is:</p>
<p><span class="math display">\[\sigma^2\left(X\right)=\frac{1}{\lambda^2}\]</span></p>
<p>Interestingly, this implies that the standard deviation <span class="math inline">\(\sigma\)</span> is the same as the mean <span class="math inline">\(\mu\)</span>. Contrast this with the Poisson distribution, where the <em>variance</em> <span class="math inline">\(\sigma^2\)</span> is the same as the mean. Thus, the CV of the exponential distribution is always 1.</p>
<p>The exponential distribution is supported for all non-negative real numbers; i.e., the half-open interval [0, <span class="math inline">\(+\infty\)</span>). Like the gamma distribution, the exponential distribution can be used to model biological processes for which its mechanistic description makes sense (e.g., waiting times or lifespans), or for any situation resulting in primarily 0 or small values and few large values.</p>
<div id="exponential-distribution-in-r" class="section level4 hasAnchor" number="5.3.7.1">
<h4><span class="header-section-number">5.3.7.1</span> Exponential distribution in R<a href="mod-05.html#exponential-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The exponential distribution is accessed using the <code>_exp</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dexp()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>pexp()</code>: Calculates CDF up to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qexp()</code>.</li>
<li><code>qexp()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>pexp()</code>.</li>
<li><code>rexp()</code>: Draws random numbers from the exponential distribution.</li>
</ul>
</div>
</div>
<div id="triangular-distribution" class="section level3 hasAnchor" number="5.3.8">
<h3><span class="header-section-number">5.3.8</span> Triangular distribution<a href="mod-05.html#triangular-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>triangular distribution</strong> is sometimes called the “distribution of ignorance” or “lack of knowledge distribution”. Sometimes we need to model a process about which we have very little information. For example, we may want to simulate population dynamics without knowing a key survival rate, or organismal growth without knowing a key growth constant. In these situations we might have only a vague idea of how a parameter or an outcome are distributed. At a minimum, we can usually infer or estimate the range and central tendency of a variable. Those are enough to estimate a triangular distribution.</p>
<p>The triangular distribution is parameterized by three parameters: the lower limit <em>a</em>, the upper limit <em>b</em>, and the mode (most common value) <em>c</em>. Any triangular distribution must satisfy <em>a</em> &lt; <em>b</em> and <em>a</em> <span class="math inline">\(\le\)</span> <em>c</em> <span class="math inline">\(\le\)</span> <em>b</em>.</p>
<p>The mean of a triangular distribution <em>X</em> is the mean of its parameters:</p>
<p><span class="math display">\[\mu\left(X\right)=\frac{a+b+c}{3}\]</span></p>
<p>and the variance is</p>
<p><span class="math display">\[\sigma^2\left(X\right)=\frac{a^2+b^2+c^2-ab-ac-bc}{18}\]</span></p>
<p>In addition to serving as a stand-in distribution when data are scarce, the triangular distribution can arise in several natural situations. For example, the mean of two standard uniform variables follows a triangular distribution (see below).</p>
<div id="triangular-distribution-in-r" class="section level4 hasAnchor" number="5.3.8.1">
<h4><span class="header-section-number">5.3.8.1</span> Triangular distribution in R<a href="mod-05.html#triangular-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The triangular distribution is available in the add-on package “triangle” <span class="citation">(<a href="#ref-carnell2019">Carnell 2019</a>)</span>. The triangular distribution is accessed using the <code>_triangle</code> group of functions, where the space could be <code>d</code>, <code>p</code>, <code>q</code>, or <code>r</code>. These functions calculate or returns something different:</p>
<ul>
<li><code>dtriangle()</code>: Calculates probability density function (PDF) at <em>x</em>.</li>
<li><code>ptriangle()</code>: Calculates CDF up <em>a</em> to <em>x</em>. Answers the question, “at what quantile of the distribution should some value fall?”. The reverse of <code>qtriangle()</code>.</li>
<li><code>qtriangle()</code>: Calculates the value at a specified quantile or quantiles. The reverse of <code>ptriangle()</code>.</li>
<li><code>rtriangle()</code>: Draws random numbers from the triangular distribution.</li>
</ul>
<p>The code below shows the PDFs of various triangular distributions. Notice that <code>c</code> is not used as a variable name, to avoid potentially masking the very critical R function <code>c</code>. The triangular distribution is available in the package <code>triangle</code>, as well as the newer package <code>extraDistr</code>. In 2024 I started using <code>extraDistr</code> instead of <code>triangle</code> because the former contains so many other distributions; the two packages work very similarly.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="mod-05.html#cb711-1" tabindex="-1"></a><span class="fu">library</span>(extraDistr)</span></code></pre></div>
<pre><code>## Warning: package &#39;extraDistr&#39; was built under R version 4.3.3</code></pre>
<pre><code>## 
## Attaching package: &#39;extraDistr&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     rtnorm</code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="mod-05.html#cb715-1" tabindex="-1"></a>ax <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb715-2"><a href="mod-05.html#cb715-2" tabindex="-1"></a>bx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">7</span>)</span>
<span id="cb715-3"><a href="mod-05.html#cb715-3" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb715-4"><a href="mod-05.html#cb715-4" tabindex="-1"></a></span>
<span id="cb715-5"><a href="mod-05.html#cb715-5" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(ax[<span class="dv">1</span>], bx[<span class="dv">1</span>], <span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb715-6"><a href="mod-05.html#cb715-6" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(ax[<span class="dv">2</span>], bx[<span class="dv">2</span>], <span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb715-7"><a href="mod-05.html#cb715-7" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(ax[<span class="dv">3</span>], bx[<span class="dv">3</span>], <span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb715-8"><a href="mod-05.html#cb715-8" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dtriang</span>(x1, ax[<span class="dv">1</span>], bx[<span class="dv">1</span>], cx[<span class="dv">1</span>])</span>
<span id="cb715-9"><a href="mod-05.html#cb715-9" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dtriang</span>(x2, ax[<span class="dv">2</span>], bx[<span class="dv">2</span>], cx[<span class="dv">2</span>])</span>
<span id="cb715-10"><a href="mod-05.html#cb715-10" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dtriang</span>(x3, ax[<span class="dv">3</span>], bx[<span class="dv">3</span>], cx[<span class="dv">3</span>])</span>
<span id="cb715-11"><a href="mod-05.html#cb715-11" tabindex="-1"></a></span>
<span id="cb715-12"><a href="mod-05.html#cb715-12" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb715-13"><a href="mod-05.html#cb715-13" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb715-14"><a href="mod-05.html#cb715-14" tabindex="-1"></a><span class="fu">points</span>(x2, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb715-15"><a href="mod-05.html#cb715-15" tabindex="-1"></a><span class="fu">points</span>(x3, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb715-16"><a href="mod-05.html#cb715-16" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Tri(1, 5, 3)&quot;</span>, <span class="st">&quot;Tri(1, 10, 3)&quot;</span>, <span class="st">&quot;Tri(3, 7, 6)&quot;</span>), </span>
<span id="cb715-17"><a href="mod-05.html#cb715-17" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-410-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The code below demonstrates how a triangular distribution can arise as the distribution of means of two standard uniform variables <code>x1</code> and <code>x2</code>. The command <code>density()</code> calculates the kernel density estimate of a vector. This kernel density estimate is an empirical estimate of the PDF of a variable.</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="mod-05.html#cb716-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb716-2"><a href="mod-05.html#cb716-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb716-3"><a href="mod-05.html#cb716-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(n))</span>
<span id="cb716-4"><a href="mod-05.html#cb716-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb716-5"><a href="mod-05.html#cb716-5" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> (<span class="fu">runif</span>(n[i]) <span class="sc">+</span> <span class="fu">runif</span>(n[i]))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb716-6"><a href="mod-05.html#cb716-6" tabindex="-1"></a>}</span>
<span id="cb716-7"><a href="mod-05.html#cb716-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb716-8"><a href="mod-05.html#cb716-8" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">density</span>(x[[i]])</span>
<span id="cb716-9"><a href="mod-05.html#cb716-9" tabindex="-1"></a>    x1[[i]] <span class="ot">&lt;-</span> z<span class="sc">$</span>x</span>
<span id="cb716-10"><a href="mod-05.html#cb716-10" tabindex="-1"></a>    y[[i]] <span class="ot">&lt;-</span> z<span class="sc">$</span>y</span>
<span id="cb716-11"><a href="mod-05.html#cb716-11" tabindex="-1"></a>}</span>
<span id="cb716-12"><a href="mod-05.html#cb716-12" tabindex="-1"></a></span>
<span id="cb716-13"><a href="mod-05.html#cb716-13" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">3</span>)</span>
<span id="cb716-14"><a href="mod-05.html#cb716-14" tabindex="-1"></a><span class="fu">plot</span>(x1[[<span class="dv">1</span>]], y[[<span class="dv">1</span>]], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">1</span>],</span>
<span id="cb716-15"><a href="mod-05.html#cb716-15" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Kernel density estimate&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb716-16"><a href="mod-05.html#cb716-16" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb716-17"><a href="mod-05.html#cb716-17" tabindex="-1"></a>    <span class="fu">points</span>(x1[[i]], y[[i]], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[i])</span>
<span id="cb716-18"><a href="mod-05.html#cb716-18" tabindex="-1"></a>}</span>
<span id="cb716-19"><a href="mod-05.html#cb716-19" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;n=100&quot;</span>, <span class="st">&quot;n=1000&quot;</span>, <span class="st">&quot;n=10000&quot;</span>),</span>
<span id="cb716-20"><a href="mod-05.html#cb716-20" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-411-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="distributions-summary" class="section level3 hasAnchor" number="5.3.9">
<h3><span class="header-section-number">5.3.9</span> Distributions summary<a href="mod-05.html#distributions-summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The table below summarizes some the key features of the <strong>discrete distributions</strong> we explored in this module.</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution</th>
<th>Support</th>
<th>What it models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bernoulli</td>
<td>0 or 1</td>
<td>Outcome of a single binary trial</td>
</tr>
<tr class="even">
<td>Binomial</td>
<td>[0, <em>n</em>]</td>
<td>Number of successes in <em>n</em> trials with constant probability <em>p</em>.</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Number of events occurring independently at constant rate (i.e., count data)</td>
</tr>
<tr class="even">
<td>Negative binomial</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Number of failures until a success; or, counts with overdispersion</td>
</tr>
<tr class="odd">
<td>Geometric</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Number of trials until a single failure with constant probability</td>
</tr>
<tr class="even">
<td>Beta-binomial</td>
<td>[0, <em>n</em>]</td>
<td>Number of successes in <em>n</em> trials, with varying <em>p</em>.</td>
</tr>
<tr class="odd">
<td>Multinomial</td>
<td>[0, <em>n</em>] for each <em>x<sub>i</sub></em>, with sum(<em>x<sub>i</sub></em>) = <em>n</em></td>
<td>Number of counts <em>x<sub>i</sub></em> in <em>k</em> categories out of <em>n</em> trials.</td>
</tr>
</tbody>
</table>
<p>The table below summarizes some the key features of the <strong>continuous distributions</strong> we explored in this module.</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution</th>
<th>Support</th>
<th>What it models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Uniform</td>
<td>[min, max]</td>
<td>Continuous variables where all values are equally likely.</td>
</tr>
<tr class="even">
<td>Normal</td>
<td>[<span class="math inline">\(-\infty\)</span>, <span class="math inline">\(+\infty\)</span>]</td>
<td>Many natural processes</td>
</tr>
<tr class="odd">
<td>Lognormal</td>
<td>(0, <span class="math inline">\(+\infty\)</span>)</td>
<td>Many processes that are normally distributed on log scale; values arising from multiplicative processes</td>
</tr>
<tr class="even">
<td>Gamma</td>
<td>(0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Waiting times until an event occurs</td>
</tr>
<tr class="odd">
<td>Beta</td>
<td>[0, 1]</td>
<td>Probabilities of single events (i.e., probabilities for binomial processes)</td>
</tr>
<tr class="even">
<td>Dirichlet</td>
<td>[0, 1] for each <em>x<sub>i</sub></em>, and sum(<em>x<sub>i</sub></em>) = 1</td>
<td>Probabilities of multiple events (i.e., probabilities for multinomial processes)</td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td>[0, <span class="math inline">\(+\infty\)</span>]</td>
<td>Waiting times between events</td>
</tr>
<tr class="even">
<td>Triangular</td>
<td>[min, max]</td>
<td>Continuous variables about which little is known; requires minimum, maximum, and mode.</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="mod-05-dists2" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Fitting and testing distributions<a href="mod-05.html#mod-05-dists2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Deciding what probability distribution to use to analyze your data is an important step in biological data analysis. The next step is to see how well your data actually match a distribution. This page demonstrates ways to compare data to probability distributions. We will also explore some methods to explicitly test whether or not a set of values came from a particular distribution.</p>
<div id="estimating-distributional-parameters" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Estimating distributional parameters<a href="mod-05.html#estimating-distributional-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>fitdistr()</code> in package <code>MASS</code> estimates the <strong>parameters</strong> of a distribution most likely to produce random variables supplied as input. Simply put, if you have a variable <em>x</em> and want to know what parameters of some distribution are most likely to produce <em>x</em>, then <code>fitdistr()</code> will estimate this for you. The method of estimation is called <strong>maximum-likelihood</strong>, which we will explore in more detail later. Examples of distribution fitting are shown below. Note that for the beta distribution, starting values for the fitting function must be supplied. This is because for this distribution the parameter estimation process is stochastic and iterative and needs somewhere to start.</p>
<p>The function <code>fitdistr()</code> is in the package <code>MASS</code>, which is short for “Modern Applied Statistics with S”. This widely used package implements many methods described in the textbook of the same name <span class="citation">(<a href="#ref-venables2002">Venables and Ripley 2002</a>)</span>. The titular language S was a precursor language to R.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="mod-05.html#cb717-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb717-2"><a href="mod-05.html#cb717-2" tabindex="-1"></a></span>
<span id="cb717-3"><a href="mod-05.html#cb717-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb717-4"><a href="mod-05.html#cb717-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb717-5"><a href="mod-05.html#cb717-5" tabindex="-1"></a></span>
<span id="cb717-6"><a href="mod-05.html#cb717-6" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb717-7"><a href="mod-05.html#cb717-7" tabindex="-1"></a><span class="fu">fitdistr</span>(x1, <span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<pre><code>##       mean          sd    
##   12.0688071    1.8331290 
##  ( 0.2592436) ( 0.1833129)</code></pre>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="mod-05.html#cb719-1" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">8</span>)</span>
<span id="cb719-2"><a href="mod-05.html#cb719-2" tabindex="-1"></a><span class="fu">fitdistr</span>(x2, <span class="st">&quot;Poisson&quot;</span>)</span></code></pre></div>
<pre><code>##     lambda  
##   8.2200000 
##  (0.4054627)</code></pre>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="mod-05.html#cb721-1" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rgeom</span>(n, <span class="fl">0.7</span>)</span>
<span id="cb721-2"><a href="mod-05.html#cb721-2" tabindex="-1"></a><span class="fu">fitdistr</span>(x3, <span class="st">&quot;geometric&quot;</span>)</span></code></pre></div>
<pre><code>##       prob   
##   0.90909091 
##  (0.03876377)</code></pre>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="mod-05.html#cb723-1" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="dv">2</span>, <span class="fl">0.5</span>)</span>
<span id="cb723-2"><a href="mod-05.html#cb723-2" tabindex="-1"></a><span class="fu">fitdistr</span>(x4, <span class="st">&quot;beta&quot;</span>, <span class="at">start=</span><span class="fu">list</span>(<span class="at">shape1=</span><span class="dv">1</span>, <span class="at">shape2=</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<pre><code>##     shape1      shape2  
##   2.1520168   0.5070293 
##  (0.4828815) (0.0844015)</code></pre>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="mod-05.html#cb726-1" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(n, <span class="dv">4</span>, <span class="fl">0.2</span>)</span>
<span id="cb726-2"><a href="mod-05.html#cb726-2" tabindex="-1"></a><span class="fu">fitdistr</span>(x5, <span class="st">&quot;negative binomial&quot;</span>)</span></code></pre></div>
<pre><code>##      size         mu    
##    3.674590   15.660000 
##  ( 0.907684) ( 1.283731)</code></pre>
<p>How did <code>fitdistr()</code> do? Most of the parameter estimates were pretty close to the true values. The estimates generally get closer as the sample size increases. Try increasing <code>n</code> to 500 and rerunning the code above.</p>
</div>
</div>
<div id="graphical-methods-for-examining-distributions" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Graphical methods for examining distributions<a href="mod-05.html#graphical-methods-for-examining-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="comparing-distributions-with-pdf-or-pmf-plots" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Comparing distributions with PDF or PMF plots<a href="mod-05.html#comparing-distributions-with-pdf-or-pmf-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can compare the distributions implied by the estimated parameters to the actual data using the quantile or distribution functions. The basic idea is to plot the data distribution, and superimpose the equivalent plots of the hypothetical distributions.</p>
<p>In the example below, we compare the probability mass function (PMF) of a a discrete distribution (e.g., counts) to the PMFs of two possible distributions that might match the data. Note that the PMF of a discrete distribution can be estimated as the proportion of observations that take on each value.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="mod-05.html#cb728-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb728-2"><a href="mod-05.html#cb728-2" tabindex="-1"></a></span>
<span id="cb728-3"><a href="mod-05.html#cb728-3" tabindex="-1"></a><span class="co"># the counts:</span></span>
<span id="cb728-4"><a href="mod-05.html#cb728-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">100</span>, <span class="at">mu=</span><span class="dv">4</span>, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb728-5"><a href="mod-05.html#cb728-5" tabindex="-1"></a></span>
<span id="cb728-6"><a href="mod-05.html#cb728-6" tabindex="-1"></a><span class="co"># fit parameters for poisson and negative binomial</span></span>
<span id="cb728-7"><a href="mod-05.html#cb728-7" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;Poisson&quot;</span>)</span>
<span id="cb728-8"><a href="mod-05.html#cb728-8" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;negative binomial&quot;</span>)</span>
<span id="cb728-9"><a href="mod-05.html#cb728-9" tabindex="-1"></a></span>
<span id="cb728-10"><a href="mod-05.html#cb728-10" tabindex="-1"></a><span class="co"># calculate PMFs of candidate distributions across</span></span>
<span id="cb728-11"><a href="mod-05.html#cb728-11" tabindex="-1"></a><span class="co"># range of data</span></span>
<span id="cb728-12"><a href="mod-05.html#cb728-12" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(x)</span>
<span id="cb728-13"><a href="mod-05.html#cb728-13" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(xx, f1<span class="sc">$</span>estimate)</span>
<span id="cb728-14"><a href="mod-05.html#cb728-14" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(xx, <span class="at">size=</span>f2<span class="sc">$</span>estimate[<span class="st">&quot;size&quot;</span>],</span>
<span id="cb728-15"><a href="mod-05.html#cb728-15" tabindex="-1"></a>              <span class="at">mu=</span>f2<span class="sc">$</span>estimate[<span class="st">&quot;mu&quot;</span>])</span>
<span id="cb728-16"><a href="mod-05.html#cb728-16" tabindex="-1"></a></span>
<span id="cb728-17"><a href="mod-05.html#cb728-17" tabindex="-1"></a><span class="co"># empirical PMF of counts</span></span>
<span id="cb728-18"><a href="mod-05.html#cb728-18" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">table</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb728-19"><a href="mod-05.html#cb728-19" tabindex="-1"></a>plot.x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(y3))</span>
<span id="cb728-20"><a href="mod-05.html#cb728-20" tabindex="-1"></a>plot.y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(y3)</span>
<span id="cb728-21"><a href="mod-05.html#cb728-21" tabindex="-1"></a></span>
<span id="cb728-22"><a href="mod-05.html#cb728-22" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb728-23"><a href="mod-05.html#cb728-23" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb728-24"><a href="mod-05.html#cb728-24" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb728-25"><a href="mod-05.html#cb728-25" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb728-26"><a href="mod-05.html#cb728-26" tabindex="-1"></a><span class="fu">plot</span>(plot.x, plot.y, <span class="at">type=</span><span class="st">&quot;o&quot;</span>, </span>
<span id="cb728-27"><a href="mod-05.html#cb728-27" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb728-28"><a href="mod-05.html#cb728-28" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;PMF&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>)</span>
<span id="cb728-29"><a href="mod-05.html#cb728-29" tabindex="-1"></a><span class="fu">points</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;o&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb728-30"><a href="mod-05.html#cb728-30" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;o&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb728-31"><a href="mod-05.html#cb728-31" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;Poisson&quot;</span>, <span class="st">&quot;negative binomial&quot;</span>),</span>
<span id="cb728-32"><a href="mod-05.html#cb728-32" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">16</span>, <span class="at">pt.cex=</span><span class="fl">1.3</span>,</span>
<span id="cb728-33"><a href="mod-05.html#cb728-33" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-413-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In this example, the data (black) seem to be better described by the negative binomial (blue) than by the Poisson (red).</p>
<p>The example below shows the same procedure applied to a continuous distribution. The only difference is in how the probability density function (PDF) of the data is estimated (note PDF, not PMF). The PDF of a continuous distribution is estimated with function <code>density()</code>. It is a good idea to limit the estimation of density functions to the domain of the data. Keep in mind, however, that different distributions have different limits. If a suspected distribution is supported outside the possible range of the data, then it might not be the right one. The example below illustrates this: the data (<code>x</code>) are all positive, but one of the distributions tested (normal) will produce negative values using the estimated parameters (<code>f1</code>). That alone should lead the researcher in this situation to eliminate the normal as a possibility; the plot only confirms the unsuitability of the normal for modeling <code>x</code>.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="mod-05.html#cb729-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb729-2"><a href="mod-05.html#cb729-2" tabindex="-1"></a></span>
<span id="cb729-3"><a href="mod-05.html#cb729-3" tabindex="-1"></a><span class="co"># the data:</span></span>
<span id="cb729-4"><a href="mod-05.html#cb729-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">200</span>, <span class="at">shape=</span><span class="dv">2</span>, <span class="at">scale=</span><span class="dv">20</span>)</span>
<span id="cb729-5"><a href="mod-05.html#cb729-5" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-414-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="mod-05.html#cb730-1" tabindex="-1"></a><span class="co"># fit parameters for poisson and negative binomial</span></span>
<span id="cb730-2"><a href="mod-05.html#cb730-2" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb730-3"><a href="mod-05.html#cb730-3" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb730-4"><a href="mod-05.html#cb730-4" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="mod-05.html#cb732-1" tabindex="-1"></a><span class="co"># calculate PMFs of candidate distributions across</span></span>
<span id="cb732-2"><a href="mod-05.html#cb732-2" tabindex="-1"></a><span class="co"># range of data</span></span>
<span id="cb732-3"><a href="mod-05.html#cb732-3" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb732-4"><a href="mod-05.html#cb732-4" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xx, f1<span class="sc">$</span>estimate[<span class="dv">1</span>], f1<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb732-5"><a href="mod-05.html#cb732-5" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dlnorm</span>(xx, f2<span class="sc">$</span>estimate[<span class="dv">1</span>], f2<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb732-6"><a href="mod-05.html#cb732-6" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(xx, <span class="at">shape=</span>f3<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>f3<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb732-7"><a href="mod-05.html#cb732-7" tabindex="-1"></a></span>
<span id="cb732-8"><a href="mod-05.html#cb732-8" tabindex="-1"></a><span class="co"># empirical PDF of data</span></span>
<span id="cb732-9"><a href="mod-05.html#cb732-9" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">density</span>(x, <span class="at">from=</span><span class="fu">min</span>(x), <span class="at">to=</span><span class="fu">max</span>(x))</span>
<span id="cb732-10"><a href="mod-05.html#cb732-10" tabindex="-1"></a></span>
<span id="cb732-11"><a href="mod-05.html#cb732-11" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb732-12"><a href="mod-05.html#cb732-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb732-13"><a href="mod-05.html#cb732-13" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb732-14"><a href="mod-05.html#cb732-14" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb732-15"><a href="mod-05.html#cb732-15" tabindex="-1"></a><span class="fu">plot</span>(dx<span class="sc">$</span>x, dx<span class="sc">$</span>y,</span>
<span id="cb732-16"><a href="mod-05.html#cb732-16" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.025</span>),</span>
<span id="cb732-17"><a href="mod-05.html#cb732-17" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>)</span>
<span id="cb732-18"><a href="mod-05.html#cb732-18" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab=</span><span class="st">&quot;PDF&quot;</span>, <span class="at">line=</span><span class="dv">4</span>)</span>
<span id="cb732-19"><a href="mod-05.html#cb732-19" tabindex="-1"></a><span class="fu">points</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb732-20"><a href="mod-05.html#cb732-20" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb732-21"><a href="mod-05.html#cb732-21" tabindex="-1"></a><span class="fu">points</span>(xx, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb732-22"><a href="mod-05.html#cb732-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb732-23"><a href="mod-05.html#cb732-23" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;lognormal&quot;</span>, <span class="st">&quot;gamma&quot;</span>),</span>
<span id="cb732-24"><a href="mod-05.html#cb732-24" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</span>
<span id="cb732-25"><a href="mod-05.html#cb732-25" tabindex="-1"></a>    <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-414-2.png" width="576" style="display: block; margin: auto;" /></p>
<p>The plot suggests that the data are better described by a gamma distribution than by a normal or lognormal. This is because the curve for the data is most closely matched by the curve for the gamma. Try adjusting the sample size in the example above (e.g., <code>n &lt;- 50</code>) and see if the correct distribution always matches the data.</p>
</div>
<div id="comparing-distributions-using-cdf-and-ecdf" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Comparing distributions using CDF and ECDF<a href="mod-05.html#comparing-distributions-using-cdf-and-ecdf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another way to compare data to distributions is with the cumulative distribution function (CDF). The basic idea is the same as using density functions: compare the empirical CDF (ECDF) of the data to the CDFs potential distributions and judge which one best matches the data.</p>
<p>The example below shows how to use ECDF and CDF to compare a continuous distribution to various target distributions.</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="mod-05.html#cb733-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb733-2"><a href="mod-05.html#cb733-2" tabindex="-1"></a></span>
<span id="cb733-3"><a href="mod-05.html#cb733-3" tabindex="-1"></a><span class="co"># make the data:</span></span>
<span id="cb733-4"><a href="mod-05.html#cb733-4" tabindex="-1"></a> </span>
<span id="cb733-5"><a href="mod-05.html#cb733-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">100</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="dv">4</span>), <span class="at">sdlog=</span><span class="fu">log</span>(<span class="dv">3</span>))</span>
<span id="cb733-6"><a href="mod-05.html#cb733-6" tabindex="-1"></a></span>
<span id="cb733-7"><a href="mod-05.html#cb733-7" tabindex="-1"></a><span class="co"># fit some distributions</span></span>
<span id="cb733-8"><a href="mod-05.html#cb733-8" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb733-9"><a href="mod-05.html#cb733-9" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb733-10"><a href="mod-05.html#cb733-10" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb733-11"><a href="mod-05.html#cb733-11" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;exponential&quot;</span>)</span>
<span id="cb733-12"><a href="mod-05.html#cb733-12" tabindex="-1"></a></span>
<span id="cb733-13"><a href="mod-05.html#cb733-13" tabindex="-1"></a><span class="co"># calculate density functions over domain of x</span></span>
<span id="cb733-14"><a href="mod-05.html#cb733-14" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb733-15"><a href="mod-05.html#cb733-15" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(xx, f1<span class="sc">$</span>estimate[<span class="st">&quot;mean&quot;</span>], f1<span class="sc">$</span>estimate[<span class="st">&quot;sd&quot;</span>])</span>
<span id="cb733-16"><a href="mod-05.html#cb733-16" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">plnorm</span>(xx, f2<span class="sc">$</span>estimate[<span class="st">&quot;meanlog&quot;</span>], f2<span class="sc">$</span>estimate[<span class="st">&quot;sdlog&quot;</span>])</span>
<span id="cb733-17"><a href="mod-05.html#cb733-17" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">pgamma</span>(xx,</span>
<span id="cb733-18"><a href="mod-05.html#cb733-18" tabindex="-1"></a>             <span class="at">shape=</span>f3<span class="sc">$</span>estimate[<span class="st">&quot;shape&quot;</span>], </span>
<span id="cb733-19"><a href="mod-05.html#cb733-19" tabindex="-1"></a>             <span class="at">rate=</span>f3<span class="sc">$</span>estimate[<span class="st">&quot;rate&quot;</span>])</span>
<span id="cb733-20"><a href="mod-05.html#cb733-20" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">pexp</span>(xx, <span class="at">rate=</span>f4<span class="sc">$</span>estimate[<span class="st">&quot;rate&quot;</span>])</span>
<span id="cb733-21"><a href="mod-05.html#cb733-21" tabindex="-1"></a></span>
<span id="cb733-22"><a href="mod-05.html#cb733-22" tabindex="-1"></a><span class="co"># ecdf of data</span></span>
<span id="cb733-23"><a href="mod-05.html#cb733-23" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)(xx)</span>
<span id="cb733-24"><a href="mod-05.html#cb733-24" tabindex="-1"></a></span>
<span id="cb733-25"><a href="mod-05.html#cb733-25" tabindex="-1"></a><span class="co"># fancy plot</span></span>
<span id="cb733-26"><a href="mod-05.html#cb733-26" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="fu">rainbow</span>(<span class="dv">4</span>))</span>
<span id="cb733-27"><a href="mod-05.html#cb733-27" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb733-28"><a href="mod-05.html#cb733-28" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb733-29"><a href="mod-05.html#cb733-29" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb733-30"><a href="mod-05.html#cb733-30" tabindex="-1"></a><span class="fu">plot</span>(xx, y5, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,</span>
<span id="cb733-31"><a href="mod-05.html#cb733-31" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;(E)CDF&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span>cols[<span class="dv">1</span>])</span>
<span id="cb733-32"><a href="mod-05.html#cb733-32" tabindex="-1"></a><span class="fu">points</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">2</span>])</span>
<span id="cb733-33"><a href="mod-05.html#cb733-33" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">3</span>])</span>
<span id="cb733-34"><a href="mod-05.html#cb733-34" tabindex="-1"></a><span class="fu">points</span>(xx, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">4</span>])</span>
<span id="cb733-35"><a href="mod-05.html#cb733-35" tabindex="-1"></a><span class="fu">points</span>(xx, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">5</span>])</span>
<span id="cb733-36"><a href="mod-05.html#cb733-36" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb733-37"><a href="mod-05.html#cb733-37" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;ECDF(data)&quot;</span>, <span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;Lognormal&quot;</span>, <span class="st">&quot;Gamma&quot;</span>, <span class="st">&quot;Exponential&quot;</span>), </span>
<span id="cb733-38"><a href="mod-05.html#cb733-38" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-415-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In this example, the ECDF of the original data (black) appears to best match the lognormal (green)—as well it should, because the data came from a lognormal distribution. The normal (red) is clearly inappropriate because it diverges from the actual data over most of the range of the data. The gamma and exponential are each better than the normal, but not as close to the data as the lognormal.</p>
</div>
<div id="comparing-distributions-using-qq-plots" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Comparing distributions using QQ plots<a href="mod-05.html#comparing-distributions-using-qq-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, you can use <strong>quantile-quantile (QQ) plots</strong> to compare data to different distributions that you suspect they may follow. The example below uses a QQ plot instead of ECDF as seen above.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="mod-05.html#cb734-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb734-2"><a href="mod-05.html#cb734-2" tabindex="-1"></a></span>
<span id="cb734-3"><a href="mod-05.html#cb734-3" tabindex="-1"></a><span class="co"># true distribution: lognormal</span></span>
<span id="cb734-4"><a href="mod-05.html#cb734-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb734-5"><a href="mod-05.html#cb734-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(n, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="dv">4</span>), <span class="at">sdlog=</span><span class="fu">log</span>(<span class="dv">3</span>))</span>
<span id="cb734-6"><a href="mod-05.html#cb734-6" tabindex="-1"></a></span>
<span id="cb734-7"><a href="mod-05.html#cb734-7" tabindex="-1"></a><span class="co"># estimate distributional parameters</span></span>
<span id="cb734-8"><a href="mod-05.html#cb734-8" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb734-9"><a href="mod-05.html#cb734-9" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb734-10"><a href="mod-05.html#cb734-10" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb734-11"><a href="mod-05.html#cb734-11" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x, <span class="st">&quot;exponential&quot;</span>)</span>
<span id="cb734-12"><a href="mod-05.html#cb734-12" tabindex="-1"></a></span>
<span id="cb734-13"><a href="mod-05.html#cb734-13" tabindex="-1"></a><span class="co"># quantiles of reference distribution</span></span>
<span id="cb734-14"><a href="mod-05.html#cb734-14" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(n)</span>
<span id="cb734-15"><a href="mod-05.html#cb734-15" tabindex="-1"></a></span>
<span id="cb734-16"><a href="mod-05.html#cb734-16" tabindex="-1"></a><span class="co"># define functions to draw from each reference distribution</span></span>
<span id="cb734-17"><a href="mod-05.html#cb734-17" tabindex="-1"></a>dfun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qnorm</span>(p, f1<span class="sc">$</span>estimate[<span class="dv">1</span>], f1<span class="sc">$</span>estimate[<span class="dv">2</span>])}</span>
<span id="cb734-18"><a href="mod-05.html#cb734-18" tabindex="-1"></a>dfun2 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qlnorm</span>(p, f2<span class="sc">$</span>estimate[<span class="dv">1</span>], f2<span class="sc">$</span>estimate[<span class="dv">2</span>])}</span>
<span id="cb734-19"><a href="mod-05.html#cb734-19" tabindex="-1"></a>dfun3 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qgamma</span>(p, <span class="at">shape=</span>f3<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb734-20"><a href="mod-05.html#cb734-20" tabindex="-1"></a>                            <span class="at">rate=</span>f3<span class="sc">$</span>estimate[<span class="dv">2</span>])}</span>
<span id="cb734-21"><a href="mod-05.html#cb734-21" tabindex="-1"></a>dfun4 <span class="ot">&lt;-</span> <span class="cf">function</span>(p){<span class="fu">qexp</span>(p, f4<span class="sc">$</span>estimate)}</span>
<span id="cb734-22"><a href="mod-05.html#cb734-22" tabindex="-1"></a></span>
<span id="cb734-23"><a href="mod-05.html#cb734-23" tabindex="-1"></a><span class="co"># get values at each reference quantile</span></span>
<span id="cb734-24"><a href="mod-05.html#cb734-24" tabindex="-1"></a>qy1 <span class="ot">&lt;-</span> <span class="fu">dfun1</span>(qx)</span>
<span id="cb734-25"><a href="mod-05.html#cb734-25" tabindex="-1"></a>qy2 <span class="ot">&lt;-</span> <span class="fu">dfun2</span>(qx)</span>
<span id="cb734-26"><a href="mod-05.html#cb734-26" tabindex="-1"></a>qy3 <span class="ot">&lt;-</span> <span class="fu">dfun3</span>(qx)</span>
<span id="cb734-27"><a href="mod-05.html#cb734-27" tabindex="-1"></a>qy4 <span class="ot">&lt;-</span> <span class="fu">dfun4</span>(qx)</span>
<span id="cb734-28"><a href="mod-05.html#cb734-28" tabindex="-1"></a></span>
<span id="cb734-29"><a href="mod-05.html#cb734-29" tabindex="-1"></a><span class="co"># make plot</span></span>
<span id="cb734-30"><a href="mod-05.html#cb734-30" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb734-31"><a href="mod-05.html#cb734-31" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, </span>
<span id="cb734-32"><a href="mod-05.html#cb734-32" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb734-33"><a href="mod-05.html#cb734-33" tabindex="-1"></a><span class="fu">qqplot</span>(qy1, x, <span class="at">main=</span><span class="st">&quot;Normal&quot;</span>)</span>
<span id="cb734-34"><a href="mod-05.html#cb734-34" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun1, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb734-35"><a href="mod-05.html#cb734-35" tabindex="-1"></a><span class="fu">qqplot</span>(qy2, x, <span class="at">main=</span><span class="st">&quot;Lognormal&quot;</span>)</span>
<span id="cb734-36"><a href="mod-05.html#cb734-36" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun2, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb734-37"><a href="mod-05.html#cb734-37" tabindex="-1"></a><span class="fu">qqplot</span>(qy3, x, <span class="at">main=</span><span class="st">&quot;Gamma&quot;</span>)</span>
<span id="cb734-38"><a href="mod-05.html#cb734-38" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun3, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb734-39"><a href="mod-05.html#cb734-39" tabindex="-1"></a><span class="fu">qqplot</span>(qy4, x, <span class="at">main=</span><span class="st">&quot;Exponential&quot;</span>)</span>
<span id="cb734-40"><a href="mod-05.html#cb734-40" tabindex="-1"></a><span class="fu">qqline</span>(x, <span class="at">distribution=</span>dfun4, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-416-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The figure shows that the normal is clearly inappropriate because the points do not fall on the line. The gamma and exponential are okay over most of the domain of x, but depart for large values. The lognormal plot (top right) shows the best match between the data and the reference distribution.</p>
<p>It is important to keep in mind that the comparisons we’ve made here are of idealized cases. Real data are often much messier and noisier than the distributions used in these examples. Sometimes real data are best characterized by mixture distributions for which there are no straightforward ways to estimate parameters. Still, the steps outlined above for estimating distributional parameters and comparing to idealized distributions are important first steps in data analysis.</p>
</div>
</div>
<div id="formal-tests-for-distributions" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Formal tests for distributions<a href="mod-05.html#formal-tests-for-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="tests-for-normality" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Tests for normality<a href="mod-05.html#tests-for-normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The normal distribution is so important for so many statistical methods that people have developed tests to formally determine whether data come from a normal distribution. The most common test for normality is the <strong>Shapiro-Wilk test</strong>. The Shapiro-Wilk test tests the null hypothesis that a sample <em>x</em><sub>1</sub>, …, <em>x</em><sub><em>n</em></sub> comes from a normally distributed population. The test statistic <em>W</em> is calculated as:</p>
<p><span class="math display">\[W=\frac{\left(\sum_{i=1}^{n}{a_ix_{(i)}}\right)^2}{\sum_{i=1}^{n}\left(x_i-\bar{x}\right)^2}\]</span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> is the sample mean, <em>x</em><sub>(<em>i</em>)</sub> is the <em>i</em><sup>th</sup> order statistic, and <em>a<sub>i</sub></em> is a coefficient related to expected values of <em>i.i.d.</em> normal variables. When the null hypothesis of a Shapiro-Wilk test is rejected, then there is evidence that the data are not normally distributed. The code below shows some examples of the Shapiro-Wilk test in R.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="mod-05.html#cb735-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb735-2"><a href="mod-05.html#cb735-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb735-3"><a href="mod-05.html#cb735-3" tabindex="-1"></a><span class="fu">shapiro.test</span>(x1)</span>
<span id="cb735-4"><a href="mod-05.html#cb735-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-5"><a href="mod-05.html#cb735-5" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb735-6"><a href="mod-05.html#cb735-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-7"><a href="mod-05.html#cb735-7" tabindex="-1"></a><span class="do">## data:  x1</span></span>
<span id="cb735-8"><a href="mod-05.html#cb735-8" tabindex="-1"></a><span class="do">## W = 0.96858, p-value = 0.7247</span></span>
<span id="cb735-9"><a href="mod-05.html#cb735-9" tabindex="-1"></a></span>
<span id="cb735-10"><a href="mod-05.html#cb735-10" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="dv">10</span>)</span>
<span id="cb735-11"><a href="mod-05.html#cb735-11" tabindex="-1"></a><span class="fu">shapiro.test</span>(x2)</span>
<span id="cb735-12"><a href="mod-05.html#cb735-12" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-13"><a href="mod-05.html#cb735-13" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb735-14"><a href="mod-05.html#cb735-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-15"><a href="mod-05.html#cb735-15" tabindex="-1"></a><span class="do">## data:  x2</span></span>
<span id="cb735-16"><a href="mod-05.html#cb735-16" tabindex="-1"></a><span class="do">## W = 0.90741, p-value = 0.0569</span></span>
<span id="cb735-17"><a href="mod-05.html#cb735-17" tabindex="-1"></a></span>
<span id="cb735-18"><a href="mod-05.html#cb735-18" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span>
<span id="cb735-19"><a href="mod-05.html#cb735-19" tabindex="-1"></a><span class="fu">shapiro.test</span>(x3)</span>
<span id="cb735-20"><a href="mod-05.html#cb735-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-21"><a href="mod-05.html#cb735-21" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb735-22"><a href="mod-05.html#cb735-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-23"><a href="mod-05.html#cb735-23" tabindex="-1"></a><span class="do">## data:  x3</span></span>
<span id="cb735-24"><a href="mod-05.html#cb735-24" tabindex="-1"></a><span class="do">## W = 0.9316, p-value = 0.1658</span></span>
<span id="cb735-25"><a href="mod-05.html#cb735-25" tabindex="-1"></a></span>
<span id="cb735-26"><a href="mod-05.html#cb735-26" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb735-27"><a href="mod-05.html#cb735-27" tabindex="-1"></a><span class="fu">shapiro.test</span>(x4)</span>
<span id="cb735-28"><a href="mod-05.html#cb735-28" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-29"><a href="mod-05.html#cb735-29" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb735-30"><a href="mod-05.html#cb735-30" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb735-31"><a href="mod-05.html#cb735-31" tabindex="-1"></a><span class="do">## data:  x4</span></span>
<span id="cb735-32"><a href="mod-05.html#cb735-32" tabindex="-1"></a><span class="do">## W = 0.96392, p-value = 0.007723</span></span></code></pre></div>
<p>Interestingly, the Shapiro-Wilk test turns out to be very powerful. That is, it can detect very small differences from the null hypothesis (i.e., normality) if the sample size is large enough. So, if you have data that you suspect are normal, but the Shapiro-Wilk test says otherwise, you need to visually inspect the data to determine how serious the departure from normality is. Another situation where the Shapiro-Wilk test does not perform well is when data with many repeated values. Consider the following example:</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="mod-05.html#cb736-1" tabindex="-1"></a><span class="co"># repeat each value 3 times</span></span>
<span id="cb736-2"><a href="mod-05.html#cb736-2" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">3</span>), <span class="at">each=</span><span class="dv">3</span>) </span>
<span id="cb736-3"><a href="mod-05.html#cb736-3" tabindex="-1"></a><span class="co"># P &lt; 0.05, so test says nonnormal</span></span>
<span id="cb736-4"><a href="mod-05.html#cb736-4" tabindex="-1"></a><span class="fu">shapiro.test</span>(x6) </span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x6
## W = 0.97026, p-value = 0.1502</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="mod-05.html#cb738-1" tabindex="-1"></a><span class="co"># density plot look normal!</span></span>
<span id="cb738-2"><a href="mod-05.html#cb738-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb738-3"><a href="mod-05.html#cb738-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x6))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx440-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="kolmogorov-smirnov-tests" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Kolmogorov-Smirnov tests<a href="mod-05.html#kolmogorov-smirnov-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>Kolmogorov-Smirnov (KS) test</strong> is a non-parametric test that compares a dataset to a distribution. Unlike the Shapiro-Wilk test, which only tests for normality, the KS test can compare data to any distribution. The KS test is useful because it is sensitive to differences in both location (i.e., mean) and shape. The example below illustrates the use of the KS test and plots the distributions.</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="mod-05.html#cb739-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e2</span></span>
<span id="cb739-2"><a href="mod-05.html#cb739-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb739-3"><a href="mod-05.html#cb739-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb739-4"><a href="mod-05.html#cb739-4" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">2</span>)</span>
<span id="cb739-5"><a href="mod-05.html#cb739-5" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">20</span>)</span>
<span id="cb739-6"><a href="mod-05.html#cb739-6" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">14</span>)</span>
<span id="cb739-7"><a href="mod-05.html#cb739-7" tabindex="-1"></a></span>
<span id="cb739-8"><a href="mod-05.html#cb739-8" tabindex="-1"></a><span class="co"># run KS tests:</span></span>
<span id="cb739-9"><a href="mod-05.html#cb739-9" tabindex="-1"></a><span class="fu">ks.test</span>(x1, x2)</span></code></pre></div>
<pre><code>## 
##  Asymptotic two-sample Kolmogorov-Smirnov test
## 
## data:  x1 and x2
## D = 0.12, p-value = 0.4676
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="mod-05.html#cb741-1" tabindex="-1"></a><span class="fu">ks.test</span>(x1, x3)</span></code></pre></div>
<pre><code>## 
##  Asymptotic two-sample Kolmogorov-Smirnov test
## 
## data:  x1 and x3
## D = 0.64, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="mod-05.html#cb743-1" tabindex="-1"></a><span class="fu">ks.test</span>(x3, x4)</span></code></pre></div>
<pre><code>## 
##  Asymptotic two-sample Kolmogorov-Smirnov test
## 
## data:  x3 and x4
## D = 0.41, p-value = 1.001e-07
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="mod-05.html#cb745-1" tabindex="-1"></a><span class="fu">ks.test</span>(x3, x5)</span></code></pre></div>
<pre><code>## Warning in ks.test.default(x3, x5): p-value will be approximate in the presence
## of ties</code></pre>
<pre><code>## 
##  Asymptotic two-sample Kolmogorov-Smirnov test
## 
## data:  x3 and x5
## D = 0.24, p-value = 0.006302
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="mod-05.html#cb748-1" tabindex="-1"></a><span class="co"># make a plot</span></span>
<span id="cb748-2"><a href="mod-05.html#cb748-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb748-3"><a href="mod-05.html#cb748-3" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x1)(xx)</span>
<span id="cb748-4"><a href="mod-05.html#cb748-4" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x2)(xx)</span>
<span id="cb748-5"><a href="mod-05.html#cb748-5" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x3)(xx)</span>
<span id="cb748-6"><a href="mod-05.html#cb748-6" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x4)(xx)</span>
<span id="cb748-7"><a href="mod-05.html#cb748-7" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x5)(xx)</span>
<span id="cb748-8"><a href="mod-05.html#cb748-8" tabindex="-1"></a></span>
<span id="cb748-9"><a href="mod-05.html#cb748-9" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">5</span>)</span>
<span id="cb748-10"><a href="mod-05.html#cb748-10" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb748-11"><a href="mod-05.html#cb748-11" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>,</span>
<span id="cb748-12"><a href="mod-05.html#cb748-12" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>)</span>
<span id="cb748-13"><a href="mod-05.html#cb748-13" tabindex="-1"></a><span class="fu">plot</span>(xx, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb748-14"><a href="mod-05.html#cb748-14" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ECDF&quot;</span>, <span class="at">col=</span>cols[<span class="dv">1</span>])</span>
<span id="cb748-15"><a href="mod-05.html#cb748-15" tabindex="-1"></a><span class="fu">points</span>(xx, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">2</span>])</span>
<span id="cb748-16"><a href="mod-05.html#cb748-16" tabindex="-1"></a><span class="fu">points</span>(xx, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">3</span>])</span>
<span id="cb748-17"><a href="mod-05.html#cb748-17" tabindex="-1"></a><span class="fu">points</span>(xx, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">4</span>])</span>
<span id="cb748-18"><a href="mod-05.html#cb748-18" tabindex="-1"></a><span class="fu">points</span>(xx, y5, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols[<span class="dv">5</span>])</span>
<span id="cb748-19"><a href="mod-05.html#cb748-19" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb748-20"><a href="mod-05.html#cb748-20" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;N(10,2)&quot;</span>, <span class="st">&quot;N(10,2)&quot;</span>, </span>
<span id="cb748-21"><a href="mod-05.html#cb748-21" tabindex="-1"></a>              <span class="st">&quot;N(14,2)&quot;</span>, <span class="st">&quot;N(14,20)&quot;</span>, <span class="st">&quot;Pois(14)&quot;</span>),</span>
<span id="cb748-22"><a href="mod-05.html#cb748-22" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>cols, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-418-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The KS test results show that distributions <code>x1</code> and <code>x2</code> are not different (<em>P</em> &gt; 0.05). This makes sense because they are both normal distributions with the same mean and SD. Distributions <code>x1</code> and <code>x3</code> are different (<em>P</em> &lt; 0.05) because they have different means (10 vs. 14). Distributions <code>x3</code> and <code>x4</code> were different (<em>P</em> &lt; 0.05) because they had different SD (2 vs. 20). Finally, distributions <code>x3</code> and <code>x5</code> were different (<em>P</em> &lt; 0.05) because they were different distributions with different shapes (normal vs. Poisson).</p>
<p>The KS test can be useful when you want to see how well your data matches up with their theoretical distribution. Consider the example of a lognormally distributed response below. If we suspect that the data come from a lognormal distribution or a gamma distribution, we can use the function <code>fitdistr()</code> to estimate the parameters of a lognormal and a gamma distribution that are most likely to produce those data. Then, we use a KS test to compare the data to the idealized candidates.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="mod-05.html#cb749-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb749-2"><a href="mod-05.html#cb749-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb749-3"><a href="mod-05.html#cb749-3" tabindex="-1"></a><span class="co"># estimate moments</span></span>
<span id="cb749-4"><a href="mod-05.html#cb749-4" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x1, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb749-5"><a href="mod-05.html#cb749-5" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(x1, <span class="st">&quot;gamma&quot;</span>)</span></code></pre></div>
<p>Notice that the parameters from <code>fitdistr()</code> are supplied as arguments to <code>ks.test()</code>, following the name of the distribution we want to compare to. If parameters are not supplied, then R will perform the KS test using the default parameter values (<code>meanlog=0</code> and <code>sdlog=1</code> for <code>plnorm()</code>; none for <code>pgamma()</code>), which is not what we want.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="mod-05.html#cb750-1" tabindex="-1"></a><span class="fu">ks.test</span>(x1, <span class="st">&quot;plnorm&quot;</span>, fit1<span class="sc">$</span>estimate[<span class="dv">1</span>], fit1<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  x1
## D = 0.058719, p-value = 0.8808
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="mod-05.html#cb752-1" tabindex="-1"></a><span class="fu">ks.test</span>(x1, <span class="st">&quot;pgamma&quot;</span>, <span class="at">shape=</span>fit2<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb752-2"><a href="mod-05.html#cb752-2" tabindex="-1"></a>        <span class="at">rate=</span>fit2<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  x1
## D = 0.16211, p-value = 0.01043
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="mod-05.html#cb754-1" tabindex="-1"></a><span class="co"># plot x1 and its theoretical distribution</span></span>
<span id="cb754-2"><a href="mod-05.html#cb754-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x1), <span class="fu">max</span>(x1), <span class="at">length=</span><span class="dv">500</span>)</span>
<span id="cb754-3"><a href="mod-05.html#cb754-3" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x1)(xx)</span>
<span id="cb754-4"><a href="mod-05.html#cb754-4" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">plnorm</span>(xx, fit1<span class="sc">$</span>estimate[<span class="dv">1</span>], fit1<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb754-5"><a href="mod-05.html#cb754-5" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">pgamma</span>(xx, <span class="at">shape=</span>fit2<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">rate=</span>fit2<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb754-6"><a href="mod-05.html#cb754-6" tabindex="-1"></a></span>
<span id="cb754-7"><a href="mod-05.html#cb754-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb754-8"><a href="mod-05.html#cb754-8" tabindex="-1"></a>    <span class="at">las=</span><span class="dv">1</span>, <span class="at">lend=</span><span class="dv">1</span>, <span class="at">cex.axis=</span><span class="fl">1.2</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>)</span>
<span id="cb754-9"><a href="mod-05.html#cb754-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(xx), y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;log(X)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ECDF&quot;</span>)</span>
<span id="cb754-10"><a href="mod-05.html#cb754-10" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">log</span>(xx), y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb754-11"><a href="mod-05.html#cb754-11" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">log</span>(xx), y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb754-12"><a href="mod-05.html#cb754-12" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb754-13"><a href="mod-05.html#cb754-13" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Lognormal&quot;</span>, <span class="st">&quot;Gamma&quot;</span>),</span>
<span id="cb754-14"><a href="mod-05.html#cb754-14" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb754-15"><a href="mod-05.html#cb754-15" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb754-16"><a href="mod-05.html#cb754-16" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb754-17"><a href="mod-05.html#cb754-17" tabindex="-1"></a>       <span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-420-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>While neither the lognormal distribution nor the gamma distribution are awful at representing the data, the KS test suggests that the simulated data <code>x1</code> come from a lognormal distribution, not a gamma distribution. This is because the KS test was non-significant when comparing the data to the lognormal, and significant (<em>P</em> &lt; 0.05) when comparing the data to the gamma distribution. The test comparing the data to the gamma distribution was, however, close to non-significant (<em>P</em> <span class="math inline">\(\approx\)</span> 0.01). See what happens if you change the random number seed and re-run the random generation and the test.</p>
</div>
</div>
<div id="mod-05-trans" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Data transformations<a href="mod-05.html#mod-05-trans" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data transformation is the proces of changing the values in your data according to a function. This is usually done to make the data better conform to the assumptions of a statistical test, or to make graphs easier to interpret. Transformation is done to make patterns easier to detect. In many fields transformations may be standard practice, and with good reason. Just make sure that you understand what the transform function is doing, and most importantly, why you are transforming your data.</p>
<div id="why-transform" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Why transform?<a href="mod-05.html#why-transform" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Data transformation</strong> is the process changing the values of your data according to a function. This is usually done so that the data better conform to the assumptions of a statistical test, or to make graphs of your data more interpretable. The functions that transform data are usually called “transforms”. There are many transforms out there, but only a few are very common in biology. All convert values on the <strong>original scale</strong> to values on the <strong>transformed scale</strong>. Variables often have different properties after a transformation, such as normality, or a different domain, or a different distribution shape. In general, a function for transforming data should be <strong>deterministic</strong> and <strong>invertible</strong>:</p>
<ul>
<li><strong>Deterministic:</strong> means that the function always returns the same transformed value for a given input.</li>
<li><strong>Invertible:</strong> means that values on the transformed scale can be converted unambiguously to values on the original scale.</li>
</ul>
<p>Data transformations are commonly used to make data fit certain distributions. For example, consider the figure below:</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="mod-05.html#cb755-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="fl">1.5</span>, <span class="dv">2</span>)</span>
<span id="cb755-2"><a href="mod-05.html#cb755-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb755-3"><a href="mod-05.html#cb755-3" tabindex="-1"></a><span class="fu">hist</span>(a)</span>
<span id="cb755-4"><a href="mod-05.html#cb755-4" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(a))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-421-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The left panel shows data with mostly small values and a strong positive skew. The right panel shows the same data on the log scale. Notice how the log-transformed values look much more like a normal distribution. This is very important for many statistical methods, which require normality either in the values or in the residuals. The log-transformed plot also lets us see more details about the distribution that are obscured on the original scale.</p>
</div>
<div id="transforms-vs.-link-functions" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Transforms vs. link functions<a href="mod-05.html#transforms-vs.-link-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <a href="mod-10.html#mod-10-basic">generalized linear models (GLM)</a> the response variable is modeled on a scale defined by a <strong>link function</strong>. That link function works a little like a transform, and is often confused with a transform, but it is not a transform. The figure below shows an example of this: the response variable on its original scale (right panel), a proportion, is analyzed on the logit scale (left panel). The ranks of observations do not change, but their values do. Additionally, putting the values on another scale can affect the variance of those values.</p>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-422-1.png" width="768" /></p>
<p><em>GLM link functions are not transforms because the variance is still modeled on the original scale</em>. However, when data are transformed and then analyzed, the variance is modeled on the transformed scale. The equations below show the differences between a Gaussian GLM with a link function and an ordinary linear model on transformed data. Notice the difference in how each model includes stochasticity.</p>
<p><strong>Linear model (LM) with transformation</strong></p>
<p><span class="math display">\[y_i = e^{z_i}\]</span>
<span class="math display">\[ z_i \sim Normal\left(\eta_i,\sigma^2 \right)\]</span>
<span class="math display">\[\eta_i = f\left(\theta \right)\]</span></p>
<p><strong>Generalized linear model (GLM) with link function</strong></p>
<p><span class="math display">\[y_i \sim Normal\left(z_i,\sigma^2 \right)\]</span>
<span class="math display">\[z_i = e^{\eta_i}\]</span>
<span class="math display">\[\eta_i = f\left(\theta \right)\]</span></p>
<p>In the LM, the expected value <span class="math inline">\(\eta_i\)</span> and its variance are both on the log scale. In the GLM, <span class="math inline">\(\eta_i\)</span> is on the log scale but the variance in observed values is not. This difference can have important consequences on the estimates of a statistical model. See the example <a href="mod-10.html#mod-10-loglin-examp">here</a> for a worked example.</p>
</div>
<div id="common-transformations" class="section level3 hasAnchor" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> Common transformations<a href="mod-05.html#common-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="log-transformation" class="section level4 hasAnchor" number="5.7.3.1">
<h4><span class="header-section-number">5.7.3.1</span> Log transformation<a href="mod-05.html#log-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>log-transform</strong> is one of the most common transforms in biology. It is simply the <strong>logarithm of the values</strong>. Recall that the logarithm is the inverse of exponentiation: if <span class="math inline">\(a=b^c\)</span>, then <span class="math inline">\(log_b\left(a \right)=c\)</span>. For example, <span class="math inline">\(log_2 \left(8\right)=3\)</span> because <span class="math inline">\(2^3 = 8\)</span>. Most biologists use either the natural logarithm (<strong>log<sub><em>e</em></sub></strong>, <strong>ln</strong> or just <strong>log</strong>) or the base-10 logarithm (log<sub>10</sub>). The choice of base is not that important, because any log-transform will accomplish the same effect. The default in math and statistics (and in R) is the natural logarithm. Log<sub>10</sub> is also very common in biology and engineering. It is sometimes called the “common log”, but most people just say “log 10” when referring to this function. Whatever base you use, just be consistent and make it clear to your audience what you did<a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a>. It is depressingly common to be unable to use values from old papers because they didn’t specify which base logarithm they used.</p>
<p>There are usually two reasons to use a log-transform: normalization (i.e., variance stabilization) and positivity. As seen above, many variables that appear non-normal turn out to be normally distributed on a logarithmic scale. This often occurs when something about the values is multiplicative in nature. For example, body sizes, population sizes, and bank account balances are often log-normally distributed. This is because these quantities tend to grow at a rate that is proportional to their current size<a href="#fn52" class="footnote-ref" id="fnref52"><sup>52</sup></a>. Transforming to the logarithmic scale changes multiplicative changes to additive changes. The figure below shows how values separated by a factor of 2 on the linear scale map to values separated by 1 (i.e., 20) on the log<sub>2</sub> scale. Values separated by a common <em>scaling</em> factor on the original scale are mapped to values separated by a common <em>additive</em> constant on the log scale<a href="#fn53" class="footnote-ref" id="fnref53"><sup>53</sup></a>.</p>
<p><img src="05_01.jpg" width="100%" style="display: block; margin: auto;" /></p>
<p>As a side effect of this normalization, log-transformation allows researchers to work with variables that vary over several orders of magnitude. This is because scalar multiplication on the untransformed scale is the same as addition on the log-transformed scale<a href="#fn54" class="footnote-ref" id="fnref54"><sup>54</sup></a>. The figure below shows how values ranging from 0.001 to 1000 (spanning 6 orders of magnitude) can be managed on the log-transformed scale.</p>
<p><img src="05_02.jpg" width="100%" style="display: block; margin: auto;" /></p>
<p>The second reason that the log-transform is commonly used is to ensure that values are always positive. One of the properties of the exponential function is that for any positive base, raising that base to a real power will always return a positive result. For this reason, it is common practice to analyze variables with a positive domain on the logarithmic scale. Such variables include lengths, masses, and counts, which must be positive or non-negative. Log transformation can ensure that your analysis does not predict impossibilities like negative masses.</p>
<p>Values in a data frame can be log-transformed with the <code>log()</code> (natural log) or <code>log10()</code> (log<sub>10</sub>) function. Other bases can be used via arguments to the <code>log()</code> function (e.g., <code>log(8,base=2)</code>). It is usually a good idea to keep the transformed values in their own variable, rather than overwriting the original values. This way you can quickly access the original values without having to back-transform. It is often useful to have the original values around for making figures. Keeping the original values also means you don’t have to remember whether a variable or object contains the original or transformed values.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="mod-05.html#cb756-1" tabindex="-1"></a><span class="co"># spare copy:</span></span>
<span id="cb756-2"><a href="mod-05.html#cb756-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris</span>
<span id="cb756-3"><a href="mod-05.html#cb756-3" tabindex="-1"></a></span>
<span id="cb756-4"><a href="mod-05.html#cb756-4" tabindex="-1"></a><span class="co"># natural log transform:</span></span>
<span id="cb756-5"><a href="mod-05.html#cb756-5" tabindex="-1"></a>x<span class="sc">$</span>log.petal.len <span class="ot">&lt;-</span> <span class="fu">log</span>(x<span class="sc">$</span>Petal.Length)</span>
<span id="cb756-6"><a href="mod-05.html#cb756-6" tabindex="-1"></a></span>
<span id="cb756-7"><a href="mod-05.html#cb756-7" tabindex="-1"></a><span class="co"># log base 10 transform:</span></span>
<span id="cb756-8"><a href="mod-05.html#cb756-8" tabindex="-1"></a>x<span class="sc">$</span>log.petal.wid <span class="ot">&lt;-</span> <span class="fu">log10</span>(x<span class="sc">$</span>Petal.Width)</span></code></pre></div>
<p>You can also log-transform many variables at once using the function <code>apply()</code>. In a data frame this means <code>apply</code>-ing the <code>log()</code> function to multiple columns (margin 2).</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="mod-05.html#cb757-1" tabindex="-1"></a><span class="co"># load the dataset from package MASS</span></span>
<span id="cb757-2"><a href="mod-05.html#cb757-2" tabindex="-1"></a><span class="fu">data</span>(crabs, <span class="at">package=</span><span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb757-3"><a href="mod-05.html#cb757-3" tabindex="-1"></a></span>
<span id="cb757-4"><a href="mod-05.html#cb757-4" tabindex="-1"></a><span class="co"># make a spare copy</span></span>
<span id="cb757-5"><a href="mod-05.html#cb757-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> crabs</span>
<span id="cb757-6"><a href="mod-05.html#cb757-6" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##   sp sex index   FL  RW   CL   CW  BD
## 1  B   M     1  8.1 6.7 16.1 19.0 7.0
## 2  B   M     2  8.8 7.7 18.1 20.8 7.4
## 3  B   M     3  9.2 7.8 19.0 22.4 7.7
## 4  B   M     4  9.6 7.9 20.1 23.1 8.2
## 5  B   M     5  9.8 8.0 20.3 23.0 8.2
## 6  B   M     6 10.8 9.0 23.0 26.5 9.8</code></pre>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="mod-05.html#cb759-1" tabindex="-1"></a><span class="co"># overwrite (transform in place)</span></span>
<span id="cb759-2"><a href="mod-05.html#cb759-2" tabindex="-1"></a><span class="co"># (ok but can cause headaches later)</span></span>
<span id="cb759-3"><a href="mod-05.html#cb759-3" tabindex="-1"></a>x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">2</span>, log)</span>
<span id="cb759-4"><a href="mod-05.html#cb759-4" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##   sp sex index       FL       RW       CL       CW       BD
## 1  B   M     1 2.091864 1.902108 2.778819 2.944439 1.945910
## 2  B   M     2 2.174752 2.041220 2.895912 3.034953 2.001480
## 3  B   M     3 2.219203 2.054124 2.944439 3.109061 2.041220
## 4  B   M     4 2.261763 2.066863 3.000720 3.139833 2.104134
## 5  B   M     5 2.282382 2.079442 3.010621 3.135494 2.104134
## 6  B   M     6 2.379546 2.197225 3.135494 3.277145 2.282382</code></pre>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="mod-05.html#cb761-1" tabindex="-1"></a><span class="co"># better way:</span></span>
<span id="cb761-2"><a href="mod-05.html#cb761-2" tabindex="-1"></a><span class="co"># make new variables and </span></span>
<span id="cb761-3"><a href="mod-05.html#cb761-3" tabindex="-1"></a><span class="co"># add to original data frame (better)</span></span>
<span id="cb761-4"><a href="mod-05.html#cb761-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> crabs</span>
<span id="cb761-5"><a href="mod-05.html#cb761-5" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">apply</span>(x[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">2</span>, log)</span>
<span id="cb761-6"><a href="mod-05.html#cb761-6" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(z)</span>
<span id="cb761-7"><a href="mod-05.html#cb761-7" tabindex="-1"></a><span class="fu">names</span>(z) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(z), <span class="st">&quot;log&quot;</span>, <span class="at">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb761-8"><a href="mod-05.html#cb761-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,z)</span>
<span id="cb761-9"><a href="mod-05.html#cb761-9" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##   sp sex index   FL  RW   CL   CW  BD   FL.log   RW.log   CL.log   CW.log
## 1  B   M     1  8.1 6.7 16.1 19.0 7.0 2.091864 1.902108 2.778819 2.944439
## 2  B   M     2  8.8 7.7 18.1 20.8 7.4 2.174752 2.041220 2.895912 3.034953
## 3  B   M     3  9.2 7.8 19.0 22.4 7.7 2.219203 2.054124 2.944439 3.109061
## 4  B   M     4  9.6 7.9 20.1 23.1 8.2 2.261763 2.066863 3.000720 3.139833
## 5  B   M     5  9.8 8.0 20.3 23.0 8.2 2.282382 2.079442 3.010621 3.135494
## 6  B   M     6 10.8 9.0 23.0 26.5 9.8 2.379546 2.197225 3.135494 3.277145
##     BD.log
## 1 1.945910
## 2 2.001480
## 3 2.041220
## 4 2.104134
## 5 2.104134
## 6 2.282382</code></pre>
</div>
<div id="log-transforming-with-0-values" class="section level4 hasAnchor" number="5.7.3.2">
<h4><span class="header-section-number">5.7.3.2</span> Log transforming with 0 values<a href="mod-05.html#log-transforming-with-0-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One problem that comes up with log-transformation is what to do with values of 0. The logarithm of 0 is undefined, and returns <span class="math inline">\(-\infty\)</span> in R. This is usually a problem with counts, rather than with measurements. The simplest solution is to add a small constant to the values before transforming. If the smallest nonzero value is 1, then it is easiest to just add 1 to the values:</p>
<p><span class="math display">\[y_i=\log{\left(x_i+1\right)}\]</span></p>
<p>Where <em>x<sub>i</sub></em> is the original value and <em>y<sub>i</sub></em> is the transformed value (i.e., <span class="math inline">\(f\left(x_i\right)\)</span>). Again, this works just fine if the smallest nonzero is about 1. Values between 0 and 1 can cause problems. Adding 1 to these values before log-transforming will tend to compress the lower end of the distribution and expand the upper end of the distribution. The R commands below show this:</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="mod-05.html#cb763-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.003</span>, <span class="fl">0.03</span>, <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="fl">1.3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">99</span>)</span>
<span id="cb763-2"><a href="mod-05.html#cb763-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">log</span>(x<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb763-3"><a href="mod-05.html#cb763-3" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx450-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>If the smallest nonzero value differs from 1 by more than an order of magnitude (i.e., <span class="math inline">\(\ge\)</span> 10 or <span class="math inline">\(\le\)</span> 0.1), then a slightly different procedure is called for. The transformation below generalizes the “log of <em>x</em>+1” method in such a way as to result in 0 for 0 values and somewhat preserve the original orders of magnitude <span class="citation">(<a href="#ref-mccune2002analysis">McCune et al. 2002</a>)</span>.</p>
<p><span class="math display">\[y_i=\log{\left(x_i+d\right)}-c\]</span></p>
<p>In this equation:</p>
<p><span class="math display">\[\begin{matrix}c=&amp;Trunc\left(\log{\left(min\left(x\right)\right)}\right)\\d=&amp;e^c\\min\left(x\right)=&amp;smallest\ nonzero\ x\\Trunc\left(x\right)=&amp;function\ that\ truncates\ x\ to\ an\ integer\\\end{matrix}\]</span></p>
<p>This can be implemented in R using the following custom function:</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="mod-05.html#cb764-1" tabindex="-1"></a>mgtrans <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb764-2"><a href="mod-05.html#cb764-2" tabindex="-1"></a>    minx <span class="ot">&lt;-</span> <span class="fu">min</span>(x[x <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb764-3"><a href="mod-05.html#cb764-3" tabindex="-1"></a>    cons <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="fu">log</span>(minx))</span>
<span id="cb764-4"><a href="mod-05.html#cb764-4" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="fu">exp</span>(cons)) <span class="sc">-</span> cons</span>
<span id="cb764-5"><a href="mod-05.html#cb764-5" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb764-6"><a href="mod-05.html#cb764-6" tabindex="-1"></a>}</span>
<span id="cb764-7"><a href="mod-05.html#cb764-7" tabindex="-1"></a></span>
<span id="cb764-8"><a href="mod-05.html#cb764-8" tabindex="-1"></a><span class="co"># example usage:</span></span>
<span id="cb764-9"><a href="mod-05.html#cb764-9" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">rlnorm</span>(<span class="dv">9</span>))</span>
<span id="cb764-10"><a href="mod-05.html#cb764-10" tabindex="-1"></a><span class="fu">log</span>(a)</span></code></pre></div>
<pre><code>##  [1]         -Inf  1.025571370 -0.284773007 -1.220717712  0.181303480
##  [6] -0.138891362  0.005764186  0.385280401 -0.370660032  0.644376549</code></pre>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="mod-05.html#cb766-1" tabindex="-1"></a><span class="fu">mgtrans</span>(a)</span></code></pre></div>
<pre><code>##  [1] 0.0000000 2.1494853 1.1133862 0.5888655 1.4489449 1.2136603 1.3174789
##  [8] 1.6086268 1.0565297 1.8209591</code></pre>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="mod-05.html#cb768-1" tabindex="-1"></a><span class="co"># count the points:</span></span>
<span id="cb768-2"><a href="mod-05.html#cb768-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb768-3"><a href="mod-05.html#cb768-3" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="fu">log</span>(a))     <span class="co"># missing one!</span></span>
<span id="cb768-4"><a href="mod-05.html#cb768-4" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="fu">mgtrans</span>(a))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-427-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Note that if you use the McCune and Grace transform, you should keep the original values around for plotting because back-transforming can be tricky (if not impossible, if you don’t know <em>d</em> and <em>c</em>). If you are going to back-transform other values, such as model predictions, you will need to know <em>d</em> and <em>c</em>.</p>
<p>The example below shows how the McCune and Grace transform can be advantageous. First, we create 1000 random values from a lognormal distribution. Then, randomly set 100 of the values to 0. Log-transforming the data to acheive normality comes at the cost of losing 10% of the values because <code>log(0)</code> is undefined (left panel). The <span class="math inline">\(log\left(x+1\right)\)</span> transform retains all of the values, but distorts the shape of the distribution (middle panel) because many values are between 0 and 1. The McCune and Grace method (right panel) achieves normality (mostly) <em>and</em> retains all values.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="mod-05.html#cb769-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb769-2"><a href="mod-05.html#cb769-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb769-3"><a href="mod-05.html#cb769-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(n, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb769-4"><a href="mod-05.html#cb769-4" tabindex="-1"></a>x[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb769-5"><a href="mod-05.html#cb769-5" tabindex="-1"></a></span>
<span id="cb769-6"><a href="mod-05.html#cb769-6" tabindex="-1"></a></span>
<span id="cb769-7"><a href="mod-05.html#cb769-7" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb769-8"><a href="mod-05.html#cb769-8" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">log</span>(x<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb769-9"><a href="mod-05.html#cb769-9" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">mgtrans</span>(x)</span>
<span id="cb769-10"><a href="mod-05.html#cb769-10" tabindex="-1"></a></span>
<span id="cb769-11"><a href="mod-05.html#cb769-11" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.finite</span>(t1)))</span></code></pre></div>
<pre><code>## [1] 900</code></pre>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="mod-05.html#cb771-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">cex.main=</span><span class="fl">1.2</span>)</span>
<span id="cb771-2"><a href="mod-05.html#cb771-2" tabindex="-1"></a><span class="fu">hist</span>(t1, <span class="at">main=</span><span class="fu">expression</span>(Log<span class="sc">~</span>transform<span class="sc">~</span>(<span class="fu">italic</span>(n)<span class="sc">==</span><span class="dv">900</span>)))</span>
<span id="cb771-3"><a href="mod-05.html#cb771-3" tabindex="-1"></a><span class="fu">hist</span>(t2, <span class="at">main=</span><span class="fu">expression</span>(Log<span class="sc">~</span>(<span class="fu">italic</span>(x)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">~</span>transform<span class="sc">~</span>(<span class="fu">italic</span>(n)<span class="sc">==</span><span class="dv">1000</span>)))</span>
<span id="cb771-4"><a href="mod-05.html#cb771-4" tabindex="-1"></a><span class="fu">hist</span>(t3, <span class="at">main=</span><span class="fu">expression</span>(McCune<span class="sc">-</span>Grace<span class="sc">~</span>transform<span class="sc">~</span>(<span class="fu">italic</span>(n)<span class="sc">==</span><span class="dv">1000</span>)))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-428-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The spike in the right histogram comes from the fact that the McCune and Grace method maps values of 0 to 0.</p>
</div>
<div id="rank-transformation" class="section level4 hasAnchor" number="5.7.3.3">
<h4><span class="header-section-number">5.7.3.3</span> Rank transformation<a href="mod-05.html#rank-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>rank transform</strong> is just what it sounds like: replacing original values with their ranks. In R the function <code>rank()</code> does just that. Smaller values having smaller ranks and greater values having greater ranks. The smallest value has rank = 1, and the largest value has a rank equal to the number of values. That is, for any vector x <code>rank(x)[x==min(x)]</code> = 1 and <code>rank(x)[x==max(x)]</code> = <code>length(x)</code>.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="mod-05.html#cb772-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb772-2"><a href="mod-05.html#cb772-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rank</span>(x)</span>
<span id="cb772-3"><a href="mod-05.html#cb772-3" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-429-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Notice how the transformed variables <code>y</code> are evenly spaced while the original values are not. This can be useful if values are very “clumped” or “spread out”. Rank transforms are commonly used in nonparametric procedures. Note that the <code>rank()</code> function may return fractional or repeated ranks if there are ties:</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="mod-05.html#cb773-1" tabindex="-1"></a><span class="co"># make some random values</span></span>
<span id="cb773-2"><a href="mod-05.html#cb773-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb773-3"><a href="mod-05.html#cb773-3" tabindex="-1"></a></span>
<span id="cb773-4"><a href="mod-05.html#cb773-4" tabindex="-1"></a><span class="co"># force a tie</span></span>
<span id="cb773-5"><a href="mod-05.html#cb773-5" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb773-6"><a href="mod-05.html#cb773-6" tabindex="-1"></a></span>
<span id="cb773-7"><a href="mod-05.html#cb773-7" tabindex="-1"></a><span class="co"># fractional ranks for ties:</span></span>
<span id="cb773-8"><a href="mod-05.html#cb773-8" tabindex="-1"></a><span class="fu">rank</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1.5  1.5  4.0  6.0  7.0  9.0  5.0 10.0  8.0  3.0</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="mod-05.html#cb775-1" tabindex="-1"></a><span class="co"># force a three-way tie:</span></span>
<span id="cb775-2"><a href="mod-05.html#cb775-2" tabindex="-1"></a>x[<span class="dv">3</span>] <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb775-3"><a href="mod-05.html#cb775-3" tabindex="-1"></a></span>
<span id="cb775-4"><a href="mod-05.html#cb775-4" tabindex="-1"></a><span class="co"># repeated ranks:</span></span>
<span id="cb775-5"><a href="mod-05.html#cb775-5" tabindex="-1"></a><span class="fu">rank</span>(x)</span></code></pre></div>
<pre><code>##  [1]  2  2  2  6  7  9  5 10  8  4</code></pre>
</div>
<div id="mod-05-logit" class="section level4 hasAnchor" number="5.7.3.4">
<h4><span class="header-section-number">5.7.3.4</span> Logit and probit transformations<a href="mod-05.html#mod-05-logit" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>logit transformation</strong> and <strong>probit transformation</strong> are used to map proportions to the real number line. Often this changes proportions into something resembling a normal distribution.</p>
<p>The <strong>logit</strong> is defined as the <em>logarithm of the odds ratio</em>. Its inverse (back-transformation function) is the <strong>logistic function</strong>. For any value <em>x</em> in the open interval<a href="#fn55" class="footnote-ref" id="fnref55"><sup>55</sup></a> (0, 1), the logit is calculated as:</p>
<p><span class="math display">\[logit\left(x\right)=\log{\left(\frac{x}{1-x}\right)}\]</span></p>
<p>If <em>x</em> is a probability or proportion, then logit(<em>x</em>) is also the logarithm of the odds ratio. For this reason, the logit is also called the “log-odds”. The logit function is also the inverse of the logistic function. The logistic function of a variable <em>x</em> is:</p>
<p><span class="math display">\[logistic\left(x\right)=\frac{e^x}{e^x+1}=\frac{1}{1+e^{-x}}\]</span></p>
<p>The figure below shows the relationship between the logit and logistic functions:</p>
<p><img src="05_03.jpg" width="100%" style="display: block; margin: auto;" /></p>
<p>The logit transformation has the effect of stretching out the ends of a distribution, while keeping the relationship between the original and transformed values roughly linear near the middle of the distribution. The logit transformation can be accomplished in R using the function <code>qlogis()</code>; its inverse, the logistic function, is <code>plogis()</code>.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="mod-05.html#cb777-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span><span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb777-2"><a href="mod-05.html#cb777-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(x)</span>
<span id="cb777-3"><a href="mod-05.html#cb777-3" tabindex="-1"></a></span>
<span id="cb777-4"><a href="mod-05.html#cb777-4" tabindex="-1"></a><span class="co"># compare:</span></span>
<span id="cb777-5"><a href="mod-05.html#cb777-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb777-6"><a href="mod-05.html#cb777-6" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb777-7"><a href="mod-05.html#cb777-7" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-432-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Why is this useful? The logistic function takes any real input and outputs a value between 0 and 1. This means that the logit function takes values between 0 and 1 and outputs a real number. The example below shows how this can be applied to analyze proportions:</p>
<p>The first figure below shows how analyzing proportions with linear models leads to clearly inappropriate results. The predicted values of the model extend well outside the possible range of a probability.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="mod-05.html#cb778-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb778-2"><a href="mod-05.html#cb778-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb778-3"><a href="mod-05.html#cb778-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb778-4"><a href="mod-05.html#cb778-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.75</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb778-5"><a href="mod-05.html#cb778-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">plogis</span>(z)</span>
<span id="cb778-6"><a href="mod-05.html#cb778-6" tabindex="-1"></a></span>
<span id="cb778-7"><a href="mod-05.html#cb778-7" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb778-8"><a href="mod-05.html#cb778-8" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb778-9"><a href="mod-05.html#cb778-9" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>px), <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb778-10"><a href="mod-05.html#cb778-10" tabindex="-1"></a>mn <span class="ot">&lt;-</span> pred<span class="sc">$</span>fit</span>
<span id="cb778-11"><a href="mod-05.html#cb778-11" tabindex="-1"></a>lo <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, mn, pred<span class="sc">$</span>se.fit) </span>
<span id="cb778-12"><a href="mod-05.html#cb778-12" tabindex="-1"></a>up <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, mn, pred<span class="sc">$</span>se.fit)</span>
<span id="cb778-13"><a href="mod-05.html#cb778-13" tabindex="-1"></a></span>
<span id="cb778-14"><a href="mod-05.html#cb778-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb778-15"><a href="mod-05.html#cb778-15" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.3</span>))</span>
<span id="cb778-16"><a href="mod-05.html#cb778-16" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb778-17"><a href="mod-05.html#cb778-17" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb778-18"><a href="mod-05.html#cb778-18" tabindex="-1"></a><span class="fu">points</span>(px, mn, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb778-19"><a href="mod-05.html#cb778-19" tabindex="-1"></a><span class="fu">points</span>(px, lo, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb778-20"><a href="mod-05.html#cb778-20" tabindex="-1"></a><span class="fu">points</span>(px, up, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-433-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The linear model predicts probabilities (<code>y</code>) less than 0 and greater than 1, so clearly it is inappropriate for analyzing probabilities. However, applying a logit transform to the data for analysis (and later back-transforming using the logistic function) can allow you to analyze proportions. Another (and sometimes better way) to accomplish this is to use a <a href="mod-10.html#mod-10-logistic">GLM with binomial family and logit link</a>.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="mod-05.html#cb779-1" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(y)</span>
<span id="cb779-2"><a href="mod-05.html#cb779-2" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2<span class="sc">~</span>x)</span>
<span id="cb779-3"><a href="mod-05.html#cb779-3" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span>px), <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb779-4"><a href="mod-05.html#cb779-4" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> pred2<span class="sc">$</span>fit</span>
<span id="cb779-5"><a href="mod-05.html#cb779-5" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, mn2, pred2<span class="sc">$</span>se.fit) </span>
<span id="cb779-6"><a href="mod-05.html#cb779-6" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, mn2, pred2<span class="sc">$</span>se.fit)</span>
<span id="cb779-7"><a href="mod-05.html#cb779-7" tabindex="-1"></a><span class="co"># backtransform</span></span>
<span id="cb779-8"><a href="mod-05.html#cb779-8" tabindex="-1"></a>mn2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(mn2)</span>
<span id="cb779-9"><a href="mod-05.html#cb779-9" tabindex="-1"></a>lo2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(lo2)</span>
<span id="cb779-10"><a href="mod-05.html#cb779-10" tabindex="-1"></a>up2 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(up2)</span>
<span id="cb779-11"><a href="mod-05.html#cb779-11" tabindex="-1"></a></span>
<span id="cb779-12"><a href="mod-05.html#cb779-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb779-13"><a href="mod-05.html#cb779-13" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.3</span>))</span>
<span id="cb779-14"><a href="mod-05.html#cb779-14" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb779-15"><a href="mod-05.html#cb779-15" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb779-16"><a href="mod-05.html#cb779-16" tabindex="-1"></a><span class="fu">points</span>(px, mn, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb779-17"><a href="mod-05.html#cb779-17" tabindex="-1"></a><span class="fu">points</span>(px, lo, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb779-18"><a href="mod-05.html#cb779-18" tabindex="-1"></a><span class="fu">points</span>(px, up, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb779-19"><a href="mod-05.html#cb779-19" tabindex="-1"></a><span class="fu">points</span>(px, mn2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb779-20"><a href="mod-05.html#cb779-20" tabindex="-1"></a><span class="fu">points</span>(px, lo2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb779-21"><a href="mod-05.html#cb779-21" tabindex="-1"></a><span class="fu">points</span>(px, up2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb779-22"><a href="mod-05.html#cb779-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb779-23"><a href="mod-05.html#cb779-23" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Logit-transformed&quot;</span>),</span>
<span id="cb779-24"><a href="mod-05.html#cb779-24" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">bg=</span><span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-434-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The downside of the logit transform is that it is undefined at at 0 and 1 (it approaches <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(+\infty\)</span> as the inputs approach 0 and 1). One workaround is to add a small constant to avoid taking log(0) or dividing by 0 <span class="citation">(<a href="#ref-mccune2002analysis">McCune et al. 2002</a>, <a href="#ref-warton2011">Warton and Hui 2011</a>)</span>. The latter reference suggests adding the minimum non-zero value. You could also censor the values to be arbitrarily close to 0 or 1: for example, set all values &lt;0.001 to 0.001 and all values &gt; 0.999 to 0.999. This practice is sometimes called “stabilizing the logit” <span class="citation">(<a href="#ref-kery2010">Kéry 2010</a>)</span>.</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="mod-05.html#cb780-1" tabindex="-1"></a><span class="co"># change some values in y to 1 and 0</span></span>
<span id="cb780-2"><a href="mod-05.html#cb780-2" tabindex="-1"></a>y[<span class="fu">which.max</span>(y)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb780-3"><a href="mod-05.html#cb780-3" tabindex="-1"></a>y[<span class="fu">which.min</span>(y)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb780-4"><a href="mod-05.html#cb780-4" tabindex="-1"></a></span>
<span id="cb780-5"><a href="mod-05.html#cb780-5" tabindex="-1"></a><span class="co"># logit transformed values include infinities!</span></span>
<span id="cb780-6"><a href="mod-05.html#cb780-6" tabindex="-1"></a><span class="fu">qlogis</span>(y)</span></code></pre></div>
<pre><code>##  [1] -2.5298619  3.7500756  0.2207000  2.4844936  5.3073196 -2.2318620
##  [7]  0.6657197  4.5882685  2.0138961  1.2461916  4.8648903  0.9539238
## [13]  2.0198681  0.9887879 -2.6085359  3.0539803 -1.3622593       -Inf
## [19]  1.6283614  5.3667394  2.5484363  1.7931407  1.3371457  5.2369884
## [25]  1.8344244  2.5672970  1.0519484  1.4131947  0.5373003 -2.1224186
## [31]        Inf  2.2184900  2.7649033  3.0898599 -2.5994558  0.9631093
## [37]  2.1861231 -1.7101479 -1.6322178 -2.3345978 -1.6254712  0.5573073
## [43]  0.1559367  0.6886083  0.1934203 -2.4499857 -3.5614131  1.5004569
## [49] -1.7144060  2.7456992</code></pre>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="mod-05.html#cb782-1" tabindex="-1"></a><span class="co"># stabilize logit by setting max to 0.999 and min to 0.001</span></span>
<span id="cb782-2"><a href="mod-05.html#cb782-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fl">0.999</span>, y)</span>
<span id="cb782-3"><a href="mod-05.html#cb782-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fl">0.001</span>, y)</span>
<span id="cb782-4"><a href="mod-05.html#cb782-4" tabindex="-1"></a><span class="fu">qlogis</span>(y)</span></code></pre></div>
<pre><code>##  [1] -2.5298619  3.7500756  0.2207000  2.4844936  5.3073196 -2.2318620
##  [7]  0.6657197  4.5882685  2.0138961  1.2461916  4.8648903  0.9539238
## [13]  2.0198681  0.9887879 -2.6085359  3.0539803 -1.3622593 -6.9067548
## [19]  1.6283614  5.3667394  2.5484363  1.7931407  1.3371457  5.2369884
## [25]  1.8344244  2.5672970  1.0519484  1.4131947  0.5373003 -2.1224186
## [31]  6.9067548  2.2184900  2.7649033  3.0898599 -2.5994558  0.9631093
## [37]  2.1861231 -1.7101479 -1.6322178 -2.3345978 -1.6254712  0.5573073
## [43]  0.1559367  0.6886083  0.1934203 -2.4499857 -3.5614131  1.5004569
## [49] -1.7144060  2.7456992</code></pre>
<p>The probit function is similar to the logit function, is used in similar situations, and produces similar results, but uses the CDF of the standard normal distribution instead of the logit function. The probit function is given by:</p>
<p><span class="math display">\[
probit\left(x\right)=\left(\sqrt2\right){erf}^{-1}\left(2x-1\right)=\left(\sqrt2\right)\left(\frac{2}{\sqrt\pi}\right)\int_{0}^{2x-1}{e^{-t^2}dt}\]</span></p>
<p>The R command for the probit function is <code>qnorm()</code>. As you might suspect, the inverse function is <code>pnorm()</code>.</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="mod-05.html#cb784-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span></span>
<span id="cb784-2"><a href="mod-05.html#cb784-2" tabindex="-1"></a>x.log <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb784-3"><a href="mod-05.html#cb784-3" tabindex="-1"></a>x.prb <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span><span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb784-4"><a href="mod-05.html#cb784-4" tabindex="-1"></a></span>
<span id="cb784-5"><a href="mod-05.html#cb784-5" tabindex="-1"></a><span class="fu">plot</span>(x, x.log, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb784-6"><a href="mod-05.html#cb784-6" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;f(x)&quot;</span>)</span>
<span id="cb784-7"><a href="mod-05.html#cb784-7" tabindex="-1"></a><span class="fu">points</span>(x, x.prb, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb784-8"><a href="mod-05.html#cb784-8" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb784-9"><a href="mod-05.html#cb784-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb784-10"><a href="mod-05.html#cb784-10" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Logit(x)&quot;</span>, <span class="st">&quot;Probit(x)&quot;</span>),</span>
<span id="cb784-11"><a href="mod-05.html#cb784-11" tabindex="-1"></a>    <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/chunkx460-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="uncommon-transformations" class="section level3 hasAnchor" number="5.7.4">
<h3><span class="header-section-number">5.7.4</span> Uncommon transformations<a href="mod-05.html#uncommon-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="square-root-transformation" class="section level4 hasAnchor" number="5.7.4.1">
<h4><span class="header-section-number">5.7.4.1</span> Square-root transformation<a href="mod-05.html#square-root-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Square-root transforms</strong> map values to their square roots. This is sometimes used as a variance-stabilizing transformation, similar to the log transform. Square-root transforms are useful when a response variable is proportional to the square of the explanatory variable, or when the data show heteroscedasticity (non-constant variance). Counts are sometimes analyzed using a square-root transform. The square-root transform is a special case of the <strong>power transform</strong> (where values are raised to a power) and a special case of the Box-Cox transform (see below). The square-root function in R is <code>sqrt()</code>. There are several ways to accomplish a square-root transform in R:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="mod-05.html#cb785-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb785-2"><a href="mod-05.html#cb785-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(x)</span>
<span id="cb785-3"><a href="mod-05.html#cb785-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="fl">0.5</span></span></code></pre></div>
<p>Higher roots (cube root, fourth root, etc.) are sometimes used as transforms, but this is not very common.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="mod-05.html#cb786-1" tabindex="-1"></a>w <span class="ot">&lt;-</span> x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="co"># cube root</span></span></code></pre></div>
<p>Here is an example of using the square root transform on right-skewed data:</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="mod-05.html#cb787-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb787-2"><a href="mod-05.html#cb787-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb787-3"><a href="mod-05.html#cb787-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb787-4"><a href="mod-05.html#cb787-4" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main=</span><span class="st">&quot;Original values&quot;</span>)</span>
<span id="cb787-5"><a href="mod-05.html#cb787-5" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">sqrt</span>(x), <span class="at">main=</span><span class="st">&quot;Square root&quot;</span>)</span>
<span id="cb787-6"><a href="mod-05.html#cb787-6" tabindex="-1"></a><span class="fu">hist</span>(x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),<span class="at">main=</span><span class="st">&quot;Cube root&quot;</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-438-1.png" width="768" /></p>
<p>Notice how the square- and cube-root transformed data appear much more normally-distributed than the original data.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="mod-05.html#cb788-1" tabindex="-1"></a><span class="co"># reset plot layout</span></span>
<span id="cb788-2"><a href="mod-05.html#cb788-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="arcsine-transformation" class="section level4 hasAnchor" number="5.7.4.2">
<h4><span class="header-section-number">5.7.4.2</span> Arcsine transformation<a href="mod-05.html#arcsine-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another option for proportional data is to use the arcsine transform:</p>
<p><span class="math display">\[y_i=\frac{2}{\pi}arcsin\left(\sqrt{x_i}\right)\]</span></p>
<p>Some sources omit the coefficient <span class="math inline">\(2/\pi\)</span>; others do not. Including the <span class="math inline">\(2/\pi\)</span> ensures that the transformed values range from 0 to 1 <span class="citation">(<a href="#ref-mccune2002analysis">McCune et al. 2002</a>)</span>. It should be noted that the arcsine transformation should probably <em>not</em> be used when the data come from a binomial process. In those cases, logistic or binomial GLMs are likely to be more appropriate than an arcsine transformation. Simulation results have found that the arcsine transform should probably <strong><em>not</em></strong> be used for ecological data <span class="citation">(<a href="#ref-warton2011">Warton and Hui 2011</a>)</span>. I couldn’t find a reference on its acceptability in other areas of biology but I’d be surprised if it was appropriate given the arguments presented by <span class="citation">Warton and Hui (<a href="#ref-warton2011">2011</a>)</span>.</p>
<p>If you insist on using the arcsine transform, you can do it in R using <code>asin()</code> function. In the examples below, <code>asin()</code> is embedded inside custom functions that perform the other parts of the arcsine transform.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="mod-05.html#cb789-1" tabindex="-1"></a><span class="co"># unbounded version:</span></span>
<span id="cb789-2"><a href="mod-05.html#cb789-2" tabindex="-1"></a>asin.trans1 <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="fu">asin</span>(<span class="fu">sqrt</span>(p))}</span>
<span id="cb789-3"><a href="mod-05.html#cb789-3" tabindex="-1"></a></span>
<span id="cb789-4"><a href="mod-05.html#cb789-4" tabindex="-1"></a><span class="co"># bounded version:</span></span>
<span id="cb789-5"><a href="mod-05.html#cb789-5" tabindex="-1"></a>asin.trans2 <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {<span class="dv">2</span><span class="sc">/</span>pi<span class="sc">*</span><span class="fu">asin</span>(<span class="fu">sqrt</span>(p))}</span>
<span id="cb789-6"><a href="mod-05.html#cb789-6" tabindex="-1"></a></span>
<span id="cb789-7"><a href="mod-05.html#cb789-7" tabindex="-1"></a><span class="co"># example of use</span></span>
<span id="cb789-8"><a href="mod-05.html#cb789-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb789-9"><a href="mod-05.html#cb789-9" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">asin.trans1</span>(x)</span>
<span id="cb789-10"><a href="mod-05.html#cb789-10" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">asin.trans2</span>(x)</span>
<span id="cb789-11"><a href="mod-05.html#cb789-11" tabindex="-1"></a></span>
<span id="cb789-12"><a href="mod-05.html#cb789-12" tabindex="-1"></a><span class="co"># compare with and without 2/pi coefficient:</span></span>
<span id="cb789-13"><a href="mod-05.html#cb789-13" tabindex="-1"></a><span class="fu">plot</span>(x,y1, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.6</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb789-14"><a href="mod-05.html#cb789-14" tabindex="-1"></a><span class="fu">points</span>(x, y2, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb789-15"><a href="mod-05.html#cb789-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb789-16"><a href="mod-05.html#cb789-16" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Unbounded version&quot;</span>, <span class="st">&quot;Bounded version&quot;</span>),</span>
<span id="cb789-17"><a href="mod-05.html#cb789-17" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb789-18"><a href="mod-05.html#cb789-18" tabindex="-1"></a>       <span class="at">cex=</span><span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-440-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The plot below compares the arcsine to the logit transformation for proportional data.</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="mod-05.html#cb790-1" tabindex="-1"></a><span class="co"># compare to logit transform:</span></span>
<span id="cb790-2"><a href="mod-05.html#cb790-2" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(x)</span>
<span id="cb790-3"><a href="mod-05.html#cb790-3" tabindex="-1"></a><span class="fu">plot</span>(x,y1, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb790-4"><a href="mod-05.html#cb790-4" tabindex="-1"></a><span class="fu">points</span>(x, y2, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb790-5"><a href="mod-05.html#cb790-5" tabindex="-1"></a><span class="fu">points</span>(x, y3, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb790-6"><a href="mod-05.html#cb790-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb790-7"><a href="mod-05.html#cb790-7" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Unbounded arcsine&quot;</span>,</span>
<span id="cb790-8"><a href="mod-05.html#cb790-8" tabindex="-1"></a>                <span class="st">&quot;Bounded arcsine&quot;</span>,</span>
<span id="cb790-9"><a href="mod-05.html#cb790-9" tabindex="-1"></a>                <span class="st">&quot;Logit&quot;</span>),</span>
<span id="cb790-10"><a href="mod-05.html#cb790-10" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">cex=</span><span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-441-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="box-cox-transformation" class="section level4 hasAnchor" number="5.7.4.3">
<h4><span class="header-section-number">5.7.4.3</span> Box-Cox transformation<a href="mod-05.html#box-cox-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>Box-Cox transformation</strong> is a kind of power transform that can achieve a normal distribution in a non-normally distributed response variable <span class="citation">(<a href="#ref-box1964">Box and Cox 1964</a>)</span>.</p>
<p><span class="math display">\[y_i=\left\{\begin{matrix}log{\left(x_i\right)}&amp;if\ \lambda=0\\\left(x_i^\lambda-1\right)/\lambda&amp;otherwise\\\end{matrix}\right.\]</span></p>
<p>Here the parameter <span class="math inline">\(\lambda\)</span> is some constant that must be optimized for a given variable. When <span class="math inline">\(\lambda\)</span> = 0, the transformation is defined as <span class="math inline">\(y_i=\log{\left(x_i\right)}\)</span>. Unlike the other transformations presented here, the Box-Cox transformation only makes sense in the context of a data model such as linear regression. The basic procedure is to first estimate the optimal <span class="math inline">\(\lambda\)</span> for a given model, then use that <span class="math inline">\(\lambda\)</span> to transform the data.</p>
<p>The Box-Cox transformation is available in several packages, but not base R. Here is an example using the functions in package MASS:</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="mod-05.html#cb791-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb791-2"><a href="mod-05.html#cb791-2" tabindex="-1"></a></span>
<span id="cb791-3"><a href="mod-05.html#cb791-3" tabindex="-1"></a><span class="co"># generate some data</span></span>
<span id="cb791-4"><a href="mod-05.html#cb791-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb791-5"><a href="mod-05.html#cb791-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb791-6"><a href="mod-05.html#cb791-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb791-7"><a href="mod-05.html#cb791-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb791-8"><a href="mod-05.html#cb791-8" tabindex="-1"></a></span>
<span id="cb791-9"><a href="mod-05.html#cb791-9" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-442-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="mod-05.html#cb792-1" tabindex="-1"></a><span class="co"># fit a linear model</span></span>
<span id="cb792-2"><a href="mod-05.html#cb792-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb792-3"><a href="mod-05.html#cb792-3" tabindex="-1"></a></span>
<span id="cb792-4"><a href="mod-05.html#cb792-4" tabindex="-1"></a><span class="co"># run the box-cox transformation</span></span>
<span id="cb792-5"><a href="mod-05.html#cb792-5" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(m1)</span></code></pre></div>
<p><img src="applied_biol_data_analysis_20220816_files/figure-html/unnamed-chunk-442-2.png" width="576" style="display: block; margin: auto;" /></p>
<p>The figure below illustrates how the optimal <span class="math inline">\(\lambda\)</span> is determined:</p>
<p><img src="05_04.jpg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="mod-05.html#cb793-1" tabindex="-1"></a><span class="co"># get optimal lambda:</span></span>
<span id="cb793-2"><a href="mod-05.html#cb793-2" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> bc<span class="sc">$</span>x[<span class="fu">which.max</span>(bc<span class="sc">$</span>y)]</span>
<span id="cb793-3"><a href="mod-05.html#cb793-3" tabindex="-1"></a></span>
<span id="cb793-4"><a href="mod-05.html#cb793-4" tabindex="-1"></a><span class="co"># boxcox transformation</span></span>
<span id="cb793-5"><a href="mod-05.html#cb793-5" tabindex="-1"></a>bc.trans <span class="ot">&lt;-</span> <span class="cf">function</span>(x, lam){</span>
<span id="cb793-6"><a href="mod-05.html#cb793-6" tabindex="-1"></a>    <span class="cf">if</span>(lam <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb793-7"><a href="mod-05.html#cb793-7" tabindex="-1"></a>        <span class="fu">log</span>(x)</span>
<span id="cb793-8"><a href="mod-05.html#cb793-8" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb793-9"><a href="mod-05.html#cb793-9" tabindex="-1"></a>        ((x<span class="sc">^</span>lam)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>lam</span>
<span id="cb793-10"><a href="mod-05.html#cb793-10" tabindex="-1"></a>    }</span>
<span id="cb793-11"><a href="mod-05.html#cb793-11" tabindex="-1"></a>}</span>
<span id="cb793-12"><a href="mod-05.html#cb793-12" tabindex="-1"></a></span>
<span id="cb793-13"><a href="mod-05.html#cb793-13" tabindex="-1"></a>yt <span class="ot">&lt;-</span> <span class="fu">bc.trans</span>(y, lambda)</span>
<span id="cb793-14"><a href="mod-05.html#cb793-14" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yt<span class="sc">~</span>x)</span>
<span id="cb793-15"><a href="mod-05.html#cb793-15" tabindex="-1"></a><span class="co"># note difference in R-squared:</span></span>
<span id="cb793-16"><a href="mod-05.html#cb793-16" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.037 -10.734  -1.496   6.798  22.138 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -56.86      12.34  -4.606  0.00174 ** 
## x              31.80       3.53   9.009 1.84e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.49 on 8 degrees of freedom
## Multiple R-squared:  0.9103, Adjusted R-squared:  0.8991 
## F-statistic: 81.15 on 1 and 8 DF,  p-value: 1.84e-05</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="mod-05.html#cb795-1" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yt ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.15135 -0.04794 -0.01449  0.06522  0.11884 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.08013    0.08491  -12.72 1.37e-06 ***
## x            1.96623    0.02428   80.97 6.04e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08589 on 8 degrees of freedom
## Multiple R-squared:  0.9988, Adjusted R-squared:  0.9986 
## F-statistic:  6556 on 1 and 8 DF,  p-value: 6.035e-13</code></pre>

</div>
</div>
</div>
</div>
<h3>Literature Cited<a href="literature-cited.html#literature-cited" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-box1964" class="csl-entry">
Box, G. E. P., and D. R. Cox. 1964. <a href="https://doi.org/10.1111/j.2517-6161.1964.tb00553.x">An analysis of transformations</a>. Journal of the Royal Statistical Society: Series B (Methodological) 26:211–243.
</div>
<div id="ref-carnell2019" class="csl-entry">
Carnell, R. 2019. <a href="https://CRAN.R-project.org/package=triangle">Triangle: Provides the standard distribution functions for the triangle distribution</a>.
</div>
<div id="ref-kery2010" class="csl-entry">
Kéry, M. 2010. Introduction to <span>W</span>in<span>BUGS</span> for ecologists: <span>B</span>ayesian approach to regression, <span>ANOVA</span>, mixed models and related analyses. Academic Press.
</div>
<div id="ref-mccune2002analysis" class="csl-entry">
McCune, B., J. B. Grace, and D. L. Urban. 2002. Analysis of ecological communities. MjM software design, Gleneden Beach, Oregon, USA.
</div>
<div id="ref-venables2002" class="csl-entry">
Venables, W. N., and B. D. Ripley. 2002. <a href="https://www.stats.ox.ac.uk/pub/MASS4/">Modern applied statistics with <span>S</span></a>. Fourth. Springer, New York.
</div>
<div id="ref-warton2011" class="csl-entry">
Warton, D. I., and F. K. C. Hui. 2011. <a href="https://doi.org/10.1890/10-0340.1">The arcsine is asinine: The analysis of proportions in ecology</a>. Ecology 92:3–10.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="47">
<li id="fn47"><p>After all, how useful is a dataset with a sample size of 1?<a href="mod-05.html#fnref47" class="footnote-back">↩︎</a></p></li>
<li id="fn48"><p>If your brain hurts, that’s completely normal. This function gives me headaches too<a href="mod-05.html#fnref48" class="footnote-back">↩︎</a></p></li>
<li id="fn49"><p>It is possible, and not uncommon, to analyze data using the natural log scale but plot results on the log<sub>10</sub> scale. This works because the choice of base is arbitrary for most analyses and because it is simple to convert values between scales with different bases (i.e., change of base).<a href="mod-05.html#fnref49" class="footnote-back">↩︎</a></p></li>
<li id="fn50"><p>In R, statistics, and in mathematics in general, if you see “log” it usually means “natural log”.<a href="mod-05.html#fnref50" class="footnote-back">↩︎</a></p></li>
<li id="fn51"><p>Whatever you do, don’t call the natural logarithm “lawn” unless you want to look silly.<a href="mod-05.html#fnref51" class="footnote-back">↩︎</a></p></li>
<li id="fn52"><p><a href="https://youtu.be/m2MIpDrF7Es">Here</a> is a video that explains why. I can’t recommend this channel enough. <a href="https://youtu.be/mvmuCPvRoWQ">Here</a> is another video that goes deeper on what exponents and logarithms really mean.<a href="mod-05.html#fnref52" class="footnote-back">↩︎</a></p></li>
<li id="fn53"><p><a href="https://www.youtube.com/watch?v=VSi0Z04fWj0">This video</a> illustrates the usefulness of logarithms in statistics <strong><em>and</em></strong> has a nice theme song.<a href="mod-05.html#fnref53" class="footnote-back">↩︎</a></p></li>
<li id="fn54"><p>Remember that exponential functions relate addition and multiplication. This is how exponentiation is extended to non-integer powers: <span class="math inline">\(X^aX^b=X^{a+b}\)</span>. And, in some sense the <em>definition</em> of exponentiation.<a href="mod-05.html#fnref54" class="footnote-back">↩︎</a></p></li>
<li id="fn55"><p>An <strong>open interval</strong> is an interval (a, b) that contains values &gt; <em>a</em> and &lt; <em>b</em>, but never <em>a</em> or <em>b</em>. Open intervals are denoted by parentheses (). Intervals that contain their limits are called <strong>closed intervals</strong>, denoted <span class="math inline">\(\left[a,b\right]\)</span>.<a href="mod-05.html#fnref55" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-04.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-06.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-explore2.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["applied_biol_data_analysis_20220816.pdf", "applied_biol_data_analysis_20220816.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
